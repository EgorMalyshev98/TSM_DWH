[0m10:24:54.296006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1781a8cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1787c7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe179cd2480>]}


============================== 10:24:54.300734 | 929bee7b-9c22-48e1-938e-f64273376575 ==============================
[0m10:24:54.300734 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:24:54.301591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt init', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:25:20.607156 [debug] [MainThread]: Starter project path: /home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/include/starter_project
[0m10:25:20.610192 [info ] [MainThread]: 
Your new dbt project "postgres_dwh" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m10:25:20.610835 [info ] [MainThread]: Setting up your profile.
[0m10:26:10.352338 [info ] [MainThread]: Profile postgres_dwh written to /home/egor/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m10:26:10.356871 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 76.12335, "process_in_blocks": "144", "process_kernel_time": 0.150322, "process_mem_max_rss": "98448", "process_out_blocks": "344", "process_user_time": 1.678132}
[0m10:26:10.357692 [debug] [MainThread]: Command `dbt init` succeeded at 10:26:10.357463 after 76.12 seconds
[0m10:26:10.358769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1781a8cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe177dc9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe177796570>]}
[0m10:26:10.359504 [debug] [MainThread]: Flushing usage events
[0m10:26:11.388542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:26:23.267290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e124201d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e129f7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e12420050>]}


============================== 10:26:23.270974 | 9721d7b2-42a6-4fe0-ae17-ef0329affeac ==============================
[0m10:26:23.270974 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:26:23.271946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:26:23.287010 [info ] [MainThread]: dbt version: 1.9.3
[0m10:26:23.287620 [info ] [MainThread]: python version: 3.12.9
[0m10:26:23.288222 [info ] [MainThread]: python path: /home/egor/projects/TSM_DWH/venv/bin/python
[0m10:26:23.288754 [info ] [MainThread]: os info: Linux-6.13.7-100.fc40.x86_64-x86_64-with-glibc2.39
[0m10:26:23.298267 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.snowflake'
[0m10:26:23.366669 [info ] [MainThread]: Using profiles dir at /home/egor/.dbt
[0m10:26:23.367360 [info ] [MainThread]: Using profiles.yml file at /home/egor/.dbt/profiles.yml
[0m10:26:23.368009 [info ] [MainThread]: Using dbt_project.yml file at /home/egor/projects/TSM_DWH/dbt_project.yml
[0m10:26:23.368676 [info ] [MainThread]: Configuration:
[0m10:26:23.369308 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m10:26:23.370011 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m10:26:23.370577 [info ] [MainThread]: Required dependencies:
[0m10:26:23.371169 [debug] [MainThread]: Executing "git --help"
[0m10:26:23.378758 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:26:23.379987 [debug] [MainThread]: STDERR: "b''"
[0m10:26:23.380521 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:26:23.381373 [info ] [MainThread]: Connection test skipped since no profile was found
[0m10:26:23.382337 [info ] [MainThread]: [31m2 checks failed:[0m
[0m10:26:23.383155 [info ] [MainThread]: Could not load dbt_project.yml
Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "dbtvault_snowflake_demo", target "dev" invalid: Runtime Error
    Could not find adapter type snowflake!


[0m10:26:23.383725 [info ] [MainThread]: Project loading failed for the following reason:
 project path </home/egor/projects/TSM_DWH/dbt_project.yml> not found

[0m10:26:23.385589 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.1740575, "process_in_blocks": "0", "process_kernel_time": 0.141005, "process_mem_max_rss": "99148", "process_out_blocks": "16", "process_user_time": 1.736959}
[0m10:26:23.386813 [debug] [MainThread]: Command `dbt debug` failed at 10:26:23.386529 after 0.18 seconds
[0m10:26:23.388081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e129f7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e12d5b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e121d6c00>]}
[0m10:26:23.389408 [debug] [MainThread]: Flushing usage events
[0m10:26:24.188588 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:29:59.865031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd24da600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd369e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd369f440>]}


============================== 10:29:59.871119 | fc59b86f-a3cd-4d81-bb39-2ce308cf08c3 ==============================
[0m10:29:59.871119 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:29:59.872313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m10:29:59.891300 [info ] [MainThread]: dbt version: 1.9.3
[0m10:29:59.892261 [info ] [MainThread]: python version: 3.12.9
[0m10:29:59.893389 [info ] [MainThread]: python path: /home/egor/projects/TSM_DWH/venv/bin/python
[0m10:29:59.894372 [info ] [MainThread]: os info: Linux-6.13.7-100.fc40.x86_64-x86_64-with-glibc2.39
[0m10:29:59.966767 [info ] [MainThread]: Using profiles dir at /home/egor/.dbt
[0m10:29:59.967442 [info ] [MainThread]: Using profiles.yml file at /home/egor/.dbt/profiles.yml
[0m10:29:59.968085 [info ] [MainThread]: Using dbt_project.yml file at /home/egor/projects/TSM_DWH/dbt_project.yml
[0m10:29:59.968865 [info ] [MainThread]: adapter type: postgres
[0m10:29:59.969465 [info ] [MainThread]: adapter version: 1.9.0
[0m10:30:00.085065 [info ] [MainThread]: Configuration:
[0m10:30:00.085774 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:30:00.086400 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:30:00.087006 [info ] [MainThread]: Required dependencies:
[0m10:30:00.087608 [debug] [MainThread]: Executing "git --help"
[0m10:30:00.090240 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:30:00.090921 [debug] [MainThread]: STDERR: "b''"
[0m10:30:00.091788 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:30:00.092802 [info ] [MainThread]: Connection:
[0m10:30:00.093731 [info ] [MainThread]:   host: localhost
[0m10:30:00.094651 [info ] [MainThread]:   port: 5432
[0m10:30:00.095465 [info ] [MainThread]:   user: postgres
[0m10:30:00.096429 [info ] [MainThread]:   database: postgres
[0m10:30:00.097606 [info ] [MainThread]:   schema: public
[0m10:30:00.098858 [info ] [MainThread]:   connect_timeout: 10
[0m10:30:00.099889 [info ] [MainThread]:   role: None
[0m10:30:00.100595 [info ] [MainThread]:   search_path: None
[0m10:30:00.101405 [info ] [MainThread]:   keepalives_idle: 0
[0m10:30:00.102004 [info ] [MainThread]:   sslmode: None
[0m10:30:00.102669 [info ] [MainThread]:   sslcert: None
[0m10:30:00.103624 [info ] [MainThread]:   sslkey: None
[0m10:30:00.104517 [info ] [MainThread]:   sslrootcert: None
[0m10:30:00.105394 [info ] [MainThread]:   application_name: dbt
[0m10:30:00.106295 [info ] [MainThread]:   retries: 1
[0m10:30:00.107413 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:30:00.223194 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:30:00.257335 [debug] [MainThread]: Using postgres connection "debug"
[0m10:30:00.257919 [debug] [MainThread]: On debug: select 1 as id
[0m10:30:00.258417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:30:00.277735 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  Ident authentication failed for user "postgres"

[0m10:30:00.281379 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m10:30:00.281937 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m10:30:00.282413 [debug] [MainThread]: On debug: No close available on handle
[0m10:30:00.282928 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:30:00.283458 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:30:00.284286 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  Ident authentication failed for user "postgres"
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:30:00.286172 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.48416987, "process_in_blocks": "824", "process_kernel_time": 0.205105, "process_mem_max_rss": "108108", "process_out_blocks": "24", "process_user_time": 1.786354}
[0m10:30:00.287200 [debug] [MainThread]: Command `dbt debug` failed at 10:30:00.287059 after 0.49 seconds
[0m10:30:00.287994 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:30:00.289090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd43901a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd35f8800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd05040e0>]}
[0m10:30:00.290162 [debug] [MainThread]: Flushing usage events
[0m10:30:01.193578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:32:01.259815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019d4912b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019cc19850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019ece4920>]}


============================== 10:32:01.263698 | b127e064-c87a-4136-9c7e-1c8a28019142 ==============================
[0m10:32:01.263698 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:32:01.264628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:32:01.279267 [info ] [MainThread]: dbt version: 1.9.3
[0m10:32:01.280690 [info ] [MainThread]: python version: 3.12.9
[0m10:32:01.281553 [info ] [MainThread]: python path: /home/egor/projects/TSM_DWH/venv/bin/python
[0m10:32:01.282533 [info ] [MainThread]: os info: Linux-6.13.7-100.fc40.x86_64-x86_64-with-glibc2.39
[0m10:32:01.343975 [info ] [MainThread]: Using profiles dir at /home/egor/.dbt
[0m10:32:01.344692 [info ] [MainThread]: Using profiles.yml file at /home/egor/.dbt/profiles.yml
[0m10:32:01.345380 [info ] [MainThread]: Using dbt_project.yml file at /home/egor/projects/TSM_DWH/dbt_project.yml
[0m10:32:01.459299 [info ] [MainThread]: Configuration:
[0m10:32:01.460056 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m10:32:01.460640 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:32:01.461286 [info ] [MainThread]: Required dependencies:
[0m10:32:01.461855 [debug] [MainThread]: Executing "git --help"
[0m10:32:01.464447 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:32:01.465080 [debug] [MainThread]: STDERR: "b''"
[0m10:32:01.465570 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:32:01.466104 [info ] [MainThread]: Connection test skipped since no profile was found
[0m10:32:01.466871 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:32:01.467778 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "postgres_dwh", target "dev" invalid: 1234 is not of type 'string'


[0m10:32:01.469663 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.2662074, "process_in_blocks": "0", "process_kernel_time": 0.138355, "process_mem_max_rss": "101612", "process_out_blocks": "16", "process_user_time": 1.661417}
[0m10:32:01.470753 [debug] [MainThread]: Command `dbt debug` failed at 10:32:01.470565 after 0.27 seconds
[0m10:32:01.471635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019cc19850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019c1b9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019c1b9160>]}
[0m10:32:01.472644 [debug] [MainThread]: Flushing usage events
[0m10:32:02.316080 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:32:21.898469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db9d64920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dbb40ef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db9610500>]}


============================== 10:32:21.902307 | 8c80f243-82df-4723-ba87-652161b2d982 ==============================
[0m10:32:21.902307 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:32:21.903094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:32:21.917166 [info ] [MainThread]: dbt version: 1.9.3
[0m10:32:21.917860 [info ] [MainThread]: python version: 3.12.9
[0m10:32:21.918563 [info ] [MainThread]: python path: /home/egor/projects/TSM_DWH/venv/bin/python
[0m10:32:21.919156 [info ] [MainThread]: os info: Linux-6.13.7-100.fc40.x86_64-x86_64-with-glibc2.39
[0m10:32:21.987558 [info ] [MainThread]: Using profiles dir at /home/egor/.dbt
[0m10:32:21.988198 [info ] [MainThread]: Using profiles.yml file at /home/egor/.dbt/profiles.yml
[0m10:32:21.988895 [info ] [MainThread]: Using dbt_project.yml file at /home/egor/projects/TSM_DWH/dbt_project.yml
[0m10:32:21.989840 [info ] [MainThread]: adapter type: postgres
[0m10:32:21.990366 [info ] [MainThread]: adapter version: 1.9.0
[0m10:32:22.106228 [info ] [MainThread]: Configuration:
[0m10:32:22.106872 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:32:22.107416 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:32:22.108019 [info ] [MainThread]: Required dependencies:
[0m10:32:22.108578 [debug] [MainThread]: Executing "git --help"
[0m10:32:22.111039 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:32:22.111608 [debug] [MainThread]: STDERR: "b''"
[0m10:32:22.112419 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:32:22.113423 [info ] [MainThread]: Connection:
[0m10:32:22.114333 [info ] [MainThread]:   host: localhost
[0m10:32:22.115240 [info ] [MainThread]:   port: 5432
[0m10:32:22.116114 [info ] [MainThread]:   user: postgres
[0m10:32:22.117331 [info ] [MainThread]:   database: postgres
[0m10:32:22.118224 [info ] [MainThread]:   schema: public
[0m10:32:22.119321 [info ] [MainThread]:   connect_timeout: 10
[0m10:32:22.120418 [info ] [MainThread]:   role: None
[0m10:32:22.121367 [info ] [MainThread]:   search_path: None
[0m10:32:22.122005 [info ] [MainThread]:   keepalives_idle: 0
[0m10:32:22.122576 [info ] [MainThread]:   sslmode: None
[0m10:32:22.123140 [info ] [MainThread]:   sslcert: None
[0m10:32:22.123906 [info ] [MainThread]:   sslkey: None
[0m10:32:22.124760 [info ] [MainThread]:   sslrootcert: None
[0m10:32:22.125636 [info ] [MainThread]:   application_name: dbt
[0m10:32:22.126627 [info ] [MainThread]:   retries: 1
[0m10:32:22.127843 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:32:22.240432 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:32:22.269845 [debug] [MainThread]: Using postgres connection "debug"
[0m10:32:22.270457 [debug] [MainThread]: On debug: select 1 as id
[0m10:32:22.270921 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:32:22.275566 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  Ident authentication failed for user "postgres"

[0m10:32:22.279076 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m10:32:22.280140 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m10:32:22.281147 [debug] [MainThread]: On debug: No close available on handle
[0m10:32:22.281609 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:32:22.282286 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:32:22.283137 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  Ident authentication failed for user "postgres"
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:32:22.284766 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.44919735, "process_in_blocks": "0", "process_kernel_time": 0.19105, "process_mem_max_rss": "108192", "process_out_blocks": "24", "process_user_time": 1.784941}
[0m10:32:22.285479 [debug] [MainThread]: Command `dbt debug` failed at 10:32:22.285307 after 0.45 seconds
[0m10:32:22.286160 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:32:22.286681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db9d64920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db94c9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db8e50350>]}
[0m10:32:22.287337 [debug] [MainThread]: Flushing usage events
[0m10:32:23.104487 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:34:17.063767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60797d6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60797d4f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60797d7f50>]}


============================== 10:34:17.067656 | 3683a995-e259-4f36-9626-051d51b449d3 ==============================
[0m10:34:17.067656 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:34:17.068502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m10:34:17.083457 [info ] [MainThread]: dbt version: 1.9.3
[0m10:34:17.084432 [info ] [MainThread]: python version: 3.12.9
[0m10:34:17.085583 [info ] [MainThread]: python path: /home/egor/projects/TSM_DWH/venv/bin/python
[0m10:34:17.086679 [info ] [MainThread]: os info: Linux-6.13.7-100.fc40.x86_64-x86_64-with-glibc2.39
[0m10:34:17.153332 [info ] [MainThread]: Using profiles dir at /home/egor/.dbt
[0m10:34:17.154045 [info ] [MainThread]: Using profiles.yml file at /home/egor/.dbt/profiles.yml
[0m10:34:17.154602 [info ] [MainThread]: Using dbt_project.yml file at /home/egor/projects/TSM_DWH/dbt_project.yml
[0m10:34:17.155518 [info ] [MainThread]: adapter type: postgres
[0m10:34:17.156103 [info ] [MainThread]: adapter version: 1.9.0
[0m10:34:17.273306 [info ] [MainThread]: Configuration:
[0m10:34:17.274069 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:34:17.274664 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:34:17.275297 [info ] [MainThread]: Required dependencies:
[0m10:34:17.275985 [debug] [MainThread]: Executing "git --help"
[0m10:34:17.278291 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:34:17.278865 [debug] [MainThread]: STDERR: "b''"
[0m10:34:17.279328 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:34:17.279902 [info ] [MainThread]: Connection:
[0m10:34:17.280889 [info ] [MainThread]:   host: localhost
[0m10:34:17.281856 [info ] [MainThread]:   port: 5432
[0m10:34:17.282792 [info ] [MainThread]:   user: postgres
[0m10:34:17.283427 [info ] [MainThread]:   database: postgres
[0m10:34:17.284379 [info ] [MainThread]:   schema: public
[0m10:34:17.285363 [info ] [MainThread]:   connect_timeout: 10
[0m10:34:17.286452 [info ] [MainThread]:   role: None
[0m10:34:17.287511 [info ] [MainThread]:   search_path: None
[0m10:34:17.288601 [info ] [MainThread]:   keepalives_idle: 0
[0m10:34:17.289498 [info ] [MainThread]:   sslmode: None
[0m10:34:17.290129 [info ] [MainThread]:   sslcert: None
[0m10:34:17.291197 [info ] [MainThread]:   sslkey: None
[0m10:34:17.292043 [info ] [MainThread]:   sslrootcert: None
[0m10:34:17.292812 [info ] [MainThread]:   application_name: dbt
[0m10:34:17.293422 [info ] [MainThread]:   retries: 1
[0m10:34:17.294544 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:34:17.428453 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:34:17.460393 [debug] [MainThread]: Using postgres connection "debug"
[0m10:34:17.460955 [debug] [MainThread]: On debug: select 1 as id
[0m10:34:17.461407 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:34:17.466045 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  Ident authentication failed for user "postgres"

[0m10:34:17.469457 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m10:34:17.470522 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m10:34:17.471604 [debug] [MainThread]: On debug: No close available on handle
[0m10:34:17.472228 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:34:17.472868 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:34:17.473627 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  Ident authentication failed for user "postgres"
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:34:17.475183 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.46748513, "process_in_blocks": "592", "process_kernel_time": 0.191653, "process_mem_max_rss": "108308", "process_out_blocks": "24", "process_user_time": 1.805094}
[0m10:34:17.475799 [debug] [MainThread]: Command `dbt debug` failed at 10:34:17.475628 after 0.47 seconds
[0m10:34:17.476307 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:34:17.476846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60797608f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f607a1ebe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f607d6b78c0>]}
[0m10:34:17.477399 [debug] [MainThread]: Flushing usage events
[0m10:34:18.367835 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:34:37.089542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20786deba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20777d4a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2076038f80>]}


============================== 10:34:37.093396 | 4f675124-89b5-4782-b467-4055ea63de97 ==============================
[0m10:34:37.093396 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:34:37.094323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:34:37.110560 [info ] [MainThread]: dbt version: 1.9.3
[0m10:34:37.111846 [info ] [MainThread]: python version: 3.12.9
[0m10:34:37.113016 [info ] [MainThread]: python path: /home/egor/projects/TSM_DWH/venv/bin/python
[0m10:34:37.113922 [info ] [MainThread]: os info: Linux-6.13.7-100.fc40.x86_64-x86_64-with-glibc2.39
[0m10:34:37.181426 [info ] [MainThread]: Using profiles dir at /home/egor/.dbt
[0m10:34:37.182249 [info ] [MainThread]: Using profiles.yml file at /home/egor/.dbt/profiles.yml
[0m10:34:37.183003 [info ] [MainThread]: Using dbt_project.yml file at /home/egor/projects/TSM_DWH/dbt_project.yml
[0m10:34:37.183949 [info ] [MainThread]: adapter type: postgres
[0m10:34:37.184568 [info ] [MainThread]: adapter version: 1.9.0
[0m10:34:37.304051 [info ] [MainThread]: Configuration:
[0m10:34:37.304743 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:34:37.305415 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:34:37.306143 [info ] [MainThread]: Required dependencies:
[0m10:34:37.307078 [debug] [MainThread]: Executing "git --help"
[0m10:34:37.309758 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:34:37.310620 [debug] [MainThread]: STDERR: "b''"
[0m10:34:37.311516 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:34:37.312459 [info ] [MainThread]: Connection:
[0m10:34:37.313416 [info ] [MainThread]:   host: 127.0.0.1
[0m10:34:37.314336 [info ] [MainThread]:   port: 5432
[0m10:34:37.315081 [info ] [MainThread]:   user: postgres
[0m10:34:37.316184 [info ] [MainThread]:   database: postgres
[0m10:34:37.317143 [info ] [MainThread]:   schema: public
[0m10:34:37.318309 [info ] [MainThread]:   connect_timeout: 10
[0m10:34:37.319414 [info ] [MainThread]:   role: None
[0m10:34:37.320431 [info ] [MainThread]:   search_path: None
[0m10:34:37.321418 [info ] [MainThread]:   keepalives_idle: 0
[0m10:34:37.322101 [info ] [MainThread]:   sslmode: None
[0m10:34:37.323105 [info ] [MainThread]:   sslcert: None
[0m10:34:37.324154 [info ] [MainThread]:   sslkey: None
[0m10:34:37.325086 [info ] [MainThread]:   sslrootcert: None
[0m10:34:37.325738 [info ] [MainThread]:   application_name: dbt
[0m10:34:37.326427 [info ] [MainThread]:   retries: 1
[0m10:34:37.327194 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:34:37.455611 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:34:37.483711 [debug] [MainThread]: Using postgres connection "debug"
[0m10:34:37.484380 [debug] [MainThread]: On debug: select 1 as id
[0m10:34:37.484885 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:34:37.499865 [debug] [MainThread]: SQL status: SELECT 1 in 0.015 seconds
[0m10:34:37.501397 [debug] [MainThread]: On debug: Close
[0m10:34:37.502217 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:34:37.502932 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:34:37.504620 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.47340927, "process_in_blocks": "0", "process_kernel_time": 0.188408, "process_mem_max_rss": "109372", "process_out_blocks": "16", "process_user_time": 1.824241}
[0m10:34:37.505356 [debug] [MainThread]: Command `dbt debug` succeeded at 10:34:37.505199 after 0.47 seconds
[0m10:34:37.505833 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:34:37.506331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20757d7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2075752c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2075750230>]}
[0m10:34:37.506899 [debug] [MainThread]: Flushing usage events
[0m10:34:38.272807 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:18.630658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29f89b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29fa65670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29f89bd70>]}


============================== 14:20:18.635275 | 9435c007-9837-407a-a60a-1c96326b37aa ==============================
[0m14:20:18.635275 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:20:18.636289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:20:18.651254 [info ] [MainThread]: dbt version: 1.9.3
[0m14:20:18.652055 [info ] [MainThread]: python version: 3.12.9
[0m14:20:18.652708 [info ] [MainThread]: python path: /home/egor/projects/TSM_DWH/venv/bin/python
[0m14:20:18.653353 [info ] [MainThread]: os info: Linux-6.13.7-100.fc40.x86_64-x86_64-with-glibc2.39
[0m14:20:18.721582 [info ] [MainThread]: Using profiles dir at /home/egor/.dbt
[0m14:20:18.722453 [info ] [MainThread]: Using profiles.yml file at /home/egor/.dbt/profiles.yml
[0m14:20:18.723238 [info ] [MainThread]: Using dbt_project.yml file at /home/egor/projects/TSM_DWH/dbt_project.yml
[0m14:20:18.724603 [info ] [MainThread]: adapter type: postgres
[0m14:20:18.725269 [info ] [MainThread]: adapter version: 1.9.0
[0m14:20:18.859311 [info ] [MainThread]: Configuration:
[0m14:20:18.860102 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:20:18.860815 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:20:18.861783 [info ] [MainThread]: Required dependencies:
[0m14:20:18.862468 [debug] [MainThread]: Executing "git --help"
[0m14:20:18.864945 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:20:18.865549 [debug] [MainThread]: STDERR: "b''"
[0m14:20:18.866364 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:20:18.867253 [info ] [MainThread]: Connection:
[0m14:20:18.867995 [info ] [MainThread]:   host: 127.0.0.1
[0m14:20:18.868620 [info ] [MainThread]:   port: 5432
[0m14:20:18.869230 [info ] [MainThread]:   user: postgres
[0m14:20:18.869829 [info ] [MainThread]:   database: postgres
[0m14:20:18.870536 [info ] [MainThread]:   schema: public
[0m14:20:18.871465 [info ] [MainThread]:   connect_timeout: 10
[0m14:20:18.872409 [info ] [MainThread]:   role: None
[0m14:20:18.873343 [info ] [MainThread]:   search_path: None
[0m14:20:18.874368 [info ] [MainThread]:   keepalives_idle: 0
[0m14:20:18.875442 [info ] [MainThread]:   sslmode: None
[0m14:20:18.876498 [info ] [MainThread]:   sslcert: None
[0m14:20:18.877394 [info ] [MainThread]:   sslkey: None
[0m14:20:18.878291 [info ] [MainThread]:   sslrootcert: None
[0m14:20:18.879441 [info ] [MainThread]:   application_name: dbt
[0m14:20:18.880328 [info ] [MainThread]:   retries: 1
[0m14:20:18.881182 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:20:19.017984 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:20:19.053143 [debug] [MainThread]: Using postgres connection "debug"
[0m14:20:19.054075 [debug] [MainThread]: On debug: select 1 as id
[0m14:20:19.054709 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:20:19.070441 [debug] [MainThread]: SQL status: SELECT 1 in 0.016 seconds
[0m14:20:19.072304 [debug] [MainThread]: On debug: Close
[0m14:20:19.073066 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:20:19.073830 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:20:19.075940 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.50706464, "process_in_blocks": "272", "process_kernel_time": 0.237743, "process_mem_max_rss": "109160", "process_out_blocks": "24", "process_user_time": 1.891519}
[0m14:20:19.076827 [debug] [MainThread]: Command `dbt debug` succeeded at 14:20:19.076626 after 0.51 seconds
[0m14:20:19.077494 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:20:19.078265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29fb4bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29f173f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29eff86b0>]}
[0m14:20:19.079013 [debug] [MainThread]: Flushing usage events
[0m14:20:19.988176 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:26.044810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff281acb3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28358c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2810b0b60>]}


============================== 14:20:26.048687 | c8d61401-d463-461c-9e35-7aa9f07030e6 ==============================
[0m14:20:26.048687 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:20:26.049603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m14:20:26.231134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8d61401-d463-461c-9e35-7aa9f07030e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff281aca330>]}
[0m14:20:26.299373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8d61401-d463-461c-9e35-7aa9f07030e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2809718e0>]}
[0m14:20:26.300370 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:20:26.430515 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:20:26.494034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:20:26.494571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:20:26.495397 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dwh.example
[0m14:20:26.501168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8d61401-d463-461c-9e35-7aa9f07030e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28090a150>]}
[0m14:20:26.563094 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m14:20:26.565599 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m14:20:26.597280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8d61401-d463-461c-9e35-7aa9f07030e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff27f9c2930>]}
[0m14:20:26.597973 [info ] [MainThread]: Found 433 macros
[0m14:20:26.600682 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:20:26.603309 [debug] [MainThread]: Command end result
[0m14:20:26.644303 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m14:20:26.647013 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m14:20:26.653004 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m14:20:26.654749 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.66780007, "process_in_blocks": "848", "process_kernel_time": 0.200079, "process_mem_max_rss": "108192", "process_out_blocks": "1728", "process_user_time": 2.002761}
[0m14:20:26.655786 [debug] [MainThread]: Command `dbt build` succeeded at 14:20:26.655589 after 0.67 seconds
[0m14:20:26.656657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28120b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2813cfe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28019ac30>]}
[0m14:20:26.657585 [debug] [MainThread]: Flushing usage events
[0m14:20:27.463187 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:59.750659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f517934f920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f517934f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f517931c800>]}


============================== 14:20:59.754658 | c2e6b2c0-e61b-4783-998d-95714040a408 ==============================
[0m14:20:59.754658 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:20:59.755712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:20:59.946810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2e6b2c0-e61b-4783-998d-95714040a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5178ff39b0>]}
[0m14:21:00.014798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2e6b2c0-e61b-4783-998d-95714040a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51791889e0>]}
[0m14:21:00.015759 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:21:00.144994 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:21:00.188155 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:21:00.188887 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m14:21:00.189674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c2e6b2c0-e61b-4783-998d-95714040a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5177f49910>]}
[0m14:21:00.970382 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dwh.example
[0m14:21:00.976461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2e6b2c0-e61b-4783-998d-95714040a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5179e0ab70>]}
[0m14:21:01.034118 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m14:21:01.036565 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m14:21:01.049983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2e6b2c0-e61b-4783-998d-95714040a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5177f68ef0>]}
[0m14:21:01.050616 [info ] [MainThread]: Found 433 macros
[0m14:21:01.051228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2e6b2c0-e61b-4783-998d-95714040a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51783b39b0>]}
[0m14:21:01.052223 [warn ] [MainThread]: The selection criterion 'stg' does not match any enabled nodes
[0m14:21:01.053938 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:21:01.054989 [debug] [MainThread]: Command end result
[0m14:21:01.090415 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m14:21:01.092891 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m14:21:01.096802 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m14:21:01.098111 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4047768, "process_in_blocks": "0", "process_kernel_time": 0.259464, "process_mem_max_rss": "106256", "process_out_blocks": "2496", "process_user_time": 2.811057}
[0m14:21:01.098738 [debug] [MainThread]: Command `cli run` succeeded at 14:21:01.098568 after 1.41 seconds
[0m14:21:01.099362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5179add0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5179561730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5178bb7230>]}
[0m14:21:01.099872 [debug] [MainThread]: Flushing usage events
[0m14:21:01.972454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:35:58.945936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013f106e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013ebd8f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013d1e9400>]}


============================== 14:35:58.951303 | 4ad44510-724c-4927-9ef6-eb078bb6ee78 ==============================
[0m14:35:58.951303 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:35:58.952332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:35:59.162761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ad44510-724c-4927-9ef6-eb078bb6ee78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013d7bc170>]}
[0m14:35:59.231434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ad44510-724c-4927-9ef6-eb078bb6ee78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013cfe7530>]}
[0m14:35:59.232466 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:35:59.428437 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:35:59.530072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:35:59.530685 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:35:59.531691 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dwh.example
[0m14:35:59.538620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ad44510-724c-4927-9ef6-eb078bb6ee78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013cbfbe60>]}
[0m14:35:59.601266 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m14:35:59.603830 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m14:35:59.646209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ad44510-724c-4927-9ef6-eb078bb6ee78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013b57ed20>]}
[0m14:35:59.646885 [info ] [MainThread]: Found 433 macros
[0m14:35:59.649087 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:35:59.651320 [debug] [MainThread]: Command end result
[0m14:35:59.681150 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m14:35:59.682875 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m14:35:59.688045 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m14:35:59.689909 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.8075227, "process_in_blocks": "50808", "process_kernel_time": 0.377926, "process_mem_max_rss": "107492", "process_out_blocks": "1704", "process_user_time": 2.203792}
[0m14:35:59.690598 [debug] [MainThread]: Command `dbt build` succeeded at 14:35:59.690392 after 0.81 seconds
[0m14:35:59.691241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013f106e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013cccc2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013bd46bd0>]}
[0m14:35:59.691761 [debug] [MainThread]: Flushing usage events
[0m14:36:00.640111 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:50.666944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c763da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c763cce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c72f8260>]}


============================== 14:37:50.672602 | 66c75e48-2de2-48e0-aee6-b5e7a0b7728c ==============================
[0m14:37:50.672602 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:37:50.673651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:37:50.898645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66c75e48-2de2-48e0-aee6-b5e7a0b7728c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c6498320>]}
[0m14:37:50.966990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66c75e48-2de2-48e0-aee6-b5e7a0b7728c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c6acb050>]}
[0m14:37:50.968026 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:37:51.095735 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:37:51.155623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:37:51.156171 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:37:51.162058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66c75e48-2de2-48e0-aee6-b5e7a0b7728c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c650c6e0>]}
[0m14:37:51.216998 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m14:37:51.219370 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m14:37:51.259494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66c75e48-2de2-48e0-aee6-b5e7a0b7728c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c610a060>]}
[0m14:37:51.260409 [info ] [MainThread]: Found 433 macros
[0m14:37:51.262624 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:37:51.265101 [debug] [MainThread]: Command end result
[0m14:37:51.298858 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m14:37:51.300572 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m14:37:51.304164 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m14:37:51.305926 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.7007353, "process_in_blocks": "46352", "process_kernel_time": 0.281581, "process_mem_max_rss": "107400", "process_out_blocks": "1800", "process_user_time": 2.167548}
[0m14:37:51.306565 [debug] [MainThread]: Command `dbt build` succeeded at 14:37:51.306432 after 0.70 seconds
[0m14:37:51.307132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c6c43410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c64e8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c6da3440>]}
[0m14:37:51.307625 [debug] [MainThread]: Flushing usage events
[0m14:37:52.153313 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:26.186612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83039ff500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8305a50200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8303f1eff0>]}


============================== 15:00:26.191633 | 2f8dc286-bf6c-4ebe-b8db-234b7977ed18 ==============================
[0m15:00:26.191633 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:00:26.192564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:00:26.400818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f8dc286-bf6c-4ebe-b8db-234b7977ed18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8303fcc0b0>]}
[0m15:00:26.468234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f8dc286-bf6c-4ebe-b8db-234b7977ed18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f830365f530>]}
[0m15:00:26.469298 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:00:26.596034 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:00:26.657154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:00:26.657671 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:00:26.658522 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models
[0m15:00:26.665356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f8dc286-bf6c-4ebe-b8db-234b7977ed18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8303304500>]}
[0m15:00:26.736022 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:00:26.738903 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:00:26.780862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f8dc286-bf6c-4ebe-b8db-234b7977ed18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8301d9dc10>]}
[0m15:00:26.781548 [info ] [MainThread]: Found 433 macros
[0m15:00:26.784055 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:00:26.786744 [debug] [MainThread]: Command end result
[0m15:00:26.818329 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:00:26.820216 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:00:26.825051 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m15:00:26.826865 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.7227416, "process_in_blocks": "42448", "process_kernel_time": 0.285072, "process_mem_max_rss": "107832", "process_out_blocks": "1736", "process_user_time": 2.212713}
[0m15:00:26.827688 [debug] [MainThread]: Command `dbt build` succeeded at 15:00:26.827519 after 0.72 seconds
[0m15:00:26.828218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8303bab0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8302d30440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8302dc6570>]}
[0m15:00:26.828834 [debug] [MainThread]: Flushing usage events
[0m15:00:27.765238 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:37.172889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec533a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec533b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec5a3edb0>]}


============================== 15:01:37.178512 | 603f7497-ae25-48c8-b54c-3089712c8e72 ==============================
[0m15:01:37.178512 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:01:37.179398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:01:37.369296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '603f7497-ae25-48c8-b54c-3089712c8e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec5acacc0>]}
[0m15:01:37.438576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '603f7497-ae25-48c8-b54c-3089712c8e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec5bb91f0>]}
[0m15:01:37.439524 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:01:37.564962 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:01:37.625271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:01:37.625843 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:01:37.626682 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models
[0m15:01:37.632459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '603f7497-ae25-48c8-b54c-3089712c8e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec48bc860>]}
[0m15:01:37.694668 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:01:37.697062 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:01:37.722886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '603f7497-ae25-48c8-b54c-3089712c8e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec35c38f0>]}
[0m15:01:37.723565 [info ] [MainThread]: Found 433 macros
[0m15:01:37.725843 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:01:37.728339 [debug] [MainThread]: Command end result
[0m15:01:37.761349 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:01:37.763006 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:01:37.767089 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m15:01:37.768367 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.6649259, "process_in_blocks": "5216", "process_kernel_time": 0.227331, "process_mem_max_rss": "107692", "process_out_blocks": "1736", "process_user_time": 2.000981}
[0m15:01:37.768968 [debug] [MainThread]: Command `dbt build` succeeded at 15:01:37.768807 after 0.67 seconds
[0m15:01:37.769525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec5a3edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec491a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec5a930b0>]}
[0m15:01:37.770075 [debug] [MainThread]: Flushing usage events
[0m15:01:38.799439 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:42.500082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabe961e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabf1cfda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabe963ec0>]}


============================== 13:21:42.505467 | f4eaceaf-f301-4d4a-8f64-bf1a454d66d4 ==============================
[0m13:21:42.505467 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:21:42.506305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m13:21:42.718443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4eaceaf-f301-4d4a-8f64-bf1a454d66d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabede6300>]}
[0m13:21:42.800167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4eaceaf-f301-4d4a-8f64-bf1a454d66d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabe58c680>]}
[0m13:21:42.801243 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:21:42.954561 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:21:43.024821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:43.025344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:43.031208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4eaceaf-f301-4d4a-8f64-bf1a454d66d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabdb4b7d0>]}
[0m13:21:43.110313 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:21:43.113393 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:21:43.158138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4eaceaf-f301-4d4a-8f64-bf1a454d66d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabd7004d0>]}
[0m13:21:43.159258 [info ] [MainThread]: Found 433 macros
[0m13:21:43.161423 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:21:43.163690 [debug] [MainThread]: Command end result
[0m13:21:43.196826 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:21:43.198521 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:21:43.202209 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m13:21:43.204338 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.7656624, "process_in_blocks": "65992", "process_kernel_time": 0.333371, "process_mem_max_rss": "107352", "process_out_blocks": "1736", "process_user_time": 2.193067}
[0m13:21:43.204945 [debug] [MainThread]: Command `dbt build` succeeded at 13:21:43.204819 after 0.77 seconds
[0m13:21:43.205490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabeed3b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabdb99eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabc7b55b0>]}
[0m13:21:43.205989 [debug] [MainThread]: Flushing usage events
[0m13:21:43.907307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:23:45.261861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f78e03440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f7b0506e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f78b50b60>]}


============================== 13:23:45.266106 | 91723730-b387-49e7-ad96-2143b8b39464 ==============================
[0m13:23:45.266106 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:23:45.267268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:23:45.399106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91723730-b387-49e7-ad96-2143b8b39464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f7c9bbc50>]}
[0m13:23:45.419988 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2196086, "process_in_blocks": "21544", "process_kernel_time": 0.223245, "process_mem_max_rss": "97164", "process_out_blocks": "144", "process_user_time": 1.703779}
[0m13:23:45.420663 [debug] [MainThread]: Command `dbt clean` succeeded at 13:23:45.420536 after 0.22 seconds
[0m13:23:45.421221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f78ee2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f7c9bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f78b70ad0>]}
[0m13:23:45.421773 [debug] [MainThread]: Flushing usage events
[0m13:23:46.477983 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:23:52.160381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a7008b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4e1a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a50f9e80>]}


============================== 13:23:52.164096 | 1868b1c3-b584-4d89-9c3c-2cbb3f835a57 ==============================
[0m13:23:52.164096 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:23:52.165009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:23:52.186024 [info ] [MainThread]: dbt version: 1.9.3
[0m13:23:52.186759 [info ] [MainThread]: python version: 3.12.9
[0m13:23:52.187507 [info ] [MainThread]: python path: /home/egor/projects/TSM_DWH/venv/bin/python
[0m13:23:52.188245 [info ] [MainThread]: os info: Linux-6.13.7-100.fc40.x86_64-x86_64-with-glibc2.39
[0m13:23:52.269160 [info ] [MainThread]: Using profiles dir at /home/egor/.dbt
[0m13:23:52.269881 [info ] [MainThread]: Using profiles.yml file at /home/egor/.dbt/profiles.yml
[0m13:23:52.270514 [info ] [MainThread]: Using dbt_project.yml file at /home/egor/projects/TSM_DWH/dbt_project.yml
[0m13:23:52.271368 [info ] [MainThread]: adapter type: postgres
[0m13:23:52.271889 [info ] [MainThread]: adapter version: 1.9.0
[0m13:23:52.387787 [info ] [MainThread]: Configuration:
[0m13:23:52.388514 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:23:52.389131 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:23:52.389724 [info ] [MainThread]: Required dependencies:
[0m13:23:52.390426 [debug] [MainThread]: Executing "git --help"
[0m13:23:52.392947 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:23:52.393714 [debug] [MainThread]: STDERR: "b''"
[0m13:23:52.394525 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:23:52.395394 [info ] [MainThread]: Connection:
[0m13:23:52.396367 [info ] [MainThread]:   host: 127.0.0.1
[0m13:23:52.397200 [info ] [MainThread]:   port: 5432
[0m13:23:52.397953 [info ] [MainThread]:   user: postgres
[0m13:23:52.398710 [info ] [MainThread]:   database: postgres
[0m13:23:52.399589 [info ] [MainThread]:   schema: public
[0m13:23:52.400536 [info ] [MainThread]:   connect_timeout: 10
[0m13:23:52.401641 [info ] [MainThread]:   role: None
[0m13:23:52.402666 [info ] [MainThread]:   search_path: None
[0m13:23:52.403774 [info ] [MainThread]:   keepalives_idle: 0
[0m13:23:52.404953 [info ] [MainThread]:   sslmode: None
[0m13:23:52.406038 [info ] [MainThread]:   sslcert: None
[0m13:23:52.407215 [info ] [MainThread]:   sslkey: None
[0m13:23:52.408132 [info ] [MainThread]:   sslrootcert: None
[0m13:23:52.409059 [info ] [MainThread]:   application_name: dbt
[0m13:23:52.410007 [info ] [MainThread]:   retries: 1
[0m13:23:52.411135 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:23:52.540525 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:23:52.570959 [debug] [MainThread]: Using postgres connection "debug"
[0m13:23:52.571540 [debug] [MainThread]: On debug: select 1 as id
[0m13:23:52.572015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:23:52.587533 [debug] [MainThread]: SQL status: SELECT 1 in 0.015 seconds
[0m13:23:52.589190 [debug] [MainThread]: On debug: Close
[0m13:23:52.589760 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:23:52.590944 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:23:52.592286 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4910602, "process_in_blocks": "1576", "process_kernel_time": 0.229584, "process_mem_max_rss": "109340", "process_out_blocks": "16", "process_user_time": 1.77595}
[0m13:23:52.592967 [debug] [MainThread]: Command `dbt debug` succeeded at 13:23:52.592783 after 0.49 seconds
[0m13:23:52.593537 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:23:52.594084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4d395e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4cc48f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a35f8ad0>]}
[0m13:23:52.594682 [debug] [MainThread]: Flushing usage events
[0m13:23:53.440356 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:24:00.607956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f604540b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6074f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6074f830>]}


============================== 13:24:00.611810 | 7b91b304-cec1-4663-a6d9-282455bbc9b6 ==============================
[0m13:24:00.611810 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:24:00.613118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/egor/.dbt', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt list', 'send_anonymous_usage_stats': 'True'}
[0m13:24:00.797615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b91b304-cec1-4663-a6d9-282455bbc9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f60edff50>]}
[0m13:24:00.866444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b91b304-cec1-4663-a6d9-282455bbc9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f609ba780>]}
[0m13:24:00.867481 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:24:00.995218 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:24:00.996118 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:24:00.996775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7b91b304-cec1-4663-a6d9-282455bbc9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6077d790>]}
[0m13:24:01.803083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b91b304-cec1-4663-a6d9-282455bbc9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f603fa2a0>]}
[0m13:24:01.843913 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:24:01.846395 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:24:01.859659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b91b304-cec1-4663-a6d9-282455bbc9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f5f3677d0>]}
[0m13:24:01.860543 [warn ] [MainThread]: No nodes selected!
[0m13:24:01.861759 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.3104166, "process_in_blocks": "360", "process_kernel_time": 0.226335, "process_mem_max_rss": "105504", "process_out_blocks": "1656", "process_user_time": 2.628581}
[0m13:24:01.862405 [debug] [MainThread]: Command `dbt list` succeeded at 13:24:01.862243 after 1.31 seconds
[0m13:24:01.862903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f604540b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f61cfd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f60d3ed50>]}
[0m13:24:01.863471 [debug] [MainThread]: Flushing usage events
[0m13:24:02.759734 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:24:15.655469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc354ab1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc356cbbb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3546913a0>]}


============================== 13:24:15.659338 | 3b8ec4b6-72a2-4a8b-a570-e5062f7028e9 ==============================
[0m13:24:15.659338 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:24:15.660309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m13:24:15.858397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b8ec4b6-72a2-4a8b-a570-e5062f7028e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc354f9ff80>]}
[0m13:24:15.927125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b8ec4b6-72a2-4a8b-a570-e5062f7028e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3569624b0>]}
[0m13:24:15.928102 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:24:16.047691 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:24:16.108544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:24:16.109072 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:24:16.114947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b8ec4b6-72a2-4a8b-a570-e5062f7028e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc353dbaa80>]}
[0m13:24:16.166288 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:24:16.168696 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:24:16.181284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b8ec4b6-72a2-4a8b-a570-e5062f7028e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc355d3b320>]}
[0m13:24:16.181946 [info ] [MainThread]: Found 433 macros
[0m13:24:16.182537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b8ec4b6-72a2-4a8b-a570-e5062f7028e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc353520e90>]}
[0m13:24:16.184290 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:24:16.186498 [debug] [MainThread]: Command end result
[0m13:24:16.219579 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:24:16.221409 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:24:16.225020 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m13:24:16.226192 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.628353, "process_in_blocks": "24", "process_kernel_time": 0.20496, "process_mem_max_rss": "105712", "process_out_blocks": "1648", "process_user_time": 1.968162}
[0m13:24:16.226790 [debug] [MainThread]: Command `dbt compile` succeeded at 13:24:16.226662 after 0.63 seconds
[0m13:24:16.227292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3547bb440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc354ffae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc354ffb380>]}
[0m13:24:16.227803 [debug] [MainThread]: Flushing usage events
[0m13:24:16.953102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:24:22.800341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6ae4a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6ae49340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6a7a57f0>]}


============================== 13:24:22.804589 | 4fca89c0-69f4-48ed-9f7a-3cea7dbda313 ==============================
[0m13:24:22.804589 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:24:22.805401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/egor/.dbt', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt list', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:24:22.988733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fca89c0-69f4-48ed-9f7a-3cea7dbda313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6aed8140>]}
[0m13:24:23.055639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fca89c0-69f4-48ed-9f7a-3cea7dbda313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6acdbad0>]}
[0m13:24:23.056650 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:24:23.175886 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:24:23.235077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:24:23.235594 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:24:23.241975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fca89c0-69f4-48ed-9f7a-3cea7dbda313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd69f85e80>]}
[0m13:24:23.293079 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:24:23.295659 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:24:23.307103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fca89c0-69f4-48ed-9f7a-3cea7dbda313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6973f2f0>]}
[0m13:24:23.307988 [warn ] [MainThread]: No nodes selected!
[0m13:24:23.309317 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.5662237, "process_in_blocks": "0", "process_kernel_time": 0.188126, "process_mem_max_rss": "105420", "process_out_blocks": "840", "process_user_time": 1.913242}
[0m13:24:23.309894 [debug] [MainThread]: Command `dbt list` succeeded at 13:24:23.309756 after 0.57 seconds
[0m13:24:23.310426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6a8a4cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6a471040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6a472cf0>]}
[0m13:24:23.310914 [debug] [MainThread]: Flushing usage events
[0m13:24:24.160536 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:08.065353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4340b2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4349d9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4349dae10>]}


============================== 13:26:08.069130 | c24d46c7-5815-481c-8779-6d9f674337aa ==============================
[0m13:26:08.069130 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:26:08.070007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt list', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:26:08.252901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c24d46c7-5815-481c-8779-6d9f674337aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4349dbf80>]}
[0m13:26:08.319962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c24d46c7-5815-481c-8779-6d9f674337aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4342918e0>]}
[0m13:26:08.320982 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:26:08.455724 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:26:08.518105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:26:08.518622 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:26:08.519458 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dwh.stg
[0m13:26:08.525403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c24d46c7-5815-481c-8779-6d9f674337aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa434dbeea0>]}
[0m13:26:08.588289 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:26:08.590987 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:26:08.601539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c24d46c7-5815-481c-8779-6d9f674337aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa432f6d1c0>]}
[0m13:26:08.602755 [warn ] [MainThread]: No nodes selected!
[0m13:26:08.604243 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.59719795, "process_in_blocks": "1384", "process_kernel_time": 0.203827, "process_mem_max_rss": "105240", "process_out_blocks": "848", "process_user_time": 1.994807}
[0m13:26:08.604991 [debug] [MainThread]: Command `dbt list` succeeded at 13:26:08.604846 after 0.60 seconds
[0m13:26:08.605559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa434975dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4343883e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4343896a0>]}
[0m13:26:08.606172 [debug] [MainThread]: Flushing usage events
[0m13:26:09.429036 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:25.938562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b3089a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b53fffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b373aff0>]}


============================== 13:26:25.943048 | 19d3992f-0627-4e05-9daa-d8ea0578f562 ==============================
[0m13:26:25.943048 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:26:25.944267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt list', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:26:26.127448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19d3992f-0627-4e05-9daa-d8ea0578f562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b38d9a90>]}
[0m13:26:26.198928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19d3992f-0627-4e05-9daa-d8ea0578f562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b52798b0>]}
[0m13:26:26.199998 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:26:26.321803 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:26:26.381028 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:26:26.381550 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:26:26.382417 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stg
[0m13:26:26.388488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19d3992f-0627-4e05-9daa-d8ea0578f562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b27d4620>]}
[0m13:26:26.450489 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:26:26.452971 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:26:26.463640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19d3992f-0627-4e05-9daa-d8ea0578f562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b26f87d0>]}
[0m13:26:26.464601 [warn ] [MainThread]: No nodes selected!
[0m13:26:26.465735 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.5887456, "process_in_blocks": "0", "process_kernel_time": 0.21783, "process_mem_max_rss": "105208", "process_out_blocks": "840", "process_user_time": 2.082377}
[0m13:26:26.466346 [debug] [MainThread]: Command `dbt list` succeeded at 13:26:26.466219 after 0.59 seconds
[0m13:26:26.466853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b1f50440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b2df4ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b31492b0>]}
[0m13:26:26.467401 [debug] [MainThread]: Flushing usage events
[0m13:26:27.247013 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:40.838266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d41f3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d3830b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d5cd8410>]}


============================== 13:27:40.842142 | af3969a9-3f44-4598-827a-6d5b83c18591 ==============================
[0m13:27:40.842142 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:27:40.843221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m13:27:41.032776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af3969a9-3f44-4598-827a-6d5b83c18591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d2f30320>]}
[0m13:27:41.099938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af3969a9-3f44-4598-827a-6d5b83c18591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d2f578c0>]}
[0m13:27:41.100969 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:27:41.264818 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:27:41.344833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:27:41.345329 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:27:41.346134 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dwh
[0m13:27:41.352355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af3969a9-3f44-4598-827a-6d5b83c18591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d2f301a0>]}
[0m13:27:41.415095 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:27:41.417576 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:27:41.429582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af3969a9-3f44-4598-827a-6d5b83c18591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d2b298e0>]}
[0m13:27:41.430213 [info ] [MainThread]: Found 433 macros
[0m13:27:41.430888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af3969a9-3f44-4598-827a-6d5b83c18591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d27728d0>]}
[0m13:27:41.432696 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:27:41.434882 [debug] [MainThread]: Command end result
[0m13:27:41.469468 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:27:41.471569 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:27:41.475250 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m13:27:41.476375 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.6955867, "process_in_blocks": "0", "process_kernel_time": 0.214587, "process_mem_max_rss": "105724", "process_out_blocks": "1672", "process_user_time": 2.052575}
[0m13:27:41.476968 [debug] [MainThread]: Command `dbt compile` succeeded at 13:27:41.476839 after 0.70 seconds
[0m13:27:41.477528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d390b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d2f560c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d2f766c0>]}
[0m13:27:41.478064 [debug] [MainThread]: Flushing usage events
[0m13:27:42.203449 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:12.506530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a3e00cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a37bc0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a3e02270>]}


============================== 13:34:12.512243 | c24b9e2b-355b-41c7-b7ad-ba162d31195a ==============================
[0m13:34:12.512243 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:34:12.513312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:34:12.712487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c24b9e2b-355b-41c7-b7ad-ba162d31195a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a38436b0>]}
[0m13:34:12.733729 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.28819168, "process_in_blocks": "51928", "process_kernel_time": 0.277124, "process_mem_max_rss": "96960", "process_out_blocks": "112", "process_user_time": 1.854209}
[0m13:34:12.734391 [debug] [MainThread]: Command `dbt clean` succeeded at 13:34:12.734245 after 0.29 seconds
[0m13:34:12.734908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a3777a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a5ac83e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a345b7a0>]}
[0m13:34:12.735422 [debug] [MainThread]: Flushing usage events
[0m13:34:13.782712 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:26.173388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7bcaa600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7bf7fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7bf7d220>]}


============================== 13:34:26.177045 | f92a6545-7ab6-4c79-950d-f35fe76c56b5 ==============================
[0m13:34:26.177045 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:34:26.177992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt list', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:34:26.383062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f92a6545-7ab6-4c79-950d-f35fe76c56b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7bfd3e00>]}
[0m13:34:26.451581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f92a6545-7ab6-4c79-950d-f35fe76c56b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7bbe5670>]}
[0m13:34:26.452589 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:34:26.607315 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:34:26.608145 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:34:26.608764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f92a6545-7ab6-4c79-950d-f35fe76c56b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7adf0ef0>]}
[0m13:34:27.396922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f92a6545-7ab6-4c79-950d-f35fe76c56b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc79d2f560>]}
[0m13:34:27.439190 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:34:27.441609 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:34:27.457684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f92a6545-7ab6-4c79-950d-f35fe76c56b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7a588530>]}
[0m13:34:27.458577 [warn ] [MainThread]: No nodes selected!
[0m13:34:27.459752 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.3455738, "process_in_blocks": "9160", "process_kernel_time": 0.213884, "process_mem_max_rss": "105480", "process_out_blocks": "1704", "process_user_time": 2.664903}
[0m13:34:27.460400 [debug] [MainThread]: Command `dbt list` succeeded at 13:34:27.460233 after 1.35 seconds
[0m13:34:27.460959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7bfd0b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7a5f6960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7f5bbc50>]}
[0m13:34:27.461687 [debug] [MainThread]: Flushing usage events
[0m13:34:28.324446 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:35.759831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3399e5b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3399d68f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3399e5b6e0>]}


============================== 13:34:35.763686 | 8a227833-36a8-4be5-a2dd-4afd2f40a43e ==============================
[0m13:34:35.763686 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:34:35.764609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:34:35.955460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a227833-36a8-4be5-a2dd-4afd2f40a43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3399328320>]}
[0m13:34:36.024304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a227833-36a8-4be5-a2dd-4afd2f40a43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f339a18b830>]}
[0m13:34:36.025354 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:34:36.157033 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:34:36.216233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:34:36.216745 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:34:36.222428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a227833-36a8-4be5-a2dd-4afd2f40a43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f339939de80>]}
[0m13:34:36.274990 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:34:36.277800 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:34:36.291102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a227833-36a8-4be5-a2dd-4afd2f40a43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33983d4b00>]}
[0m13:34:36.291815 [info ] [MainThread]: Found 433 macros
[0m13:34:36.292496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a227833-36a8-4be5-a2dd-4afd2f40a43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f339939e7e0>]}
[0m13:34:36.294348 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:34:36.296669 [debug] [MainThread]: Command end result
[0m13:34:36.332387 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:34:36.334827 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:34:36.338499 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m13:34:36.340398 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.63800305, "process_in_blocks": "7824", "process_kernel_time": 0.228434, "process_mem_max_rss": "105480", "process_out_blocks": "1736", "process_user_time": 1.984186}
[0m13:34:36.341020 [debug] [MainThread]: Command `dbt compile` succeeded at 13:34:36.340873 after 0.64 seconds
[0m13:34:36.341583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3399e5b6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33993f8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3398b69100>]}
[0m13:34:36.342089 [debug] [MainThread]: Flushing usage events
[0m13:34:37.038700 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:25.264618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e58025910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e59b4c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e58026060>]}


============================== 13:36:25.268452 | f6d55630-f7c7-4da9-886f-d83e7d42e940 ==============================
[0m13:36:25.268452 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:36:25.269385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m13:36:25.451431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6d55630-f7c7-4da9-886f-d83e7d42e940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e580b3f50>]}
[0m13:36:25.518351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6d55630-f7c7-4da9-886f-d83e7d42e940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e57126510>]}
[0m13:36:25.519599 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:36:25.642590 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:36:25.706330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:36:25.706841 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:36:25.712671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6d55630-f7c7-4da9-886f-d83e7d42e940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e571e11c0>]}
[0m13:36:25.761784 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:36:25.764349 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:36:25.800708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6d55630-f7c7-4da9-886f-d83e7d42e940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e5659c0e0>]}
[0m13:36:25.801349 [info ] [MainThread]: Found 433 macros
[0m13:36:25.803453 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:36:25.805678 [debug] [MainThread]: Command end result
[0m13:36:25.837490 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:36:25.839386 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:36:25.843277 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m13:36:25.844471 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.6412807, "process_in_blocks": "9152", "process_kernel_time": 0.223425, "process_mem_max_rss": "107440", "process_out_blocks": "1672", "process_user_time": 1.988765}
[0m13:36:25.845178 [debug] [MainThread]: Command `dbt build` succeeded at 13:36:25.845001 after 0.64 seconds
[0m13:36:25.845708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e59b4c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e580b2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e580b0e90>]}
[0m13:36:25.846249 [debug] [MainThread]: Flushing usage events
[0m13:36:26.801607 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:47.318145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3be93c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3bc8c4da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3bcac33b0>]}


============================== 13:36:47.322420 | cf651dca-cef7-4cfd-b5c9-286f053df877 ==============================
[0m13:36:47.322420 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:36:47.323364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:36:47.345503 [info ] [MainThread]: dbt version: 1.9.3
[0m13:36:47.346413 [info ] [MainThread]: python version: 3.12.9
[0m13:36:47.347227 [info ] [MainThread]: python path: /home/egor/projects/TSM_DWH/venv/bin/python
[0m13:36:47.348330 [info ] [MainThread]: os info: Linux-6.13.7-100.fc40.x86_64-x86_64-with-glibc2.39
[0m13:36:47.416000 [info ] [MainThread]: Using profiles dir at /home/egor/.dbt
[0m13:36:47.416645 [info ] [MainThread]: Using profiles.yml file at /home/egor/.dbt/profiles.yml
[0m13:36:47.417165 [info ] [MainThread]: Using dbt_project.yml file at /home/egor/projects/TSM_DWH/dbt_project.yml
[0m13:36:47.417887 [info ] [MainThread]: adapter type: postgres
[0m13:36:47.418371 [info ] [MainThread]: adapter version: 1.9.0
[0m13:36:47.537547 [info ] [MainThread]: Configuration:
[0m13:36:47.538280 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:36:47.538950 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:36:47.539623 [info ] [MainThread]: Required dependencies:
[0m13:36:47.540350 [debug] [MainThread]: Executing "git --help"
[0m13:36:47.542879 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:36:47.543686 [debug] [MainThread]: STDERR: "b''"
[0m13:36:47.544673 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:36:47.545700 [info ] [MainThread]: Connection:
[0m13:36:47.546738 [info ] [MainThread]:   host: 127.0.0.1
[0m13:36:47.547694 [info ] [MainThread]:   port: 5432
[0m13:36:47.548627 [info ] [MainThread]:   user: postgres
[0m13:36:47.549502 [info ] [MainThread]:   database: postgres
[0m13:36:47.550361 [info ] [MainThread]:   schema: public
[0m13:36:47.551368 [info ] [MainThread]:   connect_timeout: 10
[0m13:36:47.552403 [info ] [MainThread]:   role: None
[0m13:36:47.553578 [info ] [MainThread]:   search_path: None
[0m13:36:47.554848 [info ] [MainThread]:   keepalives_idle: 0
[0m13:36:47.555641 [info ] [MainThread]:   sslmode: None
[0m13:36:47.556296 [info ] [MainThread]:   sslcert: None
[0m13:36:47.556829 [info ] [MainThread]:   sslkey: None
[0m13:36:47.557605 [info ] [MainThread]:   sslrootcert: None
[0m13:36:47.558524 [info ] [MainThread]:   application_name: dbt
[0m13:36:47.559390 [info ] [MainThread]:   retries: 1
[0m13:36:47.560444 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:36:47.678408 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:36:47.739009 [debug] [MainThread]: Using postgres connection "debug"
[0m13:36:47.739620 [debug] [MainThread]: On debug: select 1 as id
[0m13:36:47.740086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:36:47.770875 [debug] [MainThread]: SQL status: SELECT 1 in 0.031 seconds
[0m13:36:47.772097 [debug] [MainThread]: On debug: Close
[0m13:36:47.772657 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:36:47.773296 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:36:47.774491 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.515724, "process_in_blocks": "2912", "process_kernel_time": 0.206429, "process_mem_max_rss": "109292", "process_out_blocks": "24", "process_user_time": 1.827276}
[0m13:36:47.775215 [debug] [MainThread]: Command `dbt debug` succeeded at 13:36:47.775014 after 0.52 seconds
[0m13:36:47.775680 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:36:47.776193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3bcf95250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3bc2efd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3bcea0aa0>]}
[0m13:36:47.776755 [debug] [MainThread]: Flushing usage events
[0m13:36:48.569010 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:03.748425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc6d4b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc8f8c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc6d4b800>]}


============================== 13:39:03.752181 | 9a1a493c-570c-4854-9a9e-ace6b4b256c1 ==============================
[0m13:39:03.752181 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:39:03.753323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:39:03.941894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a1a493c-570c-4854-9a9e-ace6b4b256c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc74f8200>]}
[0m13:39:04.011713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a1a493c-570c-4854-9a9e-ace6b4b256c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc6a17380>]}
[0m13:39:04.012745 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:39:04.140726 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m13:39:04.185363 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:39:04.186066 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m13:39:04.186789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9a1a493c-570c-4854-9a9e-ace6b4b256c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc59414f0>]}
[0m13:39:05.009769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a1a493c-570c-4854-9a9e-ace6b4b256c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc5942390>]}
[0m13:39:05.058990 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:39:05.062335 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:39:05.075340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a1a493c-570c-4854-9a9e-ace6b4b256c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc5d845c0>]}
[0m13:39:05.075974 [info ] [MainThread]: Found 433 macros
[0m13:39:05.076854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a1a493c-570c-4854-9a9e-ace6b4b256c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc5980b00>]}
[0m13:39:05.078048 [warn ] [MainThread]: The selection criterion 'stg' does not match any enabled nodes
[0m13:39:05.080311 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:39:05.081345 [debug] [MainThread]: Command end result
[0m13:39:05.118443 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:39:05.120262 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:39:05.123829 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m13:39:05.124951 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4347928, "process_in_blocks": "72", "process_kernel_time": 0.240631, "process_mem_max_rss": "106028", "process_out_blocks": "2528", "process_user_time": 2.99393}
[0m13:39:05.125586 [debug] [MainThread]: Command `cli run` succeeded at 13:39:05.125454 after 1.44 seconds
[0m13:39:05.126092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc6c7c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc6ff9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc59b37a0>]}
[0m13:39:05.126723 [debug] [MainThread]: Flushing usage events
[0m13:39:06.137188 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:41.918530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62e1205dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62e11940e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62df10eb70>]}


============================== 13:39:41.922224 | 5ed9fc8f-53ba-4e8b-8c23-9e183a4bfd17 ==============================
[0m13:39:41.922224 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:39:41.923233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt parse', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:39:42.104363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ed9fc8f-53ba-4e8b-8c23-9e183a4bfd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62df6f60f0>]}
[0m13:39:42.170468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ed9fc8f-53ba-4e8b-8c23-9e183a4bfd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62deae0860>]}
[0m13:39:42.171529 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:39:42.299214 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:39:42.344931 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:39:42.345649 [debug] [MainThread]: previous checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, current checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23
[0m13:39:42.346196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ed9fc8f-53ba-4e8b-8c23-9e183a4bfd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62def3ecc0>]}
[0m13:39:43.135273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ed9fc8f-53ba-4e8b-8c23-9e183a4bfd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ddd87d70>]}
[0m13:39:43.139965 [info ] [MainThread]: Performance info: /home/egor/projects/TSM_DWH/target/perf_info.json
[0m13:39:43.201470 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:39:43.204709 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:39:43.206078 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 1.3475802, "process_in_blocks": "0", "process_kernel_time": 0.183959, "process_mem_max_rss": "105280", "process_out_blocks": "1656", "process_user_time": 2.706665}
[0m13:39:43.206723 [debug] [MainThread]: Command `dbt parse` succeeded at 13:39:43.206594 after 1.35 seconds
[0m13:39:43.207310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62e2bbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62dec999d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ddda2210>]}
[0m13:39:43.207846 [debug] [MainThread]: Flushing usage events
[0m13:39:43.844600 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:08.877401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29c0bd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29bd787a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29bb27cb0>]}


============================== 13:41:08.881135 | e322ed2e-9f5f-4aa8-a2cc-e1fc0a92572c ==============================
[0m13:41:08.881135 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:41:08.882090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:41:17.485419 [debug] [MainThread]: Starter project path: /home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/include/starter_project
[0m13:41:17.488818 [info ] [MainThread]: 
Your new dbt project "tsm_dwh" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m13:41:17.489437 [info ] [MainThread]: Setting up your profile.
[0m13:42:02.874915 [info ] [MainThread]: Profile tsm_dwh written to /home/egor/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m13:42:02.876472 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 54.05607, "process_in_blocks": "152", "process_kernel_time": 0.147331, "process_mem_max_rss": "98528", "process_out_blocks": "280", "process_user_time": 1.579614}
[0m13:42:02.877446 [debug] [MainThread]: Command `dbt init` succeeded at 13:42:02.877206 after 54.06 seconds
[0m13:42:02.878511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29bbc3440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29b74acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29c3e4dd0>]}
[0m13:42:02.879588 [debug] [MainThread]: Flushing usage events
[0m13:42:03.700119 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:42:55.177100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff94e34140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff95261550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff95263b00>]}


============================== 13:42:55.180878 | 2e390459-48e6-4b7a-9f71-9a5d577d2eed ==============================
[0m13:42:55.180878 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:42:55.181718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'version_check': 'True', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt list', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:42:55.182434 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /home/egor/projects/TSM_DWH/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m13:42:55.183638 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": false, "command_wall_clock_time": 0.06828066, "process_in_blocks": "0", "process_kernel_time": 0.140197, "process_mem_max_rss": "93384", "process_out_blocks": "16", "process_user_time": 1.500763}
[0m13:42:55.184258 [debug] [MainThread]: Command `dbt list` failed at 13:42:55.184089 after 0.07 seconds
[0m13:42:55.184781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff94f68140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff95ae3c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff98a4f0b0>]}
[0m13:42:55.185323 [debug] [MainThread]: Flushing usage events
[0m13:42:56.129765 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:48.459061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066f430bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066db26de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066d7a2600>]}


============================== 13:49:48.466039 | 0d38de5d-5b1f-433d-b023-adfb293547c3 ==============================
[0m13:49:48.466039 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:49:48.467045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:49:48.467879 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /home/egor/projects/TSM_DWH/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m13:49:48.469131 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": false, "command_wall_clock_time": 0.068632185, "process_in_blocks": "72", "process_kernel_time": 0.123364, "process_mem_max_rss": "93656", "process_out_blocks": "8", "process_user_time": 1.52341}
[0m13:49:48.469798 [debug] [MainThread]: Command `dbt clean` failed at 13:49:48.469663 after 0.07 seconds
[0m13:49:48.470331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066d0b6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066db26de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066dac8f80>]}
[0m13:49:48.470855 [debug] [MainThread]: Flushing usage events
[0m13:49:49.435549 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:49.114288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11f092690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11edf9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11e7998b0>]}


============================== 13:50:49.118858 | 5a22682b-e288-487e-ba5d-a7206b13edbe ==============================
[0m13:50:49.118858 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:50:49.119971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:50:49.251130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a22682b-e288-487e-ba5d-a7206b13edbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11e286de0>]}
[0m13:50:49.272373 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:50:49.273524 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:50:49.275322 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.22705263, "process_in_blocks": "128", "process_kernel_time": 0.167645, "process_mem_max_rss": "97400", "process_out_blocks": "8", "process_user_time": 1.713328}
[0m13:50:49.275931 [debug] [MainThread]: Command `cli deps` succeeded at 13:50:49.275809 after 0.23 seconds
[0m13:50:49.276395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1223ff380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11e1018b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11e101340>]}
[0m13:50:49.276875 [debug] [MainThread]: Flushing usage events
[0m13:50:50.244100 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:50.662248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613de698e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613f4210a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613fa0f170>]}


============================== 13:50:50.666563 | f8f7b3bc-0296-4959-b307-43e20776dcfa ==============================
[0m13:50:50.666563 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:50:50.667631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt list', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:50:50.865423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8f7b3bc-0296-4959-b307-43e20776dcfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613dfded80>]}
[0m13:50:50.943922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8f7b3bc-0296-4959-b307-43e20776dcfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613de3f050>]}
[0m13:50:50.944893 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:50:51.066592 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:50:51.157566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:51.158047 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:51.186965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8f7b3bc-0296-4959-b307-43e20776dcfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613c91a9c0>]}
[0m13:50:51.261682 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:50:51.264446 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:50:51.277743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8f7b3bc-0296-4959-b307-43e20776dcfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613df7a630>]}
[0m13:50:51.279029 [info ] [MainThread]: tsm_dwh.dv.dv_hub_fact_journal
[0m13:50:51.279642 [info ] [MainThread]: tsm_dwh.dv.dv_hub_fact_work
[0m13:50:51.280289 [info ] [MainThread]: tsm_dwh.dv.dv_hub_tech
[0m13:50:51.280854 [info ] [MainThread]: tsm_dwh.dv.dv_lnk_fact_journal_fact_work
[0m13:50:51.281347 [info ] [MainThread]: tsm_dwh.dv.dv_lnk_fact_work_tech
[0m13:50:51.281813 [info ] [MainThread]: tsm_dwh.dv.dv_msat_fact_materials
[0m13:50:51.282284 [info ] [MainThread]: tsm_dwh.dv.dv_msat_fact_pikets
[0m13:50:51.282769 [info ] [MainThread]: tsm_dwh.dv.dv_msat_norm_workload
[0m13:50:51.283275 [info ] [MainThread]: tsm_dwh.dv.dv_sat_fact_journal
[0m13:50:51.283759 [info ] [MainThread]: tsm_dwh.dv.dv_sat_fact_tech
[0m13:50:51.284243 [info ] [MainThread]: tsm_dwh.dv.dv_sat_fact_work
[0m13:50:51.284747 [info ] [MainThread]: tsm_dwh.stage.stg_1c_journal
[0m13:50:51.285512 [info ] [MainThread]: tsm_dwh.stage.stg_1c_materials
[0m13:50:51.286507 [info ] [MainThread]: tsm_dwh.stage.stg_1c_norm_workload
[0m13:50:51.287332 [info ] [MainThread]: tsm_dwh.stage.stg_1c_pikets
[0m13:50:51.288249 [info ] [MainThread]: tsm_dwh.stage.stg_1c_tech
[0m13:50:51.289075 [info ] [MainThread]: tsm_dwh.stage.stg_1c_works
[0m13:50:51.290809 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.69434863, "process_in_blocks": "0", "process_kernel_time": 0.204793, "process_mem_max_rss": "105904", "process_out_blocks": "1160", "process_user_time": 2.166456}
[0m13:50:51.291982 [debug] [MainThread]: Command `dbt list` succeeded at 13:50:51.291730 after 0.70 seconds
[0m13:50:51.293044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613d84f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613c9197f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613c91a7b0>]}
[0m13:50:51.293735 [debug] [MainThread]: Flushing usage events
[0m13:50:52.087521 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:58.683068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65e9fef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65d78dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65ce5a600>]}


============================== 13:50:58.686946 | 06ea169f-0c05-479c-b02a-559fbd4fb60e ==============================
[0m13:50:58.686946 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:50:58.687921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/egor/.dbt', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:50:59.011297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06ea169f-0c05-479c-b02a-559fbd4fb60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65d0c3e30>]}
[0m13:50:59.088954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06ea169f-0c05-479c-b02a-559fbd4fb60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65c155520>]}
[0m13:50:59.090143 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:50:59.228875 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:50:59.317465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:59.318052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:59.348341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06ea169f-0c05-479c-b02a-559fbd4fb60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65c1b09b0>]}
[0m13:50:59.424746 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:50:59.427424 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:50:59.441557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06ea169f-0c05-479c-b02a-559fbd4fb60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65b5f3fb0>]}
[0m13:50:59.442450 [info ] [MainThread]: Found 17 models, 433 macros
[0m13:50:59.443013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06ea169f-0c05-479c-b02a-559fbd4fb60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65bd014f0>]}
[0m13:50:59.445638 [info ] [MainThread]: 
[0m13:50:59.446198 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:50:59.446784 [info ] [MainThread]: 
[0m13:50:59.447682 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:50:59.460542 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m13:50:59.581130 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m13:50:59.582277 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m13:50:59.583212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:59.617626 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m13:50:59.618229 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m13:50:59.619189 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:50:59.622560 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m13:50:59.624221 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m13:50:59.624820 [debug] [ThreadPool]: On list_postgres_public: Close
[0m13:50:59.631302 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:59.631816 [debug] [MainThread]: On master: BEGIN
[0m13:50:59.632353 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:59.640963 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:50:59.641534 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:59.642264 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:50:59.646327 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m13:50:59.647825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06ea169f-0c05-479c-b02a-559fbd4fb60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65c1b22a0>]}
[0m13:50:59.648455 [debug] [MainThread]: On master: ROLLBACK
[0m13:50:59.649073 [debug] [MainThread]: On master: Close
[0m13:50:59.652800 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m13:50:59.653727 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m13:50:59.654713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.dv_hub_fact_journal)
[0m13:50:59.655565 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m13:50:59.656351 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m13:50:59.657082 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_hub_fact_work'
[0m13:50:59.658036 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m13:50:59.658860 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_hub_tech'
[0m13:50:59.659639 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work'
[0m13:50:59.660244 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m13:50:59.666051 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m13:50:59.671762 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m13:50:59.671301 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m13:50:59.673924 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m13:50:59.675951 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m13:50:59.678020 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m13:50:59.679925 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m13:50:59.681029 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m13:50:59.682007 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m13:50:59.683072 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m13:50:59.683609 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m13:50:59.684586 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m13:50:59.685496 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m13:50:59.686059 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m13:50:59.687226 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m13:50:59.687878 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_msat_fact_materials
[0m13:50:59.688501 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_msat_fact_pikets
[0m13:50:59.689293 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_fact_work, now model.tsm_dwh.dv_lnk_fact_work_tech)
[0m13:50:59.690124 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_msat_norm_workload
[0m13:50:59.690876 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_tech, now model.tsm_dwh.dv_msat_fact_materials)
[0m13:50:59.691581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_fact_journal, now model.tsm_dwh.dv_msat_fact_pikets)
[0m13:50:59.692229 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_work_tech
[0m13:50:59.692904 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_lnk_fact_journal_fact_work, now model.tsm_dwh.dv_msat_norm_workload)
[0m13:50:59.693622 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_msat_fact_materials
[0m13:50:59.694243 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_msat_fact_pikets
[0m13:50:59.696401 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m13:50:59.696919 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_msat_norm_workload
[0m13:50:59.699191 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_materials"
[0m13:50:59.701362 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m13:50:59.703610 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_norm_workload"
[0m13:50:59.705090 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_msat_fact_materials
[0m13:50:59.705761 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_lnk_fact_work_tech
[0m13:50:59.707301 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_msat_fact_materials
[0m13:50:59.707812 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_msat_norm_workload
[0m13:50:59.708364 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_msat_fact_pikets
[0m13:50:59.709600 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m13:50:59.710244 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_sat_fact_journal
[0m13:50:59.711560 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_msat_norm_workload
[0m13:50:59.712949 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_msat_fact_pikets
[0m13:50:59.713649 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_sat_fact_tech
[0m13:50:59.714295 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_materials, now model.tsm_dwh.dv_sat_fact_journal)
[0m13:50:59.714996 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_sat_fact_work
[0m13:50:59.715719 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m13:50:59.716420 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_lnk_fact_work_tech, now model.tsm_dwh.dv_sat_fact_tech)
[0m13:50:59.717050 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_sat_fact_journal
[0m13:50:59.717696 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_norm_workload, now model.tsm_dwh.dv_sat_fact_work)
[0m13:50:59.718425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_pikets, now model.tsm_dwh.stg_1c_journal)
[0m13:50:59.719731 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_sat_fact_tech
[0m13:50:59.722324 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_journal"
[0m13:50:59.722921 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_sat_fact_work
[0m13:50:59.723653 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m13:50:59.725760 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_tech"
[0m13:50:59.727886 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_work"
[0m13:50:59.730204 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m13:50:59.731069 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_sat_fact_journal
[0m13:50:59.732306 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_sat_fact_tech
[0m13:50:59.732973 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_sat_fact_work
[0m13:50:59.734328 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_sat_fact_journal
[0m13:50:59.735369 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_sat_fact_tech
[0m13:50:59.736043 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m13:50:59.736833 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_sat_fact_work
[0m13:50:59.737395 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_materials
[0m13:50:59.738101 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_norm_workload
[0m13:50:59.739032 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m13:50:59.739627 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_pikets
[0m13:50:59.740333 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_journal, now model.tsm_dwh.stg_1c_materials)
[0m13:50:59.740969 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_tech, now model.tsm_dwh.stg_1c_norm_workload)
[0m13:50:59.741668 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m13:50:59.742327 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_work, now model.tsm_dwh.stg_1c_pikets)
[0m13:50:59.742879 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_materials
[0m13:50:59.743504 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_norm_workload
[0m13:50:59.744239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_journal, now model.tsm_dwh.stg_1c_tech)
[0m13:50:59.745230 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_pikets
[0m13:50:59.747698 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_materials"
[0m13:50:59.749766 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_norm_workload"
[0m13:50:59.750452 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m13:50:59.754015 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_pikets"
[0m13:50:59.758460 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m13:50:59.759697 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_norm_workload
[0m13:50:59.760436 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_materials
[0m13:50:59.761544 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_norm_workload
[0m13:50:59.762314 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m13:50:59.763518 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_materials
[0m13:50:59.764191 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_works
[0m13:50:59.764769 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_pikets
[0m13:50:59.765704 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m13:50:59.766522 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_norm_workload, now model.tsm_dwh.stg_1c_works)
[0m13:50:59.767495 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_pikets
[0m13:50:59.768378 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m13:50:59.771316 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m13:50:59.771968 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m13:50:59.772838 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m13:50:59.774382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:59.774833 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_tech' was properly closed.
[0m13:50:59.775404 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_works' was properly closed.
[0m13:50:59.775824 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_materials' was properly closed.
[0m13:50:59.776404 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_pikets' was properly closed.
[0m13:50:59.779785 [debug] [MainThread]: Command end result
[0m13:50:59.810935 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:50:59.812809 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:50:59.822008 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m13:50:59.823702 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.1980419, "process_in_blocks": "2376", "process_kernel_time": 0.217958, "process_mem_max_rss": "115300", "process_out_blocks": "2784", "process_user_time": 2.411731}
[0m13:50:59.824327 [debug] [MainThread]: Command `dbt compile` succeeded at 13:50:59.824199 after 1.20 seconds
[0m13:50:59.824891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65eb5c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65cc44980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65a59f890>]}
[0m13:50:59.825513 [debug] [MainThread]: Flushing usage events
[0m13:51:00.587680 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:47:59.600742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ab8c50800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ab8f0a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ab89474a0>]}


============================== 16:47:59.608295 | 9e7389ad-fe52-42f7-b0ee-b46c0d50c65e ==============================
[0m16:47:59.608295 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:47:59.609720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:47:59.883386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e7389ad-fe52-42f7-b0ee-b46c0d50c65e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ab85ec5c0>]}
[0m16:47:59.934395 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:47:59.936112 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:47:59.948062 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43814826, "process_in_blocks": "144", "process_kernel_time": 0.233961, "process_mem_max_rss": "97396", "process_out_blocks": "40", "process_user_time": 3.132691}
[0m16:47:59.949256 [debug] [MainThread]: Command `cli deps` succeeded at 16:47:59.949010 after 0.44 seconds
[0m16:47:59.950156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ab8c50800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ab86c3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abc5ff380>]}
[0m16:47:59.953422 [debug] [MainThread]: Flushing usage events
[0m16:48:00.974306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:09:40.040047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9da0439b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d9db81d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9da180d70>]}


============================== 10:09:40.047344 | 7e265022-c842-4953-8b6b-ab97375e0758 ==============================
[0m10:09:40.047344 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:09:40.048752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:09:40.291160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e265022-c842-4953-8b6b-ab97375e0758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d9e7c3b0>]}
[0m10:09:40.328581 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:09:40.330891 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:09:40.333466 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41911298, "process_in_blocks": "152", "process_kernel_time": 0.219238, "process_mem_max_rss": "97384", "process_out_blocks": "48", "process_user_time": 2.88133}
[0m10:09:40.334632 [debug] [MainThread]: Command `cli deps` succeeded at 10:09:40.334382 after 0.42 seconds
[0m10:09:40.335545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9da4aa150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9da4a8500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d9b577d0>]}
[0m10:09:40.336474 [debug] [MainThread]: Flushing usage events
[0m10:09:41.110284 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:17:29.689933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0285ba6030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0287afcef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02855c5310>]}


============================== 12:17:29.696015 | a2fc91d9-5594-4201-8d60-a0b10dfb168f ==============================
[0m12:17:29.696015 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:17:29.697663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:17:29.923659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2fc91d9-5594-4201-8d60-a0b10dfb168f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0285510410>]}
[0m12:17:29.963228 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:17:29.967528 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:17:29.973082 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.40066558, "process_in_blocks": "3360", "process_kernel_time": 0.259755, "process_mem_max_rss": "97240", "process_out_blocks": "72", "process_user_time": 2.78487}
[0m12:17:29.974266 [debug] [MainThread]: Command `cli deps` succeeded at 12:17:29.974009 after 0.40 seconds
[0m12:17:29.976261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0285852b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f028524ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0285510320>]}
[0m12:17:29.977577 [debug] [MainThread]: Flushing usage events
[0m12:17:30.816898 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:06.787133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772174f500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772398c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772174f7d0>]}


============================== 12:50:06.792556 | 28a935fa-19e7-459e-b736-215a66760d72 ==============================
[0m12:50:06.792556 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:50:06.793577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:50:06.816343 [info ] [MainThread]: dbt version: 1.9.3
[0m12:50:06.817191 [info ] [MainThread]: python version: 3.12.9
[0m12:50:06.817842 [info ] [MainThread]: python path: /home/egor/projects/TSM_DWH/venv/bin/python
[0m12:50:06.818437 [info ] [MainThread]: os info: Linux-6.13.7-100.fc40.x86_64-x86_64-with-glibc2.39
[0m12:50:06.891858 [info ] [MainThread]: Using profiles dir at /home/egor/.dbt
[0m12:50:06.892586 [info ] [MainThread]: Using profiles.yml file at /home/egor/.dbt/profiles.yml
[0m12:50:06.893292 [info ] [MainThread]: Using dbt_project.yml file at /home/egor/projects/TSM_DWH/dbt_project.yml
[0m12:50:06.894298 [info ] [MainThread]: adapter type: postgres
[0m12:50:06.895154 [info ] [MainThread]: adapter version: 1.9.0
[0m12:50:07.010090 [info ] [MainThread]: Configuration:
[0m12:50:07.010833 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:50:07.011672 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:50:07.012423 [info ] [MainThread]: Required dependencies:
[0m12:50:07.013324 [debug] [MainThread]: Executing "git --help"
[0m12:50:07.015952 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:50:07.017104 [debug] [MainThread]: STDERR: "b''"
[0m12:50:07.017744 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:50:07.018704 [info ] [MainThread]: Connection:
[0m12:50:07.019471 [info ] [MainThread]:   host: 127.0.0.1
[0m12:50:07.020135 [info ] [MainThread]:   port: 5432
[0m12:50:07.020834 [info ] [MainThread]:   user: postgres
[0m12:50:07.021785 [info ] [MainThread]:   database: postgres
[0m12:50:07.022766 [info ] [MainThread]:   schema: public
[0m12:50:07.023753 [info ] [MainThread]:   connect_timeout: 10
[0m12:50:07.024707 [info ] [MainThread]:   role: None
[0m12:50:07.025599 [info ] [MainThread]:   search_path: None
[0m12:50:07.026498 [info ] [MainThread]:   keepalives_idle: 60
[0m12:50:07.027375 [info ] [MainThread]:   sslmode: None
[0m12:50:07.028289 [info ] [MainThread]:   sslcert: None
[0m12:50:07.029318 [info ] [MainThread]:   sslkey: None
[0m12:50:07.030342 [info ] [MainThread]:   sslrootcert: None
[0m12:50:07.031383 [info ] [MainThread]:   application_name: dbt
[0m12:50:07.032512 [info ] [MainThread]:   retries: 1
[0m12:50:07.033977 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:50:07.175764 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:50:07.225457 [debug] [MainThread]: Using postgres connection "debug"
[0m12:50:07.225977 [debug] [MainThread]: On debug: select 1 as id
[0m12:50:07.226443 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:50:07.246244 [debug] [MainThread]: SQL status: SELECT 1 in 0.020 seconds
[0m12:50:07.247573 [debug] [MainThread]: On debug: Close
[0m12:50:07.248137 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:50:07.248694 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:50:07.250300 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.524759, "process_in_blocks": "2880", "process_kernel_time": 0.228564, "process_mem_max_rss": "109204", "process_out_blocks": "24", "process_user_time": 1.770667}
[0m12:50:07.250951 [debug] [MainThread]: Command `dbt debug` succeeded at 12:50:07.250779 after 0.53 seconds
[0m12:50:07.251394 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:50:07.251913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7721fcd940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77214aa3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7721b52db0>]}
[0m12:50:07.252461 [debug] [MainThread]: Flushing usage events
[0m12:50:08.206072 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:34.939655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ece24b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ecdf534a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ed0534650>]}


============================== 12:50:34.943508 | e7a21bce-6888-410d-a373-b036c5c238a4 ==============================
[0m12:50:34.943508 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:50:34.944656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_1c_journal', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:50:35.136955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7a21bce-6888-410d-a373-b036c5c238a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ece9da300>]}
[0m12:50:35.208076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7a21bce-6888-410d-a373-b036c5c238a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ed0c4ba40>]}
[0m12:50:35.209066 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:50:35.337136 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:50:35.425518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m12:50:35.426267 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_tech.sql
[0m12:50:35.426814 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dev_incremental.sql
[0m12:50:35.427393 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_fact_journal.sql
[0m12:50:35.427950 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_fact_work.sql
[0m12:50:35.641656 [error] [MainThread]: Encountered an error:
Parsing Error
  at path ['tags']: ['dev', 'hub', Undefined] is not valid under any of the given schemas
[0m12:50:35.643223 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.76017135, "process_in_blocks": "272", "process_kernel_time": 0.191795, "process_mem_max_rss": "107380", "process_out_blocks": "8", "process_user_time": 2.115654}
[0m12:50:35.643819 [debug] [MainThread]: Command `dbt run` failed at 12:50:35.643683 after 0.76 seconds
[0m12:50:35.644375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ece9d9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ecc382030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ece41a4b0>]}
[0m12:50:35.644973 [debug] [MainThread]: Flushing usage events
[0m12:50:36.468109 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:03.564066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a63efcf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a6390d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a658bc740>]}


============================== 12:54:03.567859 | bdf77f78-7033-4444-932f-ec0edcf3e31d ==============================
[0m12:54:03.567859 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:54:03.568777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_1c_journal', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:54:03.748877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdf77f78-7033-4444-932f-ec0edcf3e31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a63e0c170>]}
[0m12:54:03.814538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdf77f78-7033-4444-932f-ec0edcf3e31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a63b63740>]}
[0m12:54:03.815511 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:54:03.953270 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:54:04.043110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m12:54:04.043851 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_fact_journal.sql
[0m12:54:04.044471 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dev_incremental.sql
[0m12:54:04.045072 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_fact_work.sql
[0m12:54:04.045607 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_tech.sql
[0m12:54:04.282099 [error] [MainThread]: Encountered an error:
Compilation Error in model dev_incremental (tsm_dwh/models/dev_incremental.sql)
  expected token ':', got '}'
    line 5
      tags=['dev', 'hub', {source}]
[0m12:54:04.283423 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7763957, "process_in_blocks": "112", "process_kernel_time": 0.212546, "process_mem_max_rss": "107588", "process_out_blocks": "8", "process_user_time": 2.104844}
[0m12:54:04.284035 [debug] [MainThread]: Command `dbt run` failed at 12:54:04.283893 after 0.78 seconds
[0m12:54:04.284550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a63301100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a61b1fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a64b93c50>]}
[0m12:54:04.285091 [debug] [MainThread]: Flushing usage events
[0m12:54:05.128498 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:30.905612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffe5db620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffe1006e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffe018c50>]}


============================== 12:54:30.909950 | 3b28e9d2-a862-44be-9b9e-390a324d2e9a ==============================
[0m12:54:30.909950 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:54:30.910974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_1c_journal', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:54:31.094969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b28e9d2-a862-44be-9b9e-390a324d2e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffe5da330>]}
[0m12:54:31.161529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b28e9d2-a862-44be-9b9e-390a324d2e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffe31daf0>]}
[0m12:54:31.162505 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:54:31.284479 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:54:31.372063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m12:54:31.372803 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_tech.sql
[0m12:54:31.373404 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_fact_journal.sql
[0m12:54:31.373960 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dev_incremental.sql
[0m12:54:31.374499 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_fact_work.sql
[0m12:54:31.611772 [error] [MainThread]: Encountered an error:
Compilation Error in model dev_incremental (tsm_dwh/models/dev_incremental.sql)
  invalid syntax for function call expression
    line 2
      config(
[0m12:54:31.613161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.76654994, "process_in_blocks": "0", "process_kernel_time": 0.216689, "process_mem_max_rss": "107648", "process_out_blocks": "8", "process_user_time": 2.134613}
[0m12:54:31.613823 [debug] [MainThread]: Command `dbt run` failed at 12:54:31.613680 after 0.77 seconds
[0m12:54:31.614373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffdaf44d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffda10e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffc323110>]}
[0m12:54:31.614888 [debug] [MainThread]: Flushing usage events
[0m12:54:32.501000 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:46.769442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f493ebe5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f493ebe4bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f493ebe4c50>]}


============================== 12:54:46.773719 | f5f96df0-2303-4432-a437-731effbe1b71 ==============================
[0m12:54:46.773719 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:54:46.774916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_1c_journal', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:54:46.953692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5f96df0-2303-4432-a437-731effbe1b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f493ebe6b10>]}
[0m12:54:47.020225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5f96df0-2303-4432-a437-731effbe1b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f493e296960>]}
[0m12:54:47.021288 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:54:47.138959 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:54:47.230393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m12:54:47.231176 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dev_incremental.sql
[0m12:54:47.231740 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_fact_journal.sql
[0m12:54:47.232326 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_fact_work.sql
[0m12:54:47.232901 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_tech.sql
[0m12:54:47.438758 [error] [MainThread]: Encountered an error:
Compilation Error in model dev_incremental (tsm_dwh/models/dev_incremental.sql)
  expected token ':', got '}'
    line 15
      FROM {{{{ ref('{stg_table}') }}}}
[0m12:54:47.440190 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.72893137, "process_in_blocks": "0", "process_kernel_time": 0.192048, "process_mem_max_rss": "107592", "process_out_blocks": "16", "process_user_time": 2.10796}
[0m12:54:47.440792 [debug] [MainThread]: Command `dbt run` failed at 12:54:47.440651 after 0.73 seconds
[0m12:54:47.441311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f493eb5ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f494053d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f493c919d90>]}
[0m12:54:47.441802 [debug] [MainThread]: Flushing usage events
[0m12:54:48.271528 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:56.074643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ea3baa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ec534620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ea6fad20>]}


============================== 12:54:56.078584 | 136cb314-a074-41c0-8b1d-07e2942580cc ==============================
[0m12:54:56.078584 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:54:56.079550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_1c_journal', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:54:56.261304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '136cb314-a074-41c0-8b1d-07e2942580cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ea9da2d0>]}
[0m12:54:56.331851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '136cb314-a074-41c0-8b1d-07e2942580cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e9db81a0>]}
[0m12:54:56.332848 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:54:56.453278 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:54:56.542014 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 3 files changed.
[0m12:54:56.542618 [debug] [MainThread]: Partial parsing: deleted file: tsm_dwh://tsm_dwh/models/dev_incremental.sql
[0m12:54:56.543379 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_fact_journal.sql
[0m12:54:56.543951 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_fact_work.sql
[0m12:54:56.544558 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_tech.sql
[0m12:54:56.830409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '136cb314-a074-41c0-8b1d-07e2942580cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e83ea5a0>]}
[0m12:54:56.897423 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m12:54:56.900052 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m12:54:56.918919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '136cb314-a074-41c0-8b1d-07e2942580cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e7f381a0>]}
[0m12:54:56.919601 [info ] [MainThread]: Found 17 models, 433 macros
[0m12:54:56.920239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '136cb314-a074-41c0-8b1d-07e2942580cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e839de50>]}
[0m12:54:56.922138 [info ] [MainThread]: 
[0m12:54:56.922723 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:54:56.923358 [info ] [MainThread]: 
[0m12:54:56.924314 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:54:56.925786 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:54:56.972671 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:54:56.973272 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:54:56.973810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:56.985318 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m12:54:56.986925 [debug] [ThreadPool]: On list_postgres: Close
[0m12:54:56.994970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m12:54:57.001581 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:54:57.002087 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m12:54:57.002537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:57.011025 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:54:57.011536 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:54:57.012018 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:54:57.020099 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m12:54:57.022010 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m12:54:57.022670 [debug] [ThreadPool]: On list_postgres_public: Close
[0m12:54:57.029436 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:57.029941 [debug] [MainThread]: On master: BEGIN
[0m12:54:57.030388 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:57.038948 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:54:57.039458 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:57.040034 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:54:57.045026 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m12:54:57.046993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '136cb314-a074-41c0-8b1d-07e2942580cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e9e09070>]}
[0m12:54:57.047558 [debug] [MainThread]: On master: ROLLBACK
[0m12:54:57.048139 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:57.048564 [debug] [MainThread]: On master: BEGIN
[0m12:54:57.049280 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:54:57.049710 [debug] [MainThread]: On master: COMMIT
[0m12:54:57.050245 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:57.050689 [debug] [MainThread]: On master: COMMIT
[0m12:54:57.051327 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:54:57.051769 [debug] [MainThread]: On master: Close
[0m12:54:57.056248 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m12:54:57.056995 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_1c_journal .............................. [RUN]
[0m12:54:57.057763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m12:54:57.058439 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m12:54:57.069459 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m12:54:57.070715 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m12:54:57.115835 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m12:54:57.117002 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m12:54:57.117588 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m12:54:57.118139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:57.126354 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m12:54:57.126971 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m12:54:57.127665 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name);
  );
[0m12:54:57.129176 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 112:  направление_деятельности_name);
                                         ^

[0m12:54:57.129724 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: ROLLBACK
[0m12:54:57.130601 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m12:54:57.141604 [debug] [Thread-1 (]: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  syntax error at or near ";"
  LINE 112:  направление_деятельности_name);
                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m12:54:57.143625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '136cb314-a074-41c0-8b1d-07e2942580cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e83ea5a0>]}
[0m12:54:57.144505 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_1c_journal ..................... [[31mERROR[0m in 0.08s]
[0m12:54:57.145419 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m12:54:57.146187 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_journal' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  syntax error at or near ";"
  LINE 112:  направление_деятельности_name);
                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql.
[0m12:54:57.148751 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:57.149319 [debug] [MainThread]: On master: BEGIN
[0m12:54:57.149753 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:57.161483 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:54:57.162282 [debug] [MainThread]: On master: COMMIT
[0m12:54:57.162790 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:57.163295 [debug] [MainThread]: On master: COMMIT
[0m12:54:57.164102 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:54:57.164714 [debug] [MainThread]: On master: Close
[0m12:54:57.165675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:57.166726 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m12:54:57.167925 [info ] [MainThread]: 
[0m12:54:57.168824 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m12:54:57.170184 [debug] [MainThread]: Command end result
[0m12:54:57.214604 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m12:54:57.216613 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m12:54:57.223298 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m12:54:57.224091 [info ] [MainThread]: 
[0m12:54:57.224894 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:54:57.225770 [info ] [MainThread]: 
[0m12:54:57.226583 [error] [MainThread]:   Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  syntax error at or near ";"
  LINE 112:  направление_деятельности_name);
                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m12:54:57.227277 [info ] [MainThread]: 
[0m12:54:57.227988 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:54:57.229263 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2123255, "process_in_blocks": "312", "process_kernel_time": 0.220439, "process_mem_max_rss": "118988", "process_out_blocks": "3400", "process_user_time": 2.520653}
[0m12:54:57.229940 [debug] [MainThread]: Command `dbt run` failed at 12:54:57.229730 after 1.21 seconds
[0m12:54:57.230987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ea83aea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e8327f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e8324bf0>]}
[0m12:54:57.231717 [debug] [MainThread]: Flushing usage events
[0m12:54:58.101621 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:25.236975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cef4b740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cf51b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cefeb3e0>]}


============================== 12:56:25.240723 | 862c36ae-b251-40f1-a023-37e88536b09a ==============================
[0m12:56:25.240723 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:56:25.241830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_1c_journal', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:56:25.423788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '862c36ae-b251-40f1-a023-37e88536b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cebf4860>]}
[0m12:56:25.490237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '862c36ae-b251-40f1-a023-37e88536b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cec236e0>]}
[0m12:56:25.491218 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:56:25.611470 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:56:25.702845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:56:25.703332 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:56:25.732259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '862c36ae-b251-40f1-a023-37e88536b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ce11e5a0>]}
[0m12:56:25.803767 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m12:56:25.806441 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m12:56:25.820799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '862c36ae-b251-40f1-a023-37e88536b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cd501040>]}
[0m12:56:25.821504 [info ] [MainThread]: Found 17 models, 433 macros
[0m12:56:25.822112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '862c36ae-b251-40f1-a023-37e88536b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cd5c4dd0>]}
[0m12:56:25.824042 [info ] [MainThread]: 
[0m12:56:25.824598 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:56:25.825273 [info ] [MainThread]: 
[0m12:56:25.826270 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:56:25.827541 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:56:25.879673 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:56:25.880566 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:56:25.881147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:25.893037 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.012 seconds
[0m12:56:25.894652 [debug] [ThreadPool]: On list_postgres: Close
[0m12:56:25.901646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m12:56:25.909599 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:56:25.910194 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m12:56:25.910662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:25.919058 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:56:25.919588 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:56:25.920254 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:56:25.923573 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m12:56:25.925273 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m12:56:25.925885 [debug] [ThreadPool]: On list_postgres_public: Close
[0m12:56:25.932370 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:25.932897 [debug] [MainThread]: On master: BEGIN
[0m12:56:25.933353 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:56:25.941289 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:56:25.941824 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:25.942433 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:56:25.946658 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m12:56:25.948533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '862c36ae-b251-40f1-a023-37e88536b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ceb12c90>]}
[0m12:56:25.949160 [debug] [MainThread]: On master: ROLLBACK
[0m12:56:25.949821 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:25.950340 [debug] [MainThread]: On master: BEGIN
[0m12:56:25.950994 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:56:25.951436 [debug] [MainThread]: On master: COMMIT
[0m12:56:25.951922 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:25.952362 [debug] [MainThread]: On master: COMMIT
[0m12:56:25.952946 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:56:25.953593 [debug] [MainThread]: On master: Close
[0m12:56:25.957732 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m12:56:25.958701 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_1c_journal .............................. [RUN]
[0m12:56:25.959574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m12:56:25.960267 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m12:56:25.974361 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m12:56:25.975964 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m12:56:26.019512 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m12:56:26.020673 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m12:56:26.021295 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m12:56:26.021750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:26.030330 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m12:56:26.030963 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m12:56:26.031655 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name);
  );
[0m12:56:26.033166 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 112:  направление_деятельности_name);
                                         ^

[0m12:56:26.033680 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: ROLLBACK
[0m12:56:26.034499 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m12:56:26.038733 [debug] [Thread-1 (]: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  syntax error at or near ";"
  LINE 112:  направление_деятельности_name);
                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m12:56:26.040864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '862c36ae-b251-40f1-a023-37e88536b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cbc070e0>]}
[0m12:56:26.041758 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_1c_journal ..................... [[31mERROR[0m in 0.08s]
[0m12:56:26.042723 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m12:56:26.043576 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_journal' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  syntax error at or near ";"
  LINE 112:  направление_деятельности_name);
                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql.
[0m12:56:26.046125 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:26.046599 [debug] [MainThread]: On master: BEGIN
[0m12:56:26.047208 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:56:26.057448 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:56:26.058320 [debug] [MainThread]: On master: COMMIT
[0m12:56:26.059221 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:26.060118 [debug] [MainThread]: On master: COMMIT
[0m12:56:26.061299 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:56:26.062332 [debug] [MainThread]: On master: Close
[0m12:56:26.063156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:26.063668 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m12:56:26.064437 [info ] [MainThread]: 
[0m12:56:26.065248 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m12:56:26.066973 [debug] [MainThread]: Command end result
[0m12:56:26.105394 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m12:56:26.107169 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m12:56:26.114904 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m12:56:26.115655 [info ] [MainThread]: 
[0m12:56:26.116343 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:56:26.116933 [info ] [MainThread]: 
[0m12:56:26.117521 [error] [MainThread]:   Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  syntax error at or near ";"
  LINE 112:  направление_деятельности_name);
                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m12:56:26.118063 [info ] [MainThread]: 
[0m12:56:26.118628 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:56:26.119789 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9392941, "process_in_blocks": "0", "process_kernel_time": 0.187811, "process_mem_max_rss": "115832", "process_out_blocks": "2432", "process_user_time": 2.275751}
[0m12:56:26.120420 [debug] [MainThread]: Command `dbt run` failed at 12:56:26.120293 after 0.94 seconds
[0m12:56:26.120966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cf51b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cdd89790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cdd89160>]}
[0m12:56:26.121525 [debug] [MainThread]: Flushing usage events
[0m12:56:27.087804 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:47.037061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc70cd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc696c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc8dd1bb0>]}


============================== 12:56:47.040852 | ec34c04a-ae2e-4099-b6c6-0b85e9d5c6d5 ==============================
[0m12:56:47.040852 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:56:47.041996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_1c_journal', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:56:47.221960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec34c04a-ae2e-4099-b6c6-0b85e9d5c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc6741ca0>]}
[0m12:56:47.288023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec34c04a-ae2e-4099-b6c6-0b85e9d5c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc6780470>]}
[0m12:56:47.288970 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:56:47.409684 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:56:47.502379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:56:47.502851 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:56:47.531490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec34c04a-ae2e-4099-b6c6-0b85e9d5c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc69df560>]}
[0m12:56:47.602698 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m12:56:47.605403 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m12:56:47.620609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec34c04a-ae2e-4099-b6c6-0b85e9d5c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc4d31340>]}
[0m12:56:47.621763 [info ] [MainThread]: Found 17 models, 433 macros
[0m12:56:47.622753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec34c04a-ae2e-4099-b6c6-0b85e9d5c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc5d34740>]}
[0m12:56:47.626047 [info ] [MainThread]: 
[0m12:56:47.627041 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:56:47.628010 [info ] [MainThread]: 
[0m12:56:47.629418 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:56:47.631424 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:56:47.697315 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:56:47.697893 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:56:47.698502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:47.713357 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.015 seconds
[0m12:56:47.716439 [debug] [ThreadPool]: On list_postgres: Close
[0m12:56:47.722902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m12:56:47.731150 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:56:47.731663 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m12:56:47.732241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:47.740777 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:56:47.741421 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:56:47.741988 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:56:47.745249 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m12:56:47.746939 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m12:56:47.747610 [debug] [ThreadPool]: On list_postgres_public: Close
[0m12:56:47.754159 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:47.754664 [debug] [MainThread]: On master: BEGIN
[0m12:56:47.755224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:56:47.764638 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:56:47.765500 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:47.766485 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:56:47.772706 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m12:56:47.776191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec34c04a-ae2e-4099-b6c6-0b85e9d5c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc68296a0>]}
[0m12:56:47.777323 [debug] [MainThread]: On master: ROLLBACK
[0m12:56:47.778072 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:47.778527 [debug] [MainThread]: On master: BEGIN
[0m12:56:47.779423 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:56:47.779905 [debug] [MainThread]: On master: COMMIT
[0m12:56:47.780373 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:47.780822 [debug] [MainThread]: On master: COMMIT
[0m12:56:47.781442 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:56:47.781909 [debug] [MainThread]: On master: Close
[0m12:56:47.785080 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m12:56:47.786294 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_1c_journal .............................. [RUN]
[0m12:56:47.787315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m12:56:47.788088 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m12:56:47.798790 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m12:56:47.800510 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m12:56:47.847528 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m12:56:47.848724 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m12:56:47.849333 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m12:56:47.849838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:47.859912 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m12:56:47.860680 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m12:56:47.861526 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m12:56:47.863165 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "journal" does not exist
LINE 80:         journal
                 ^

[0m12:56:47.863738 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: ROLLBACK
[0m12:56:47.864738 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m12:56:47.869323 [debug] [Thread-1 (]: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  relation "journal" does not exist
  LINE 80:         journal
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m12:56:47.872069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec34c04a-ae2e-4099-b6c6-0b85e9d5c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc5d069f0>]}
[0m12:56:47.873970 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_1c_journal ..................... [[31mERROR[0m in 0.08s]
[0m12:56:47.875264 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m12:56:47.876103 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_journal' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  relation "journal" does not exist
  LINE 80:         journal
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql.
[0m12:56:47.879101 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:47.879585 [debug] [MainThread]: On master: BEGIN
[0m12:56:47.880242 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:56:47.889698 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:56:47.890303 [debug] [MainThread]: On master: COMMIT
[0m12:56:47.890773 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:47.891238 [debug] [MainThread]: On master: COMMIT
[0m12:56:47.891882 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:56:47.892374 [debug] [MainThread]: On master: Close
[0m12:56:47.892996 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:47.893448 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m12:56:47.894329 [info ] [MainThread]: 
[0m12:56:47.895344 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m12:56:47.897173 [debug] [MainThread]: Command end result
[0m12:56:47.937786 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m12:56:47.940192 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m12:56:47.948359 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m12:56:47.949325 [info ] [MainThread]: 
[0m12:56:47.950376 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:56:47.951353 [info ] [MainThread]: 
[0m12:56:47.952176 [error] [MainThread]:   Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  relation "journal" does not exist
  LINE 80:         journal
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m12:56:47.952802 [info ] [MainThread]: 
[0m12:56:47.953543 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:56:47.955016 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.97472453, "process_in_blocks": "0", "process_kernel_time": 0.235775, "process_mem_max_rss": "115960", "process_out_blocks": "2328", "process_user_time": 2.240445}
[0m12:56:47.955885 [debug] [MainThread]: Command `dbt run` failed at 12:56:47.955640 after 0.98 seconds
[0m12:56:47.956496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc71b0080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc73c2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc73c3050>]}
[0m12:56:47.957213 [debug] [MainThread]: Flushing usage events
[0m12:56:48.749836 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:29:11.512265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2904a43860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2904cc9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29052bd250>]}


============================== 13:29:11.519072 | 3f6b04bf-baec-44e4-9a62-79d30f57030c ==============================
[0m13:29:11.519072 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:29:11.520329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:29:11.700463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f6b04bf-baec-44e4-9a62-79d30f57030c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29045b9c40>]}
[0m13:29:11.723806 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:29:11.725367 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:29:11.727213 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.38502085, "process_in_blocks": "96", "process_kernel_time": 0.196006, "process_mem_max_rss": "97496", "process_out_blocks": "104", "process_user_time": 2.060309}
[0m13:29:11.728435 [debug] [MainThread]: Command `cli deps` succeeded at 13:29:11.728196 after 0.39 seconds
[0m13:29:11.729006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29046e0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f290483ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f290483f500>]}
[0m13:29:11.729509 [debug] [MainThread]: Flushing usage events
[0m13:29:12.675052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:06:42.866524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb80238c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb7f8c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb630b830>]}


============================== 15:06:42.873597 | c3fd3562-c47d-4145-ba88-ffaa4e5c45b8 ==============================
[0m15:06:42.873597 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:06:42.875036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:06:43.135925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3fd3562-c47d-4145-ba88-ffaa4e5c45b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb5d3b320>]}
[0m15:06:43.162145 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:06:43.163679 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:06:43.166159 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41962722, "process_in_blocks": "152", "process_kernel_time": 0.201692, "process_mem_max_rss": "97480", "process_out_blocks": "72", "process_user_time": 2.076889}
[0m15:06:43.167036 [debug] [MainThread]: Command `cli deps` succeeded at 15:06:43.166858 after 0.42 seconds
[0m15:06:43.167941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb5ca3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb5c4bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb5d3b4d0>]}
[0m15:06:43.168782 [debug] [MainThread]: Flushing usage events
[0m15:06:44.049926 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:21:15.601779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1444c15850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144433f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1444acf320>]}


============================== 15:21:15.605830 | 9a5786d5-5463-4707-8bcb-356fb8b1a36a ==============================
[0m15:21:15.605830 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:21:15.606801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_1c_journal', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:21:15.786891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a5786d5-5463-4707-8bcb-356fb8b1a36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1444acd010>]}
[0m15:21:15.854725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a5786d5-5463-4707-8bcb-356fb8b1a36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1445fbb5c0>]}
[0m15:21:15.855740 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:21:15.981311 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:21:16.071928 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:21:16.072431 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:21:16.100873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a5786d5-5463-4707-8bcb-356fb8b1a36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144420fce0>]}
[0m15:21:16.175736 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:21:16.178450 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:21:16.195741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a5786d5-5463-4707-8bcb-356fb8b1a36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1442505670>]}
[0m15:21:16.196422 [info ] [MainThread]: Found 17 models, 433 macros
[0m15:21:16.197061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a5786d5-5463-4707-8bcb-356fb8b1a36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1442917cb0>]}
[0m15:21:16.198908 [info ] [MainThread]: 
[0m15:21:16.199587 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:21:16.200171 [info ] [MainThread]: 
[0m15:21:16.201133 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:21:16.202584 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:21:16.260721 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:21:16.261254 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:21:16.261806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:16.278162 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.016 seconds
[0m15:21:16.279964 [debug] [ThreadPool]: On list_postgres: Close
[0m15:21:16.285946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:21:16.293916 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:21:16.294439 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:21:16.294875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:16.304027 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:21:16.305164 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:21:16.305708 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:21:16.310548 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m15:21:16.312273 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:21:16.312965 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:21:16.320670 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:16.321161 [debug] [MainThread]: On master: BEGIN
[0m15:21:16.321728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:21:16.330057 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:21:16.330863 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:16.331739 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:21:16.340399 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m15:21:16.343164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a5786d5-5463-4707-8bcb-356fb8b1a36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1443f056d0>]}
[0m15:21:16.344394 [debug] [MainThread]: On master: ROLLBACK
[0m15:21:16.345734 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:16.346727 [debug] [MainThread]: On master: BEGIN
[0m15:21:16.348025 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:21:16.348576 [debug] [MainThread]: On master: COMMIT
[0m15:21:16.349041 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:16.349526 [debug] [MainThread]: On master: COMMIT
[0m15:21:16.350149 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:21:16.350654 [debug] [MainThread]: On master: Close
[0m15:21:16.354104 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m15:21:16.355416 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_1c_journal .............................. [RUN]
[0m15:21:16.356268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m15:21:16.356982 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m15:21:16.365613 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m15:21:16.366650 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m15:21:16.411727 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m15:21:16.413008 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m15:21:16.413653 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m15:21:16.414168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:16.422512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:21:16.423121 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m15:21:16.423858 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m15:21:16.426040 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "journal" does not exist
LINE 80:         journal
                 ^

[0m15:21:16.426638 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: ROLLBACK
[0m15:21:16.427447 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m15:21:16.436561 [debug] [Thread-1 (]: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  relation "journal" does not exist
  LINE 80:         journal
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m15:21:16.438577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5786d5-5463-4707-8bcb-356fb8b1a36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1443feba10>]}
[0m15:21:16.439433 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_1c_journal ..................... [[31mERROR[0m in 0.08s]
[0m15:21:16.440266 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m15:21:16.441035 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_journal' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  relation "journal" does not exist
  LINE 80:         journal
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql.
[0m15:21:16.443623 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:16.444145 [debug] [MainThread]: On master: BEGIN
[0m15:21:16.444718 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:21:16.456979 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m15:21:16.457924 [debug] [MainThread]: On master: COMMIT
[0m15:21:16.458920 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:16.459779 [debug] [MainThread]: On master: COMMIT
[0m15:21:16.460902 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:21:16.461772 [debug] [MainThread]: On master: Close
[0m15:21:16.462698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:16.463272 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m15:21:16.463895 [info ] [MainThread]: 
[0m15:21:16.464630 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m15:21:16.465715 [debug] [MainThread]: Command end result
[0m15:21:16.508168 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:21:16.510066 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:21:16.517597 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m15:21:16.518097 [info ] [MainThread]: 
[0m15:21:16.518760 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:21:16.519291 [info ] [MainThread]: 
[0m15:21:16.519962 [error] [MainThread]:   Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  relation "journal" does not exist
  LINE 80:         journal
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m15:21:16.520461 [info ] [MainThread]: 
[0m15:21:16.521213 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:21:16.523068 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9794058, "process_in_blocks": "1688", "process_kernel_time": 0.206682, "process_mem_max_rss": "115876", "process_out_blocks": "2464", "process_user_time": 2.253855}
[0m15:21:16.524298 [debug] [MainThread]: Command `dbt run` failed at 15:21:16.524089 after 0.98 seconds
[0m15:21:16.525011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144450dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1444a960c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1444a96ff0>]}
[0m15:21:16.525597 [debug] [MainThread]: Flushing usage events
[0m15:21:17.633609 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:27:53.793148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc7ec9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc7901e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc7819910>]}


============================== 15:27:53.797211 | d2d826c5-504c-4f63-9042-1fcfc4656afa ==============================
[0m15:27:53.797211 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:27:53.798239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_1c_journal', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:27:53.982791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2d826c5-504c-4f63-9042-1fcfc4656afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc7dda240>]}
[0m15:27:54.048572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2d826c5-504c-4f63-9042-1fcfc4656afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc713f9e0>]}
[0m15:27:54.049659 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:27:54.168884 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:27:54.262284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:27:54.262779 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:27:54.292120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2d826c5-504c-4f63-9042-1fcfc4656afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc6b18380>]}
[0m15:27:54.363296 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:27:54.365953 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:27:54.380614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2d826c5-504c-4f63-9042-1fcfc4656afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc6b62b10>]}
[0m15:27:54.381323 [info ] [MainThread]: Found 17 models, 433 macros
[0m15:27:54.382025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2d826c5-504c-4f63-9042-1fcfc4656afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc635b650>]}
[0m15:27:54.384013 [info ] [MainThread]: 
[0m15:27:54.384697 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:27:54.385356 [info ] [MainThread]: 
[0m15:27:54.386427 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:27:54.387799 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:27:54.437842 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:27:54.438380 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:27:54.439095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:54.455564 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.016 seconds
[0m15:27:54.457438 [debug] [ThreadPool]: On list_postgres: Close
[0m15:27:54.463279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:27:54.471236 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:27:54.471811 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:27:54.472228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:54.480788 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:27:54.481318 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:27:54.481784 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:27:54.485237 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m15:27:54.486999 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:27:54.487723 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:27:54.496250 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:54.496803 [debug] [MainThread]: On master: BEGIN
[0m15:27:54.497250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:27:54.505505 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:27:54.506019 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:54.506564 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:27:54.511426 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m15:27:54.513210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2d826c5-504c-4f63-9042-1fcfc4656afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc720f8c0>]}
[0m15:27:54.513816 [debug] [MainThread]: On master: ROLLBACK
[0m15:27:54.514437 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:54.514881 [debug] [MainThread]: On master: BEGIN
[0m15:27:54.515575 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:27:54.516059 [debug] [MainThread]: On master: COMMIT
[0m15:27:54.516541 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:54.516962 [debug] [MainThread]: On master: COMMIT
[0m15:27:54.517504 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:27:54.517942 [debug] [MainThread]: On master: Close
[0m15:27:54.522030 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m15:27:54.522795 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_1c_journal .............................. [RUN]
[0m15:27:54.523591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m15:27:54.524093 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m15:27:54.532570 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m15:27:54.533483 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m15:27:54.579200 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m15:27:54.580407 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m15:27:54.580999 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m15:27:54.581475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:54.589629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:27:54.590189 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m15:27:54.590952 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m15:27:54.592552 [debug] [Thread-1 (]: Postgres adapter: Postgres error: invalid input syntax for type uuid: "-1"
LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                              ^

[0m15:27:54.593100 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: ROLLBACK
[0m15:27:54.593858 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m15:27:54.599765 [debug] [Thread-1 (]: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  invalid input syntax for type uuid: "-1"
  LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m15:27:54.601746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2d826c5-504c-4f63-9042-1fcfc4656afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc6bf5070>]}
[0m15:27:54.602631 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_1c_journal ..................... [[31mERROR[0m in 0.08s]
[0m15:27:54.603633 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m15:27:54.604419 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_journal' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  invalid input syntax for type uuid: "-1"
  LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql.
[0m15:27:54.606998 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:54.607544 [debug] [MainThread]: On master: BEGIN
[0m15:27:54.607978 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:27:54.618598 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m15:27:54.619166 [debug] [MainThread]: On master: COMMIT
[0m15:27:54.619679 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:54.620126 [debug] [MainThread]: On master: COMMIT
[0m15:27:54.620842 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:27:54.621308 [debug] [MainThread]: On master: Close
[0m15:27:54.622019 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:54.622436 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m15:27:54.622879 [info ] [MainThread]: 
[0m15:27:54.623685 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m15:27:54.625134 [debug] [MainThread]: Command end result
[0m15:27:54.665568 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:27:54.667427 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:27:54.675963 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m15:27:54.676482 [info ] [MainThread]: 
[0m15:27:54.677133 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:27:54.677800 [info ] [MainThread]: 
[0m15:27:54.678502 [error] [MainThread]:   Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  invalid input syntax for type uuid: "-1"
  LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m15:27:54.679050 [info ] [MainThread]: 
[0m15:27:54.679635 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:27:54.680736 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9453865, "process_in_blocks": "1184", "process_kernel_time": 0.210011, "process_mem_max_rss": "116028", "process_out_blocks": "2464", "process_user_time": 2.236499}
[0m15:27:54.681420 [debug] [MainThread]: Command `dbt run` failed at 15:27:54.681220 after 0.95 seconds
[0m15:27:54.682024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc7ec9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc5b23200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc713ea80>]}
[0m15:27:54.682933 [debug] [MainThread]: Flushing usage events
[0m15:27:55.666578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:54.130558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8868937080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8868844e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f886ab8c410>]}


============================== 15:33:54.134416 | 85b402bf-2691-4752-b011-7dbfd0299c18 ==============================
[0m15:33:54.134416 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:33:54.135604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_1c_journal', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:33:54.315693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85b402bf-2691-4752-b011-7dbfd0299c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88690c60f0>]}
[0m15:33:54.388957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85b402bf-2691-4752-b011-7dbfd0299c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8869039e80>]}
[0m15:33:54.389986 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:33:54.512545 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:33:54.600525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:33:54.601016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:33:54.631588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85b402bf-2691-4752-b011-7dbfd0299c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88681d5e50>]}
[0m15:33:54.705233 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:33:54.708021 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:33:54.725434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85b402bf-2691-4752-b011-7dbfd0299c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8866d01a00>]}
[0m15:33:54.726137 [info ] [MainThread]: Found 17 models, 433 macros
[0m15:33:54.726787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85b402bf-2691-4752-b011-7dbfd0299c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8867d09610>]}
[0m15:33:54.728701 [info ] [MainThread]: 
[0m15:33:54.729295 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:33:54.729864 [info ] [MainThread]: 
[0m15:33:54.730726 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:33:54.731966 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:33:54.785164 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:33:54.786024 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:33:54.786583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:54.801110 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.014 seconds
[0m15:33:54.802833 [debug] [ThreadPool]: On list_postgres: Close
[0m15:33:54.808877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:33:54.816792 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:33:54.817303 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:33:54.817763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:54.826578 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:33:54.827154 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:33:54.827782 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:33:54.831106 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m15:33:54.832898 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:33:54.833577 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:33:54.840965 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:54.841472 [debug] [MainThread]: On master: BEGIN
[0m15:33:54.841914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:33:54.850392 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:33:54.850909 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:54.851493 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:33:54.856418 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m15:33:54.858348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85b402bf-2691-4752-b011-7dbfd0299c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88684fcd10>]}
[0m15:33:54.859167 [debug] [MainThread]: On master: ROLLBACK
[0m15:33:54.860082 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:54.860992 [debug] [MainThread]: On master: BEGIN
[0m15:33:54.862144 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:33:54.862752 [debug] [MainThread]: On master: COMMIT
[0m15:33:54.863203 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:54.863653 [debug] [MainThread]: On master: COMMIT
[0m15:33:54.864296 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:33:54.864815 [debug] [MainThread]: On master: Close
[0m15:33:54.868998 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m15:33:54.870512 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_1c_journal .............................. [RUN]
[0m15:33:54.871733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m15:33:54.872877 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m15:33:54.884540 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m15:33:54.885709 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m15:33:54.928820 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m15:33:54.929973 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m15:33:54.930515 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m15:33:54.931010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:54.939574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:33:54.940180 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m15:33:54.940917 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m15:33:54.942538 [debug] [Thread-1 (]: Postgres adapter: Postgres error: invalid input syntax for type uuid: "-1"
LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                              ^

[0m15:33:54.943126 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: ROLLBACK
[0m15:33:54.943970 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m15:33:54.948798 [debug] [Thread-1 (]: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  invalid input syntax for type uuid: "-1"
  LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m15:33:54.950689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85b402bf-2691-4752-b011-7dbfd0299c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8867d09340>]}
[0m15:33:54.951611 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_1c_journal ..................... [[31mERROR[0m in 0.08s]
[0m15:33:54.952608 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m15:33:54.953471 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_journal' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  invalid input syntax for type uuid: "-1"
  LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql.
[0m15:33:54.956143 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:54.957057 [debug] [MainThread]: On master: BEGIN
[0m15:33:54.957861 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:33:54.968336 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:33:54.968965 [debug] [MainThread]: On master: COMMIT
[0m15:33:54.969709 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:54.970474 [debug] [MainThread]: On master: COMMIT
[0m15:33:54.971254 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:33:54.972273 [debug] [MainThread]: On master: Close
[0m15:33:54.973301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:54.974331 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m15:33:54.975431 [info ] [MainThread]: 
[0m15:33:54.976331 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m15:33:54.977782 [debug] [MainThread]: Command end result
[0m15:33:55.017728 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:33:55.020500 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:33:55.028663 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m15:33:55.029203 [info ] [MainThread]: 
[0m15:33:55.030071 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:33:55.030975 [info ] [MainThread]: 
[0m15:33:55.032096 [error] [MainThread]:   Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  invalid input syntax for type uuid: "-1"
  LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m15:33:55.032983 [info ] [MainThread]: 
[0m15:33:55.033923 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:33:55.035738 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9643775, "process_in_blocks": "88", "process_kernel_time": 0.212452, "process_mem_max_rss": "116140", "process_out_blocks": "2464", "process_user_time": 2.314694}
[0m15:33:55.037137 [debug] [MainThread]: Command `dbt run` failed at 15:33:55.036877 after 0.97 seconds
[0m15:33:55.038239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f886863c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88691b5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8869092000>]}
[0m15:33:55.039286 [debug] [MainThread]: Flushing usage events
[0m15:33:56.215903 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:35:43.072512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a055c920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a07202c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179e5e41a0>]}


============================== 15:35:43.076610 | d54cb8a3-ae82-41d4-afee-f643b7e89fed ==============================
[0m15:35:43.076610 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:35:43.077565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_1c_journal', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:35:43.259361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd54cb8a3-ae82-41d4-afee-f643b7e89fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179eabe270>]}
[0m15:35:43.325404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd54cb8a3-ae82-41d4-afee-f643b7e89fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179ec29b20>]}
[0m15:35:43.326379 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:35:43.449132 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:35:43.540170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:35:43.540672 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:35:43.570653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd54cb8a3-ae82-41d4-afee-f643b7e89fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179dbade50>]}
[0m15:35:43.642992 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:35:43.645666 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:35:43.659820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd54cb8a3-ae82-41d4-afee-f643b7e89fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179cff9760>]}
[0m15:35:43.660525 [info ] [MainThread]: Found 17 models, 433 macros
[0m15:35:43.661089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd54cb8a3-ae82-41d4-afee-f643b7e89fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179dc2dcd0>]}
[0m15:35:43.663033 [info ] [MainThread]: 
[0m15:35:43.663690 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:35:43.664321 [info ] [MainThread]: 
[0m15:35:43.665116 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:35:43.666596 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:35:43.719096 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:35:43.719687 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:35:43.720143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:43.731895 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.012 seconds
[0m15:35:43.733604 [debug] [ThreadPool]: On list_postgres: Close
[0m15:35:43.739842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:35:43.747950 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:35:43.748469 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:35:43.748889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:43.757278 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:35:43.757845 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:35:43.758418 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:35:43.761727 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m15:35:43.763530 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:35:43.764208 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:35:43.773571 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:43.774077 [debug] [MainThread]: On master: BEGIN
[0m15:35:43.774551 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:35:43.782587 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:35:43.783097 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:43.783676 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:35:43.788640 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m15:35:43.790404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd54cb8a3-ae82-41d4-afee-f643b7e89fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179defabd0>]}
[0m15:35:43.790965 [debug] [MainThread]: On master: ROLLBACK
[0m15:35:43.791558 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:43.791980 [debug] [MainThread]: On master: BEGIN
[0m15:35:43.792660 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:35:43.793111 [debug] [MainThread]: On master: COMMIT
[0m15:35:43.793798 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:43.794345 [debug] [MainThread]: On master: COMMIT
[0m15:35:43.795364 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:35:43.796610 [debug] [MainThread]: On master: Close
[0m15:35:43.800499 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m15:35:43.801656 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_1c_journal .............................. [RUN]
[0m15:35:43.803270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m15:35:43.804225 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m15:35:43.819014 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m15:35:43.820444 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m15:35:43.866075 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m15:35:43.867414 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m15:35:43.867963 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m15:35:43.868464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:43.876981 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:35:43.877622 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m15:35:43.878329 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m15:35:43.879992 [debug] [Thread-1 (]: Postgres adapter: Postgres error: invalid input syntax for type uuid: "-1"
LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                              ^

[0m15:35:43.880609 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: ROLLBACK
[0m15:35:43.881567 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m15:35:43.886193 [debug] [Thread-1 (]: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  invalid input syntax for type uuid: "-1"
  LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m15:35:43.888197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd54cb8a3-ae82-41d4-afee-f643b7e89fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179bbee900>]}
[0m15:35:43.889071 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_1c_journal ..................... [[31mERROR[0m in 0.08s]
[0m15:35:43.889984 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m15:35:43.890725 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_journal' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  invalid input syntax for type uuid: "-1"
  LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql.
[0m15:35:43.893127 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:43.893648 [debug] [MainThread]: On master: BEGIN
[0m15:35:43.894116 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:35:43.904459 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:35:43.905090 [debug] [MainThread]: On master: COMMIT
[0m15:35:43.905943 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:43.906450 [debug] [MainThread]: On master: COMMIT
[0m15:35:43.907135 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:35:43.907771 [debug] [MainThread]: On master: Close
[0m15:35:43.908458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:43.908885 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m15:35:43.909512 [info ] [MainThread]: 
[0m15:35:43.910414 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m15:35:43.912009 [debug] [MainThread]: Command end result
[0m15:35:43.950886 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:35:43.953124 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:35:43.960760 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m15:35:43.961652 [info ] [MainThread]: 
[0m15:35:43.962508 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:35:43.963251 [info ] [MainThread]: 
[0m15:35:43.964233 [error] [MainThread]:   Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  invalid input syntax for type uuid: "-1"
  LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m15:35:43.965020 [info ] [MainThread]: 
[0m15:35:43.965996 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:35:43.967785 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.95163095, "process_in_blocks": "0", "process_kernel_time": 0.231432, "process_mem_max_rss": "116284", "process_out_blocks": "2464", "process_user_time": 2.253719}
[0m15:35:43.968954 [debug] [MainThread]: Command `dbt run` failed at 15:35:43.968691 after 0.95 seconds
[0m15:35:43.970005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a1fb7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179df2b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179ea8a150>]}
[0m15:35:43.971052 [debug] [MainThread]: Flushing usage events
[0m15:35:44.860007 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:12:21.738270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535591be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5356650b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5354152b70>]}


============================== 16:12:21.744603 | 7022c5df-377e-4bd9-9b09-ee0886358126 ==============================
[0m16:12:21.744603 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:12:21.745543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/egor/.dbt', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s tag:hub', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:12:21.965741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7022c5df-377e-4bd9-9b09-ee0886358126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5354bd4620>]}
[0m16:12:22.033114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7022c5df-377e-4bd9-9b09-ee0886358126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5355a542f0>]}
[0m16:12:22.034265 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:12:22.176093 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:12:22.264850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:12:22.265330 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:12:22.294479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7022c5df-377e-4bd9-9b09-ee0886358126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53539eab10>]}
[0m16:12:22.367566 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:12:22.370206 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:12:22.395519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7022c5df-377e-4bd9-9b09-ee0886358126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53529c5670>]}
[0m16:12:22.396238 [info ] [MainThread]: Found 17 models, 433 macros
[0m16:12:22.396847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7022c5df-377e-4bd9-9b09-ee0886358126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5353fe4740>]}
[0m16:12:22.399063 [info ] [MainThread]: 
[0m16:12:22.399788 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:12:22.400615 [info ] [MainThread]: 
[0m16:12:22.401708 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:12:22.408199 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:12:22.487291 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:12:22.488201 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:12:22.488727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:22.509175 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.020 seconds
[0m16:12:22.511059 [debug] [ThreadPool]: On list_postgres: Close
[0m16:12:22.515092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:12:22.522985 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:12:22.523511 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:12:22.523965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:12:22.532506 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m16:12:22.533044 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:12:22.533590 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:12:22.540786 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m16:12:22.543189 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:12:22.544270 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:12:22.558519 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:22.559481 [debug] [MainThread]: On master: BEGIN
[0m16:12:22.560366 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:12:22.573270 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m16:12:22.574433 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:22.575605 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:12:22.588066 [debug] [MainThread]: SQL status: SELECT 1 in 0.011 seconds
[0m16:12:22.591538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7022c5df-377e-4bd9-9b09-ee0886358126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5353fe45c0>]}
[0m16:12:22.592580 [debug] [MainThread]: On master: ROLLBACK
[0m16:12:22.593580 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:22.594387 [debug] [MainThread]: On master: BEGIN
[0m16:12:22.595523 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:12:22.596435 [debug] [MainThread]: On master: COMMIT
[0m16:12:22.597277 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:22.598116 [debug] [MainThread]: On master: COMMIT
[0m16:12:22.599099 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:12:22.599918 [debug] [MainThread]: On master: Close
[0m16:12:22.611447 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m16:12:22.612545 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m16:12:22.616294 [info ] [Thread-2 (]: 2 of 3 START sql incremental model public.dv_hub_fact_work ..................... [RUN]
[0m16:12:22.615096 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m16:12:22.613835 [info ] [Thread-1 (]: 1 of 3 START sql incremental model public.dv_hub_fact_journal .................. [RUN]
[0m16:12:22.620146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.dv_hub_fact_journal)
[0m16:12:22.617549 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_hub_fact_work'
[0m16:12:22.622472 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m16:12:22.619291 [info ] [Thread-3 (]: 3 of 3 START sql incremental model public.dv_hub_tech .......................... [RUN]
[0m16:12:22.621132 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m16:12:22.630093 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_hub_tech'
[0m16:12:22.631144 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m16:12:22.674676 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:12:22.687581 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m16:12:22.688711 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m16:12:22.689565 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m16:12:22.696619 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m16:12:22.697925 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m16:12:22.863662 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:12:22.862873 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_tech"
[0m16:12:22.864755 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_work"
[0m16:12:22.891005 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:12:22.891640 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: BEGIN
[0m16:12:22.892205 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:12:22.892728 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:12:22.893187 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:12:22.893783 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: BEGIN
[0m16:12:22.894435 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: BEGIN
[0m16:12:22.895350 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:12:22.896284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:22.905731 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m16:12:22.906435 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m16:12:22.907906 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:12:22.906941 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:12:22.908816 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      
  
    

  create  table "postgres"."public"."dv_hub_tech"
  
  
    as
  
  (
    

SELECT distinct on (bk_гар_номер)
        hk_dv_hub_tech,
        hkcode,
        recsource,
        loadts,
        bk_гар_номер
FROM "postgres"."public"."stg_1c_tech"


  );
  
  
[0m16:12:22.909620 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_hub_fact_work"
  
  
    as
  
  (
    

SELECT distinct on (bk_работа_uuid)
        hk_dv_hub_fact_work,
        hkcode,
        recsource,
        loadts,
        bk_работа_uuid
FROM "postgres"."public"."stg_1c_works"


  );
  
  
[0m16:12:22.910655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m16:12:22.911480 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:12:22.912134 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.stg_1c_tech" does not exist
LINE 21: FROM "postgres"."public"."stg_1c_tech"
              ^

[0m16:12:22.912740 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.stg_1c_works" does not exist
LINE 21: FROM "postgres"."public"."stg_1c_works"
              ^

[0m16:12:22.913256 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      
  
    

  create  table "postgres"."public"."dv_hub_fact_journal"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal"


  );
  
  
[0m16:12:22.913983 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: ROLLBACK
[0m16:12:22.914541 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: ROLLBACK
[0m16:12:22.915587 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: Close
[0m16:12:22.916164 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_1c_journal" does not exist
LINE 21: FROM "postgres"."public"."stg_1c_journal"
              ^

[0m16:12:22.916907 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: Close
[0m16:12:22.919706 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: ROLLBACK
[0m16:12:22.922556 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m16:12:22.951040 [debug] [Thread-2 (]: Database Error in model dv_hub_fact_work (tsm_dwh/models/dv/dv_hub_fact_work.sql)
  relation "public.stg_1c_works" does not exist
  LINE 21: FROM "postgres"."public"."stg_1c_works"
                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_fact_work.sql
[0m16:12:22.954222 [debug] [Thread-1 (]: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  relation "public.stg_1c_journal" does not exist
  LINE 21: FROM "postgres"."public"."stg_1c_journal"
                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_fact_journal.sql
[0m16:12:22.955806 [debug] [Thread-3 (]: Database Error in model dv_hub_tech (tsm_dwh/models/dv/dv_hub_tech.sql)
  relation "public.stg_1c_tech" does not exist
  LINE 21: FROM "postgres"."public"."stg_1c_tech"
                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_tech.sql
[0m16:12:22.956808 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7022c5df-377e-4bd9-9b09-ee0886358126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5354b78830>]}
[0m16:12:22.957709 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7022c5df-377e-4bd9-9b09-ee0886358126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5341f29d60>]}
[0m16:12:22.958192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7022c5df-377e-4bd9-9b09-ee0886358126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5341f2b380>]}
[0m16:12:22.959139 [error] [Thread-2 (]: 2 of 3 ERROR creating sql incremental model public.dv_hub_fact_work ............ [[31mERROR[0m in 0.33s]
[0m16:12:22.960061 [error] [Thread-3 (]: 3 of 3 ERROR creating sql incremental model public.dv_hub_tech ................. [[31mERROR[0m in 0.33s]
[0m16:12:22.961082 [error] [Thread-1 (]: 1 of 3 ERROR creating sql incremental model public.dv_hub_fact_journal ......... [[31mERROR[0m in 0.34s]
[0m16:12:22.962170 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m16:12:22.963006 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m16:12:22.963709 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m16:12:22.964678 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_hub_fact_work' to be skipped because of status 'error'.  Reason: Database Error in model dv_hub_fact_work (tsm_dwh/models/dv/dv_hub_fact_work.sql)
  relation "public.stg_1c_works" does not exist
  LINE 21: FROM "postgres"."public"."stg_1c_works"
                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_fact_work.sql.
[0m16:12:22.967466 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_hub_tech' to be skipped because of status 'error'.  Reason: Database Error in model dv_hub_tech (tsm_dwh/models/dv/dv_hub_tech.sql)
  relation "public.stg_1c_tech" does not exist
  LINE 21: FROM "postgres"."public"."stg_1c_tech"
                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_tech.sql.
[0m16:12:22.968937 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_hub_fact_journal' to be skipped because of status 'error'.  Reason: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  relation "public.stg_1c_journal" does not exist
  LINE 21: FROM "postgres"."public"."stg_1c_journal"
                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_fact_journal.sql.
[0m16:12:22.971206 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:22.972029 [debug] [MainThread]: On master: BEGIN
[0m16:12:22.972764 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:12:22.983274 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m16:12:22.983917 [debug] [MainThread]: On master: COMMIT
[0m16:12:22.984423 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:22.984884 [debug] [MainThread]: On master: COMMIT
[0m16:12:22.985488 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:12:22.986008 [debug] [MainThread]: On master: Close
[0m16:12:22.986756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:22.987184 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_journal' was properly closed.
[0m16:12:22.987703 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_work' was properly closed.
[0m16:12:22.988115 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_tech' was properly closed.
[0m16:12:22.988821 [info ] [MainThread]: 
[0m16:12:22.989337 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m16:12:22.991360 [debug] [MainThread]: Command end result
[0m16:12:23.029114 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:12:23.031018 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:12:23.041478 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m16:12:23.042017 [info ] [MainThread]: 
[0m16:12:23.042830 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m16:12:23.043721 [info ] [MainThread]: 
[0m16:12:23.044671 [error] [MainThread]:   Database Error in model dv_hub_fact_work (tsm_dwh/models/dv/dv_hub_fact_work.sql)
  relation "public.stg_1c_works" does not exist
  LINE 21: FROM "postgres"."public"."stg_1c_works"
                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_fact_work.sql
[0m16:12:23.045418 [info ] [MainThread]: 
[0m16:12:23.046244 [error] [MainThread]:   Database Error in model dv_hub_tech (tsm_dwh/models/dv/dv_hub_tech.sql)
  relation "public.stg_1c_tech" does not exist
  LINE 21: FROM "postgres"."public"."stg_1c_tech"
                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_tech.sql
[0m16:12:23.047030 [info ] [MainThread]: 
[0m16:12:23.048009 [error] [MainThread]:   Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  relation "public.stg_1c_journal" does not exist
  LINE 21: FROM "postgres"."public"."stg_1c_journal"
                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_fact_journal.sql
[0m16:12:23.048960 [info ] [MainThread]: 
[0m16:12:23.049994 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m16:12:23.052405 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3734176, "process_in_blocks": "54416", "process_kernel_time": 0.32951, "process_mem_max_rss": "120508", "process_out_blocks": "2624", "process_user_time": 2.584626}
[0m16:12:23.053543 [debug] [MainThread]: Command `dbt run` failed at 16:12:23.053316 after 1.37 seconds
[0m16:12:23.054491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535591be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535409d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5354231a60>]}
[0m16:12:23.055456 [debug] [MainThread]: Flushing usage events
[0m16:12:23.912624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:13:15.194153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7cc33c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7a48cbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7ad565d0>]}


============================== 16:13:15.198273 | c8be1fff-63ba-4a34-a895-5780d8bed6a1 ==============================
[0m16:13:15.198273 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:13:15.199205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s +tag:hub', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:13:15.380738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8be1fff-63ba-4a34-a895-5780d8bed6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7ae0c620>]}
[0m16:13:15.447361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8be1fff-63ba-4a34-a895-5780d8bed6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7a133f80>]}
[0m16:13:15.448386 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:13:15.587793 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:13:15.715670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:13:15.716167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:13:15.746685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8be1fff-63ba-4a34-a895-5780d8bed6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b79726300>]}
[0m16:13:15.854041 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:13:15.864823 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:13:15.894772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8be1fff-63ba-4a34-a895-5780d8bed6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7936a510>]}
[0m16:13:15.895867 [info ] [MainThread]: Found 17 models, 433 macros
[0m16:13:15.896707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8be1fff-63ba-4a34-a895-5780d8bed6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b79380da0>]}
[0m16:13:15.901120 [info ] [MainThread]: 
[0m16:13:15.902061 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:13:15.902867 [info ] [MainThread]: 
[0m16:13:15.903999 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:13:15.911815 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:13:15.962075 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:13:15.962692 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:13:15.963329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:15.974624 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m16:13:15.976282 [debug] [ThreadPool]: On list_postgres: Close
[0m16:13:15.980180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:13:15.986870 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:13:15.987472 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:13:15.987948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:15.996543 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:13:15.997052 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:13:15.997589 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:13:16.000833 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m16:13:16.002570 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:13:16.003191 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:13:16.010585 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:16.011079 [debug] [MainThread]: On master: BEGIN
[0m16:13:16.011690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:13:16.020095 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:13:16.020662 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:16.021221 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:13:16.026299 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m16:13:16.028124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8be1fff-63ba-4a34-a895-5780d8bed6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b79b20620>]}
[0m16:13:16.028734 [debug] [MainThread]: On master: ROLLBACK
[0m16:13:16.029349 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:16.029824 [debug] [MainThread]: On master: BEGIN
[0m16:13:16.030523 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:13:16.030966 [debug] [MainThread]: On master: COMMIT
[0m16:13:16.031427 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:16.031855 [debug] [MainThread]: On master: COMMIT
[0m16:13:16.032440 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:13:16.032896 [debug] [MainThread]: On master: Close
[0m16:13:16.036507 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m16:13:16.037539 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m16:13:16.039493 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_works
[0m16:13:16.038615 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_1c_journal .............................. [RUN]
[0m16:13:16.040632 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_1c_tech ................................. [RUN]
[0m16:13:16.042069 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_1c_works ................................ [RUN]
[0m16:13:16.043014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m16:13:16.043893 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_tech'
[0m16:13:16.044997 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_works'
[0m16:13:16.046557 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m16:13:16.048737 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m16:13:16.050086 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m16:13:16.064084 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m16:13:16.065759 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m16:13:16.067811 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m16:13:16.069172 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m16:13:16.075057 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m16:13:16.109906 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m16:13:16.148930 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m16:13:16.156027 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m16:13:16.154224 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m16:13:16.160459 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:13:16.161244 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:13:16.161859 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:13:16.162458 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m16:13:16.162981 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m16:13:16.163639 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m16:13:16.164222 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:13:16.164760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:16.165360 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:13:16.175146 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m16:13:16.175799 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:13:16.176586 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m16:13:16.177841 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m16:13:16.178784 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "КлючСвязи" does not exist
LINE 33: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                              ^

[0m16:13:16.179694 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:13:16.180479 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: ROLLBACK
[0m16:13:16.181040 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:13:16.182131 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_гар_номер,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_гар_номер,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m16:13:16.183085 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:13:16.183810 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: Close
[0m16:13:16.184683 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m16:13:16.185630 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "КлючСвязи" does not exist
LINE 34: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                              ^

[0m16:13:16.188317 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: ROLLBACK
[0m16:13:16.189472 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m16:13:16.197233 [debug] [Thread-3 (]: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "КлючСвязи" does not exist
  LINE 33: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:13:16.198031 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m16:13:16.206916 [debug] [Thread-2 (]: Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "КлючСвязи" does not exist
  LINE 34: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql
[0m16:13:16.209862 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:13:16.211031 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m16:13:16.211954 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8be1fff-63ba-4a34-a895-5780d8bed6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7adb4d10>]}
[0m16:13:16.212781 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:13:16.213639 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_1c_works ....................... [[31mERROR[0m in 0.15s]
[0m16:13:16.214365 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8be1fff-63ba-4a34-a895-5780d8bed6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b77257920>]}
[0m16:13:16.225951 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m16:13:16.238025 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:13:16.239261 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_works' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "КлючСвязи" does not exist
  LINE 33: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql.
[0m16:13:16.240060 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_1c_tech ........................ [[31mERROR[0m in 0.17s]
[0m16:13:16.240997 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:13:16.242643 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m16:13:16.243394 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m16:13:16.244092 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:13:16.244845 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.dv_hub_fact_work ................................... [[33mSKIP[0m]
[0m16:13:16.246436 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_tech' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "КлючСвязи" does not exist
  LINE 34: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql.
[0m16:13:16.247654 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m16:13:16.249059 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m16:13:16.250268 [info ] [Thread-3 (]: 5 of 6 SKIP relation public.dv_hub_tech ........................................ [[33mSKIP[0m]
[0m16:13:16.251533 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m16:13:16.264107 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m16:13:16.274444 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m16:13:16.281707 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:13:16.282272 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m16:13:16.283150 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:13:16.286128 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m16:13:16.287166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8be1fff-63ba-4a34-a895-5780d8bed6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7c64b8f0>]}
[0m16:13:16.289044 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_1c_journal ......................... [[32mCREATE VIEW[0m in 0.24s]
[0m16:13:16.290611 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m16:13:16.292167 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m16:13:16.293020 [info ] [Thread-4 (]: 6 of 6 START sql incremental model public.dv_hub_fact_journal .................. [RUN]
[0m16:13:16.294086 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_hub_fact_journal'
[0m16:13:16.294848 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m16:13:16.308995 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:13:16.309958 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m16:13:16.357495 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:13:16.358355 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:13:16.358902 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: BEGIN
[0m16:13:16.359367 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:13:16.367727 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m16:13:16.368288 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:13:16.368851 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      
  
    

  create  table "postgres"."public"."dv_hub_fact_journal"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal"


  );
  
  
[0m16:13:16.370197 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "hkcode" does not exist
LINE 17:         hkcode,
                 ^

[0m16:13:16.370782 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: ROLLBACK
[0m16:13:16.371629 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m16:13:16.374556 [debug] [Thread-4 (]: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  column "hkcode" does not exist
  LINE 17:         hkcode,
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_fact_journal.sql
[0m16:13:16.375283 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8be1fff-63ba-4a34-a895-5780d8bed6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7411ec00>]}
[0m16:13:16.376156 [error] [Thread-4 (]: 6 of 6 ERROR creating sql incremental model public.dv_hub_fact_journal ......... [[31mERROR[0m in 0.08s]
[0m16:13:16.377335 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m16:13:16.378143 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_hub_fact_journal' to be skipped because of status 'error'.  Reason: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  column "hkcode" does not exist
  LINE 17:         hkcode,
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_fact_journal.sql.
[0m16:13:16.380018 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:16.380712 [debug] [MainThread]: On master: BEGIN
[0m16:13:16.381215 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:13:16.392802 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:13:16.393621 [debug] [MainThread]: On master: COMMIT
[0m16:13:16.394313 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:16.394876 [debug] [MainThread]: On master: COMMIT
[0m16:13:16.395650 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:13:16.396152 [debug] [MainThread]: On master: Close
[0m16:13:16.397221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:16.398075 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m16:13:16.399059 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_tech' was properly closed.
[0m16:13:16.399665 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_works' was properly closed.
[0m16:13:16.400085 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_journal' was properly closed.
[0m16:13:16.400699 [info ] [MainThread]: 
[0m16:13:16.401435 [info ] [MainThread]: Finished running 3 incremental models, 3 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m16:13:16.403132 [debug] [MainThread]: Command end result
[0m16:13:16.440367 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:13:16.442327 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:13:16.449922 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m16:13:16.450771 [info ] [MainThread]: 
[0m16:13:16.451353 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m16:13:16.451890 [info ] [MainThread]: 
[0m16:13:16.452529 [error] [MainThread]:   Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "КлючСвязи" does not exist
  LINE 33: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:13:16.452996 [info ] [MainThread]: 
[0m16:13:16.453799 [error] [MainThread]:   Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "КлючСвязи" does not exist
  LINE 34: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql
[0m16:13:16.454622 [info ] [MainThread]: 
[0m16:13:16.455618 [error] [MainThread]:   Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  column "hkcode" does not exist
  LINE 17:         hkcode,
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_fact_journal.sql
[0m16:13:16.456160 [info ] [MainThread]: 
[0m16:13:16.456871 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=2 TOTAL=6
[0m16:13:16.458241 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3213898, "process_in_blocks": "64", "process_kernel_time": 0.238068, "process_mem_max_rss": "119700", "process_out_blocks": "2616", "process_user_time": 2.57505}
[0m16:13:16.459399 [debug] [MainThread]: Command `dbt run` failed at 16:13:16.459119 after 1.32 seconds
[0m16:13:16.460236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7a5bf530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7a6f8800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7416ed20>]}
[0m16:13:16.461420 [debug] [MainThread]: Flushing usage events
[0m16:13:17.468193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:16:04.798608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff2781a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff274fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff2781e50>]}


============================== 16:16:04.802470 | b6a9e139-c5f6-4973-b332-614afc6ca8b0 ==============================
[0m16:16:04.802470 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:16:04.803670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s +tag:hub', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:16:04.986970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6a9e139-c5f6-4973-b332-614afc6ca8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff2efc5c0>]}
[0m16:16:05.053725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6a9e139-c5f6-4973-b332-614afc6ca8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff2237a70>]}
[0m16:16:05.054747 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:16:05.174752 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:16:05.269962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:16:05.270467 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:16:05.300004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6a9e139-c5f6-4973-b332-614afc6ca8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff1b164e0>]}
[0m16:16:05.374655 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:16:05.377512 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:16:05.391646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6a9e139-c5f6-4973-b332-614afc6ca8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff175b890>]}
[0m16:16:05.392320 [info ] [MainThread]: Found 17 models, 433 macros
[0m16:16:05.392947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6a9e139-c5f6-4973-b332-614afc6ca8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff2031a30>]}
[0m16:16:05.395640 [info ] [MainThread]: 
[0m16:16:05.396210 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:16:05.396799 [info ] [MainThread]: 
[0m16:16:05.397606 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:16:05.403313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:16:05.454752 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:16:05.455349 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:16:05.455840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:05.467146 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m16:16:05.468902 [debug] [ThreadPool]: On list_postgres: Close
[0m16:16:05.471678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:16:05.478227 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:16:05.478771 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:16:05.479547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:16:05.487789 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m16:16:05.488316 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:16:05.488834 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:16:05.491994 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m16:16:05.493809 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:16:05.494436 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:16:05.503657 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:05.504186 [debug] [MainThread]: On master: BEGIN
[0m16:16:05.504650 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:16:05.512717 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:16:05.513229 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:05.513842 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:16:05.518896 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m16:16:05.520906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6a9e139-c5f6-4973-b332-614afc6ca8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff230d6a0>]}
[0m16:16:05.521490 [debug] [MainThread]: On master: ROLLBACK
[0m16:16:05.522076 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:05.522537 [debug] [MainThread]: On master: BEGIN
[0m16:16:05.523293 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:16:05.523802 [debug] [MainThread]: On master: COMMIT
[0m16:16:05.524261 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:05.524772 [debug] [MainThread]: On master: COMMIT
[0m16:16:05.525333 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:16:05.525841 [debug] [MainThread]: On master: Close
[0m16:16:05.530200 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m16:16:05.531425 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m16:16:05.532933 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_works
[0m16:16:05.534432 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_1c_journal .............................. [RUN]
[0m16:16:05.535439 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_1c_tech ................................. [RUN]
[0m16:16:05.536503 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_1c_works ................................ [RUN]
[0m16:16:05.537596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m16:16:05.538996 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_tech'
[0m16:16:05.542410 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m16:16:05.541275 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m16:16:05.540226 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_works'
[0m16:16:05.549684 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m16:16:05.558855 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m16:16:05.561889 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m16:16:05.564459 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m16:16:05.566294 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m16:16:05.567188 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m16:16:05.635649 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m16:16:05.645723 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m16:16:05.646745 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m16:16:05.647975 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m16:16:05.649155 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:16:05.649785 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m16:16:05.650407 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:16:05.651142 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:16:05.652001 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:16:05.652892 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m16:16:05.653506 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m16:16:05.654261 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:16:05.654986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:16:05.661428 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m16:16:05.662096 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:16:05.662897 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m16:16:05.664357 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "КлючСвязи" does not exist
LINE 34: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                              ^

[0m16:16:05.665014 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: ROLLBACK
[0m16:16:05.665829 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: Close
[0m16:16:05.670094 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m16:16:05.670734 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:16:05.671369 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:16:05.672368 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_гар_номер,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_гар_номер,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m16:16:05.673258 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:16:05.674746 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m16:16:05.675719 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "КлючСвязи" does not exist
LINE 35: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                              ^

[0m16:16:05.676516 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: ROLLBACK
[0m16:16:05.678155 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m16:16:05.683610 [debug] [Thread-3 (]: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "КлючСвязи" does not exist
  LINE 34: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:16:05.686198 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m16:16:05.693102 [debug] [Thread-2 (]: Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "КлючСвязи" does not exist
  LINE 35: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql
[0m16:16:05.696276 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:16:05.696951 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a9e139-c5f6-4973-b332-614afc6ca8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fef32dd30>]}
[0m16:16:05.697687 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m16:16:05.698166 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a9e139-c5f6-4973-b332-614afc6ca8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff2e9c8c0>]}
[0m16:16:05.699186 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_1c_works ....................... [[31mERROR[0m in 0.14s]
[0m16:16:05.700872 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_1c_tech ........................ [[31mERROR[0m in 0.16s]
[0m16:16:05.701807 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:16:05.702927 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m16:16:05.703690 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m16:16:05.708435 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:16:05.709334 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_works' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "КлючСвязи" does not exist
  LINE 34: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql.
[0m16:16:05.710061 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m16:16:05.711827 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_tech' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "КлючСвязи" does not exist
  LINE 35: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql.
[0m16:16:05.713272 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m16:16:05.715943 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m16:16:05.715129 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.dv_hub_fact_work ................................... [[33mSKIP[0m]
[0m16:16:05.717205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:16:05.718214 [info ] [Thread-2 (]: 5 of 6 SKIP relation public.dv_hub_tech ........................................ [[33mSKIP[0m]
[0m16:16:05.719098 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m16:16:05.725215 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m16:16:05.744688 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:16:05.745452 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:16:05.745966 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:16:05.758642 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m16:16:05.765924 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m16:16:05.773674 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:16:05.774504 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m16:16:05.785113 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m16:16:05.789156 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m16:16:05.790643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a9e139-c5f6-4973-b332-614afc6ca8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff48e79b0>]}
[0m16:16:05.791626 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_1c_journal ......................... [[32mCREATE VIEW[0m in 0.25s]
[0m16:16:05.792699 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m16:16:05.793798 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m16:16:05.794874 [info ] [Thread-3 (]: 6 of 6 START sql incremental model public.dv_hub_fact_journal .................. [RUN]
[0m16:16:05.795974 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_works, now model.tsm_dwh.dv_hub_fact_journal)
[0m16:16:05.796569 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m16:16:05.806790 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:16:05.807626 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m16:16:05.862693 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:16:05.863700 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:16:05.864243 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: BEGIN
[0m16:16:05.864779 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:16:05.873277 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m16:16:05.873915 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:16:05.874485 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      
  
    

  create  table "postgres"."public"."dv_hub_fact_journal"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal"


  );
  
  
[0m16:16:05.915329 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.040 seconds
[0m16:16:05.921657 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m16:16:05.922230 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:16:05.922846 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m16:16:05.935123 [debug] [Thread-3 (]: SQL status: COMMIT in 0.012 seconds
[0m16:16:05.936362 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m16:16:05.937220 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a9e139-c5f6-4973-b332-614afc6ca8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fef3fb0b0>]}
[0m16:16:05.938041 [info ] [Thread-3 (]: 6 of 6 OK created sql incremental model public.dv_hub_fact_journal ............. [[32mSELECT 0[0m in 0.14s]
[0m16:16:05.938902 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m16:16:05.940692 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:05.941163 [debug] [MainThread]: On master: BEGIN
[0m16:16:05.941713 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:16:05.953254 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:16:05.954203 [debug] [MainThread]: On master: COMMIT
[0m16:16:05.954925 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:05.955800 [debug] [MainThread]: On master: COMMIT
[0m16:16:05.956997 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:16:05.957879 [debug] [MainThread]: On master: Close
[0m16:16:05.958966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:05.959895 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m16:16:05.960776 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_tech' was properly closed.
[0m16:16:05.961601 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_journal' was properly closed.
[0m16:16:05.962217 [info ] [MainThread]: 
[0m16:16:05.962864 [info ] [MainThread]: Finished running 3 incremental models, 3 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m16:16:05.965028 [debug] [MainThread]: Command end result
[0m16:16:06.001785 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:16:06.003735 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:16:06.012142 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m16:16:06.012806 [info ] [MainThread]: 
[0m16:16:06.013470 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:16:06.014109 [info ] [MainThread]: 
[0m16:16:06.014894 [error] [MainThread]:   Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "КлючСвязи" does not exist
  LINE 34: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:16:06.015526 [info ] [MainThread]: 
[0m16:16:06.016325 [error] [MainThread]:   Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "КлючСвязи" does not exist
  LINE 35: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql
[0m16:16:06.017041 [info ] [MainThread]: 
[0m16:16:06.017722 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=2 TOTAL=6
[0m16:16:06.019700 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2783166, "process_in_blocks": "0", "process_kernel_time": 0.230601, "process_mem_max_rss": "119448", "process_out_blocks": "2608", "process_user_time": 2.519424}
[0m16:16:06.020824 [debug] [MainThread]: Command `dbt run` failed at 16:16:06.020595 after 1.28 seconds
[0m16:16:06.021908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff2ed7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff2f1f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fec26bd70>]}
[0m16:16:06.022905 [debug] [MainThread]: Flushing usage events
[0m16:16:07.248681 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:39:19.484592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224c604560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224c2dea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224c6055b0>]}


============================== 16:39:19.490317 | f1b4c2bf-39a1-42f7-9156-8cac874d3362 ==============================
[0m16:39:19.490317 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:39:19.491510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s +tag:hub', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:39:19.684180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1b4c2bf-39a1-42f7-9156-8cac874d3362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224ca046e0>]}
[0m16:39:19.750953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1b4c2bf-39a1-42f7-9156-8cac874d3362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224c76f080>]}
[0m16:39:19.752013 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:39:19.883901 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:39:19.984827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:19.985311 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:20.016426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1b4c2bf-39a1-42f7-9156-8cac874d3362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224b31f620>]}
[0m16:39:20.092150 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:39:20.094873 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:39:20.112594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1b4c2bf-39a1-42f7-9156-8cac874d3362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224c257890>]}
[0m16:39:20.113301 [info ] [MainThread]: Found 17 models, 433 macros
[0m16:39:20.113953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1b4c2bf-39a1-42f7-9156-8cac874d3362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224b714740>]}
[0m16:39:20.116672 [info ] [MainThread]: 
[0m16:39:20.117299 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:39:20.117913 [info ] [MainThread]: 
[0m16:39:20.118775 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:20.126777 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:39:20.184291 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:39:20.184862 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:39:20.185355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:20.199483 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.014 seconds
[0m16:39:20.201144 [debug] [ThreadPool]: On list_postgres: Close
[0m16:39:20.203996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:39:20.211189 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:39:20.211739 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:39:20.212192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:20.220978 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:39:20.221583 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:39:20.222181 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:39:20.225784 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m16:39:20.227589 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:39:20.228247 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:39:20.237348 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:20.237898 [debug] [MainThread]: On master: BEGIN
[0m16:39:20.238333 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:20.246581 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:39:20.247122 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:20.247762 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:39:20.253243 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m16:39:20.256335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1b4c2bf-39a1-42f7-9156-8cac874d3362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224b31cd70>]}
[0m16:39:20.256965 [debug] [MainThread]: On master: ROLLBACK
[0m16:39:20.257599 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:20.258046 [debug] [MainThread]: On master: BEGIN
[0m16:39:20.258851 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:39:20.259588 [debug] [MainThread]: On master: COMMIT
[0m16:39:20.260105 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:20.260690 [debug] [MainThread]: On master: COMMIT
[0m16:39:20.261629 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:39:20.262240 [debug] [MainThread]: On master: Close
[0m16:39:20.267679 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m16:39:20.269970 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m16:39:20.268987 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_1c_journal .............................. [RUN]
[0m16:39:20.271845 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_works
[0m16:39:20.272888 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_1c_tech ................................. [RUN]
[0m16:39:20.273910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m16:39:20.274770 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_1c_works ................................ [RUN]
[0m16:39:20.276166 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_tech'
[0m16:39:20.277068 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m16:39:20.278173 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_works'
[0m16:39:20.278979 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m16:39:20.289927 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m16:39:20.291177 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m16:39:20.293476 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m16:39:20.295606 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m16:39:20.296977 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m16:39:20.303030 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m16:39:20.325971 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m16:39:20.384186 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m16:39:20.386088 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m16:39:20.389027 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m16:39:20.390417 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:39:20.391023 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m16:39:20.391766 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:39:20.392680 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:39:20.393704 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m16:39:20.394533 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:20.395199 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:39:20.396180 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m16:39:20.397197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:20.402410 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m16:39:20.403025 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:39:20.403659 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_гар_номер,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_гар_номер,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m16:39:20.405939 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "гар_номер" does not exist
LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                         ^

[0m16:39:20.406528 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: ROLLBACK
[0m16:39:20.407409 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m16:39:20.410354 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m16:39:20.411285 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:39:20.412140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:39:20.412973 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m16:39:20.414041 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:20.415890 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m16:39:20.417294 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "value_Ссылка" does not exist
LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                         ^

[0m16:39:20.418288 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: ROLLBACK
[0m16:39:20.420760 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: Close
[0m16:39:20.427146 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m16:39:20.436068 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:20.436818 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m16:39:20.438998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:39:20.446723 [debug] [Thread-2 (]: Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "гар_номер" does not exist
  LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql
[0m16:39:20.456258 [debug] [Thread-3 (]: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:39:20.465673 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:39:20.466957 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:20.467525 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:39:20.468176 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1b4c2bf-39a1-42f7-9156-8cac874d3362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2248e44410>]}
[0m16:39:20.468867 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1b4c2bf-39a1-42f7-9156-8cac874d3362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224e1cb320>]}
[0m16:39:20.470046 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_1c_tech ........................ [[31mERROR[0m in 0.18s]
[0m16:39:20.471254 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_1c_works ....................... [[31mERROR[0m in 0.19s]
[0m16:39:20.472523 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m16:39:20.473289 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m16:39:20.474096 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_tech' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "гар_номер" does not exist
  LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql.
[0m16:39:20.475618 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_works' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql.
[0m16:39:20.476505 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m16:39:20.478424 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m16:39:20.477607 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.dv_hub_tech ........................................ [[33mSKIP[0m]
[0m16:39:20.479972 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m16:39:20.491495 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m16:39:20.494129 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m16:39:20.494913 [info ] [Thread-3 (]: 5 of 6 SKIP relation public.dv_hub_fact_work ................................... [[33mSKIP[0m]
[0m16:39:20.504822 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:20.506078 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m16:39:20.507496 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m16:39:20.509040 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:39:20.512845 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m16:39:20.513705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1b4c2bf-39a1-42f7-9156-8cac874d3362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2248e3b140>]}
[0m16:39:20.514581 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_1c_journal ......................... [[32mCREATE VIEW[0m in 0.24s]
[0m16:39:20.515657 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m16:39:20.516848 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m16:39:20.517813 [info ] [Thread-2 (]: 6 of 6 START sql incremental model public.dv_hub_fact_journal .................. [RUN]
[0m16:39:20.518614 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_hub_fact_journal)
[0m16:39:20.519765 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m16:39:20.533442 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:39:20.534491 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m16:39:20.585799 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:39:20.586473 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

    
  
    

  create temporary table "dv_hub_fact_journal__dbt_tmp163920567492"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal"


where not exists (
    select 1
    from {this} target
    where 
        target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_journal 
)

  );
  
  
[0m16:39:20.587016 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:39:20.596577 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 26:     from {this} target
                  ^

[0m16:39:20.597430 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m16:39:20.602132 [debug] [Thread-2 (]: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  syntax error at or near "{"
  LINE 26:     from {this} target
                    ^
[0m16:39:20.602856 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1b4c2bf-39a1-42f7-9156-8cac874d3362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2248526180>]}
[0m16:39:20.603646 [error] [Thread-2 (]: 6 of 6 ERROR creating sql incremental model public.dv_hub_fact_journal ......... [[31mERROR[0m in 0.08s]
[0m16:39:20.604621 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m16:39:20.605326 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_hub_fact_journal' to be skipped because of status 'error'.  Reason: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  syntax error at or near "{"
  LINE 26:     from {this} target
                    ^.
[0m16:39:20.607303 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:20.607821 [debug] [MainThread]: On master: BEGIN
[0m16:39:20.608264 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:39:20.619294 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:39:20.620253 [debug] [MainThread]: On master: COMMIT
[0m16:39:20.620831 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:20.621402 [debug] [MainThread]: On master: COMMIT
[0m16:39:20.622087 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:39:20.622613 [debug] [MainThread]: On master: Close
[0m16:39:20.623279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:20.623765 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m16:39:20.624270 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_journal' was properly closed.
[0m16:39:20.624854 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_works' was properly closed.
[0m16:39:20.625804 [info ] [MainThread]: 
[0m16:39:20.626960 [info ] [MainThread]: Finished running 3 incremental models, 3 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m16:39:20.629947 [debug] [MainThread]: Command end result
[0m16:39:20.674921 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:39:20.677829 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:39:20.685161 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m16:39:20.685730 [info ] [MainThread]: 
[0m16:39:20.686399 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m16:39:20.686918 [info ] [MainThread]: 
[0m16:39:20.687498 [error] [MainThread]:   Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "гар_номер" does not exist
  LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql
[0m16:39:20.688157 [info ] [MainThread]: 
[0m16:39:20.688871 [error] [MainThread]:   Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:39:20.689421 [info ] [MainThread]: 
[0m16:39:20.689992 [error] [MainThread]:   Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  syntax error at or near "{"
  LINE 26:     from {this} target
                    ^
[0m16:39:20.690507 [info ] [MainThread]: 
[0m16:39:20.691475 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=2 TOTAL=6
[0m16:39:20.693649 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2740699, "process_in_blocks": "8680", "process_kernel_time": 0.285731, "process_mem_max_rss": "118988", "process_out_blocks": "2640", "process_user_time": 2.582512}
[0m16:39:20.694657 [debug] [MainThread]: Command `dbt run` failed at 16:39:20.694417 after 1.28 seconds
[0m16:39:20.695762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224c9af6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2248573fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2248573c20>]}
[0m16:39:20.696932 [debug] [MainThread]: Flushing usage events
[0m16:39:21.844633 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:39:44.185303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ccbbce930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cca237e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc9afe4b0>]}


============================== 16:39:44.189138 | 82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6 ==============================
[0m16:39:44.189138 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:39:44.190092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s +tag:hub', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:39:44.380797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc9ffc650>]}
[0m16:39:44.446686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc9c666f0>]}
[0m16:39:44.447746 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:39:44.576745 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:39:44.664967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:44.665448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:44.694332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc8919e80>]}
[0m16:39:44.766702 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:39:44.769349 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:39:44.783274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc7d20e90>]}
[0m16:39:44.784019 [info ] [MainThread]: Found 17 models, 433 macros
[0m16:39:44.784561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc8df4740>]}
[0m16:39:44.787257 [info ] [MainThread]: 
[0m16:39:44.787934 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:39:44.788517 [info ] [MainThread]: 
[0m16:39:44.789297 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:44.797047 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:39:44.846925 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:39:44.847478 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:39:44.847931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:44.859427 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m16:39:44.861043 [debug] [ThreadPool]: On list_postgres: Close
[0m16:39:44.863854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:39:44.870733 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:39:44.871333 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:39:44.871827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:44.880307 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m16:39:44.880866 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:39:44.881406 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:39:44.884763 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m16:39:44.887020 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:39:44.887779 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:39:44.897276 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:44.897849 [debug] [MainThread]: On master: BEGIN
[0m16:39:44.898287 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:44.906397 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:39:44.906939 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:44.907523 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:39:44.912861 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m16:39:44.914867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc85add60>]}
[0m16:39:44.915488 [debug] [MainThread]: On master: ROLLBACK
[0m16:39:44.916175 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:44.916691 [debug] [MainThread]: On master: BEGIN
[0m16:39:44.917458 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:39:44.917930 [debug] [MainThread]: On master: COMMIT
[0m16:39:44.918544 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:44.919114 [debug] [MainThread]: On master: COMMIT
[0m16:39:44.919791 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:39:44.920255 [debug] [MainThread]: On master: Close
[0m16:39:44.923429 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m16:39:44.924481 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m16:39:44.925327 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_works
[0m16:39:44.926035 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_1c_journal .............................. [RUN]
[0m16:39:44.926987 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_1c_tech ................................. [RUN]
[0m16:39:44.927869 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_1c_works ................................ [RUN]
[0m16:39:44.928743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m16:39:44.929540 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_tech'
[0m16:39:44.930356 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_works'
[0m16:39:44.930966 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m16:39:44.931628 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m16:39:44.932305 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m16:39:44.945138 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m16:39:44.945831 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m16:39:44.947910 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m16:39:44.949181 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m16:39:44.955129 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m16:39:44.955931 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m16:39:45.049603 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m16:39:45.051594 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m16:39:45.052878 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m16:39:45.054083 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:45.054896 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:39:45.055812 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m16:39:45.056859 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:39:45.057459 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m16:39:45.057978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:45.058575 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m16:39:45.059172 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:39:45.060227 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:39:45.069417 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m16:39:45.070085 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:39:45.070872 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_гар_номер,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_гар_номер,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m16:39:45.072339 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m16:39:45.073203 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "гар_номер" does not exist
LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                         ^

[0m16:39:45.073902 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:45.074834 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: ROLLBACK
[0m16:39:45.075550 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m16:39:45.076629 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m16:39:45.077481 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:39:45.078350 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m16:39:45.079224 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m16:39:45.082634 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "value_Ссылка" does not exist
LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                         ^

[0m16:39:45.083453 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m16:39:45.084019 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: ROLLBACK
[0m16:39:45.091497 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:45.093070 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: Close
[0m16:39:45.093983 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m16:39:45.097882 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:39:45.102946 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:45.104539 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m16:39:45.109259 [debug] [Thread-2 (]: Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "гар_номер" does not exist
  LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql
[0m16:39:45.111907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m16:39:45.115868 [debug] [Thread-3 (]: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:39:45.128943 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc9853bf0>]}
[0m16:39:45.129616 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc8d68170>]}
[0m16:39:45.140060 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_1c_tech ........................ [[31mERROR[0m in 0.18s]
[0m16:39:45.139463 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:39:45.141629 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_1c_works ....................... [[31mERROR[0m in 0.20s]
[0m16:39:45.142843 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m16:39:45.143602 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:45.144508 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m16:39:45.145281 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:39:45.146239 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_tech' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "гар_номер" does not exist
  LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql.
[0m16:39:45.148261 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_works' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql.
[0m16:39:45.149454 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m16:39:45.150643 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m16:39:45.151727 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.dv_hub_tech ........................................ [[33mSKIP[0m]
[0m16:39:45.153065 [info ] [Thread-3 (]: 5 of 6 SKIP relation public.dv_hub_fact_work ................................... [[33mSKIP[0m]
[0m16:39:45.154189 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m16:39:45.155328 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m16:39:45.158681 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m16:39:45.170691 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m16:39:45.179105 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:45.179704 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m16:39:45.190084 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m16:39:45.192947 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m16:39:45.193974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ccbae7bc0>]}
[0m16:39:45.195680 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_1c_journal ......................... [[32mCREATE VIEW[0m in 0.27s]
[0m16:39:45.197138 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m16:39:45.198566 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m16:39:45.199350 [info ] [Thread-2 (]: 6 of 6 START sql incremental model public.dv_hub_fact_journal .................. [RUN]
[0m16:39:45.200200 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_hub_fact_journal)
[0m16:39:45.200987 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m16:39:45.217334 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:39:45.218267 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m16:39:45.265050 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:39:45.265703 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

    
  
    

  create temporary table "dv_hub_fact_journal__dbt_tmp163945249083"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal"


where not exists (
    select 1
    from {this} target
    where 
        target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_journal 
)

  );
  
  
[0m16:39:45.266224 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:39:45.275038 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 26:     from {this} target
                  ^

[0m16:39:45.275859 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m16:39:45.279245 [debug] [Thread-2 (]: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  syntax error at or near "{"
  LINE 26:     from {this} target
                    ^
[0m16:39:45.279956 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc4329610>]}
[0m16:39:45.280719 [error] [Thread-2 (]: 6 of 6 ERROR creating sql incremental model public.dv_hub_fact_journal ......... [[31mERROR[0m in 0.08s]
[0m16:39:45.281603 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m16:39:45.282320 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_hub_fact_journal' to be skipped because of status 'error'.  Reason: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  syntax error at or near "{"
  LINE 26:     from {this} target
                    ^.
[0m16:39:45.284082 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:45.284595 [debug] [MainThread]: On master: BEGIN
[0m16:39:45.285025 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:39:45.295518 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m16:39:45.296078 [debug] [MainThread]: On master: COMMIT
[0m16:39:45.296583 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:45.297433 [debug] [MainThread]: On master: COMMIT
[0m16:39:45.298656 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:39:45.299431 [debug] [MainThread]: On master: Close
[0m16:39:45.300505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:45.301032 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m16:39:45.301538 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_journal' was properly closed.
[0m16:39:45.302033 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_works' was properly closed.
[0m16:39:45.302825 [info ] [MainThread]: 
[0m16:39:45.303519 [info ] [MainThread]: Finished running 3 incremental models, 3 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m16:39:45.305984 [debug] [MainThread]: Command end result
[0m16:39:45.342715 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:39:45.344553 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:39:45.356011 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m16:39:45.356759 [info ] [MainThread]: 
[0m16:39:45.357412 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m16:39:45.357970 [info ] [MainThread]: 
[0m16:39:45.358643 [error] [MainThread]:   Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "гар_номер" does not exist
  LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql
[0m16:39:45.359131 [info ] [MainThread]: 
[0m16:39:45.359876 [error] [MainThread]:   Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:39:45.360544 [info ] [MainThread]: 
[0m16:39:45.361228 [error] [MainThread]:   Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  syntax error at or near "{"
  LINE 26:     from {this} target
                    ^
[0m16:39:45.361759 [info ] [MainThread]: 
[0m16:39:45.362713 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=2 TOTAL=6
[0m16:39:45.364732 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2353785, "process_in_blocks": "336", "process_kernel_time": 0.22744, "process_mem_max_rss": "119512", "process_out_blocks": "2592", "process_user_time": 2.569213}
[0m16:39:45.365953 [debug] [MainThread]: Command `dbt run` failed at 16:39:45.365678 after 1.24 seconds
[0m16:39:45.367038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc9a1f6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ccd5b7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc8ded9a0>]}
[0m16:39:45.368317 [debug] [MainThread]: Flushing usage events
[0m16:39:46.428910 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:04.942556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5f5da9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5f3422a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5f5d9010>]}


============================== 16:40:04.946309 | 514b091d-a809-458e-bf84-7f0df1b72a79 ==============================
[0m16:40:04.946309 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:40:04.947201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s +tag:hub', 'send_anonymous_usage_stats': 'True'}
[0m16:40:05.130744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '514b091d-a809-458e-bf84-7f0df1b72a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5fa0c530>]}
[0m16:40:05.195765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '514b091d-a809-458e-bf84-7f0df1b72a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5ed33e90>]}
[0m16:40:05.196769 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:40:05.315484 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:40:05.407405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:05.407915 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:05.436538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '514b091d-a809-458e-bf84-7f0df1b72a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5e302660>]}
[0m16:40:05.509779 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:40:05.512304 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:40:05.526484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '514b091d-a809-458e-bf84-7f0df1b72a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5d31eb10>]}
[0m16:40:05.527106 [info ] [MainThread]: Found 17 models, 433 macros
[0m16:40:05.527694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '514b091d-a809-458e-bf84-7f0df1b72a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5e32a060>]}
[0m16:40:05.530270 [info ] [MainThread]: 
[0m16:40:05.530913 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:40:05.531525 [info ] [MainThread]: 
[0m16:40:05.532301 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:40:05.539524 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:40:05.589237 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:40:05.589787 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:40:05.590242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:05.601248 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m16:40:05.603010 [debug] [ThreadPool]: On list_postgres: Close
[0m16:40:05.605762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:40:05.612361 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:40:05.613086 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:40:05.613572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:05.621905 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m16:40:05.622435 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:40:05.622892 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:40:05.626204 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m16:40:05.628120 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:40:05.628768 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:40:05.636692 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:05.637222 [debug] [MainThread]: On master: BEGIN
[0m16:40:05.637775 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:05.646938 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m16:40:05.647543 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:05.648105 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:40:05.653662 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m16:40:05.655933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '514b091d-a809-458e-bf84-7f0df1b72a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5ef00d70>]}
[0m16:40:05.656578 [debug] [MainThread]: On master: ROLLBACK
[0m16:40:05.657683 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:05.658589 [debug] [MainThread]: On master: BEGIN
[0m16:40:05.659717 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:40:05.660182 [debug] [MainThread]: On master: COMMIT
[0m16:40:05.660679 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:05.661100 [debug] [MainThread]: On master: COMMIT
[0m16:40:05.661683 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:40:05.662149 [debug] [MainThread]: On master: Close
[0m16:40:05.665524 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m16:40:05.666541 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m16:40:05.667419 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_works
[0m16:40:05.668079 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_1c_journal .............................. [RUN]
[0m16:40:05.669046 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_1c_tech ................................. [RUN]
[0m16:40:05.669945 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_1c_works ................................ [RUN]
[0m16:40:05.670768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m16:40:05.671534 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_tech'
[0m16:40:05.672231 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_works'
[0m16:40:05.672805 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m16:40:05.673459 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m16:40:05.674127 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m16:40:05.687006 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m16:40:05.689543 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m16:40:05.692169 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m16:40:05.693692 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m16:40:05.694347 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m16:40:05.695269 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m16:40:05.779343 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m16:40:05.781331 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m16:40:05.784786 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m16:40:05.785638 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:40:05.786407 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:40:05.787030 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m16:40:05.787660 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m16:40:05.788298 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:40:05.788964 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:40:05.789485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:05.790132 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m16:40:05.791347 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:40:05.799895 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m16:40:05.800514 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:40:05.801147 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m16:40:05.803574 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "value_Ссылка" does not exist
LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                         ^

[0m16:40:05.804580 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:40:05.805197 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: ROLLBACK
[0m16:40:05.805740 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m16:40:05.806325 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:40:05.807018 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:40:05.807821 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m16:40:05.808663 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: Close
[0m16:40:05.809299 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_гар_номер,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_гар_номер,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m16:40:05.813919 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "гар_номер" does not exist
LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                         ^

[0m16:40:05.814920 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: ROLLBACK
[0m16:40:05.816147 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m16:40:05.821683 [debug] [Thread-2 (]: Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "гар_номер" does not exist
  LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql
[0m16:40:05.825043 [debug] [Thread-3 (]: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:40:05.825955 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '514b091d-a809-458e-bf84-7f0df1b72a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5f9b4800>]}
[0m16:40:05.826471 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '514b091d-a809-458e-bf84-7f0df1b72a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5be3ef90>]}
[0m16:40:05.827589 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_1c_tech ........................ [[31mERROR[0m in 0.15s]
[0m16:40:05.828466 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m16:40:05.829425 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_1c_works ....................... [[31mERROR[0m in 0.15s]
[0m16:40:05.830635 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m16:40:05.841847 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m16:40:05.845251 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:40:05.846971 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_tech' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "гар_номер" does not exist
  LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql.
[0m16:40:05.847797 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m16:40:05.849262 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_works' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql.
[0m16:40:05.850232 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m16:40:05.852513 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:40:05.853424 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.dv_hub_tech ........................................ [[33mSKIP[0m]
[0m16:40:05.854982 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m16:40:05.861254 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m16:40:05.864515 [info ] [Thread-3 (]: 5 of 6 SKIP relation public.dv_hub_fact_work ................................... [[33mSKIP[0m]
[0m16:40:05.863393 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:40:05.866260 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m16:40:05.867701 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m16:40:05.869545 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:40:05.894787 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:40:05.895670 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:40:05.896574 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:40:05.910318 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m16:40:05.918924 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m16:40:05.925193 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:40:05.925765 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m16:40:05.943704 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.017 seconds
[0m16:40:05.946646 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m16:40:05.947597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '514b091d-a809-458e-bf84-7f0df1b72a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a612739e0>]}
[0m16:40:05.949230 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_1c_journal ......................... [[32mCREATE VIEW[0m in 0.28s]
[0m16:40:05.950603 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m16:40:05.951749 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m16:40:05.952469 [info ] [Thread-2 (]: 6 of 6 START sql incremental model public.dv_hub_fact_journal .................. [RUN]
[0m16:40:05.953145 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_hub_fact_journal)
[0m16:40:05.953711 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m16:40:05.968338 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:40:05.969431 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m16:40:06.017084 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:40:06.017740 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

    
  
    

  create temporary table "dv_hub_fact_journal__dbt_tmp164005998709"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal"


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_journal" target
    where 
        target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_journal 
)

  );
  
  
[0m16:40:06.018252 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:06.027146 [debug] [Thread-2 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "stg"
LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                 ^

[0m16:40:06.027968 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m16:40:06.032693 [debug] [Thread-2 (]: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                   ^
[0m16:40:06.033355 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '514b091d-a809-458e-bf84-7f0df1b72a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a58d37860>]}
[0m16:40:06.034138 [error] [Thread-2 (]: 6 of 6 ERROR creating sql incremental model public.dv_hub_fact_journal ......... [[31mERROR[0m in 0.08s]
[0m16:40:06.035150 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m16:40:06.035987 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_hub_fact_journal' to be skipped because of status 'error'.  Reason: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                   ^.
[0m16:40:06.037781 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:06.038263 [debug] [MainThread]: On master: BEGIN
[0m16:40:06.038720 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:06.050454 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:40:06.051114 [debug] [MainThread]: On master: COMMIT
[0m16:40:06.052054 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:06.052950 [debug] [MainThread]: On master: COMMIT
[0m16:40:06.054057 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:40:06.055122 [debug] [MainThread]: On master: Close
[0m16:40:06.056231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:06.057362 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m16:40:06.058353 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_journal' was properly closed.
[0m16:40:06.059002 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_works' was properly closed.
[0m16:40:06.059636 [info ] [MainThread]: 
[0m16:40:06.060298 [info ] [MainThread]: Finished running 3 incremental models, 3 view models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m16:40:06.062088 [debug] [MainThread]: Command end result
[0m16:40:06.105459 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:40:06.107356 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:40:06.115337 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m16:40:06.116316 [info ] [MainThread]: 
[0m16:40:06.117291 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m16:40:06.117904 [info ] [MainThread]: 
[0m16:40:06.118985 [error] [MainThread]:   Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "гар_номер" does not exist
  LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql
[0m16:40:06.119794 [info ] [MainThread]: 
[0m16:40:06.120467 [error] [MainThread]:   Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:40:06.121007 [info ] [MainThread]: 
[0m16:40:06.121685 [error] [MainThread]:   Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                   ^
[0m16:40:06.122460 [info ] [MainThread]: 
[0m16:40:06.123102 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=2 TOTAL=6
[0m16:40:06.124264 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2384214, "process_in_blocks": "304", "process_kernel_time": 0.219014, "process_mem_max_rss": "118952", "process_out_blocks": "2696", "process_user_time": 2.52395}
[0m16:40:06.124934 [debug] [MainThread]: Command `dbt run` failed at 16:40:06.124800 after 1.24 seconds
[0m16:40:06.125461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5f3422a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5f9eb410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a58d87d70>]}
[0m16:40:06.125983 [debug] [MainThread]: Flushing usage events
[0m16:40:07.208801 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:54.452421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f951fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f8f6e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f951ffe0>]}


============================== 16:48:54.457592 | d3b7bd44-f439-4f98-bc4b-e3791c0c1d94 ==============================
[0m16:48:54.457592 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:48:54.458526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s +tag:hub', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:48:54.659817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f8b8d340>]}
[0m16:48:54.727562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f8ea5730>]}
[0m16:48:54.728609 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:48:54.860678 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:48:54.952150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:48:54.952661 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:48:54.981718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f8388620>]}
[0m16:48:55.057466 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:48:55.060102 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:48:55.085207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f846e780>]}
[0m16:48:55.085932 [info ] [MainThread]: Found 17 models, 433 macros
[0m16:48:55.086604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f9f64740>]}
[0m16:48:55.089415 [info ] [MainThread]: 
[0m16:48:55.090061 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:48:55.090855 [info ] [MainThread]: 
[0m16:48:55.091639 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:48:55.097607 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:48:55.159265 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:48:55.159846 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:48:55.160331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:55.181855 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.021 seconds
[0m16:48:55.183482 [debug] [ThreadPool]: On list_postgres: Close
[0m16:48:55.186046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:48:55.193690 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:48:55.194178 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:48:55.194744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:55.203153 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m16:48:55.203721 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:48:55.204191 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:48:55.207440 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m16:48:55.209486 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:48:55.210121 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:48:55.218092 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:55.218654 [debug] [MainThread]: On master: BEGIN
[0m16:48:55.219100 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:48:55.229191 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m16:48:55.229722 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:55.230432 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:48:55.240048 [debug] [MainThread]: SQL status: SELECT 2 in 0.009 seconds
[0m16:48:55.243954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f7f1df40>]}
[0m16:48:55.245019 [debug] [MainThread]: On master: ROLLBACK
[0m16:48:55.245979 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:55.246468 [debug] [MainThread]: On master: BEGIN
[0m16:48:55.247334 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:48:55.247822 [debug] [MainThread]: On master: COMMIT
[0m16:48:55.248282 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:55.248801 [debug] [MainThread]: On master: COMMIT
[0m16:48:55.249418 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:48:55.249878 [debug] [MainThread]: On master: Close
[0m16:48:55.257032 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m16:48:55.257879 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m16:48:55.258853 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_works
[0m16:48:55.259562 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_1c_journal .............................. [RUN]
[0m16:48:55.260562 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_1c_tech ................................. [RUN]
[0m16:48:55.261483 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_1c_works ................................ [RUN]
[0m16:48:55.262547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m16:48:55.263236 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_tech'
[0m16:48:55.264021 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_works'
[0m16:48:55.264631 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m16:48:55.265176 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m16:48:55.266128 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m16:48:55.279696 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m16:48:55.281138 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m16:48:55.283901 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m16:48:55.285208 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m16:48:55.301671 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m16:48:55.302442 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m16:48:55.362935 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m16:48:55.363757 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m16:48:55.365744 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m16:48:55.366956 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:48:55.367654 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m16:48:55.368591 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:48:55.369062 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:48:55.369715 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:48:55.370760 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m16:48:55.371786 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m16:48:55.372777 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:48:55.373489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:55.384205 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m16:48:55.384943 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m16:48:55.385658 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:48:55.386403 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:48:55.387341 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m16:48:55.388163 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m16:48:55.388820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:48:55.389699 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:48:55.390787 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "value_Ссылка" does not exist
LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                         ^

[0m16:48:55.391952 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m16:48:55.393411 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: ROLLBACK
[0m16:48:55.394893 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: Close
[0m16:48:55.396968 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m16:48:55.404744 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m16:48:55.408885 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:48:55.409449 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:48:55.410088 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m16:48:55.410871 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech__dbt_tmp" rename to "stg_1c_tech"
[0m16:48:55.412762 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:48:55.413531 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:48:55.430111 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:48:55.430865 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m16:48:55.437161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m16:48:55.436795 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m16:48:55.441951 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:48:55.442713 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:48:55.443691 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:48:55.444689 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m16:48:55.445468 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:48:55.453037 [debug] [Thread-3 (]: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:48:55.455110 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f6f8daf0>]}
[0m16:48:55.456003 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_1c_works ....................... [[31mERROR[0m in 0.19s]
[0m16:48:55.456884 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m16:48:55.457667 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_works' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql.
[0m16:48:55.459007 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m16:48:55.459646 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.dv_hub_fact_work ................................... [[33mSKIP[0m]
[0m16:48:55.460458 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m16:48:55.482437 [debug] [Thread-2 (]: SQL status: COMMIT in 0.036 seconds
[0m16:48:55.492225 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_tech__dbt_backup"
[0m16:48:55.499339 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:48:55.500049 [debug] [Thread-1 (]: SQL status: COMMIT in 0.054 seconds
[0m16:48:55.500643 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
drop view if exists "postgres"."public"."stg_1c_tech__dbt_backup" cascade
[0m16:48:55.503766 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m16:48:55.505364 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:48:55.506080 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:48:55.506748 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m16:48:55.509588 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m16:48:55.510675 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18fad1f890>]}
[0m16:48:55.511559 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_1c_tech ............................ [[32mCREATE VIEW[0m in 0.25s]
[0m16:48:55.512947 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m16:48:55.514250 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m16:48:55.515104 [info ] [Thread-3 (]: 5 of 6 START sql incremental model public.dv_hub_tech .......................... [RUN]
[0m16:48:55.516003 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_works, now model.tsm_dwh.dv_hub_tech)
[0m16:48:55.516527 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m16:48:55.527629 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.017 seconds
[0m16:48:55.528717 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m16:48:55.530513 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m16:48:55.531636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f573d400>]}
[0m16:48:55.533510 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_1c_journal ......................... [[32mCREATE VIEW[0m in 0.27s]
[0m16:48:55.535494 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m16:48:55.536265 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m16:48:55.537488 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m16:48:55.553707 [info ] [Thread-2 (]: 6 of 6 START sql incremental model public.dv_hub_fact_journal .................. [RUN]
[0m16:48:55.559939 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_hub_fact_journal)
[0m16:48:55.566103 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m16:48:55.587627 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:48:55.610365 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m16:48:55.611358 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_tech"
[0m16:48:55.620629 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:48:55.621788 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

    
  
    

  create temporary table "dv_hub_fact_journal__dbt_tmp164855615710"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal"


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_journal" target
    where 
        target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_journal 
)

  );
  
  
[0m16:48:55.622742 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:55.623654 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:48:55.624603 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: BEGIN
[0m16:48:55.625663 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:55.635458 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m16:48:55.636110 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:48:55.636764 [debug] [Thread-2 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "stg"
LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                 ^

[0m16:48:55.637323 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      
  
    

  create  table "postgres"."public"."dv_hub_tech"
  
  
    as
  
  (
    

SELECT distinct on (bk_ресурс_uuid)
        hk_dv_hub_tech,
        hkcode,
        recsource,
        loadts,
        bk_ресурс_uuid
FROM "postgres"."public"."stg_1c_tech"


  );
  
  
[0m16:48:55.638401 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m16:48:55.644118 [debug] [Thread-2 (]: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                   ^
[0m16:48:55.645276 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f46573e0>]}
[0m16:48:55.646264 [error] [Thread-2 (]: 6 of 6 ERROR creating sql incremental model public.dv_hub_fact_journal ......... [[31mERROR[0m in 0.09s]
[0m16:48:55.647438 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m16:48:55.648257 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_hub_fact_journal' to be skipped because of status 'error'.  Reason: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                   ^.
[0m16:48:55.674254 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.035 seconds
[0m16:48:55.681822 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m16:48:55.682486 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:48:55.683063 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m16:48:55.692880 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m16:48:55.693918 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: Close
[0m16:48:55.694755 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f464b590>]}
[0m16:48:55.696311 [info ] [Thread-3 (]: 5 of 6 OK created sql incremental model public.dv_hub_tech ..................... [[32mSELECT 0[0m in 0.18s]
[0m16:48:55.697627 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m16:48:55.699636 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:55.700121 [debug] [MainThread]: On master: BEGIN
[0m16:48:55.700711 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:48:55.711856 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:48:55.712433 [debug] [MainThread]: On master: COMMIT
[0m16:48:55.713146 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:55.713790 [debug] [MainThread]: On master: COMMIT
[0m16:48:55.714419 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:48:55.714889 [debug] [MainThread]: On master: Close
[0m16:48:55.715590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:55.716485 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m16:48:55.717410 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_journal' was properly closed.
[0m16:48:55.718124 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_tech' was properly closed.
[0m16:48:55.719010 [info ] [MainThread]: 
[0m16:48:55.720024 [info ] [MainThread]: Finished running 3 incremental models, 3 view models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m16:48:55.722731 [debug] [MainThread]: Command end result
[0m16:48:55.760903 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:48:55.762695 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:48:55.771523 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m16:48:55.772199 [info ] [MainThread]: 
[0m16:48:55.772876 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:48:55.773523 [info ] [MainThread]: 
[0m16:48:55.774421 [error] [MainThread]:   Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:48:55.775171 [info ] [MainThread]: 
[0m16:48:55.776025 [error] [MainThread]:   Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                   ^
[0m16:48:55.776633 [info ] [MainThread]: 
[0m16:48:55.777229 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=1 TOTAL=6
[0m16:48:55.778933 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3889942, "process_in_blocks": "21432", "process_kernel_time": 0.297379, "process_mem_max_rss": "119288", "process_out_blocks": "2592", "process_user_time": 2.627715}
[0m16:48:55.779652 [debug] [MainThread]: Command `dbt run` failed at 16:48:55.779490 after 1.39 seconds
[0m16:48:55.780176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f8d31160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18fad8cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f7bb50a0>]}
[0m16:48:55.780743 [debug] [MainThread]: Flushing usage events
[0m16:48:57.027659 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:53:39.980237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9f229160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da171e3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da0809ac0>]}


============================== 16:53:39.985918 | 33cc656c-2a91-46f3-8bec-e4d63832318f ==============================
[0m16:53:39.985918 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:53:39.986997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s +tag:hub', 'send_anonymous_usage_stats': 'True'}
[0m16:53:40.209054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9fc10500>]}
[0m16:53:40.275003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9fa018e0>]}
[0m16:53:40.276023 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:53:40.408266 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:53:40.526094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:53:40.526658 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:53:40.557151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9e52e840>]}
[0m16:53:40.630148 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:53:40.632823 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:53:40.661045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9d522300>]}
[0m16:53:40.661742 [info ] [MainThread]: Found 17 models, 433 macros
[0m16:53:40.662290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9e16eab0>]}
[0m16:53:40.664947 [info ] [MainThread]: 
[0m16:53:40.665675 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:53:40.666248 [info ] [MainThread]: 
[0m16:53:40.667216 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:53:40.674043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:53:40.734930 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:53:40.735487 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:53:40.735954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:40.759640 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.024 seconds
[0m16:53:40.761305 [debug] [ThreadPool]: On list_postgres: Close
[0m16:53:40.765334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:53:40.772100 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:53:40.772672 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:53:40.773146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:53:40.782042 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:53:40.782666 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:53:40.783173 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:53:40.786928 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m16:53:40.788757 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:53:40.789397 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:53:40.797285 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:40.797851 [debug] [MainThread]: On master: BEGIN
[0m16:53:40.798294 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:53:40.808832 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m16:53:40.809370 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:40.810156 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:53:40.819616 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m16:53:40.822877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9e1c2b10>]}
[0m16:53:40.824030 [debug] [MainThread]: On master: ROLLBACK
[0m16:53:40.825362 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:40.826439 [debug] [MainThread]: On master: BEGIN
[0m16:53:40.827668 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:53:40.828633 [debug] [MainThread]: On master: COMMIT
[0m16:53:40.829525 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:40.830272 [debug] [MainThread]: On master: COMMIT
[0m16:53:40.831329 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:53:40.832286 [debug] [MainThread]: On master: Close
[0m16:53:40.854805 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m16:53:40.856112 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_1c_journal .............................. [RUN]
[0m16:53:40.861574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m16:53:40.862829 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m16:53:40.869836 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m16:53:40.871092 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_1c_tech ................................. [RUN]
[0m16:53:40.872326 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_tech'
[0m16:53:40.883166 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m16:53:40.873542 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_works
[0m16:53:40.890188 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_1c_works ................................ [RUN]
[0m16:53:40.891529 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_works'
[0m16:53:40.888792 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m16:53:40.893003 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m16:53:40.897053 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m16:53:40.904496 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m16:53:40.905925 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m16:53:40.902556 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m16:53:40.924710 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m16:53:41.046407 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m16:53:41.048552 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m16:53:41.049861 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m16:53:41.051143 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:53:41.052196 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m16:53:41.053033 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:53:41.054294 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:53:41.055785 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:53:41.056941 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m16:53:41.057767 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m16:53:41.058350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:41.059195 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:53:41.064739 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m16:53:41.065771 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:53:41.066771 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m16:53:41.072883 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:53:41.073619 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m16:53:41.074471 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:53:41.075190 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:53:41.076225 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m16:53:41.077170 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m16:53:41.077924 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m16:53:41.086229 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:53:41.086877 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m16:53:41.087558 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech__dbt_tmp" rename to "stg_1c_tech"
[0m16:53:41.092721 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:53:41.093557 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m16:53:41.094564 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m16:53:41.095420 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:53:41.099663 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:53:41.100168 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m16:53:41.111262 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works__dbt_tmp" rename to "stg_1c_works"
[0m16:53:41.118802 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:53:41.120830 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m16:53:41.121575 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:53:41.122232 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:53:41.122817 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:53:41.123331 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:53:41.124062 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m16:53:41.126447 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m16:53:41.127362 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:53:41.127992 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m16:53:41.134983 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m16:53:41.148840 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m16:53:41.149962 [debug] [Thread-2 (]: SQL status: COMMIT in 0.023 seconds
[0m16:53:41.150498 [debug] [Thread-3 (]: SQL status: COMMIT in 0.022 seconds
[0m16:53:41.159492 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:53:41.162576 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_tech__dbt_backup"
[0m16:53:41.165367 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_works__dbt_backup"
[0m16:53:41.166036 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m16:53:41.167104 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:53:41.168282 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:53:41.169109 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
drop view if exists "postgres"."public"."stg_1c_tech__dbt_backup" cascade
[0m16:53:41.169925 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:53:41.170477 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
drop view if exists "postgres"."public"."stg_1c_works__dbt_backup" cascade
[0m16:53:41.173498 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m16:53:41.174136 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:53:41.178933 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m16:53:41.179584 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m16:53:41.181820 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: Close
[0m16:53:41.182745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da140b590>]}
[0m16:53:41.183332 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9c062d80>]}
[0m16:53:41.184691 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_1c_journal ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m16:53:41.185499 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9c16fbf0>]}
[0m16:53:41.186440 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_1c_tech ............................ [[32mCREATE VIEW[0m in 0.31s]
[0m16:53:41.187667 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m16:53:41.188538 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_1c_works ........................... [[32mCREATE VIEW[0m in 0.29s]
[0m16:53:41.189593 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m16:53:41.190895 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m16:53:41.191951 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m16:53:41.193277 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m16:53:41.194360 [info ] [Thread-4 (]: 4 of 6 START sql incremental model public.dv_hub_fact_journal .................. [RUN]
[0m16:53:41.195448 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m16:53:41.196602 [info ] [Thread-1 (]: 5 of 6 START sql incremental model public.dv_hub_tech .......................... [RUN]
[0m16:53:41.197958 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_hub_fact_journal'
[0m16:53:41.199424 [info ] [Thread-3 (]: 6 of 6 START sql incremental model public.dv_hub_fact_work ..................... [RUN]
[0m16:53:41.201144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_journal, now model.tsm_dwh.dv_hub_tech)
[0m16:53:41.202474 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m16:53:41.203557 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_works, now model.tsm_dwh.dv_hub_fact_work)
[0m16:53:41.204416 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m16:53:41.210441 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m16:53:41.219820 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:53:41.227864 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m16:53:41.234105 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m16:53:41.235498 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m16:53:41.236239 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m16:53:41.253771 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m16:53:41.342179 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_work"
[0m16:53:41.347636 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:53:41.351451 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:53:41.352224 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

    
  
    

  create temporary table "dv_hub_fact_journal__dbt_tmp165341322362"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal"


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_journal" target
    where 
        target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_journal 
)

  );
  
  
[0m16:53:41.353023 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

    
  
    

  create temporary table "dv_hub_tech__dbt_tmp165341349188"
  
  
    as
  
  (
    

SELECT distinct on (bk_ресурс_uuid)
        hk_dv_hub_tech,
        hkcode,
        recsource,
        loadts,
        bk_ресурс_uuid
FROM "postgres"."public"."stg_1c_tech"


where not exists (
    select 1
    from "postgres"."public"."dv_hub_tech" target
    where 
        target.hk_dv_hub_tech = stg.hk_dv_hub_tech 
)

  );
  
  
[0m16:53:41.353687 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:53:41.354456 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:53:41.355011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:41.355936 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: BEGIN
[0m16:53:41.357236 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:53:41.367951 [debug] [Thread-1 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "stg"
LINE 28:         target.hk_dv_hub_tech = stg.hk_dv_hub_tech 
                                         ^

[0m16:53:41.369588 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_tech: Close
[0m16:53:41.370257 [debug] [Thread-4 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "stg"
LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                 ^

[0m16:53:41.374054 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m16:53:41.374845 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m16:53:41.375485 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:53:41.376316 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_hub_fact_work"
  
  
    as
  
  (
    

SELECT distinct on (bk_работа_uuid)
        hk_dv_hub_fact_work,
        hkcode,
        recsource,
        loadts,
        bk_работа_uuid
FROM "postgres"."public"."stg_1c_works"


  );
  
  
[0m16:53:41.409898 [debug] [Thread-1 (]: Database Error in model dv_hub_tech (tsm_dwh/models/dv/dv_hub_tech.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_tech = stg.hk_dv_hub_tech 
                                           ^
[0m16:53:41.419341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9c0de150>]}
[0m16:53:41.416205 [debug] [Thread-4 (]: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                   ^
[0m16:53:41.426685 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9c0ccf80>]}
[0m16:53:41.422670 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model public.dv_hub_tech ................. [[31mERROR[0m in 0.22s]
[0m16:53:41.430825 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m16:53:41.425556 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.046 seconds
[0m16:53:41.442026 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_hub_tech' to be skipped because of status 'error'.  Reason: Database Error in model dv_hub_tech (tsm_dwh/models/dv/dv_hub_tech.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_tech = stg.hk_dv_hub_tech 
                                           ^.
[0m16:53:41.428092 [error] [Thread-4 (]: 4 of 6 ERROR creating sql incremental model public.dv_hub_fact_journal ......... [[31mERROR[0m in 0.23s]
[0m16:53:41.453059 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m16:53:41.455908 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_hub_fact_journal' to be skipped because of status 'error'.  Reason: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                   ^.
[0m16:53:41.457746 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m16:53:41.458952 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:53:41.460105 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m16:53:41.473578 [debug] [Thread-3 (]: SQL status: COMMIT in 0.012 seconds
[0m16:53:41.475536 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: Close
[0m16:53:41.477801 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9c0bc350>]}
[0m16:53:41.481030 [info ] [Thread-3 (]: 6 of 6 OK created sql incremental model public.dv_hub_fact_work ................ [[32mSELECT 0[0m in 0.27s]
[0m16:53:41.483012 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m16:53:41.486971 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:41.488913 [debug] [MainThread]: On master: BEGIN
[0m16:53:41.489816 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:53:41.505066 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m16:53:41.506707 [debug] [MainThread]: On master: COMMIT
[0m16:53:41.508064 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:41.509302 [debug] [MainThread]: On master: COMMIT
[0m16:53:41.510809 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:53:41.512083 [debug] [MainThread]: On master: Close
[0m16:53:41.517073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:41.518404 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_tech' was properly closed.
[0m16:53:41.519579 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_tech' was properly closed.
[0m16:53:41.521488 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_work' was properly closed.
[0m16:53:41.522608 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_journal' was properly closed.
[0m16:53:41.523802 [info ] [MainThread]: 
[0m16:53:41.525113 [info ] [MainThread]: Finished running 3 incremental models, 3 view models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m16:53:41.527659 [debug] [MainThread]: Command end result
[0m16:53:41.579833 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:53:41.588763 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:53:41.602956 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m16:53:41.604767 [info ] [MainThread]: 
[0m16:53:41.606045 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:53:41.607043 [info ] [MainThread]: 
[0m16:53:41.608445 [error] [MainThread]:   Database Error in model dv_hub_tech (tsm_dwh/models/dv/dv_hub_tech.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_tech = stg.hk_dv_hub_tech 
                                           ^
[0m16:53:41.609530 [info ] [MainThread]: 
[0m16:53:41.610629 [error] [MainThread]:   Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                   ^
[0m16:53:41.613894 [info ] [MainThread]: 
[0m16:53:41.616798 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m16:53:41.620365 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7039288, "process_in_blocks": "46368", "process_kernel_time": 0.333718, "process_mem_max_rss": "121636", "process_out_blocks": "2600", "process_user_time": 2.873743}
[0m16:53:41.623913 [debug] [MainThread]: Command `dbt run` failed at 16:53:41.621308 after 1.71 seconds
[0m16:53:41.625024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9fb5b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da0f75820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9e1c1070>]}
[0m16:53:41.626334 [debug] [MainThread]: Flushing usage events
[0m16:53:43.136216 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:02.336093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff63239c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6323b740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff64d90680>]}


============================== 16:55:02.339831 | fe3dd13d-7488-4e82-9a69-e808cc4cd2a5 ==============================
[0m16:55:02.339831 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:55:02.340832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s +tag:hub', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:55:02.520976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff632f45c0>]}
[0m16:55:02.588157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff62f58380>]}
[0m16:55:02.589157 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:55:02.732176 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:55:02.822647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:02.823131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:02.853466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff619619a0>]}
[0m16:55:02.923805 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:55:02.926191 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:55:02.939875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6114be60>]}
[0m16:55:02.940560 [info ] [MainThread]: Found 17 models, 433 macros
[0m16:55:02.941174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff62658290>]}
[0m16:55:02.943888 [info ] [MainThread]: 
[0m16:55:02.944584 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:55:02.945193 [info ] [MainThread]: 
[0m16:55:02.946274 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:55:02.955186 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:55:03.005611 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:55:03.006160 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:55:03.006751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:03.017948 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m16:55:03.019579 [debug] [ThreadPool]: On list_postgres: Close
[0m16:55:03.022307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:55:03.029209 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:55:03.029779 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:55:03.030225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:03.038290 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m16:55:03.038883 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:55:03.039352 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:55:03.042651 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.003 seconds
[0m16:55:03.044603 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:55:03.045197 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:55:03.053793 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:03.054305 [debug] [MainThread]: On master: BEGIN
[0m16:55:03.054816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:03.063510 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m16:55:03.064035 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:03.064643 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:55:03.070556 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m16:55:03.072954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5f974e90>]}
[0m16:55:03.073526 [debug] [MainThread]: On master: ROLLBACK
[0m16:55:03.074203 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:03.074717 [debug] [MainThread]: On master: BEGIN
[0m16:55:03.075453 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:55:03.075922 [debug] [MainThread]: On master: COMMIT
[0m16:55:03.076408 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:03.076847 [debug] [MainThread]: On master: COMMIT
[0m16:55:03.077417 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:55:03.077874 [debug] [MainThread]: On master: Close
[0m16:55:03.081385 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m16:55:03.082573 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m16:55:03.083736 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_works
[0m16:55:03.084513 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_1c_journal .............................. [RUN]
[0m16:55:03.085488 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_1c_tech ................................. [RUN]
[0m16:55:03.086573 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_1c_works ................................ [RUN]
[0m16:55:03.087390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m16:55:03.088406 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_tech'
[0m16:55:03.089509 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_works'
[0m16:55:03.090321 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m16:55:03.091433 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m16:55:03.092503 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m16:55:03.105258 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m16:55:03.107834 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m16:55:03.110872 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m16:55:03.112593 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m16:55:03.113772 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m16:55:03.114782 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m16:55:03.205200 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m16:55:03.206628 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m16:55:03.207208 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m16:55:03.208597 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:55:03.209121 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m16:55:03.209713 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:55:03.210696 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:55:03.211788 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m16:55:03.212712 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:55:03.213289 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:55:03.214063 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m16:55:03.215054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:03.219896 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m16:55:03.220563 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:55:03.221239 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m16:55:03.225012 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:55:03.234234 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:55:03.234869 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m16:55:03.235449 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech" rename to "stg_1c_tech__dbt_backup"
[0m16:55:03.236102 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:55:03.236793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m16:55:03.237846 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m16:55:03.238663 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:55:03.239187 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:55:03.243186 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:55:03.244110 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m16:55:03.244955 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m16:55:03.245543 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech__dbt_tmp" rename to "stg_1c_tech"
[0m16:55:03.249749 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:55:03.250481 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:55:03.251130 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works" rename to "stg_1c_works__dbt_backup"
[0m16:55:03.251992 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:55:03.257046 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:55:03.268489 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m16:55:03.275970 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m16:55:03.279430 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:55:03.280051 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m16:55:03.285947 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m16:55:03.286491 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works__dbt_tmp" rename to "stg_1c_works"
[0m16:55:03.290199 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:55:03.290859 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:55:03.291510 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m16:55:03.292135 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:55:03.292676 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m16:55:03.295339 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m16:55:03.296264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:55:03.297416 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:55:03.299825 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:55:03.300432 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m16:55:03.301058 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:55:03.301714 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:55:03.306630 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m16:55:03.313988 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_tech__dbt_backup"
[0m16:55:03.320247 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:55:03.320927 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m16:55:03.321505 [debug] [Thread-3 (]: SQL status: COMMIT in 0.020 seconds
[0m16:55:03.321988 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
drop view if exists "postgres"."public"."stg_1c_tech__dbt_backup" cascade
[0m16:55:03.325007 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m16:55:03.327850 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_works__dbt_backup"
[0m16:55:03.329833 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:55:03.331283 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:55:03.332028 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m16:55:03.332796 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
drop view if exists "postgres"."public"."stg_1c_works__dbt_backup" cascade
[0m16:55:03.340452 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.012 seconds
[0m16:55:03.343472 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m16:55:03.345837 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff64d47980>]}
[0m16:55:03.346888 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_1c_tech ............................ [[32mCREATE VIEW[0m in 0.26s]
[0m16:55:03.347863 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m16:55:03.348810 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m16:55:03.349665 [info ] [Thread-4 (]: 4 of 6 START sql incremental model public.dv_hub_tech .......................... [RUN]
[0m16:55:03.350563 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_hub_tech'
[0m16:55:03.351073 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m16:55:03.360301 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.027 seconds
[0m16:55:03.366178 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.033 seconds
[0m16:55:03.368898 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m16:55:03.372163 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m16:55:03.375042 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: Close
[0m16:55:03.376351 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m16:55:03.378268 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5f8ce9f0>]}
[0m16:55:03.379282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5f8ce7b0>]}
[0m16:55:03.390679 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_1c_works ........................... [[32mCREATE VIEW[0m in 0.29s]
[0m16:55:03.401788 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_1c_journal ......................... [[32mCREATE VIEW[0m in 0.29s]
[0m16:55:03.403101 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m16:55:03.418478 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m16:55:03.440361 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:55:03.441475 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

    
  
    

  create temporary table "dv_hub_tech__dbt_tmp165503416815"
  
  
    as
  
  (
    

SELECT distinct on (bk_ресурс_uuid)
        hk_dv_hub_tech,
        hkcode,
        recsource,
        loadts,
        bk_ресурс_uuid
FROM "postgres"."public"."stg_1c_tech" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_tech" target
    where 
        target.hk_dv_hub_tech = stg.hk_dv_hub_tech 
)

  );
  
  
[0m16:55:03.442146 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:55:03.442750 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m16:55:03.443897 [info ] [Thread-2 (]: 5 of 6 START sql incremental model public.dv_hub_fact_work ..................... [RUN]
[0m16:55:03.445109 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m16:55:03.446011 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_hub_fact_work)
[0m16:55:03.446907 [info ] [Thread-1 (]: 6 of 6 START sql incremental model public.dv_hub_fact_journal .................. [RUN]
[0m16:55:03.447666 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m16:55:03.448465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_journal, now model.tsm_dwh.dv_hub_fact_journal)
[0m16:55:03.456141 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m16:55:03.456934 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m16:55:03.463299 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:55:03.464472 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m16:55:03.473836 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:55:03.474520 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m16:55:03.475092 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.033 seconds
[0m16:55:03.475759 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

    
  
    

  create temporary table "dv_hub_fact_work__dbt_tmp165503469306"
  
  
    as
  
  (
    

SELECT distinct on (bk_работа_uuid)
        hk_dv_hub_fact_work,
        hkcode,
        recsource,
        loadts,
        bk_работа_uuid
FROM "postgres"."public"."stg_1c_works" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_work" target
    where 
        target.hk_dv_hub_fact_work = stg.hk_dv_hub_fact_work 
)

  );
  
  
[0m16:55:03.481096 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:55:03.497301 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:55:03.497923 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:55:03.498723 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

    
  
    

  create temporary table "dv_hub_fact_journal__dbt_tmp165503478730"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_journal" target
    where 
        target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_journal 
)

  );
  
  
[0m16:55:03.499457 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: BEGIN
[0m16:55:03.500249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:03.501131 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m16:55:03.501892 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:55:03.503127 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech__dbt_tmp165503416815'
        
      order by ordinal_position

  
[0m16:55:03.518587 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.020 seconds
[0m16:55:03.519583 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.016 seconds
[0m16:55:03.523172 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:55:03.523755 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.024 seconds
[0m16:55:03.529456 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:55:03.530250 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: BEGIN
[0m16:55:03.533799 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:55:03.534506 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m16:55:03.535302 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: BEGIN
[0m16:55:03.536020 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m16:55:03.536732 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:55:03.537347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m16:55:03.538194 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work__dbt_tmp165503469306'
        
      order by ordinal_position

  
[0m16:55:03.538875 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:55:03.539909 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal__dbt_tmp165503478730'
        
      order by ordinal_position

  
[0m16:55:03.540761 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.004 seconds
[0m16:55:03.552985 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.013 seconds
[0m16:55:03.553640 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.012 seconds
[0m16:55:03.557543 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:55:03.559844 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:55:03.563456 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:55:03.564203 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m16:55:03.564899 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m16:55:03.565608 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m16:55:03.568813 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.002 seconds
[0m16:55:03.576066 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.010 seconds
[0m16:55:03.576713 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.010 seconds
[0m16:55:03.579828 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_tech"
[0m16:55:03.585539 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:55:03.591488 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:55:03.592610 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m16:55:03.593273 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m16:55:03.594116 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:55:03.597202 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      insert into "postgres"."public"."dv_hub_tech" ("hk_dv_hub_tech", "hkcode", "recsource", "loadts", "bk_ресурс_uuid")
    (
        select "hk_dv_hub_tech", "hkcode", "recsource", "loadts", "bk_ресурс_uuid"
        from "dv_hub_tech__dbt_tmp165503416815"
    )


  
[0m16:55:03.598480 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.004 seconds
[0m16:55:03.599113 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m16:55:03.601728 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_work"
[0m16:55:03.602432 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m16:55:03.604788 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:55:03.606882 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m16:55:03.607752 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:55:03.608465 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:55:03.609489 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      insert into "postgres"."public"."dv_hub_fact_work" ("hk_dv_hub_fact_work", "hkcode", "recsource", "loadts", "bk_работа_uuid")
    (
        select "hk_dv_hub_fact_work", "hkcode", "recsource", "loadts", "bk_работа_uuid"
        from "dv_hub_fact_work__dbt_tmp165503469306"
    )


  
[0m16:55:03.610166 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:55:03.611030 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m16:55:03.612009 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      insert into "postgres"."public"."dv_hub_fact_journal" ("hk_dv_hub_fact_journal", "hkcode", "recsource", "loadts", "bk_жуфвр_uuid")
    (
        select "hk_dv_hub_fact_journal", "hkcode", "recsource", "loadts", "bk_жуфвр_uuid"
        from "dv_hub_fact_journal__dbt_tmp165503478730"
    )


  
[0m16:55:03.612798 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m16:55:03.617434 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m16:55:03.618266 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m16:55:03.619366 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:55:03.621798 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m16:55:03.622619 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m16:55:03.623455 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:55:03.624586 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m16:55:03.627911 [debug] [Thread-4 (]: SQL status: COMMIT in 0.014 seconds
[0m16:55:03.629000 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: Close
[0m16:55:03.629816 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5f822a50>]}
[0m16:55:03.630940 [info ] [Thread-4 (]: 4 of 6 OK created sql incremental model public.dv_hub_tech ..................... [[32mINSERT 0 0[0m in 0.28s]
[0m16:55:03.631902 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m16:55:03.640064 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m16:55:03.641332 [debug] [Thread-2 (]: SQL status: COMMIT in 0.017 seconds
[0m16:55:03.643361 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m16:55:03.645089 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: Close
[0m16:55:03.646383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5f99bfe0>]}
[0m16:55:03.647246 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5f99ae40>]}
[0m16:55:03.648204 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model public.dv_hub_fact_journal ............. [[32mINSERT 0 0[0m in 0.20s]
[0m16:55:03.649532 [info ] [Thread-2 (]: 5 of 6 OK created sql incremental model public.dv_hub_fact_work ................ [[32mINSERT 0 0[0m in 0.20s]
[0m16:55:03.651047 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m16:55:03.652606 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m16:55:03.655154 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:03.656222 [debug] [MainThread]: On master: BEGIN
[0m16:55:03.656972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:55:03.667560 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:55:03.668501 [debug] [MainThread]: On master: COMMIT
[0m16:55:03.669482 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:03.670284 [debug] [MainThread]: On master: COMMIT
[0m16:55:03.671330 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:55:03.672546 [debug] [MainThread]: On master: Close
[0m16:55:03.673902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:03.674580 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_journal' was properly closed.
[0m16:55:03.674996 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_work' was properly closed.
[0m16:55:03.675562 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_works' was properly closed.
[0m16:55:03.675999 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_tech' was properly closed.
[0m16:55:03.676703 [info ] [MainThread]: 
[0m16:55:03.677575 [info ] [MainThread]: Finished running 3 incremental models, 3 view models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m16:55:03.679449 [debug] [MainThread]: Command end result
[0m16:55:03.721262 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:55:03.724954 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:55:03.732506 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m16:55:03.733417 [info ] [MainThread]: 
[0m16:55:03.734039 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:55:03.734771 [info ] [MainThread]: 
[0m16:55:03.735417 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:55:03.736811 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4593469, "process_in_blocks": "0", "process_kernel_time": 0.245078, "process_mem_max_rss": "120420", "process_out_blocks": "2800", "process_user_time": 2.715666}
[0m16:55:03.737400 [debug] [MainThread]: Command `dbt run` succeeded at 16:55:03.737265 after 1.46 seconds
[0m16:55:03.738021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff667b7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5f974e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5f9674a0>]}
[0m16:55:03.738739 [debug] [MainThread]: Flushing usage events
[0m16:55:04.852517 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:00.155870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80162e55e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80164ffd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80162e7260>]}


============================== 17:06:00.163077 | 6a2c0cae-2084-4218-813e-d32ce09d0a4a ==============================
[0m17:06:00.163077 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:06:00.164080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s +tag:link', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:06:00.345359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a2c0cae-2084-4218-813e-d32ce09d0a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8016808650>]}
[0m17:06:00.412006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a2c0cae-2084-4218-813e-d32ce09d0a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8015bf65a0>]}
[0m17:06:00.413026 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:06:00.533741 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:06:00.625338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:06:00.625829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:06:00.654493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a2c0cae-2084-4218-813e-d32ce09d0a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8015125d90>]}
[0m17:06:00.729828 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m17:06:00.732514 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m17:06:00.747086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a2c0cae-2084-4218-813e-d32ce09d0a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8014109460>]}
[0m17:06:00.747860 [info ] [MainThread]: Found 17 models, 433 macros
[0m17:06:00.748596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a2c0cae-2084-4218-813e-d32ce09d0a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80151266f0>]}
[0m17:06:00.751539 [info ] [MainThread]: 
[0m17:06:00.752220 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:06:00.752799 [info ] [MainThread]: 
[0m17:06:00.753594 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:06:00.759464 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:06:00.809951 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:06:00.810549 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:06:00.811032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:00.822362 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.011 seconds
[0m17:06:00.824092 [debug] [ThreadPool]: On list_postgres: Close
[0m17:06:00.828280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m17:06:00.835038 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:06:00.835606 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:06:00.836074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:00.844849 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m17:06:00.845359 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:06:00.845875 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:06:00.849475 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.003 seconds
[0m17:06:00.851321 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:06:00.852005 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:06:00.862208 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:00.862774 [debug] [MainThread]: On master: BEGIN
[0m17:06:00.863276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:06:00.871605 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m17:06:00.872136 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:00.872848 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:06:00.879056 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m17:06:00.881622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a2c0cae-2084-4218-813e-d32ce09d0a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80155fef90>]}
[0m17:06:00.882188 [debug] [MainThread]: On master: ROLLBACK
[0m17:06:00.882869 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:00.883331 [debug] [MainThread]: On master: BEGIN
[0m17:06:00.884188 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:06:00.884697 [debug] [MainThread]: On master: COMMIT
[0m17:06:00.885167 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:00.885670 [debug] [MainThread]: On master: COMMIT
[0m17:06:00.886313 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:06:00.887103 [debug] [MainThread]: On master: Close
[0m17:06:00.891856 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m17:06:00.892777 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_works
[0m17:06:00.893918 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_1c_tech ................................. [RUN]
[0m17:06:00.895322 [info ] [Thread-2 (]: 2 of 4 START sql view model public.stg_1c_works ................................ [RUN]
[0m17:06:00.896490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_tech)
[0m17:06:00.897208 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_works'
[0m17:06:00.897916 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m17:06:00.898876 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m17:06:00.913911 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m17:06:00.915908 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m17:06:00.917210 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m17:06:00.928507 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m17:06:00.995216 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m17:06:00.992514 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m17:06:00.996599 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m17:06:00.997545 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m17:06:00.998111 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m17:06:00.998927 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m17:06:00.999799 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:06:01.000446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:01.009638 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m17:06:01.010224 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m17:06:01.010747 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m17:06:01.011253 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m17:06:01.011936 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m17:06:01.012677 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m17:06:01.021359 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m17:06:01.022115 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m17:06:01.035595 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m17:06:01.037576 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m17:06:01.038142 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech" rename to "stg_1c_tech__dbt_backup"
[0m17:06:01.038842 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works" rename to "stg_1c_works__dbt_backup"
[0m17:06:01.040166 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:06:01.040770 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:06:01.044097 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m17:06:01.047614 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m17:06:01.048163 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech__dbt_tmp" rename to "stg_1c_tech"
[0m17:06:01.048761 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works__dbt_tmp" rename to "stg_1c_works"
[0m17:06:01.050085 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:06:01.050693 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:06:01.081226 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m17:06:01.084167 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m17:06:01.084820 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m17:06:01.085463 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m17:06:01.086113 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m17:06:01.086827 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m17:06:01.101155 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m17:06:01.108881 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_tech__dbt_backup"
[0m17:06:01.115046 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m17:06:01.115870 [debug] [Thread-2 (]: SQL status: COMMIT in 0.028 seconds
[0m17:06:01.116474 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
drop view if exists "postgres"."public"."stg_1c_tech__dbt_backup" cascade
[0m17:06:01.119518 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_works__dbt_backup"
[0m17:06:01.121228 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m17:06:01.121915 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
drop view if exists "postgres"."public"."stg_1c_works__dbt_backup" cascade
[0m17:06:01.148449 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.028 seconds
[0m17:06:01.151779 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m17:06:01.154042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2c0cae-2084-4218-813e-d32ce09d0a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f801800f650>]}
[0m17:06:01.154964 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.stg_1c_tech ............................ [[32mCREATE VIEW[0m in 0.26s]
[0m17:06:01.155883 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m17:06:01.156840 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m17:06:01.157656 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public.dv_lnk_fact_work_tech ................ [RUN]
[0m17:06:01.158636 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_lnk_fact_work_tech'
[0m17:06:01.159179 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.037 seconds
[0m17:06:01.159786 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_work_tech
[0m17:06:01.161635 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: Close
[0m17:06:01.175591 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m17:06:01.176707 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2c0cae-2084-4218-813e-d32ce09d0a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8012d540b0>]}
[0m17:06:01.178230 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.stg_1c_works ........................... [[32mCREATE VIEW[0m in 0.28s]
[0m17:06:01.179650 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m17:06:01.180231 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_lnk_fact_work_tech
[0m17:06:01.181276 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m17:06:01.187733 [info ] [Thread-1 (]: 4 of 4 START sql incremental model public.dv_lnk_fact_journal_fact_work ........ [RUN]
[0m17:06:01.194008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_lnk_fact_journal_fact_work)
[0m17:06:01.200207 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m17:06:01.210142 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m17:06:01.236179 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m17:06:01.259739 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m17:06:01.257779 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m17:06:01.260983 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m17:06:01.261825 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: BEGIN
[0m17:06:01.262467 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:06:01.263569 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m17:06:01.264418 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: BEGIN
[0m17:06:01.265641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:01.271866 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m17:06:01.272743 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m17:06:01.273506 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      
  
    

  create  table "postgres"."public"."dv_lnk_fact_work_tech"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_work,
	hk_dv_hub_tech)
        hk_dv_lnk_fact_work_tech,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_work,
	hk_dv_hub_tech
FROM "postgres"."public"."stg_1c_tech" stg


  );
  
  
[0m17:06:01.276266 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m17:06:01.277012 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m17:06:01.277777 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_lnk_fact_journal_fact_work"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work)
        hk_dv_lnk_fact_journal_fact_work,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work
FROM "postgres"."public"."stg_1c_works" stg


  );
  
  
[0m17:06:01.314567 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.036 seconds
[0m17:06:01.315349 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.041 seconds
[0m17:06:01.321182 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m17:06:01.323352 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m17:06:01.324018 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m17:06:01.324655 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m17:06:01.325317 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m17:06:01.325975 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m17:06:01.338199 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m17:06:01.339525 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: Close
[0m17:06:01.340354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2c0cae-2084-4218-813e-d32ce09d0a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8010342c90>]}
[0m17:06:01.341960 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model public.dv_lnk_fact_journal_fact_work ... [[32mSELECT 0[0m in 0.15s]
[0m17:06:01.343587 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m17:06:01.352211 [debug] [Thread-4 (]: SQL status: COMMIT in 0.025 seconds
[0m17:06:01.353239 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: Close
[0m17:06:01.354315 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2c0cae-2084-4218-813e-d32ce09d0a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8012ce20f0>]}
[0m17:06:01.355718 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public.dv_lnk_fact_work_tech ........... [[32mSELECT 0[0m in 0.20s]
[0m17:06:01.357242 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m17:06:01.359531 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:01.360124 [debug] [MainThread]: On master: BEGIN
[0m17:06:01.360886 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:06:01.373933 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m17:06:01.374774 [debug] [MainThread]: On master: COMMIT
[0m17:06:01.375340 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:01.375943 [debug] [MainThread]: On master: COMMIT
[0m17:06:01.377064 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:06:01.377845 [debug] [MainThread]: On master: Close
[0m17:06:01.378793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:01.379236 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work' was properly closed.
[0m17:06:01.380025 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_works' was properly closed.
[0m17:06:01.380846 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_work_tech' was properly closed.
[0m17:06:01.381921 [info ] [MainThread]: 
[0m17:06:01.382931 [info ] [MainThread]: Finished running 2 incremental models, 2 view models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m17:06:01.385624 [debug] [MainThread]: Command end result
[0m17:06:01.424939 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m17:06:01.427702 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m17:06:01.436111 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m17:06:01.436998 [info ] [MainThread]: 
[0m17:06:01.437933 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:06:01.438803 [info ] [MainThread]: 
[0m17:06:01.439741 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:06:01.441464 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3443952, "process_in_blocks": "848", "process_kernel_time": 0.259564, "process_mem_max_rss": "119088", "process_out_blocks": "2536", "process_user_time": 2.529807}
[0m17:06:01.442076 [debug] [MainThread]: Command `dbt run` succeeded at 17:06:01.441943 after 1.35 seconds
[0m17:06:01.442592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80160f4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80162e7260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8012d914c0>]}
[0m17:06:01.443078 [debug] [MainThread]: Flushing usage events
[0m17:06:02.674570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:13.808834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ffddd310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ffb98800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ff954bf0>]}


============================== 17:06:13.812753 | d5869755-e90c-4603-aae4-a62b6175ac8e ==============================
[0m17:06:13.812753 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:06:13.813753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s +tag:link', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:06:13.997819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5869755-e90c-4603-aae4-a62b6175ac8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ffe005f0>]}
[0m17:06:14.064535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5869755-e90c-4603-aae4-a62b6175ac8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ffa4c260>]}
[0m17:06:14.065640 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:06:14.185851 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:06:14.277935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:06:14.278441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:06:14.306704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5869755-e90c-4603-aae4-a62b6175ac8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9fe71bf80>]}
[0m17:06:14.378131 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m17:06:14.381037 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m17:06:14.395111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5869755-e90c-4603-aae4-a62b6175ac8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9fdbebfe0>]}
[0m17:06:14.395880 [info ] [MainThread]: Found 17 models, 433 macros
[0m17:06:14.396507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5869755-e90c-4603-aae4-a62b6175ac8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda00ac09b0>]}
[0m17:06:14.399076 [info ] [MainThread]: 
[0m17:06:14.399712 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:06:14.400287 [info ] [MainThread]: 
[0m17:06:14.401229 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:06:14.409480 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:06:14.459272 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:06:14.459865 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:06:14.460490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:14.474708 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.014 seconds
[0m17:06:14.476496 [debug] [ThreadPool]: On list_postgres: Close
[0m17:06:14.480566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m17:06:14.487249 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:06:14.487842 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m17:06:14.488310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:14.497278 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m17:06:14.497874 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m17:06:14.498395 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:06:14.501611 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.003 seconds
[0m17:06:14.503582 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m17:06:14.504201 [debug] [ThreadPool]: On list_postgres_public: Close
[0m17:06:14.513005 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:14.513504 [debug] [MainThread]: On master: BEGIN
[0m17:06:14.513940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:06:14.522000 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m17:06:14.522561 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:14.523163 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:06:14.529668 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m17:06:14.532342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5869755-e90c-4603-aae4-a62b6175ac8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda01772210>]}
[0m17:06:14.532998 [debug] [MainThread]: On master: ROLLBACK
[0m17:06:14.533600 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:14.534034 [debug] [MainThread]: On master: BEGIN
[0m17:06:14.534733 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:06:14.535171 [debug] [MainThread]: On master: COMMIT
[0m17:06:14.535773 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:14.536221 [debug] [MainThread]: On master: COMMIT
[0m17:06:14.536828 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:06:14.537292 [debug] [MainThread]: On master: Close
[0m17:06:14.541616 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m17:06:14.542366 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_works
[0m17:06:14.543122 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_1c_tech ................................. [RUN]
[0m17:06:14.543980 [info ] [Thread-2 (]: 2 of 4 START sql view model public.stg_1c_works ................................ [RUN]
[0m17:06:14.544885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_tech)
[0m17:06:14.545618 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_works'
[0m17:06:14.546216 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m17:06:14.546875 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m17:06:14.558033 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m17:06:14.560661 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m17:06:14.561850 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m17:06:14.572883 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m17:06:14.625561 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m17:06:14.626435 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m17:06:14.627613 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m17:06:14.628247 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m17:06:14.628817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:14.629569 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m17:06:14.630204 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m17:06:14.631026 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:06:14.640606 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m17:06:14.641186 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m17:06:14.641880 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m17:06:14.643004 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m17:06:14.643552 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m17:06:14.644172 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m17:06:14.649184 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m17:06:14.649949 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m17:06:14.662870 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m17:06:14.663643 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m17:06:14.664218 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works" rename to "stg_1c_works__dbt_backup"
[0m17:06:14.664866 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech" rename to "stg_1c_tech__dbt_backup"
[0m17:06:14.666174 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:06:14.671474 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m17:06:14.672073 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m17:06:14.672714 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works__dbt_tmp" rename to "stg_1c_works"
[0m17:06:14.676129 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m17:06:14.676902 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech__dbt_tmp" rename to "stg_1c_tech"
[0m17:06:14.677761 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:06:14.684419 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m17:06:14.718089 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m17:06:14.719727 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m17:06:14.720298 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m17:06:14.720982 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m17:06:14.721556 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m17:06:14.722166 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m17:06:14.743600 [debug] [Thread-2 (]: SQL status: COMMIT in 0.020 seconds
[0m17:06:14.751217 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_works__dbt_backup"
[0m17:06:14.758112 [debug] [Thread-1 (]: SQL status: COMMIT in 0.035 seconds
[0m17:06:14.757602 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m17:06:14.761425 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_tech__dbt_backup"
[0m17:06:14.762137 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
drop view if exists "postgres"."public"."stg_1c_works__dbt_backup" cascade
[0m17:06:14.763433 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m17:06:14.764171 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
drop view if exists "postgres"."public"."stg_1c_tech__dbt_backup" cascade
[0m17:06:14.783321 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.019 seconds
[0m17:06:14.786363 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: Close
[0m17:06:14.789787 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5869755-e90c-4603-aae4-a62b6175ac8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda0169fb30>]}
[0m17:06:14.790708 [info ] [Thread-2 (]: 2 of 4 OK created sql view model public.stg_1c_works ........................... [[32mCREATE VIEW[0m in 0.24s]
[0m17:06:14.791624 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m17:06:14.792507 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m17:06:14.793337 [info ] [Thread-4 (]: 3 of 4 START sql incremental model public.dv_lnk_fact_journal_fact_work ........ [RUN]
[0m17:06:14.794485 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work'
[0m17:06:14.795081 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m17:06:14.808163 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.043 seconds
[0m17:06:14.815531 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m17:06:14.813291 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m17:06:14.816670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5869755-e90c-4603-aae4-a62b6175ac8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ff657e30>]}
[0m17:06:14.817773 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.stg_1c_tech ............................ [[32mCREATE VIEW[0m in 0.27s]
[0m17:06:14.819017 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m17:06:14.819655 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m17:06:14.845961 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m17:06:14.846911 [info ] [Thread-2 (]: 4 of 4 START sql incremental model public.dv_lnk_fact_work_tech ................ [RUN]
[0m17:06:14.858460 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_works, now model.tsm_dwh.dv_lnk_fact_work_tech)
[0m17:06:14.864357 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_work_tech
[0m17:06:14.874530 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m17:06:14.889733 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m17:06:14.890514 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

    
  
    

  create temporary table "dv_lnk_fact_journal_fact_work__dbt_tmp170614861810"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work)
        hk_dv_lnk_fact_journal_fact_work,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work
FROM "postgres"."public"."stg_1c_works" stg


where not exists (
    select 1
    from "postgres"."public"."dv_lnk_fact_journal_fact_work" target
    where 
        target.hk_dv_lnk_fact_journal_fact_work = stg.hk_dv_lnk_fact_journal_fact_work 
)

  );
  
  
[0m17:06:14.891143 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_lnk_fact_work_tech
[0m17:06:14.891741 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:06:14.898598 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m17:06:14.899548 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

    
  
    

  create temporary table "dv_lnk_fact_work_tech__dbt_tmp170614895489"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_work,
	hk_dv_hub_tech)
        hk_dv_lnk_fact_work_tech,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_work,
	hk_dv_hub_tech
FROM "postgres"."public"."stg_1c_tech" stg


where not exists (
    select 1
    from "postgres"."public"."dv_lnk_fact_work_tech" target
    where 
        target.hk_dv_lnk_fact_work_tech = stg.hk_dv_lnk_fact_work_tech 
)

  );
  
  
[0m17:06:14.900128 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:06:14.916221 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.024 seconds
[0m17:06:14.923622 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.023 seconds
[0m17:06:14.933881 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m17:06:14.937682 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m17:06:14.938351 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: BEGIN
[0m17:06:14.939043 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: BEGIN
[0m17:06:14.939981 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m17:06:14.940549 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m17:06:14.941133 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work__dbt_tmp170614861810'
        
      order by ordinal_position

  
[0m17:06:14.941902 [debug] [Thread-2 (]: SQL status: BEGIN in 0.002 seconds
[0m17:06:14.942805 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m17:06:14.943574 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech__dbt_tmp170614895489'
        
      order by ordinal_position

  
[0m17:06:14.949275 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.007 seconds
[0m17:06:14.955663 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.011 seconds
[0m17:06:14.956264 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m17:06:14.959868 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m17:06:14.960508 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:06:14.961188 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:06:14.966818 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.005 seconds
[0m17:06:14.967465 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.005 seconds
[0m17:06:14.975833 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m17:06:14.979426 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m17:06:14.980014 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:06:14.980600 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:06:14.983654 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.002 seconds
[0m17:06:14.984258 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.003 seconds
[0m17:06:14.998942 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m17:06:14.999851 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m17:06:15.000871 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m17:06:15.001569 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      insert into "postgres"."public"."dv_lnk_fact_work_tech" ("hk_dv_lnk_fact_work_tech", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_work", "hk_dv_hub_tech")
    (
        select "hk_dv_lnk_fact_work_tech", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_work", "hk_dv_hub_tech"
        from "dv_lnk_fact_work_tech__dbt_tmp170614895489"
    )


  
[0m17:06:15.002462 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m17:06:15.003165 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m17:06:15.003775 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      insert into "postgres"."public"."dv_lnk_fact_journal_fact_work" ("hk_dv_lnk_fact_journal_fact_work", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_journal", "hk_dv_hub_fact_work")
    (
        select "hk_dv_lnk_fact_journal_fact_work", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_journal", "hk_dv_hub_fact_work"
        from "dv_lnk_fact_journal_fact_work__dbt_tmp170614861810"
    )


  
[0m17:06:15.005743 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m17:06:15.006443 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m17:06:15.007113 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m17:06:15.007732 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m17:06:15.009851 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m17:06:15.010513 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m17:06:15.011063 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m17:06:15.023154 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m17:06:15.024205 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: Close
[0m17:06:15.025120 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5869755-e90c-4603-aae4-a62b6175ac8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9fc2e3e00>]}
[0m17:06:15.026070 [info ] [Thread-2 (]: 4 of 4 OK created sql incremental model public.dv_lnk_fact_work_tech ........... [[32mINSERT 0 0[0m in 0.17s]
[0m17:06:15.026966 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m17:06:15.049506 [debug] [Thread-4 (]: SQL status: COMMIT in 0.038 seconds
[0m17:06:15.050730 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: Close
[0m17:06:15.051600 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5869755-e90c-4603-aae4-a62b6175ac8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9fc3553a0>]}
[0m17:06:15.052601 [info ] [Thread-4 (]: 3 of 4 OK created sql incremental model public.dv_lnk_fact_journal_fact_work ... [[32mINSERT 0 0[0m in 0.26s]
[0m17:06:15.053619 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m17:06:15.055709 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:15.056192 [debug] [MainThread]: On master: BEGIN
[0m17:06:15.056862 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:06:15.068571 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m17:06:15.069422 [debug] [MainThread]: On master: COMMIT
[0m17:06:15.069917 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:15.070388 [debug] [MainThread]: On master: COMMIT
[0m17:06:15.070991 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:06:15.071432 [debug] [MainThread]: On master: Close
[0m17:06:15.072158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:15.073116 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_tech' was properly closed.
[0m17:06:15.074100 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_work_tech' was properly closed.
[0m17:06:15.074866 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work' was properly closed.
[0m17:06:15.075666 [info ] [MainThread]: 
[0m17:06:15.076407 [info ] [MainThread]: Finished running 2 incremental models, 2 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m17:06:15.078882 [debug] [MainThread]: Command end result
[0m17:06:15.120969 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m17:06:15.123105 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m17:06:15.131192 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m17:06:15.131810 [info ] [MainThread]: 
[0m17:06:15.132486 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:06:15.133231 [info ] [MainThread]: 
[0m17:06:15.133987 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:06:15.135136 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3840728, "process_in_blocks": "0", "process_kernel_time": 0.262026, "process_mem_max_rss": "118888", "process_out_blocks": "2608", "process_user_time": 2.563747}
[0m17:06:15.135804 [debug] [MainThread]: Command `dbt run` succeeded at 17:06:15.135661 after 1.38 seconds
[0m17:06:15.136362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ff531ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9ff453860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9fc12ec60>]}
[0m17:06:15.137108 [debug] [MainThread]: Flushing usage events
[0m17:06:16.190284 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:21:39.098107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634d7df410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634d90c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634bbf8500>]}


============================== 09:21:39.103457 | 29507a64-02c0-49fe-86e0-3b19b813b59c ==============================
[0m09:21:39.103457 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:21:39.104486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s +tag:stage', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:21:39.321077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29507a64-02c0-49fe-86e0-3b19b813b59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634be08590>]}
[0m09:21:39.388177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29507a64-02c0-49fe-86e0-3b19b813b59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634b3aed50>]}
[0m09:21:39.389195 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:21:39.519357 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:21:39.611272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:21:39.611757 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:21:39.642237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29507a64-02c0-49fe-86e0-3b19b813b59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634ab95bb0>]}
[0m09:21:39.715223 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m09:21:39.717926 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m09:21:39.742645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29507a64-02c0-49fe-86e0-3b19b813b59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634a36a570>]}
[0m09:21:39.743351 [info ] [MainThread]: Found 17 models, 433 macros
[0m09:21:39.743996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29507a64-02c0-49fe-86e0-3b19b813b59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634a3bb560>]}
[0m09:21:39.746675 [info ] [MainThread]: 
[0m09:21:39.747220 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:21:39.747796 [info ] [MainThread]: 
[0m09:21:39.748561 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:21:39.754213 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:21:39.814520 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:21:39.815068 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:21:39.815616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:21:39.842499 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.027 seconds
[0m09:21:39.844155 [debug] [ThreadPool]: On list_postgres: Close
[0m09:21:39.849081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m09:21:39.855806 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m09:21:39.856320 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m09:21:39.856804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:39.866011 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m09:21:39.866961 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m09:21:39.867716 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:21:39.872271 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.004 seconds
[0m09:21:39.874170 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m09:21:39.874817 [debug] [ThreadPool]: On list_postgres_public: Close
[0m09:21:39.884565 [debug] [MainThread]: Using postgres connection "master"
[0m09:21:39.885068 [debug] [MainThread]: On master: BEGIN
[0m09:21:39.885633 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:21:39.898458 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:21:39.899438 [debug] [MainThread]: Using postgres connection "master"
[0m09:21:39.900492 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:21:39.907457 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m09:21:39.909893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29507a64-02c0-49fe-86e0-3b19b813b59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634d766030>]}
[0m09:21:39.910490 [debug] [MainThread]: On master: ROLLBACK
[0m09:21:39.911319 [debug] [MainThread]: Using postgres connection "master"
[0m09:21:39.911818 [debug] [MainThread]: On master: BEGIN
[0m09:21:39.912495 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:21:39.912924 [debug] [MainThread]: On master: COMMIT
[0m09:21:39.913387 [debug] [MainThread]: Using postgres connection "master"
[0m09:21:39.913804 [debug] [MainThread]: On master: COMMIT
[0m09:21:39.914390 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:21:39.914852 [debug] [MainThread]: On master: Close
[0m09:21:39.919365 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m09:21:39.920060 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_materials
[0m09:21:39.920917 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_norm_workload
[0m09:21:39.921735 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_1c_journal .............................. [RUN]
[0m09:21:39.922771 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_pikets
[0m09:21:39.923482 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_1c_materials ............................ [RUN]
[0m09:21:39.924433 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_1c_norm_workload ........................ [RUN]
[0m09:21:39.925354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m09:21:39.926296 [info ] [Thread-4 (]: 4 of 6 START sql view model public.stg_1c_pikets ............................... [RUN]
[0m09:21:39.927257 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_materials'
[0m09:21:39.928509 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_norm_workload'
[0m09:21:39.929545 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m09:21:39.930803 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_pikets'
[0m09:21:39.931908 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_materials
[0m09:21:39.933010 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_norm_workload
[0m09:21:39.944480 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_pikets
[0m09:21:39.945921 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m09:21:39.950244 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_materials"
[0m09:21:39.954410 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_norm_workload"
[0m09:21:39.957983 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_pikets"
[0m09:21:39.959739 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_pikets
[0m09:21:39.960775 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_materials
[0m09:21:40.005119 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_norm_workload
[0m09:21:40.044049 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_materials"
[0m09:21:40.044695 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m09:21:40.042124 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_norm_workload"
[0m09:21:40.047586 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_pikets"
[0m09:21:40.052643 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m09:21:40.053727 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:21:40.055087 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:21:40.055910 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:21:40.056986 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: BEGIN
[0m09:21:40.057741 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: BEGIN
[0m09:21:40.058692 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: BEGIN
[0m09:21:40.059336 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:21:40.059889 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:21:40.060465 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:21:40.061088 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:21:40.061762 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m09:21:40.063451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:40.075490 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m09:21:40.076949 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:21:40.077833 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m09:21:40.078445 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m09:21:40.078936 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m09:21:40.079530 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */

  create view "postgres"."public"."stg_1c_materials__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(НомерСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемМатериала::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_materials,
	НомерСтроки::int,
	Примечание::varchar,
	ОбъемМатериала::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar
    FROM 
        src_materials
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name)
  );
[0m09:21:40.080213 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:21:40.080869 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:21:40.081462 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:21:40.082202 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */

  create view "postgres"."public"."stg_1c_pikets__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(КлючСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетС::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеС::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(Объем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_pikets,
	КлючСтроки::uuid,
	ПикетС::numeric,
	ПикетПо::numeric,
	СмещениеС::numeric,
	СмещениеПо::numeric,
	Объем::numeric,
	ВидПикета_value::uuid,
	ВидПикета_codе::varchar,
	ВидПикета_name::varchar,
	ТипПикета_value::uuid,
	ТипПикета_codе::varchar,
	ТипПикета_name::varchar,
	ГруппаПикетовSpider_value::uuid,
	ГруппаПикетовSpider_codе::varchar,
	ГруппаПикетовSpider_name::varchar
    FROM 
        src_pikets
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name)
  );
[0m09:21:40.083457 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m09:21:40.085281 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */

  create view "postgres"."public"."stg_1c_norm_workload__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(Период::varchar, 'N\A')) || '|' || TRIM(COALESCE(РассчетныйОбъем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьНормативная::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьФактическая::varchar, 'N\A')) || '|' || TRIM(COALESCE(НаемныйРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(НесколькоКлючевыхРесурсов::varchar, 'N\A')) || '|' || TRIM(COALESCE(ЖУФВР::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючДокументаРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_norm_workload,
	Период::timestamptz,
	РассчетныйОбъем::numeric,
	ТрудоемкостьНормативная::numeric,
	ТрудоемкостьФактическая::numeric,
	НаемныйРесурс::bool,
	КлючевойРесурс_value::uuid,
	КлючевойРесурс_codе::varchar,
	КлючевойРесурс_name::varchar,
	НесколькоКлючевыхРесурсов::bool,
	ЖУФВР::uuid,
	КлючДокументаРесурс::uuid,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	РесурсSpider_value::uuid,
	РесурсSpider_codе::varchar,
	РесурсSpider_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar
    FROM 
        src_norm_workload
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name)
  );
[0m09:21:40.088411 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:21:40.098417 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:21:40.099276 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials__dbt_tmp" rename to "stg_1c_materials"
[0m09:21:40.102426 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:21:40.108073 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m09:21:40.108767 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m09:21:40.122218 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:21:40.125365 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m09:21:40.126179 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.040 seconds
[0m09:21:40.129821 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:21:40.130511 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m09:21:40.131132 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:21:40.135514 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:21:40.136144 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload__dbt_tmp" rename to "stg_1c_norm_workload"
[0m09:21:40.136955 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m09:21:40.137780 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:21:40.138232 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets__dbt_tmp" rename to "stg_1c_pikets"
[0m09:21:40.142255 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:21:40.142919 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:21:40.143556 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m09:21:40.146220 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m09:21:40.146840 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:21:40.147403 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m09:21:40.148191 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:21:40.149047 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:21:40.150838 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m09:21:40.156666 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m09:21:40.158911 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_materials__dbt_backup"
[0m09:21:40.163142 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m09:21:40.163899 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:21:40.172894 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:21:40.173495 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:21:40.174009 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m09:21:40.174855 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
drop view if exists "postgres"."public"."stg_1c_materials__dbt_backup" cascade
[0m09:21:40.175436 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m09:21:40.176092 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m09:21:40.180050 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_norm_workload__dbt_backup"
[0m09:21:40.182141 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m09:21:40.183509 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:21:40.186825 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: Close
[0m09:21:40.187498 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m09:21:40.188141 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
drop view if exists "postgres"."public"."stg_1c_norm_workload__dbt_backup" cascade
[0m09:21:40.192926 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."stg_1c_pikets__dbt_backup"
[0m09:21:40.195533 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m09:21:40.196258 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29507a64-02c0-49fe-86e0-3b19b813b59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634d693740>]}
[0m09:21:40.196932 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:21:40.198016 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:21:40.200868 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m09:21:40.201723 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_1c_materials ....................... [[32mCREATE VIEW[0m in 0.27s]
[0m09:21:40.203591 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: Close
[0m09:21:40.204264 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
drop view if exists "postgres"."public"."stg_1c_pikets__dbt_backup" cascade
[0m09:21:40.205499 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:21:40.206369 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_materials
[0m09:21:40.207295 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m09:21:40.208839 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29507a64-02c0-49fe-86e0-3b19b813b59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63482de7b0>]}
[0m09:21:40.210243 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:21:40.211129 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m09:21:40.212685 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_1c_norm_workload ................... [[32mCREATE VIEW[0m in 0.28s]
[0m09:21:40.215812 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: Close
[0m09:21:40.217175 [info ] [Thread-2 (]: 5 of 6 START sql view model public.stg_1c_tech ................................. [RUN]
[0m09:21:40.219022 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_norm_workload
[0m09:21:40.220514 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_materials, now model.tsm_dwh.stg_1c_tech)
[0m09:21:40.222355 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29507a64-02c0-49fe-86e0-3b19b813b59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63482ba510>]}
[0m09:21:40.223522 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.011 seconds
[0m09:21:40.224298 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_works
[0m09:21:40.225493 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m09:21:40.229552 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m09:21:40.226818 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.stg_1c_pikets .......................... [[32mCREATE VIEW[0m in 0.29s]
[0m09:21:40.231139 [info ] [Thread-3 (]: 6 of 6 START sql view model public.stg_1c_works ................................ [RUN]
[0m09:21:40.237393 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m09:21:40.239109 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_pikets
[0m09:21:40.240516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29507a64-02c0-49fe-86e0-3b19b813b59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634b692f60>]}
[0m09:21:40.241597 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_norm_workload, now model.tsm_dwh.stg_1c_works)
[0m09:21:40.242614 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m09:21:40.244193 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_1c_journal ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m09:21:40.245592 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m09:21:40.252499 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m09:21:40.253515 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m09:21:40.258136 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m09:21:40.259739 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:21:40.262803 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m09:21:40.263845 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m09:21:40.265005 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:21:40.271485 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m09:21:40.272670 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:21:40.273813 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m09:21:40.274665 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:21:40.281255 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m09:21:40.282416 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:21:40.283076 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m09:21:40.285490 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m09:21:40.286533 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:21:40.287984 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m09:21:40.291859 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:21:40.292515 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:21:40.296633 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:21:40.301356 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:21:40.302197 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech" rename to "stg_1c_tech__dbt_backup"
[0m09:21:40.302859 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works" rename to "stg_1c_works__dbt_backup"
[0m09:21:40.304155 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:21:40.304814 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:21:40.308353 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:21:40.312883 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:21:40.313757 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works__dbt_tmp" rename to "stg_1c_works"
[0m09:21:40.315058 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech__dbt_tmp" rename to "stg_1c_tech"
[0m09:21:40.316584 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:21:40.317153 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:21:40.319308 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m09:21:40.321336 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m09:21:40.321887 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:21:40.322467 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:21:40.322957 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m09:21:40.323473 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m09:21:40.333239 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m09:21:40.336561 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_works__dbt_backup"
[0m09:21:40.337649 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:21:40.338122 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
drop view if exists "postgres"."public"."stg_1c_works__dbt_backup" cascade
[0m09:21:40.347018 [debug] [Thread-2 (]: SQL status: COMMIT in 0.023 seconds
[0m09:21:40.351567 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_tech__dbt_backup"
[0m09:21:40.352671 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:21:40.353258 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
drop view if exists "postgres"."public"."stg_1c_tech__dbt_backup" cascade
[0m09:21:40.354173 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.015 seconds
[0m09:21:40.356546 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: Close
[0m09:21:40.357297 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29507a64-02c0-49fe-86e0-3b19b813b59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634812c8c0>]}
[0m09:21:40.358084 [info ] [Thread-3 (]: 6 of 6 OK created sql view model public.stg_1c_works ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m09:21:40.359013 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m09:21:40.369505 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.016 seconds
[0m09:21:40.372275 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m09:21:40.373466 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29507a64-02c0-49fe-86e0-3b19b813b59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634ab96180>]}
[0m09:21:40.375144 [info ] [Thread-2 (]: 5 of 6 OK created sql view model public.stg_1c_tech ............................ [[32mCREATE VIEW[0m in 0.15s]
[0m09:21:40.376690 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m09:21:40.378818 [debug] [MainThread]: Using postgres connection "master"
[0m09:21:40.379434 [debug] [MainThread]: On master: BEGIN
[0m09:21:40.379968 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:21:40.391252 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m09:21:40.391835 [debug] [MainThread]: On master: COMMIT
[0m09:21:40.392356 [debug] [MainThread]: Using postgres connection "master"
[0m09:21:40.392885 [debug] [MainThread]: On master: COMMIT
[0m09:21:40.393469 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:21:40.393901 [debug] [MainThread]: On master: Close
[0m09:21:40.394552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:21:40.395193 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m09:21:40.395954 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_tech' was properly closed.
[0m09:21:40.396699 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_works' was properly closed.
[0m09:21:40.397636 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_pikets' was properly closed.
[0m09:21:40.398749 [info ] [MainThread]: 
[0m09:21:40.399708 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m09:21:40.401778 [debug] [MainThread]: Command end result
[0m09:21:40.439061 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m09:21:40.440945 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m09:21:40.448799 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m09:21:40.449324 [info ] [MainThread]: 
[0m09:21:40.450107 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:21:40.450908 [info ] [MainThread]: 
[0m09:21:40.451780 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:21:40.453616 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4226929, "process_in_blocks": "38568", "process_kernel_time": 0.296725, "process_mem_max_rss": "118176", "process_out_blocks": "2776", "process_user_time": 2.669233}
[0m09:21:40.454223 [debug] [MainThread]: Command `dbt run` succeeded at 09:21:40.454071 after 1.42 seconds
[0m09:21:40.454754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634bde5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634bde6ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f634ab77560>]}
[0m09:21:40.455259 [debug] [MainThread]: Flushing usage events
[0m09:21:41.645953 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:31:02.490136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0cc65ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0e0b9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0d0c21e0>]}


============================== 09:31:02.496693 | 07710644-e97d-4591-962f-d5cabc20de19 ==============================
[0m09:31:02.496693 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:31:02.497741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:31:02.705516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0d410530>]}
[0m09:31:02.775330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0cdcb320>]}
[0m09:31:02.776537 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:31:02.973399 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:31:03.179370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:31:03.180777 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:31:03.237547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0bd2e510>]}
[0m09:31:03.368148 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m09:31:03.372416 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m09:31:03.418729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0ad104a0>]}
[0m09:31:03.419449 [info ] [MainThread]: Found 17 models, 433 macros
[0m09:31:03.422934 [info ] [MainThread]: 
[0m09:31:03.423676 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:31:03.424248 [info ] [MainThread]: 
[0m09:31:03.425280 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:31:03.433466 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:31:03.494523 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:31:03.495137 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:31:03.495643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:31:03.526679 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.031 seconds
[0m09:31:03.528463 [debug] [ThreadPool]: On list_postgres: Close
[0m09:31:03.531292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m09:31:03.538530 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m09:31:03.539045 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m09:31:03.539710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:31:03.548783 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m09:31:03.549327 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m09:31:03.549876 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:31:03.553588 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.003 seconds
[0m09:31:03.555637 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m09:31:03.556233 [debug] [ThreadPool]: On list_postgres_public: Close
[0m09:31:03.567881 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:03.568664 [debug] [MainThread]: On master: BEGIN
[0m09:31:03.569102 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:31:03.580221 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m09:31:03.580768 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:03.581471 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:31:03.588506 [debug] [MainThread]: SQL status: SELECT 7 in 0.006 seconds
[0m09:31:03.591759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0ed61e20>]}
[0m09:31:03.592386 [debug] [MainThread]: On master: ROLLBACK
[0m09:31:03.593082 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:03.593562 [debug] [MainThread]: On master: BEGIN
[0m09:31:03.594416 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:31:03.594903 [debug] [MainThread]: On master: COMMIT
[0m09:31:03.595358 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:03.595840 [debug] [MainThread]: On master: COMMIT
[0m09:31:03.596434 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:31:03.596892 [debug] [MainThread]: On master: Close
[0m09:31:03.603607 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_msat_fact_materials
[0m09:31:03.604364 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_msat_fact_pikets
[0m09:31:03.604933 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_msat_norm_workload
[0m09:31:03.606144 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_sat_fact_journal
[0m09:31:03.605621 [info ] [Thread-1 (]: 1 of 17 START sql view model public.dv_msat_fact_materials ..................... [RUN]
[0m09:31:03.607475 [info ] [Thread-2 (]: 2 of 17 START sql view model public.dv_msat_fact_pikets ........................ [RUN]
[0m09:31:03.608509 [info ] [Thread-3 (]: 3 of 17 START sql view model public.dv_msat_norm_workload ...................... [RUN]
[0m09:31:03.609461 [info ] [Thread-4 (]: 4 of 17 START sql view model public.dv_sat_fact_journal ........................ [RUN]
[0m09:31:03.610354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.dv_msat_fact_materials)
[0m09:31:03.611612 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_msat_fact_pikets'
[0m09:31:03.612923 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_msat_norm_workload'
[0m09:31:03.614229 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_sat_fact_journal'
[0m09:31:03.615067 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_msat_fact_materials
[0m09:31:03.615674 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_msat_fact_pikets
[0m09:31:03.616644 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_msat_norm_workload
[0m09:31:03.617836 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_sat_fact_journal
[0m09:31:03.628842 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_materials"
[0m09:31:03.632232 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m09:31:03.637002 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_norm_workload"
[0m09:31:03.641018 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_journal"
[0m09:31:03.643676 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_msat_fact_materials
[0m09:31:03.661132 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_msat_norm_workload
[0m09:31:03.679388 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_msat_fact_pikets
[0m09:31:03.725986 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_sat_fact_journal
[0m09:31:03.906899 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_journal"
[0m09:31:03.902838 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_materials"
[0m09:31:03.911982 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m09:31:03.917874 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_norm_workload"
[0m09:31:03.922823 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m09:31:03.923867 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: BEGIN
[0m09:31:03.924572 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m09:31:03.925238 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:31:03.925858 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m09:31:03.926692 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m09:31:03.927801 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: BEGIN
[0m09:31:03.928971 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: BEGIN
[0m09:31:03.930119 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: BEGIN
[0m09:31:03.931894 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:31:03.931408 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:31:03.930808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:03.941366 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m09:31:03.942364 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m09:31:03.943975 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */

  create view "postgres"."public"."dv_msat_norm_workload__dbt_tmp"
    
    
  as (
    WITH active_sat AS (
SELECT *
FROM (
        SELECT 
            hk_dv_hub_fact_work,
            hdiff_dv_msat_norm_workload,
            loadts,
            sub_seq,
            COUNT(*) OVER (PARTITION BY hk_dv_hub_fact_work, loadts) AS cnt,
            rank() OVER (
                PARTITION BY hk_dv_hub_fact_work
                ORDER BY loadts DESC
            ) AS rnk
        FROM dv_msat_norm_workload
    ) a (
        sat_id,
        sat_hdiff,
        sat_loadts,
        sat_sub_seq,
        sat_count,
        sat_rnk
    )
WHERE sat_rnk = 1
),
stage_cte AS (
    SELECT 
        stg_id,
        stg_hdiff,
        stg_loadts,
        stg_recsource,
        stg_sub_seq,
        период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
        COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
        lag(stg_hdiff) over(
            PARTITION BY stg_id, stg_sub_seq
            ORDER BY stg_loadts
        ) AS 
            stg_lag_hdiff,
            sat_hdiff,
            sat_count,
            sat_sub_seq,
            sat_rnk
    FROM (
            SELECT 
                s.hk_dv_hub_fact_work,
                s.hdiff_dv_msat_norm_workload,
                s.loadts,
                s.recsource,
                row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
            FROM stg_1c_norm_workload s
                CROSS JOIN (
                    SELECT max(loadts) AS max_loadts
                    FROM dv_msat_norm_workload
                ) ml
            WHERE s.loadts > ml.max_loadts
        ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    LEFT JOIN active_sat a ON sat_id = stg_id
    AND sat_sub_seq = stg_sub_seq
),
stage_for_insert AS (
    SELECT DISTINCT 
        stg_id,
        stg_loadts
    FROM (
            SELECT stg_id,
                stg_loadts,
                stg_hdiff,
                stg_lag_hdiff,
                stg_count,
                lag(stg_count) over(
                    PARTITION BY stg_id,
                    stg_sub_seq
                    ORDER BY stg_loadts
                ) AS stg_lag_count,
                sat_hdiff,
                sat_count,
                sat_sub_seq,
                sat_rnk
            FROM stage_cte
        ) t
    WHERE (
            stg_hdiff <> stg_lag_hdiff
            OR stg_count <> stg_lag_count
        )
        OR (
            (
                stg_hdiff <> sat_hdiff
                AND stg_lag_hdiff IS NULL
            )
            OR (
                stg_count <> sat_count
                AND stg_lag_count IS NULL
            )
        )
)


INSERT INTO dv_msat_norm_workload (hk_dv_hub_fact_work, recsource, loadts, hdiff_dv_msat_norm_workload, sub_seq, период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name)
SELECT DISTINCT 
    stg_id,
    stg_recsource,
    stg_loadts,
    stg_hdiff,
    stg_sub_seq,
    период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
FROM stage_cte s
WHERE EXISTS(
        SELECT 1
        FROM stage_for_insert si
        WHERE si.stg_id = s.stg_id
            AND si.stg_loadts = s.stg_loadts
    )
ORDER BY stg_loadts,
    stg_id,
    stg_sub_seq
ON CONFLICT DO NOTHING;
  );
[0m09:31:03.946399 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "INSERT"
LINE 143: INSERT INTO dv_msat_norm_workload (hk_dv_hub_fact_work, recs...
          ^

[0m09:31:03.947631 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m09:31:03.948220 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: ROLLBACK
[0m09:31:03.949134 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m09:31:03.950331 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m09:31:03.952294 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

  create view "postgres"."public"."dv_sat_fact_journal__dbt_tmp"
    
    
  as (
    WITH active_sat AS (
SELECT DISTINCT ON (hk_dv_hub_fact_journal) hk_dv_hub_fact_journal, hdiff_dv_sat_fact_journal, loadts
FROM dv_sat_fact_journal
ORDER BY hk_dv_hub_fact_journal, loadts DESC)

, max_load AS (
SELECT max(loadts) AS max_loadts
FROM dv_sat_fact_journal
)

, stage_cte AS (
    SELECT
        s.hk_dv_hub_fact_journal,
        s.hdiff_dv_sat_fact_journal,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_journal) over(PARTITION BY s.hk_dv_hub_fact_journal ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_journal AS sat_hdiff,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_journal,
            s.hdiff_dv_sat_fact_journal,
            s.loadts,
            s.recsource,
            rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
        FROM stg_1c_journal s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts) s

    LEFT JOIN active_sat a ON a.hk_dv_hub_fact_journal = s.hk_dv_hub_fact_journal)


INSERT INTO dv_sat_fact_journal (hk_dv_hub_fact_journal, recsource, loadts, hdiff_dv_sat_fact_journal, rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
SELECT DISTINCT
    hk_dv_hub_fact_journal,
    recsource,
    loadts,
    hdiff_dv_sat_fact_journal,
    rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM stage_cte
WHERE hdiff_dv_sat_fact_journal <> lag_hdiff or (hdiff_dv_sat_fact_journal <> sat_hdiff AND lag_hdiff IS NULL) OR sat_hdiff IS NULL
ORDER BY loadts
ON CONFLICT DO NOTHING;
  );
[0m09:31:03.953501 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: Close
[0m09:31:03.954242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m09:31:03.955421 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m09:31:03.956475 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m09:31:03.960577 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */

  create view "postgres"."public"."dv_msat_fact_pikets__dbt_tmp"
    
    
  as (
    WITH active_sat AS (
SELECT *
FROM (
        SELECT 
            hk_dv_hub_fact_work,
            hdiff_dv_msat_fact_pikets,
            loadts,
            sub_seq,
            COUNT(*) OVER (PARTITION BY hk_dv_hub_fact_work, loadts) AS cnt,
            rank() OVER (
                PARTITION BY hk_dv_hub_fact_work
                ORDER BY loadts DESC
            ) AS rnk
        FROM dv_msat_fact_pikets
    ) a (
        sat_id,
        sat_hdiff,
        sat_loadts,
        sat_sub_seq,
        sat_count,
        sat_rnk
    )
WHERE sat_rnk = 1
),
stage_cte AS (
    SELECT 
        stg_id,
        stg_hdiff,
        stg_loadts,
        stg_recsource,
        stg_sub_seq,
        ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name,
        COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
        lag(stg_hdiff) over(
            PARTITION BY stg_id, stg_sub_seq
            ORDER BY stg_loadts
        ) AS 
            stg_lag_hdiff,
            sat_hdiff,
            sat_count,
            sat_sub_seq,
            sat_rnk
    FROM (
            SELECT 
                s.hk_dv_hub_fact_work,
                s.hdiff_dv_msat_fact_pikets,
                s.loadts,
                s.recsource,
                row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
            FROM stg_1c_pikets s
                CROSS JOIN (
                    SELECT max(loadts) AS max_loadts
                    FROM dv_msat_fact_pikets
                ) ml
            WHERE s.loadts > ml.max_loadts
        ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    LEFT JOIN active_sat a ON sat_id = stg_id
    AND sat_sub_seq = stg_sub_seq
),
stage_for_insert AS (
    SELECT DISTINCT 
        stg_id,
        stg_loadts
    FROM (
            SELECT stg_id,
                stg_loadts,
                stg_hdiff,
                stg_lag_hdiff,
                stg_count,
                lag(stg_count) over(
                    PARTITION BY stg_id,
                    stg_sub_seq
                    ORDER BY stg_loadts
                ) AS stg_lag_count,
                sat_hdiff,
                sat_count,
                sat_sub_seq,
                sat_rnk
            FROM stage_cte
        ) t
    WHERE (
            stg_hdiff <> stg_lag_hdiff
            OR stg_count <> stg_lag_count
        )
        OR (
            (
                stg_hdiff <> sat_hdiff
                AND stg_lag_hdiff IS NULL
            )
            OR (
                stg_count <> sat_count
                AND stg_lag_count IS NULL
            )
        )
)


INSERT INTO dv_msat_fact_pikets (hk_dv_hub_fact_work, recsource, loadts, hdiff_dv_msat_fact_pikets, sub_seq, ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name)
SELECT DISTINCT 
    stg_id,
    stg_recsource,
    stg_loadts,
    stg_hdiff,
    stg_sub_seq,
    ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
FROM stage_cte s
WHERE EXISTS(
        SELECT 1
        FROM stage_for_insert si
        WHERE si.stg_id = s.stg_id
            AND si.stg_loadts = s.stg_loadts
    )
ORDER BY stg_loadts,
    stg_id,
    stg_sub_seq
ON CONFLICT DO NOTHING;
  );
[0m09:31:03.961524 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "INSERT"
LINE 98: INSERT INTO dv_sat_fact_journal (hk_dv_hub_fact_journal, rec...
         ^

[0m09:31:03.963576 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: ROLLBACK
[0m09:31:03.962192 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */

  create view "postgres"."public"."dv_msat_fact_materials__dbt_tmp"
    
    
  as (
    WITH active_sat AS (
SELECT *
FROM (
        SELECT 
            hk_dv_hub_fact_work,
            hdiff_dv_msat_fact_materials,
            loadts,
            sub_seq,
            COUNT(*) OVER (PARTITION BY hk_dv_hub_fact_work, loadts) AS cnt,
            rank() OVER (
                PARTITION BY hk_dv_hub_fact_work
                ORDER BY loadts DESC
            ) AS rnk
        FROM dv_msat_fact_materials
    ) a (
        sat_id,
        sat_hdiff,
        sat_loadts,
        sat_sub_seq,
        sat_count,
        sat_rnk
    )
WHERE sat_rnk = 1
),
stage_cte AS (
    SELECT 
        stg_id,
        stg_hdiff,
        stg_loadts,
        stg_recsource,
        stg_sub_seq,
        номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
        COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
        lag(stg_hdiff) over(
            PARTITION BY stg_id, stg_sub_seq
            ORDER BY stg_loadts
        ) AS 
            stg_lag_hdiff,
            sat_hdiff,
            sat_count,
            sat_sub_seq,
            sat_rnk
    FROM (
            SELECT 
                s.hk_dv_hub_fact_work,
                s.hdiff_dv_msat_fact_materials,
                s.loadts,
                s.recsource,
                row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
            FROM stg_1c_materials s
                CROSS JOIN (
                    SELECT max(loadts) AS max_loadts
                    FROM dv_msat_fact_materials
                ) ml
            WHERE s.loadts > ml.max_loadts
        ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    LEFT JOIN active_sat a ON sat_id = stg_id
    AND sat_sub_seq = stg_sub_seq
),
stage_for_insert AS (
    SELECT DISTINCT 
        stg_id,
        stg_loadts
    FROM (
            SELECT stg_id,
                stg_loadts,
                stg_hdiff,
                stg_lag_hdiff,
                stg_count,
                lag(stg_count) over(
                    PARTITION BY stg_id,
                    stg_sub_seq
                    ORDER BY stg_loadts
                ) AS stg_lag_count,
                sat_hdiff,
                sat_count,
                sat_sub_seq,
                sat_rnk
            FROM stage_cte
        ) t
    WHERE (
            stg_hdiff <> stg_lag_hdiff
            OR stg_count <> stg_lag_count
        )
        OR (
            (
                stg_hdiff <> sat_hdiff
                AND stg_lag_hdiff IS NULL
            )
            OR (
                stg_count <> sat_count
                AND stg_lag_count IS NULL
            )
        )
)


INSERT INTO dv_msat_fact_materials (hk_dv_hub_fact_work, recsource, loadts, hdiff_dv_msat_fact_materials, sub_seq, номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name)
SELECT DISTINCT 
    stg_id,
    stg_recsource,
    stg_loadts,
    stg_hdiff,
    stg_sub_seq,
    номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
FROM stage_cte s
WHERE EXISTS(
        SELECT 1
        FROM stage_for_insert si
        WHERE si.stg_id = s.stg_id
            AND si.stg_loadts = s.stg_loadts
    )
ORDER BY stg_loadts,
    stg_id,
    stg_sub_seq
ON CONFLICT DO NOTHING;
  );
[0m09:31:03.965574 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: Close
[0m09:31:03.966898 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "INSERT"
LINE 115: INSERT INTO dv_msat_fact_materials (hk_dv_hub_fact_work, rec...
          ^

[0m09:31:03.968160 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "INSERT"
LINE 133: INSERT INTO dv_msat_fact_pikets (hk_dv_hub_fact_work, recsou...
          ^

[0m09:31:03.972657 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: ROLLBACK
[0m09:31:03.973995 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: ROLLBACK
[0m09:31:03.975280 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: Close
[0m09:31:03.976726 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: Close
[0m09:31:04.035525 [debug] [Thread-2 (]: Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  syntax error at or near "INSERT"
  LINE 133: INSERT INTO dv_msat_fact_pikets (hk_dv_hub_fact_work, recsou...
            ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_pikets.sql
[0m09:31:04.038789 [debug] [Thread-3 (]: Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  syntax error at or near "INSERT"
  LINE 143: INSERT INTO dv_msat_norm_workload (hk_dv_hub_fact_work, recs...
            ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_norm_workload.sql
[0m09:31:04.041617 [debug] [Thread-4 (]: Database Error in model dv_sat_fact_journal (tsm_dwh/models/dv/dv_sat_fact_journal.sql)
  syntax error at or near "INSERT"
  LINE 98: INSERT INTO dv_sat_fact_journal (hk_dv_hub_fact_journal, rec...
           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_sat_fact_journal.sql
[0m09:31:04.044796 [debug] [Thread-1 (]: Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  syntax error at or near "INSERT"
  LINE 115: INSERT INTO dv_msat_fact_materials (hk_dv_hub_fact_work, rec...
            ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_materials.sql
[0m09:31:04.046323 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0860ce60>]}
[0m09:31:04.047442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd09724890>]}
[0m09:31:04.048051 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0973ea80>]}
[0m09:31:04.049276 [error] [Thread-2 (]: 2 of 17 ERROR creating sql view model public.dv_msat_fact_pikets ............... [[31mERROR[0m in 0.42s]
[0m09:31:04.050127 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0d3bc470>]}
[0m09:31:04.051156 [error] [Thread-1 (]: 1 of 17 ERROR creating sql view model public.dv_msat_fact_materials ............ [[31mERROR[0m in 0.44s]
[0m09:31:04.052575 [error] [Thread-3 (]: 3 of 17 ERROR creating sql view model public.dv_msat_norm_workload ............. [[31mERROR[0m in 0.43s]
[0m09:31:04.053513 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_msat_fact_pikets
[0m09:31:04.054349 [error] [Thread-4 (]: 4 of 17 ERROR creating sql view model public.dv_sat_fact_journal ............... [[31mERROR[0m in 0.43s]
[0m09:31:04.055733 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_msat_fact_materials
[0m09:31:04.057173 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_msat_norm_workload
[0m09:31:04.058462 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_sat_fact_tech
[0m09:31:04.059468 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_fact_pikets' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  syntax error at or near "INSERT"
  LINE 133: INSERT INTO dv_msat_fact_pikets (hk_dv_hub_fact_work, recsou...
            ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_pikets.sql.
[0m09:31:04.060572 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_sat_fact_journal
[0m09:31:04.061304 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_sat_fact_work
[0m09:31:04.062077 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m09:31:04.063753 [info ] [Thread-2 (]: 5 of 17 START sql view model public.dv_sat_fact_tech ........................... [RUN]
[0m09:31:04.065709 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_fact_materials' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  syntax error at or near "INSERT"
  LINE 115: INSERT INTO dv_msat_fact_materials (hk_dv_hub_fact_work, rec...
            ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_materials.sql.
[0m09:31:04.066768 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_materials
[0m09:31:04.067649 [info ] [Thread-1 (]: 6 of 17 START sql view model public.dv_sat_fact_work ........................... [RUN]
[0m09:31:04.068506 [info ] [Thread-3 (]: 7 of 17 START sql view model public.stg_1c_journal ............................. [RUN]
[0m09:31:04.069364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_pikets, now model.tsm_dwh.dv_sat_fact_tech)
[0m09:31:04.070997 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_norm_workload' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  syntax error at or near "INSERT"
  LINE 143: INSERT INTO dv_msat_norm_workload (hk_dv_hub_fact_work, recs...
            ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_norm_workload.sql.
[0m09:31:04.072146 [info ] [Thread-4 (]: 8 of 17 START sql view model public.stg_1c_materials ........................... [RUN]
[0m09:31:04.073026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_materials, now model.tsm_dwh.dv_sat_fact_work)
[0m09:31:04.073797 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_norm_workload, now model.tsm_dwh.stg_1c_journal)
[0m09:31:04.074486 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_sat_fact_tech
[0m09:31:04.075939 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_sat_fact_journal' to be skipped because of status 'error'.  Reason: Database Error in model dv_sat_fact_journal (tsm_dwh/models/dv/dv_sat_fact_journal.sql)
  syntax error at or near "INSERT"
  LINE 98: INSERT INTO dv_sat_fact_journal (hk_dv_hub_fact_journal, rec...
           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_sat_fact_journal.sql.
[0m09:31:04.077076 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_journal, now model.tsm_dwh.stg_1c_materials)
[0m09:31:04.078353 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_sat_fact_work
[0m09:31:04.079548 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m09:31:04.083502 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_tech"
[0m09:31:04.084405 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_materials
[0m09:31:04.087116 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_work"
[0m09:31:04.093495 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_sat_fact_tech
[0m09:31:04.092590 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m09:31:04.100895 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_materials"
[0m09:31:04.108565 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_materials
[0m09:31:04.111904 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_tech"
[0m09:31:04.116799 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_materials"
[0m09:31:04.117437 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_sat_fact_work
[0m09:31:04.118501 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m09:31:04.124843 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m09:31:04.131080 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: BEGIN
[0m09:31:04.130575 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m09:31:04.132479 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_work"
[0m09:31:04.133157 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:31:04.134432 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:31:04.136000 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_materials: BEGIN
[0m09:31:04.136895 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:31:04.137782 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m09:31:04.138776 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: BEGIN
[0m09:31:04.139644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:04.140570 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:31:04.141946 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m09:31:04.143621 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:31:04.146742 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m09:31:04.147605 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m09:31:04.148661 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

  create view "postgres"."public"."dv_sat_fact_tech__dbt_tmp"
    
    
  as (
    WITH active_sat AS (
SELECT DISTINCT ON (hk_dv_lnk_fact_work_tech) hk_dv_lnk_fact_work_tech, hdiff_dv_sat_fact_tech, loadts
FROM dv_sat_fact_tech
ORDER BY hk_dv_lnk_fact_work_tech, loadts DESC)

, max_load AS (
SELECT max(loadts) AS max_loadts
FROM dv_sat_fact_tech
)

, stage_cte AS (
    SELECT
        s.hk_dv_lnk_fact_work_tech,
        s.hdiff_dv_sat_fact_tech,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_tech) over(PARTITION BY s.hk_dv_lnk_fact_work_tech ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_tech AS sat_hdiff,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name

    FROM
        (SELECT
            s.hk_dv_lnk_fact_work_tech,
            s.hdiff_dv_sat_fact_tech,
            s.loadts,
            s.recsource,
            примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
        FROM stg_1c_tech s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts) s

    LEFT JOIN active_sat a ON a.hk_dv_lnk_fact_work_tech = s.hk_dv_lnk_fact_work_tech)


INSERT INTO dv_sat_fact_tech (hk_dv_lnk_fact_work_tech, recsource, loadts, hdiff_dv_sat_fact_tech, примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
SELECT DISTINCT
    hk_dv_lnk_fact_work_tech,
    recsource,
    loadts,
    hdiff_dv_sat_fact_tech,
    примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM stage_cte
WHERE hdiff_dv_sat_fact_tech <> lag_hdiff or (hdiff_dv_sat_fact_tech <> sat_hdiff AND lag_hdiff IS NULL) OR sat_hdiff IS NULL
ORDER BY loadts
ON CONFLICT DO NOTHING;
  );
[0m09:31:04.150502 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "INSERT"
LINE 64: INSERT INTO dv_sat_fact_tech (hk_dv_lnk_fact_work_tech, recs...
         ^

[0m09:31:04.152544 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: ROLLBACK
[0m09:31:04.151531 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m09:31:04.153740 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:31:04.154927 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */

  create view "postgres"."public"."stg_1c_materials__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(НомерСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемМатериала::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_materials,
	НомерСтроки::int,
	Примечание::varchar,
	ОбъемМатериала::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar
    FROM 
        src_materials
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name)
  );
[0m09:31:04.156536 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: Close
[0m09:31:04.160228 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m09:31:04.163079 [debug] [Thread-2 (]: Database Error in model dv_sat_fact_tech (tsm_dwh/models/dv/dv_sat_fact_tech.sql)
  syntax error at or near "INSERT"
  LINE 64: INSERT INTO dv_sat_fact_tech (hk_dv_lnk_fact_work_tech, recs...
           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_sat_fact_tech.sql
[0m09:31:04.165874 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0861d6a0>]}
[0m09:31:04.163691 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:31:04.164915 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:31:04.164172 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m09:31:04.166744 [error] [Thread-2 (]: 5 of 17 ERROR creating sql view model public.dv_sat_fact_tech .................. [[31mERROR[0m in 0.10s]
[0m09:31:04.167758 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m09:31:04.179253 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m09:31:04.183806 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:31:04.185175 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_sat_fact_tech
[0m09:31:04.186680 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

  create view "postgres"."public"."dv_sat_fact_work__dbt_tmp"
    
    
  as (
    WITH active_sat AS (
SELECT DISTINCT ON (hk_dv_hub_fact_work) hk_dv_hub_fact_work, hdiff_dv_sat_fact_work, loadts
FROM dv_sat_fact_work
ORDER BY hk_dv_hub_fact_work, loadts DESC)

, max_load AS (
SELECT max(loadts) AS max_loadts
FROM dv_sat_fact_work
)

, stage_cte AS (
    SELECT
        s.hk_dv_hub_fact_work,
        s.hdiff_dv_sat_fact_work,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_work) over(PARTITION BY s.hk_dv_hub_fact_work ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_work AS sat_hdiff,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_work,
            s.hdiff_dv_sat_fact_work,
            s.loadts,
            s.recsource,
            идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
        FROM stg_1c_works s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts) s

    LEFT JOIN active_sat a ON a.hk_dv_hub_fact_work = s.hk_dv_hub_fact_work)


INSERT INTO dv_sat_fact_work (hk_dv_hub_fact_work, recsource, loadts, hdiff_dv_sat_fact_work, идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
SELECT DISTINCT
    hk_dv_hub_fact_work,
    recsource,
    loadts,
    hdiff_dv_sat_fact_work,
    идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM stage_cte
WHERE hdiff_dv_sat_fact_work <> lag_hdiff or (hdiff_dv_sat_fact_work <> sat_hdiff AND lag_hdiff IS NULL) OR sat_hdiff IS NULL
ORDER BY loadts
ON CONFLICT DO NOTHING;
  );
[0m09:31:04.188165 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials" rename to "stg_1c_materials__dbt_backup"
[0m09:31:04.189110 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_norm_workload
[0m09:31:04.189945 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_sat_fact_tech' to be skipped because of status 'error'.  Reason: Database Error in model dv_sat_fact_tech (tsm_dwh/models/dv/dv_sat_fact_tech.sql)
  syntax error at or near "INSERT"
  LINE 64: INSERT INTO dv_sat_fact_tech (hk_dv_lnk_fact_work_tech, recs...
           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_sat_fact_tech.sql.
[0m09:31:04.190871 [info ] [Thread-2 (]: 9 of 17 START sql view model public.stg_1c_norm_workload ....................... [RUN]
[0m09:31:04.192266 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_tech, now model.tsm_dwh.stg_1c_norm_workload)
[0m09:31:04.193449 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_norm_workload
[0m09:31:04.194640 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:31:04.200520 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_norm_workload"
[0m09:31:04.201297 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m09:31:04.201998 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "INSERT"
LINE 64: INSERT INTO dv_sat_fact_work (hk_dv_hub_fact_work, recsource...
         ^

[0m09:31:04.206344 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:31:04.213408 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:31:04.214604 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: ROLLBACK
[0m09:31:04.215652 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_norm_workload
[0m09:31:04.216340 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials__dbt_tmp" rename to "stg_1c_materials"
[0m09:31:04.216999 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m09:31:04.221802 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_norm_workload"
[0m09:31:04.222777 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: Close
[0m09:31:04.223870 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:31:04.225013 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:31:04.241590 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:31:04.242660 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m09:31:04.256142 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:31:04.256916 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m09:31:04.258001 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:31:04.260882 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m09:31:04.262685 [debug] [Thread-1 (]: Database Error in model dv_sat_fact_work (tsm_dwh/models/dv/dv_sat_fact_work.sql)
  syntax error at or near "INSERT"
  LINE 64: INSERT INTO dv_sat_fact_work (hk_dv_hub_fact_work, recsource...
           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_sat_fact_work.sql
[0m09:31:04.263341 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:31:04.263979 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_norm_workload: BEGIN
[0m09:31:04.264538 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:31:04.265304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0bd0caa0>]}
[0m09:31:04.265910 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m09:31:04.266498 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:31:04.267019 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m09:31:04.267886 [error] [Thread-1 (]: 6 of 17 ERROR creating sql view model public.dv_sat_fact_work .................. [[31mERROR[0m in 0.19s]
[0m09:31:04.269911 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_sat_fact_work
[0m09:31:04.270566 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_pikets
[0m09:31:04.271431 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_sat_fact_work' to be skipped because of status 'error'.  Reason: Database Error in model dv_sat_fact_work (tsm_dwh/models/dv/dv_sat_fact_work.sql)
  syntax error at or near "INSERT"
  LINE 64: INSERT INTO dv_sat_fact_work (hk_dv_hub_fact_work, recsource...
           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_sat_fact_work.sql.
[0m09:31:04.272288 [info ] [Thread-1 (]: 10 of 17 START sql view model public.stg_1c_pikets ............................. [RUN]
[0m09:31:04.273666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_work, now model.tsm_dwh.stg_1c_pikets)
[0m09:31:04.274431 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_pikets
[0m09:31:04.283859 [debug] [Thread-4 (]: SQL status: COMMIT in 0.015 seconds
[0m09:31:04.283255 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_pikets"
[0m09:31:04.295443 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."stg_1c_materials__dbt_backup"
[0m09:31:04.296359 [debug] [Thread-2 (]: SQL status: BEGIN in 0.030 seconds
[0m09:31:04.297512 [debug] [Thread-3 (]: SQL status: COMMIT in 0.028 seconds
[0m09:31:04.304609 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:31:04.305488 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:31:04.310635 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m09:31:04.311481 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_pikets
[0m09:31:04.312296 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
drop view if exists "postgres"."public"."stg_1c_materials__dbt_backup" cascade
[0m09:31:04.313183 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */

  create view "postgres"."public"."stg_1c_norm_workload__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(Период::varchar, 'N\A')) || '|' || TRIM(COALESCE(РассчетныйОбъем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьНормативная::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьФактическая::varchar, 'N\A')) || '|' || TRIM(COALESCE(НаемныйРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(НесколькоКлючевыхРесурсов::varchar, 'N\A')) || '|' || TRIM(COALESCE(ЖУФВР::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючДокументаРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_norm_workload,
	Период::timestamptz,
	РассчетныйОбъем::numeric,
	ТрудоемкостьНормативная::numeric,
	ТрудоемкостьФактическая::numeric,
	НаемныйРесурс::bool,
	КлючевойРесурс_value::uuid,
	КлючевойРесурс_codе::varchar,
	КлючевойРесурс_name::varchar,
	НесколькоКлючевыхРесурсов::bool,
	ЖУФВР::uuid,
	КлючДокументаРесурс::uuid,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	РесурсSpider_value::uuid,
	РесурсSpider_codе::varchar,
	РесурсSpider_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar
    FROM 
        src_norm_workload
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name)
  );
[0m09:31:04.314685 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:31:04.319507 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_pikets"
[0m09:31:04.320642 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m09:31:04.322147 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:31:04.323268 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_pikets: BEGIN
[0m09:31:04.324346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:04.325793 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:31:04.331216 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:31:04.331890 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.012 seconds
[0m09:31:04.332933 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload" rename to "stg_1c_norm_workload__dbt_backup"
[0m09:31:04.336836 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_materials: Close
[0m09:31:04.338082 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0ec935f0>]}
[0m09:31:04.339363 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:31:04.340641 [info ] [Thread-4 (]: 8 of 17 OK created sql view model public.stg_1c_materials ...................... [[32mCREATE VIEW[0m in 0.26s]
[0m09:31:04.341939 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m09:31:04.346992 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:31:04.348078 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.026 seconds
[0m09:31:04.348830 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_materials
[0m09:31:04.349520 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:31:04.350468 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload__dbt_tmp" rename to "stg_1c_norm_workload"
[0m09:31:04.353586 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m09:31:04.354507 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m09:31:04.355727 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */

  create view "postgres"."public"."stg_1c_pikets__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(КлючСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетС::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеС::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(Объем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_pikets,
	КлючСтроки::uuid,
	ПикетС::numeric,
	ПикетПо::numeric,
	СмещениеС::numeric,
	СмещениеПо::numeric,
	Объем::numeric,
	ВидПикета_value::uuid,
	ВидПикета_codе::varchar,
	ВидПикета_name::varchar,
	ТипПикета_value::uuid,
	ТипПикета_codе::varchar,
	ТипПикета_name::varchar,
	ГруппаПикетовSpider_value::uuid,
	ГруппаПикетовSpider_codе::varchar,
	ГруппаПикетовSpider_name::varchar
    FROM 
        src_pikets
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name)
  );
[0m09:31:04.357013 [info ] [Thread-4 (]: 11 of 17 START sql view model public.stg_1c_tech ............................... [RUN]
[0m09:31:04.358343 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0861f5f0>]}
[0m09:31:04.359123 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:31:04.360486 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_materials, now model.tsm_dwh.stg_1c_tech)
[0m09:31:04.361974 [info ] [Thread-3 (]: 7 of 17 OK created sql view model public.stg_1c_journal ........................ [[32mCREATE VIEW[0m in 0.28s]
[0m09:31:04.366058 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m09:31:04.366913 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:31:04.367517 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m09:31:04.368335 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m09:31:04.369122 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:31:04.376023 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:31:04.382707 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m09:31:04.383491 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_works
[0m09:31:04.384158 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m09:31:04.384992 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets" rename to "stg_1c_pikets__dbt_backup"
[0m09:31:04.385890 [info ] [Thread-3 (]: 12 of 17 START sql view model public.stg_1c_works .............................. [RUN]
[0m09:31:04.387369 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m09:31:04.388351 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:31:04.389022 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_journal, now model.tsm_dwh.stg_1c_works)
[0m09:31:04.397149 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m09:31:04.398298 [debug] [Thread-2 (]: SQL status: COMMIT in 0.012 seconds
[0m09:31:04.403314 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:31:04.404088 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m09:31:04.407456 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_norm_workload__dbt_backup"
[0m09:31:04.408518 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:31:04.409699 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets__dbt_tmp" rename to "stg_1c_pikets"
[0m09:31:04.416709 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:31:04.418024 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m09:31:04.418672 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m09:31:04.419447 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
drop view if exists "postgres"."public"."stg_1c_norm_workload__dbt_backup" cascade
[0m09:31:04.420526 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:31:04.421311 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:31:04.422217 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m09:31:04.425750 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m09:31:04.433061 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:31:04.434150 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.012 seconds
[0m09:31:04.435587 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m09:31:04.436266 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m09:31:04.438646 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_norm_workload: Close
[0m09:31:04.439526 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m09:31:04.440685 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd08566390>]}
[0m09:31:04.442194 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:31:04.443980 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:31:04.445522 [info ] [Thread-2 (]: 9 of 17 OK created sql view model public.stg_1c_norm_workload .................. [[32mCREATE VIEW[0m in 0.25s]
[0m09:31:04.447583 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m09:31:04.449243 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m09:31:04.450772 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_norm_workload
[0m09:31:04.451821 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:31:04.452705 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m09:31:04.453722 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m09:31:04.455186 [info ] [Thread-2 (]: 13 of 17 START sql incremental model public.dv_hub_fact_journal ................ [RUN]
[0m09:31:04.456103 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:31:04.462680 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_norm_workload, now model.tsm_dwh.dv_hub_fact_journal)
[0m09:31:04.461613 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_pikets__dbt_backup"
[0m09:31:04.467956 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:31:04.468841 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m09:31:04.469506 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m09:31:04.470649 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:31:04.471259 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech" rename to "stg_1c_tech__dbt_backup"
[0m09:31:04.482292 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:31:04.487313 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m09:31:04.487980 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
drop view if exists "postgres"."public"."stg_1c_pikets__dbt_backup" cascade
[0m09:31:04.488870 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m09:31:04.489911 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:31:04.497321 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m09:31:04.498285 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:31:04.498899 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:31:04.509828 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.019 seconds
[0m09:31:04.510596 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:31:04.516439 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech__dbt_tmp" rename to "stg_1c_tech"
[0m09:31:04.533185 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_pikets: Close
[0m09:31:04.547577 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works" rename to "stg_1c_works__dbt_backup"
[0m09:31:04.569243 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:31:04.570008 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:31:04.570962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd097621b0>]}
[0m09:31:04.572143 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:31:04.576585 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m09:31:04.578048 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

    
  
    

  create temporary table "dv_hub_fact_journal__dbt_tmp093104548204"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_journal" target
    where 
        target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_journal 
)

  );
  
  
[0m09:31:04.579287 [info ] [Thread-1 (]: 10 of 17 OK created sql view model public.stg_1c_pikets ........................ [[32mCREATE VIEW[0m in 0.30s]
[0m09:31:04.583722 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:31:04.584468 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:31:04.585120 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:31:04.586366 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_pikets
[0m09:31:04.587063 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works__dbt_tmp" rename to "stg_1c_works"
[0m09:31:04.587813 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m09:31:04.589711 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:31:04.593547 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m09:31:04.594690 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:31:04.595633 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m09:31:04.600444 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m09:31:04.605452 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."stg_1c_tech__dbt_backup"
[0m09:31:04.606095 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.021 seconds
[0m09:31:04.607222 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:31:04.669701 [debug] [Thread-3 (]: SQL status: COMMIT in 0.073 seconds
[0m09:31:04.687928 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:31:04.688626 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
drop view if exists "postgres"."public"."stg_1c_tech__dbt_backup" cascade
[0m09:31:04.692920 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_works__dbt_backup"
[0m09:31:04.693731 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: BEGIN
[0m09:31:04.696152 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:31:04.697361 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
drop view if exists "postgres"."public"."stg_1c_works__dbt_backup" cascade
[0m09:31:04.698190 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:31:04.699114 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:31:04.700217 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal__dbt_tmp093104548204'
        
      order by ordinal_position

  
[0m09:31:04.706752 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.006 seconds
[0m09:31:04.716086 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.021 seconds
[0m09:31:04.716936 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:31:04.718878 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m09:31:04.719525 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.021 seconds
[0m09:31:04.720129 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:31:04.722095 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: Close
[0m09:31:04.722787 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd097618e0>]}
[0m09:31:04.724201 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd08604b00>]}
[0m09:31:04.726268 [info ] [Thread-4 (]: 11 of 17 OK created sql view model public.stg_1c_tech .......................... [[32mCREATE VIEW[0m in 0.36s]
[0m09:31:04.729718 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.006 seconds
[0m09:31:04.730711 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m09:31:04.728809 [info ] [Thread-3 (]: 12 of 17 OK created sql view model public.stg_1c_works ......................... [[32mCREATE VIEW[0m in 0.34s]
[0m09:31:04.743102 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:31:04.744870 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m09:31:04.746024 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m09:31:04.746946 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:31:04.747910 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:31:04.749631 [info ] [Thread-1 (]: 14 of 17 START sql incremental model public.dv_hub_tech ........................ [RUN]
[0m09:31:04.750580 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m09:31:04.751492 [info ] [Thread-4 (]: 15 of 17 START sql incremental model public.dv_lnk_fact_work_tech .............. [RUN]
[0m09:31:04.752543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_pikets, now model.tsm_dwh.dv_hub_tech)
[0m09:31:04.753247 [info ] [Thread-3 (]: 16 of 17 START sql incremental model public.dv_hub_fact_work ................... [RUN]
[0m09:31:04.754181 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.004 seconds
[0m09:31:04.754825 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_lnk_fact_work_tech)
[0m09:31:04.755593 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m09:31:04.756334 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_works, now model.tsm_dwh.dv_hub_fact_work)
[0m09:31:04.767692 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:31:04.771168 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_journal"
[0m09:31:04.777446 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m09:31:04.778368 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m09:31:04.783614 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:31:04.788121 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m09:31:04.789059 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:31:04.790114 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m09:31:04.791575 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:31:04.792590 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      insert into "postgres"."public"."dv_hub_fact_journal" ("hk_dv_hub_fact_journal", "hkcode", "recsource", "loadts", "bk_жуфвр_uuid")
    (
        select "hk_dv_hub_fact_journal", "hkcode", "recsource", "loadts", "bk_жуфвр_uuid"
        from "dv_hub_fact_journal__dbt_tmp093104548204"
    )


  
[0m09:31:04.799465 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:31:04.800179 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m09:31:04.805315 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:31:04.806263 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

    
  
    

  create temporary table "dv_hub_tech__dbt_tmp093104796687"
  
  
    as
  
  (
    

SELECT distinct on (bk_ресурс_uuid)
        hk_dv_hub_tech,
        hkcode,
        recsource,
        loadts,
        bk_ресурс_uuid
FROM "postgres"."public"."stg_1c_tech" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_tech" target
    where 
        target.hk_dv_hub_tech = stg.hk_dv_hub_tech 
)

  );
  
  
[0m09:31:04.807368 [debug] [Thread-2 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m09:31:04.816358 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:31:04.817113 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

    
  
    

  create temporary table "dv_lnk_fact_work_tech__dbt_tmp093104802846"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_work,
	hk_dv_hub_tech)
        hk_dv_lnk_fact_work_tech,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_work,
	hk_dv_hub_tech
FROM "postgres"."public"."stg_1c_tech" stg


where not exists (
    select 1
    from "postgres"."public"."dv_lnk_fact_work_tech" target
    where 
        target.hk_dv_lnk_fact_work_tech = stg.hk_dv_lnk_fact_work_tech 
)

  );
  
  
[0m09:31:04.817810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:04.820019 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m09:31:04.820605 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

    
  
    

  create temporary table "dv_hub_fact_work__dbt_tmp093104811729"
  
  
    as
  
  (
    

SELECT distinct on (bk_работа_uuid)
        hk_dv_hub_fact_work,
        hkcode,
        recsource,
        loadts,
        bk_работа_uuid
FROM "postgres"."public"."stg_1c_works" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_work" target
    where 
        target.hk_dv_hub_fact_work = stg.hk_dv_hub_fact_work 
)

  );
  
  
[0m09:31:04.821257 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:31:04.822385 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:31:04.823220 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:31:04.824467 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m09:31:04.841070 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m09:31:04.843461 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m09:31:04.844746 [debug] [Thread-3 (]: SQL status: SELECT 22 in 0.021 seconds
[0m09:31:04.846034 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.028 seconds
[0m09:31:04.846929 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd08531c10>]}
[0m09:31:04.847524 [debug] [Thread-4 (]: SQL status: SELECT 63 in 0.026 seconds
[0m09:31:04.851564 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:31:04.855140 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:31:04.856046 [info ] [Thread-2 (]: 13 of 17 OK created sql incremental model public.dv_hub_fact_journal ........... [[32mINSERT 0 1[0m in 0.38s]
[0m09:31:04.860837 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:31:04.862352 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: BEGIN
[0m09:31:04.863718 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_tech: BEGIN
[0m09:31:04.864617 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m09:31:04.865327 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: BEGIN
[0m09:31:04.866356 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m09:31:04.866979 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m09:31:04.867568 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:31:04.868444 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:31:04.869189 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:31:04.869847 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:31:04.870607 [info ] [Thread-2 (]: 17 of 17 START sql incremental model public.dv_lnk_fact_journal_fact_work ...... [RUN]
[0m09:31:04.871517 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work__dbt_tmp093104811729'
        
      order by ordinal_position

  
[0m09:31:04.872102 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:31:04.872839 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech__dbt_tmp093104796687'
        
      order by ordinal_position

  
[0m09:31:04.873963 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_fact_journal, now model.tsm_dwh.dv_lnk_fact_journal_fact_work)
[0m09:31:04.877184 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:31:04.875477 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech__dbt_tmp093104802846'
        
      order by ordinal_position

  
[0m09:31:04.886266 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:31:04.887335 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:31:04.888622 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.012 seconds
[0m09:31:04.894512 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.019 seconds
[0m09:31:04.900489 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:31:04.901502 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.015 seconds
[0m09:31:04.905435 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:31:04.911996 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:31:04.912729 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

    
  
    

  create temporary table "dv_lnk_fact_journal_fact_work__dbt_tmp093104894049"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work)
        hk_dv_lnk_fact_journal_fact_work,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work
FROM "postgres"."public"."stg_1c_works" stg


where not exists (
    select 1
    from "postgres"."public"."dv_lnk_fact_journal_fact_work" target
    where 
        target.hk_dv_lnk_fact_journal_fact_work = stg.hk_dv_lnk_fact_journal_fact_work 
)

  );
  
  
[0m09:31:04.916991 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:31:04.917688 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:31:04.918453 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:31:04.919028 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:31:04.919689 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:31:04.924834 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m09:31:04.926161 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.005 seconds
[0m09:31:04.931412 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:31:04.932192 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.012 seconds
[0m09:31:04.938322 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:31:04.939012 [debug] [Thread-2 (]: SQL status: SELECT 22 in 0.020 seconds
[0m09:31:04.937591 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:31:04.944944 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:31:04.951366 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:31:04.952092 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m09:31:04.952778 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:31:04.953526 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:31:04.954167 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: BEGIN
[0m09:31:04.957221 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_tech"
[0m09:31:04.958780 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m09:31:04.960443 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:31:04.961497 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:31:04.962495 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.004 seconds
[0m09:31:04.963221 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      insert into "postgres"."public"."dv_hub_tech" ("hk_dv_hub_tech", "hkcode", "recsource", "loadts", "bk_ресурс_uuid")
    (
        select "hk_dv_hub_tech", "hkcode", "recsource", "loadts", "bk_ресурс_uuid"
        from "dv_hub_tech__dbt_tmp093104796687"
    )


  
[0m09:31:04.963910 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.006 seconds
[0m09:31:04.964894 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work__dbt_tmp093104894049'
        
      order by ordinal_position

  
[0m09:31:04.967589 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:31:04.970226 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_work"
[0m09:31:04.971175 [debug] [Thread-1 (]: SQL status: INSERT 0 17 in 0.003 seconds
[0m09:31:04.974117 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m09:31:04.975497 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:31:04.976761 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:31:04.977475 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:31:04.978226 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m09:31:04.979492 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      insert into "postgres"."public"."dv_lnk_fact_work_tech" ("hk_dv_lnk_fact_work_tech", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_work", "hk_dv_hub_tech")
    (
        select "hk_dv_lnk_fact_work_tech", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_work", "hk_dv_hub_tech"
        from "dv_lnk_fact_work_tech__dbt_tmp093104802846"
    )


  
[0m09:31:04.980127 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      insert into "postgres"."public"."dv_hub_fact_work" ("hk_dv_hub_fact_work", "hkcode", "recsource", "loadts", "bk_работа_uuid")
    (
        select "hk_dv_hub_fact_work", "hkcode", "recsource", "loadts", "bk_работа_uuid"
        from "dv_hub_fact_work__dbt_tmp093104811729"
    )


  
[0m09:31:04.980876 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.009 seconds
[0m09:31:04.987528 [debug] [Thread-4 (]: SQL status: INSERT 0 63 in 0.006 seconds
[0m09:31:04.988557 [debug] [Thread-3 (]: SQL status: INSERT 0 22 in 0.007 seconds
[0m09:31:04.992155 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m09:31:04.987094 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:31:04.993846 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m09:31:04.996457 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m09:31:04.997324 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:31:04.997962 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:31:04.998951 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_tech: Close
[0m09:31:04.999742 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:31:05.000459 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m09:31:05.001304 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m09:31:05.002112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd086fb770>]}
[0m09:31:05.003453 [info ] [Thread-1 (]: 14 of 17 OK created sql incremental model public.dv_hub_tech ................... [[32mINSERT 0 17[0m in 0.25s]
[0m09:31:05.004592 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m09:31:05.005217 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.004 seconds
[0m09:31:05.013436 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:31:05.015014 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:31:05.018892 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.003 seconds
[0m09:31:05.021684 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:31:05.022465 [debug] [Thread-3 (]: SQL status: COMMIT in 0.019 seconds
[0m09:31:05.023130 [debug] [Thread-4 (]: SQL status: COMMIT in 0.020 seconds
[0m09:31:05.024933 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: Close
[0m09:31:05.027059 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: Close
[0m09:31:05.028561 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:31:05.030205 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0856e180>]}
[0m09:31:05.031829 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0856d040>]}
[0m09:31:05.032583 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      insert into "postgres"."public"."dv_lnk_fact_journal_fact_work" ("hk_dv_lnk_fact_journal_fact_work", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_journal", "hk_dv_hub_fact_work")
    (
        select "hk_dv_lnk_fact_journal_fact_work", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_journal", "hk_dv_hub_fact_work"
        from "dv_lnk_fact_journal_fact_work__dbt_tmp093104894049"
    )


  
[0m09:31:05.033623 [info ] [Thread-3 (]: 16 of 17 OK created sql incremental model public.dv_hub_fact_work .............. [[32mINSERT 0 22[0m in 0.27s]
[0m09:31:05.034769 [info ] [Thread-4 (]: 15 of 17 OK created sql incremental model public.dv_lnk_fact_work_tech ......... [[32mINSERT 0 63[0m in 0.28s]
[0m09:31:05.036217 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m09:31:05.037104 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:31:05.037993 [debug] [Thread-2 (]: SQL status: INSERT 0 22 in 0.002 seconds
[0m09:31:05.041889 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m09:31:05.043516 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:31:05.044911 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m09:31:05.057216 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m09:31:05.059478 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: Close
[0m09:31:05.061011 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07710644-e97d-4591-962f-d5cabc20de19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd098d61b0>]}
[0m09:31:05.062725 [info ] [Thread-2 (]: 17 of 17 OK created sql incremental model public.dv_lnk_fact_journal_fact_work . [[32mINSERT 0 22[0m in 0.19s]
[0m09:31:05.064259 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:31:05.066358 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:05.067426 [debug] [MainThread]: On master: BEGIN
[0m09:31:05.067887 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:31:05.080248 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:31:05.080952 [debug] [MainThread]: On master: COMMIT
[0m09:31:05.081644 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:05.082086 [debug] [MainThread]: On master: COMMIT
[0m09:31:05.082758 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:31:05.083203 [debug] [MainThread]: On master: Close
[0m09:31:05.084143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:31:05.085052 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_tech' was properly closed.
[0m09:31:05.086045 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work' was properly closed.
[0m09:31:05.086699 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_work' was properly closed.
[0m09:31:05.087108 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_work_tech' was properly closed.
[0m09:31:05.087737 [info ] [MainThread]: 
[0m09:31:05.088449 [info ] [MainThread]: Finished running 5 incremental models, 12 view models in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m09:31:05.095333 [debug] [MainThread]: Command end result
[0m09:31:05.133609 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m09:31:05.135504 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m09:31:05.147439 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m09:31:05.147989 [info ] [MainThread]: 
[0m09:31:05.148895 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m09:31:05.149966 [info ] [MainThread]: 
[0m09:31:05.151021 [error] [MainThread]:   Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  syntax error at or near "INSERT"
  LINE 133: INSERT INTO dv_msat_fact_pikets (hk_dv_hub_fact_work, recsou...
            ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_pikets.sql
[0m09:31:05.152000 [info ] [MainThread]: 
[0m09:31:05.152957 [error] [MainThread]:   Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  syntax error at or near "INSERT"
  LINE 115: INSERT INTO dv_msat_fact_materials (hk_dv_hub_fact_work, rec...
            ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_materials.sql
[0m09:31:05.153738 [info ] [MainThread]: 
[0m09:31:05.154793 [error] [MainThread]:   Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  syntax error at or near "INSERT"
  LINE 143: INSERT INTO dv_msat_norm_workload (hk_dv_hub_fact_work, recs...
            ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_norm_workload.sql
[0m09:31:05.155459 [info ] [MainThread]: 
[0m09:31:05.156573 [error] [MainThread]:   Database Error in model dv_sat_fact_journal (tsm_dwh/models/dv/dv_sat_fact_journal.sql)
  syntax error at or near "INSERT"
  LINE 98: INSERT INTO dv_sat_fact_journal (hk_dv_hub_fact_journal, rec...
           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_sat_fact_journal.sql
[0m09:31:05.157551 [info ] [MainThread]: 
[0m09:31:05.158745 [error] [MainThread]:   Database Error in model dv_sat_fact_tech (tsm_dwh/models/dv/dv_sat_fact_tech.sql)
  syntax error at or near "INSERT"
  LINE 64: INSERT INTO dv_sat_fact_tech (hk_dv_lnk_fact_work_tech, recs...
           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_sat_fact_tech.sql
[0m09:31:05.159857 [info ] [MainThread]: 
[0m09:31:05.161185 [error] [MainThread]:   Database Error in model dv_sat_fact_work (tsm_dwh/models/dv/dv_sat_fact_work.sql)
  syntax error at or near "INSERT"
  LINE 64: INSERT INTO dv_sat_fact_work (hk_dv_hub_fact_work, recsource...
           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_sat_fact_work.sql
[0m09:31:05.162220 [info ] [MainThread]: 
[0m09:31:05.163182 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=6 SKIP=0 TOTAL=17
[0m09:31:05.165455 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.746019, "process_in_blocks": "47456", "process_kernel_time": 0.409182, "process_mem_max_rss": "122396", "process_out_blocks": "3376", "process_user_time": 4.038755}
[0m09:31:05.166738 [debug] [MainThread]: Command `dbt build` failed at 09:31:05.166462 after 2.75 seconds
[0m09:31:05.167810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0cb656a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0c7fe750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0976b170>]}
[0m09:31:05.168891 [debug] [MainThread]: Flushing usage events
[0m09:31:06.283478 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:31:35.434496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b8c15760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b895a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b9186750>]}


============================== 09:31:35.438288 | 5dae5e58-1bb2-448c-919d-882f65afcc0c ==============================
[0m09:31:35.438288 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:31:35.439110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build -s tag:stage, hub, link', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:31:35.620538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dae5e58-1bb2-448c-919d-882f65afcc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b861a390>]}
[0m09:31:35.688151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dae5e58-1bb2-448c-919d-882f65afcc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b8c14ec0>]}
[0m09:31:35.689143 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:31:35.812775 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:31:35.911612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:31:35.912149 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:31:35.948865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dae5e58-1bb2-448c-919d-882f65afcc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b7f96a80>]}
[0m09:31:36.021713 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m09:31:36.024348 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m09:31:36.053082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dae5e58-1bb2-448c-919d-882f65afcc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b779fb90>]}
[0m09:31:36.053843 [info ] [MainThread]: Found 17 models, 433 macros
[0m09:31:36.055018 [warn ] [MainThread]: The selection criterion 'tag:stage,' does not match any enabled nodes
[0m09:31:36.055889 [warn ] [MainThread]: The selection criterion 'hub,' does not match any enabled nodes
[0m09:31:36.056656 [warn ] [MainThread]: The selection criterion 'link' does not match any enabled nodes
[0m09:31:36.057588 [warn ] [MainThread]: The selection criterion 'tag:stage,' does not match any enabled nodes
[0m09:31:36.058546 [warn ] [MainThread]: The selection criterion 'hub,' does not match any enabled nodes
[0m09:31:36.059307 [warn ] [MainThread]: The selection criterion 'link' does not match any enabled nodes
[0m09:31:36.060572 [warn ] [MainThread]: The selection criterion 'tag:stage,' does not match any enabled nodes
[0m09:31:36.061605 [warn ] [MainThread]: The selection criterion 'hub,' does not match any enabled nodes
[0m09:31:36.062453 [warn ] [MainThread]: The selection criterion 'link' does not match any enabled nodes
[0m09:31:36.064185 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:31:36.068436 [debug] [MainThread]: Command end result
[0m09:31:36.106123 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m09:31:36.109007 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m09:31:36.115312 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m09:31:36.116611 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.73878354, "process_in_blocks": "2080", "process_kernel_time": 0.211215, "process_mem_max_rss": "108756", "process_out_blocks": "2304", "process_user_time": 2.072637}
[0m09:31:36.117247 [debug] [MainThread]: Command `dbt build` succeeded at 09:31:36.117063 after 0.74 seconds
[0m09:31:36.117875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b8a884a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b8c15fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4b91aa960>]}
[0m09:31:36.118407 [debug] [MainThread]: Flushing usage events
[0m09:31:37.003565 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:32:43.288994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bca22900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bc8ea3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bd393380>]}


============================== 09:32:43.294563 | bdd47ecf-5803-484d-82ff-2f6483c41f64 ==============================
[0m09:32:43.294563 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:32:43.295556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build -s tag:stage,-tag:hub, -tag:link', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:32:43.298510 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'tsm_dwh' does not have a target named 'ag:link'. The valid target names for this profile are:
   - dev
[0m09:32:43.300270 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.07060333, "process_in_blocks": "32992", "process_kernel_time": 0.205251, "process_mem_max_rss": "93304", "process_out_blocks": "16", "process_user_time": 1.598371}
[0m09:32:43.301441 [debug] [MainThread]: Command `dbt build` failed at 09:32:43.301166 after 0.07 seconds
[0m09:32:43.302173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bca22900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bc353950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bc3538c0>]}
[0m09:32:43.302923 [debug] [MainThread]: Flushing usage events
[0m09:32:44.280682 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:33:40.918583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a9e14fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a9c24890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a9e97f20>]}


============================== 09:33:40.922321 | ca36a645-b59d-4c87-bd1b-3c0346cacce3 ==============================
[0m09:33:40.922321 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:33:40.923257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build -s tag:stage,-tag:hub, -tag:link', 'send_anonymous_usage_stats': 'True'}
[0m09:33:40.926192 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'tsm_dwh' does not have a target named 'ag:link'. The valid target names for this profile are:
   - dev
[0m09:33:40.927419 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.0658197, "process_in_blocks": "32", "process_kernel_time": 0.149114, "process_mem_max_rss": "93560", "process_out_blocks": "8", "process_user_time": 1.481071}
[0m09:33:40.928041 [debug] [MainThread]: Command `dbt build` failed at 09:33:40.927917 after 0.07 seconds
[0m09:33:40.928920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a9e63e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a9931250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3aa346900>]}
[0m09:33:40.929588 [debug] [MainThread]: Flushing usage events
[0m09:33:41.717487 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:33:48.940801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aaf506e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ab174caa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aaf539eb0>]}


============================== 09:33:48.944595 | 710fe247-72d3-409a-9dab-9b1c49c974de ==============================
[0m09:33:48.944595 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:33:48.945524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -s tag:stage,tag:hub, tag:link', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:33:49.144859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '710fe247-72d3-409a-9dab-9b1c49c974de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aaf0b1760>]}
[0m09:33:49.210509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '710fe247-72d3-409a-9dab-9b1c49c974de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aafe6e9c0>]}
[0m09:33:49.211565 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:33:49.342620 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:33:49.444702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:33:49.445191 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:33:49.475268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '710fe247-72d3-409a-9dab-9b1c49c974de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aaedd2420>]}
[0m09:33:49.546908 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m09:33:49.549788 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m09:33:49.593842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '710fe247-72d3-409a-9dab-9b1c49c974de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aae1c8d40>]}
[0m09:33:49.594503 [info ] [MainThread]: Found 17 models, 433 macros
[0m09:33:49.595862 [warn ] [MainThread]: The selection criterion 'tag:stage,tag:hub,' does not match any enabled nodes
[0m09:33:49.596949 [warn ] [MainThread]: The selection criterion 'tag:stage,tag:hub,' does not match any enabled nodes
[0m09:33:49.597874 [warn ] [MainThread]: The selection criterion 'tag:stage,tag:hub,' does not match any enabled nodes
[0m09:33:49.599670 [info ] [MainThread]: 
[0m09:33:49.600326 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:33:49.601251 [info ] [MainThread]: 
[0m09:33:49.602293 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:33:49.610252 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:33:49.727694 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:33:49.728564 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:33:49.729327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:33:49.764545 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.035 seconds
[0m09:33:49.767215 [debug] [ThreadPool]: On list_postgres: Close
[0m09:33:49.771366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m09:33:49.778133 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m09:33:49.778747 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m09:33:49.779205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:33:49.791612 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m09:33:49.792287 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m09:33:49.792793 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:33:49.796163 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.003 seconds
[0m09:33:49.798124 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m09:33:49.798807 [debug] [ThreadPool]: On list_postgres_public: Close
[0m09:33:49.809466 [debug] [MainThread]: Using postgres connection "master"
[0m09:33:49.810001 [debug] [MainThread]: On master: BEGIN
[0m09:33:49.810469 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:33:49.819306 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:33:49.819915 [debug] [MainThread]: Using postgres connection "master"
[0m09:33:49.820495 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:33:49.827812 [debug] [MainThread]: SQL status: SELECT 7 in 0.007 seconds
[0m09:33:49.830873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '710fe247-72d3-409a-9dab-9b1c49c974de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aaf0b1880>]}
[0m09:33:49.831468 [debug] [MainThread]: On master: ROLLBACK
[0m09:33:49.832187 [debug] [MainThread]: Using postgres connection "master"
[0m09:33:49.832750 [debug] [MainThread]: On master: BEGIN
[0m09:33:49.833454 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:33:49.833900 [debug] [MainThread]: On master: COMMIT
[0m09:33:49.834385 [debug] [MainThread]: Using postgres connection "master"
[0m09:33:49.834872 [debug] [MainThread]: On master: COMMIT
[0m09:33:49.835456 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:33:49.835903 [debug] [MainThread]: On master: Close
[0m09:33:49.840589 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:33:49.841192 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:33:49.842043 [info ] [Thread-1 (]: 1 of 2 START sql incremental model public.dv_lnk_fact_journal_fact_work ........ [RUN]
[0m09:33:49.842780 [info ] [Thread-2 (]: 2 of 2 START sql incremental model public.dv_lnk_fact_work_tech ................ [RUN]
[0m09:33:49.843678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.dv_lnk_fact_journal_fact_work)
[0m09:33:49.844498 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_lnk_fact_work_tech'
[0m09:33:49.845128 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:33:49.846096 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:33:49.876442 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:33:49.877214 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:33:49.878218 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:33:49.889190 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:33:49.999089 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:33:50.000539 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:33:50.001127 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

    
  
    

  create temporary table "dv_lnk_fact_journal_fact_work__dbt_tmp093349945267"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work)
        hk_dv_lnk_fact_journal_fact_work,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work
FROM "postgres"."public"."stg_1c_works" stg


where not exists (
    select 1
    from "postgres"."public"."dv_lnk_fact_journal_fact_work" target
    where 
        target.hk_dv_lnk_fact_journal_fact_work = stg.hk_dv_lnk_fact_journal_fact_work 
)

  );
  
  
[0m09:33:50.001906 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

    
  
    

  create temporary table "dv_lnk_fact_work_tech__dbt_tmp093349949540"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_work,
	hk_dv_hub_tech)
        hk_dv_lnk_fact_work_tech,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_work,
	hk_dv_hub_tech
FROM "postgres"."public"."stg_1c_tech" stg


where not exists (
    select 1
    from "postgres"."public"."dv_lnk_fact_work_tech" target
    where 
        target.hk_dv_lnk_fact_work_tech = stg.hk_dv_lnk_fact_work_tech 
)

  );
  
  
[0m09:33:50.002519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:33:50.003144 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:33:50.023403 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.021 seconds
[0m09:33:50.024201 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.021 seconds
[0m09:33:50.040541 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:33:50.048169 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:33:50.049216 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: BEGIN
[0m09:33:50.050183 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: BEGIN
[0m09:33:50.051406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:33:50.052138 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:33:50.053160 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:33:50.054029 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:33:50.055284 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work__dbt_tmp093349945267'
        
      order by ordinal_position

  
[0m09:33:50.056147 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech__dbt_tmp093349949540'
        
      order by ordinal_position

  
[0m09:33:50.064196 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m09:33:50.070690 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:33:50.071457 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:33:50.071999 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.015 seconds
[0m09:33:50.075876 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:33:50.076513 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m09:33:50.077064 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:33:50.085797 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:33:50.086682 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:33:50.089802 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.003 seconds
[0m09:33:50.090393 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m09:33:50.094090 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:33:50.100059 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:33:50.104325 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:33:50.105588 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:33:50.106578 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      insert into "postgres"."public"."dv_lnk_fact_journal_fact_work" ("hk_dv_lnk_fact_journal_fact_work", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_journal", "hk_dv_hub_fact_work")
    (
        select "hk_dv_lnk_fact_journal_fact_work", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_journal", "hk_dv_hub_fact_work"
        from "dv_lnk_fact_journal_fact_work__dbt_tmp093349945267"
    )


  
[0m09:33:50.107746 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m09:33:50.113666 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.009 seconds
[0m09:33:50.122114 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:33:50.128256 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m09:33:50.128892 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:33:50.129409 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m09:33:50.130156 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:33:50.130788 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      insert into "postgres"."public"."dv_lnk_fact_work_tech" ("hk_dv_lnk_fact_work_tech", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_work", "hk_dv_hub_tech")
    (
        select "hk_dv_lnk_fact_work_tech", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_work", "hk_dv_hub_tech"
        from "dv_lnk_fact_work_tech__dbt_tmp093349949540"
    )


  
[0m09:33:50.131760 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m09:33:50.133922 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m09:33:50.134810 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:33:50.135435 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m09:33:50.161113 [debug] [Thread-1 (]: SQL status: COMMIT in 0.031 seconds
[0m09:33:50.163478 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: Close
[0m09:33:50.165661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '710fe247-72d3-409a-9dab-9b1c49c974de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aafc78860>]}
[0m09:33:50.166528 [info ] [Thread-1 (]: 1 of 2 OK created sql incremental model public.dv_lnk_fact_journal_fact_work ... [[32mINSERT 0 0[0m in 0.32s]
[0m09:33:50.167629 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:33:50.186072 [debug] [Thread-2 (]: SQL status: COMMIT in 0.050 seconds
[0m09:33:50.187847 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: Close
[0m09:33:50.189196 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '710fe247-72d3-409a-9dab-9b1c49c974de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aac0ee990>]}
[0m09:33:50.190336 [info ] [Thread-2 (]: 2 of 2 OK created sql incremental model public.dv_lnk_fact_work_tech ........... [[32mINSERT 0 0[0m in 0.34s]
[0m09:33:50.191633 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:33:50.193510 [debug] [MainThread]: Using postgres connection "master"
[0m09:33:50.194544 [debug] [MainThread]: On master: BEGIN
[0m09:33:50.194997 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:33:50.206544 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m09:33:50.207168 [debug] [MainThread]: On master: COMMIT
[0m09:33:50.207822 [debug] [MainThread]: Using postgres connection "master"
[0m09:33:50.208582 [debug] [MainThread]: On master: COMMIT
[0m09:33:50.209275 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:33:50.209779 [debug] [MainThread]: On master: Close
[0m09:33:50.210444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:33:50.210877 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work' was properly closed.
[0m09:33:50.211292 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_work_tech' was properly closed.
[0m09:33:50.211858 [info ] [MainThread]: 
[0m09:33:50.212435 [info ] [MainThread]: Finished running 2 incremental models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m09:33:50.213596 [debug] [MainThread]: Command end result
[0m09:33:50.255845 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m09:33:50.258707 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m09:33:50.265858 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m09:33:50.266403 [info ] [MainThread]: 
[0m09:33:50.267088 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:33:50.267760 [info ] [MainThread]: 
[0m09:33:50.268494 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:33:50.269755 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.38492, "process_in_blocks": "4776", "process_kernel_time": 0.248662, "process_mem_max_rss": "120712", "process_out_blocks": "2440", "process_user_time": 2.474856}
[0m09:33:50.270330 [debug] [MainThread]: Command `dbt build` succeeded at 09:33:50.270186 after 1.39 seconds
[0m09:33:50.270947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aaf26d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ab174caa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6aaf538710>]}
[0m09:33:50.271488 [debug] [MainThread]: Flushing usage events
[0m09:33:51.250662 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:34:44.738318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaf0d10a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaf0b81d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaf129ff80>]}


============================== 09:34:44.742432 | b121497b-db64-4f9c-8b06-c9dbaa836cd8 ==============================
[0m09:34:44.742432 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:34:44.743250 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build -s tag:stage,tag:hub, tag:link', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:34:44.924096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b121497b-db64-4f9c-8b06-c9dbaa836cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaf070ce30>]}
[0m09:34:44.991758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b121497b-db64-4f9c-8b06-c9dbaa836cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaf0c498e0>]}
[0m09:34:44.992807 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:34:45.112186 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:34:45.204410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:34:45.204895 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:34:45.234623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b121497b-db64-4f9c-8b06-c9dbaa836cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaeff15bb0>]}
[0m09:34:45.306684 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m09:34:45.309446 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m09:34:45.338163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b121497b-db64-4f9c-8b06-c9dbaa836cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaeef08b60>]}
[0m09:34:45.339007 [info ] [MainThread]: Found 17 models, 433 macros
[0m09:34:45.340710 [warn ] [MainThread]: The selection criterion 'tag:stage,tag:hub,' does not match any enabled nodes
[0m09:34:45.341845 [warn ] [MainThread]: The selection criterion 'tag:stage,tag:hub,' does not match any enabled nodes
[0m09:34:45.342844 [warn ] [MainThread]: The selection criterion 'tag:stage,tag:hub,' does not match any enabled nodes
[0m09:34:45.344698 [info ] [MainThread]: 
[0m09:34:45.345338 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:34:45.346231 [info ] [MainThread]: 
[0m09:34:45.347210 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:34:45.353946 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:34:45.409693 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:34:45.410244 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:34:45.410742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:45.422500 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.012 seconds
[0m09:34:45.424310 [debug] [ThreadPool]: On list_postgres: Close
[0m09:34:45.428445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m09:34:45.435360 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m09:34:45.435891 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m09:34:45.436328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:45.444911 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m09:34:45.445445 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m09:34:45.445930 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:34:45.449179 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.003 seconds
[0m09:34:45.451138 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m09:34:45.451820 [debug] [ThreadPool]: On list_postgres_public: Close
[0m09:34:45.461233 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:45.461771 [debug] [MainThread]: On master: BEGIN
[0m09:34:45.462225 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:34:45.471132 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:34:45.471691 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:45.472452 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:34:45.479305 [debug] [MainThread]: SQL status: SELECT 7 in 0.006 seconds
[0m09:34:45.483366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b121497b-db64-4f9c-8b06-c9dbaa836cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaef70f560>]}
[0m09:34:45.484018 [debug] [MainThread]: On master: ROLLBACK
[0m09:34:45.484730 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:45.485206 [debug] [MainThread]: On master: BEGIN
[0m09:34:45.486068 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:34:45.486825 [debug] [MainThread]: On master: COMMIT
[0m09:34:45.487347 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:45.487838 [debug] [MainThread]: On master: COMMIT
[0m09:34:45.488857 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:34:45.489713 [debug] [MainThread]: On master: Close
[0m09:34:45.494351 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:34:45.495595 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:34:45.497019 [info ] [Thread-1 (]: 1 of 2 START sql incremental model public.dv_lnk_fact_journal_fact_work ........ [RUN]
[0m09:34:45.498471 [info ] [Thread-2 (]: 2 of 2 START sql incremental model public.dv_lnk_fact_work_tech ................ [RUN]
[0m09:34:45.499313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.dv_lnk_fact_journal_fact_work)
[0m09:34:45.500175 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_lnk_fact_work_tech'
[0m09:34:45.500839 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:34:45.501444 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:34:45.530098 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:34:45.532805 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:34:45.534399 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:34:45.545789 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:34:45.652598 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:34:45.655279 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:34:45.655847 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

    
  
    

  create temporary table "dv_lnk_fact_work_tech__dbt_tmp093445609057"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_work,
	hk_dv_hub_tech)
        hk_dv_lnk_fact_work_tech,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_work,
	hk_dv_hub_tech
FROM "postgres"."public"."stg_1c_tech" stg


where not exists (
    select 1
    from "postgres"."public"."dv_lnk_fact_work_tech" target
    where 
        target.hk_dv_lnk_fact_work_tech = stg.hk_dv_lnk_fact_work_tech 
)

  );
  
  
[0m09:34:45.656509 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

    
  
    

  create temporary table "dv_lnk_fact_journal_fact_work__dbt_tmp093445605821"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work)
        hk_dv_lnk_fact_journal_fact_work,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work
FROM "postgres"."public"."stg_1c_works" stg


where not exists (
    select 1
    from "postgres"."public"."dv_lnk_fact_journal_fact_work" target
    where 
        target.hk_dv_lnk_fact_journal_fact_work = stg.hk_dv_lnk_fact_journal_fact_work 
)

  );
  
  
[0m09:34:45.657139 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:34:45.657792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:45.671423 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.013 seconds
[0m09:34:45.672066 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.015 seconds
[0m09:34:45.687563 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:34:45.690937 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:34:45.691547 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: BEGIN
[0m09:34:45.692080 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: BEGIN
[0m09:34:45.692987 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m09:34:45.693583 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:34:45.694162 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech__dbt_tmp093445609057'
        
      order by ordinal_position

  
[0m09:34:45.694924 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m09:34:45.695807 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:34:45.696640 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work__dbt_tmp093445605821'
        
      order by ordinal_position

  
[0m09:34:45.702339 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.007 seconds
[0m09:34:45.709305 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:34:45.709947 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.013 seconds
[0m09:34:45.710507 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:34:45.714162 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:34:45.715009 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:34:45.718292 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.003 seconds
[0m09:34:45.719208 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m09:34:45.727974 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:34:45.731650 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:34:45.732404 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:34:45.733122 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:34:45.737491 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m09:34:45.738106 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.004 seconds
[0m09:34:45.747850 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:34:45.750271 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:34:45.751437 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:34:45.752021 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:34:45.752536 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      insert into "postgres"."public"."dv_lnk_fact_journal_fact_work" ("hk_dv_lnk_fact_journal_fact_work", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_journal", "hk_dv_hub_fact_work")
    (
        select "hk_dv_lnk_fact_journal_fact_work", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_journal", "hk_dv_hub_fact_work"
        from "dv_lnk_fact_journal_fact_work__dbt_tmp093445605821"
    )


  
[0m09:34:45.753257 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      insert into "postgres"."public"."dv_lnk_fact_work_tech" ("hk_dv_lnk_fact_work_tech", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_work", "hk_dv_hub_tech")
    (
        select "hk_dv_lnk_fact_work_tech", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_work", "hk_dv_hub_tech"
        from "dv_lnk_fact_work_tech__dbt_tmp093445609057"
    )


  
[0m09:34:45.754469 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m09:34:45.755365 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:34:45.778658 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m09:34:45.777656 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m09:34:45.779688 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:34:45.780307 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:34:45.780923 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m09:34:45.781523 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m09:34:45.794882 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m09:34:45.796027 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m09:34:45.798096 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: Close
[0m09:34:45.799107 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: Close
[0m09:34:45.802190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b121497b-db64-4f9c-8b06-c9dbaa836cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaf2ce39e0>]}
[0m09:34:45.802821 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b121497b-db64-4f9c-8b06-c9dbaa836cd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaec55fad0>]}
[0m09:34:45.803651 [info ] [Thread-1 (]: 1 of 2 OK created sql incremental model public.dv_lnk_fact_journal_fact_work ... [[32mINSERT 0 0[0m in 0.30s]
[0m09:34:45.804649 [info ] [Thread-2 (]: 2 of 2 OK created sql incremental model public.dv_lnk_fact_work_tech ........... [[32mINSERT 0 0[0m in 0.30s]
[0m09:34:45.805704 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:34:45.806573 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:34:45.808726 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:45.809212 [debug] [MainThread]: On master: BEGIN
[0m09:34:45.809970 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:34:45.820820 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m09:34:45.821389 [debug] [MainThread]: On master: COMMIT
[0m09:34:45.821955 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:45.822669 [debug] [MainThread]: On master: COMMIT
[0m09:34:45.823722 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:34:45.824858 [debug] [MainThread]: On master: Close
[0m09:34:45.826315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:34:45.827203 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work' was properly closed.
[0m09:34:45.828158 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_work_tech' was properly closed.
[0m09:34:45.829148 [info ] [MainThread]: 
[0m09:34:45.829978 [info ] [MainThread]: Finished running 2 incremental models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m09:34:45.832238 [debug] [MainThread]: Command end result
[0m09:34:45.875741 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m09:34:45.878332 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m09:34:45.885038 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m09:34:45.885598 [info ] [MainThread]: 
[0m09:34:45.886258 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:34:45.886864 [info ] [MainThread]: 
[0m09:34:45.887525 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:34:45.888688 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.2065893, "process_in_blocks": "32", "process_kernel_time": 0.241649, "process_mem_max_rss": "120428", "process_out_blocks": "2440", "process_user_time": 2.461757}
[0m09:34:45.889262 [debug] [MainThread]: Command `dbt build` succeeded at 09:34:45.889133 after 1.21 seconds
[0m09:34:45.889796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaf2d58b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaeef08440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcaf131f470>]}
[0m09:34:45.890297 [debug] [MainThread]: Flushing usage events
[0m09:34:46.711425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:34:56.844671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6deab523c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6deccd8bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6deb1fa8a0>]}


============================== 09:34:56.848585 | efa464fd-7a4b-4ee1-a6f1-29f3da58aa5f ==============================
[0m09:34:56.848585 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:34:56.849510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -s tag:stage, tag:hub, tag:link', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:34:57.031862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efa464fd-7a4b-4ee1-a6f1-29f3da58aa5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de9f04b00>]}
[0m09:34:57.098167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efa464fd-7a4b-4ee1-a6f1-29f3da58aa5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dec0ff590>]}
[0m09:34:57.099182 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:34:57.217047 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:34:57.309000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:34:57.309485 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:34:57.339540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efa464fd-7a4b-4ee1-a6f1-29f3da58aa5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de9b33020>]}
[0m09:34:57.411167 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m09:34:57.413678 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m09:34:57.442152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efa464fd-7a4b-4ee1-a6f1-29f3da58aa5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de8b2b020>]}
[0m09:34:57.442914 [info ] [MainThread]: Found 17 models, 433 macros
[0m09:34:57.444098 [warn ] [MainThread]: The selection criterion 'tag:stage,' does not match any enabled nodes
[0m09:34:57.444909 [warn ] [MainThread]: The selection criterion 'tag:hub,' does not match any enabled nodes
[0m09:34:57.445934 [warn ] [MainThread]: The selection criterion 'tag:stage,' does not match any enabled nodes
[0m09:34:57.446758 [warn ] [MainThread]: The selection criterion 'tag:hub,' does not match any enabled nodes
[0m09:34:57.447628 [warn ] [MainThread]: The selection criterion 'tag:stage,' does not match any enabled nodes
[0m09:34:57.448492 [warn ] [MainThread]: The selection criterion 'tag:hub,' does not match any enabled nodes
[0m09:34:57.451024 [info ] [MainThread]: 
[0m09:34:57.451703 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:34:57.452533 [info ] [MainThread]: 
[0m09:34:57.453420 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:34:57.462124 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:34:57.512634 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:34:57.513243 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:34:57.513830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:57.525716 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.012 seconds
[0m09:34:57.527346 [debug] [ThreadPool]: On list_postgres: Close
[0m09:34:57.531479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m09:34:57.538197 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m09:34:57.538754 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m09:34:57.539167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:57.548042 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m09:34:57.548616 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m09:34:57.549113 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:34:57.552557 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.003 seconds
[0m09:34:57.554587 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m09:34:57.555287 [debug] [ThreadPool]: On list_postgres_public: Close
[0m09:34:57.565104 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:57.565644 [debug] [MainThread]: On master: BEGIN
[0m09:34:57.566067 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:34:57.574564 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:34:57.575073 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:57.575813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:34:57.582784 [debug] [MainThread]: SQL status: SELECT 7 in 0.006 seconds
[0m09:34:57.585917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efa464fd-7a4b-4ee1-a6f1-29f3da58aa5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dea586330>]}
[0m09:34:57.586487 [debug] [MainThread]: On master: ROLLBACK
[0m09:34:57.587070 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:57.587534 [debug] [MainThread]: On master: BEGIN
[0m09:34:57.588238 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:34:57.588863 [debug] [MainThread]: On master: COMMIT
[0m09:34:57.589653 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:57.590563 [debug] [MainThread]: On master: COMMIT
[0m09:34:57.591879 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:34:57.592802 [debug] [MainThread]: On master: Close
[0m09:34:57.596824 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:34:57.598030 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:34:57.599029 [info ] [Thread-1 (]: 1 of 2 START sql incremental model public.dv_lnk_fact_journal_fact_work ........ [RUN]
[0m09:34:57.600162 [info ] [Thread-2 (]: 2 of 2 START sql incremental model public.dv_lnk_fact_work_tech ................ [RUN]
[0m09:34:57.601040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.dv_lnk_fact_journal_fact_work)
[0m09:34:57.602024 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_lnk_fact_work_tech'
[0m09:34:57.603136 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:34:57.604408 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:34:57.635131 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:34:57.638077 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:34:57.639041 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:34:57.644739 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:34:57.756451 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:34:57.757119 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:34:57.757662 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

    
  
    

  create temporary table "dv_lnk_fact_work_tech__dbt_tmp093457705638"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_work,
	hk_dv_hub_tech)
        hk_dv_lnk_fact_work_tech,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_work,
	hk_dv_hub_tech
FROM "postgres"."public"."stg_1c_tech" stg


where not exists (
    select 1
    from "postgres"."public"."dv_lnk_fact_work_tech" target
    where 
        target.hk_dv_lnk_fact_work_tech = stg.hk_dv_lnk_fact_work_tech 
)

  );
  
  
[0m09:34:57.758230 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

    
  
    

  create temporary table "dv_lnk_fact_journal_fact_work__dbt_tmp093457709251"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work)
        hk_dv_lnk_fact_journal_fact_work,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work
FROM "postgres"."public"."stg_1c_works" stg


where not exists (
    select 1
    from "postgres"."public"."dv_lnk_fact_journal_fact_work" target
    where 
        target.hk_dv_lnk_fact_journal_fact_work = stg.hk_dv_lnk_fact_journal_fact_work 
)

  );
  
  
[0m09:34:57.758847 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:34:57.759448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:57.772747 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.013 seconds
[0m09:34:57.773460 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.015 seconds
[0m09:34:57.788424 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:34:57.791929 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:34:57.792526 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: BEGIN
[0m09:34:57.793066 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: BEGIN
[0m09:34:57.793938 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:34:57.794487 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:34:57.795058 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work__dbt_tmp093457709251'
        
      order by ordinal_position

  
[0m09:34:57.795603 [debug] [Thread-2 (]: SQL status: BEGIN in 0.002 seconds
[0m09:34:57.796325 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:34:57.797241 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech__dbt_tmp093457705638'
        
      order by ordinal_position

  
[0m09:34:57.803342 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.007 seconds
[0m09:34:57.804471 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.006 seconds
[0m09:34:57.813400 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:34:57.814722 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:34:57.815315 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:34:57.816032 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:34:57.821047 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m09:34:57.821711 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.005 seconds
[0m09:34:57.829967 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:34:57.833591 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:34:57.834190 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:34:57.834819 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:34:57.837772 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.002 seconds
[0m09:34:57.843595 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.008 seconds
[0m09:34:57.848106 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:34:57.850637 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:34:57.851855 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:34:57.852596 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      insert into "postgres"."public"."dv_lnk_fact_work_tech" ("hk_dv_lnk_fact_work_tech", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_work", "hk_dv_hub_tech")
    (
        select "hk_dv_lnk_fact_work_tech", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_work", "hk_dv_hub_tech"
        from "dv_lnk_fact_work_tech__dbt_tmp093457705638"
    )


  
[0m09:34:57.853295 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:34:57.853955 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:34:57.854532 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      insert into "postgres"."public"."dv_lnk_fact_journal_fact_work" ("hk_dv_lnk_fact_journal_fact_work", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_journal", "hk_dv_hub_fact_work")
    (
        select "hk_dv_lnk_fact_journal_fact_work", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_journal", "hk_dv_hub_fact_work"
        from "dv_lnk_fact_journal_fact_work__dbt_tmp093457709251"
    )


  
[0m09:34:57.871237 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.006 seconds
[0m09:34:57.873509 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m09:34:57.875512 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m09:34:57.876164 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:34:57.876861 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:34:57.877488 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m09:34:57.878091 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m09:34:57.892174 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m09:34:57.894420 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: Close
[0m09:34:57.896693 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efa464fd-7a4b-4ee1-a6f1-29f3da58aa5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6deca53a10>]}
[0m09:34:57.897558 [info ] [Thread-2 (]: 2 of 2 OK created sql incremental model public.dv_lnk_fact_work_tech ........... [[32mINSERT 0 0[0m in 0.29s]
[0m09:34:57.898486 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:34:57.918251 [debug] [Thread-1 (]: SQL status: COMMIT in 0.039 seconds
[0m09:34:57.919368 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: Close
[0m09:34:57.920329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efa464fd-7a4b-4ee1-a6f1-29f3da58aa5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de9b01b20>]}
[0m09:34:57.921620 [info ] [Thread-1 (]: 1 of 2 OK created sql incremental model public.dv_lnk_fact_journal_fact_work ... [[32mINSERT 0 0[0m in 0.32s]
[0m09:34:57.923150 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:34:57.925706 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:57.926726 [debug] [MainThread]: On master: BEGIN
[0m09:34:57.927199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:34:57.937967 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m09:34:57.938514 [debug] [MainThread]: On master: COMMIT
[0m09:34:57.939254 [debug] [MainThread]: Using postgres connection "master"
[0m09:34:57.939943 [debug] [MainThread]: On master: COMMIT
[0m09:34:57.940544 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:34:57.941014 [debug] [MainThread]: On master: Close
[0m09:34:57.941719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:34:57.942547 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work' was properly closed.
[0m09:34:57.943511 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_work_tech' was properly closed.
[0m09:34:57.944301 [info ] [MainThread]: 
[0m09:34:57.944926 [info ] [MainThread]: Finished running 2 incremental models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m09:34:57.946654 [debug] [MainThread]: Command end result
[0m09:34:57.992534 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m09:34:57.994515 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m09:34:58.004967 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m09:34:58.005553 [info ] [MainThread]: 
[0m09:34:58.006386 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:34:58.007278 [info ] [MainThread]: 
[0m09:34:58.007924 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:34:58.009291 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.2213995, "process_in_blocks": "0", "process_kernel_time": 0.227024, "process_mem_max_rss": "120456", "process_out_blocks": "2432", "process_user_time": 2.469544}
[0m09:34:58.009989 [debug] [MainThread]: Command `dbt build` succeeded at 09:34:58.009853 after 1.22 seconds
[0m09:34:58.010627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6deae05ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6de8b1cda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6deab53620>]}
[0m09:34:58.011481 [debug] [MainThread]: Flushing usage events
[0m09:34:58.926550 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:35:21.742171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a4168ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a3d1c440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a4169ee0>]}


============================== 09:35:21.746057 | 94d8fe3d-8766-424e-9311-a134cfec79ba ==============================
[0m09:35:21.746057 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:35:21.747061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build -s tag:stage tag:hub tag:link', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:35:21.928974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94d8fe3d-8766-424e-9311-a134cfec79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a4220800>]}
[0m09:35:21.995352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94d8fe3d-8766-424e-9311-a134cfec79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a4220fb0>]}
[0m09:35:21.996363 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:35:22.116477 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:35:22.208195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:35:22.208693 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:35:22.239519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94d8fe3d-8766-424e-9311-a134cfec79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a2b36cc0>]}
[0m09:35:22.312983 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m09:35:22.315646 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m09:35:22.344137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94d8fe3d-8766-424e-9311-a134cfec79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a173a510>]}
[0m09:35:22.344876 [info ] [MainThread]: Found 17 models, 433 macros
[0m09:35:22.348183 [info ] [MainThread]: 
[0m09:35:22.348968 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:35:22.349551 [info ] [MainThread]: 
[0m09:35:22.350396 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:35:22.358499 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:35:22.408886 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:35:22.409545 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:35:22.410129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:35:22.421767 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.012 seconds
[0m09:35:22.423467 [debug] [ThreadPool]: On list_postgres: Close
[0m09:35:22.427524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m09:35:22.434261 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m09:35:22.434818 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m09:35:22.435235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:35:22.444086 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m09:35:22.444656 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m09:35:22.445171 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:35:22.448719 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.003 seconds
[0m09:35:22.450744 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m09:35:22.451499 [debug] [ThreadPool]: On list_postgres_public: Close
[0m09:35:22.460718 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:22.461195 [debug] [MainThread]: On master: BEGIN
[0m09:35:22.461758 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:35:22.470621 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:35:22.471150 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:22.471839 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:35:22.478836 [debug] [MainThread]: SQL status: SELECT 7 in 0.006 seconds
[0m09:35:22.481976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94d8fe3d-8766-424e-9311-a134cfec79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a2b35d60>]}
[0m09:35:22.482551 [debug] [MainThread]: On master: ROLLBACK
[0m09:35:22.483232 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:22.483749 [debug] [MainThread]: On master: BEGIN
[0m09:35:22.484454 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:35:22.484907 [debug] [MainThread]: On master: COMMIT
[0m09:35:22.485461 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:22.486003 [debug] [MainThread]: On master: COMMIT
[0m09:35:22.486870 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:35:22.487932 [debug] [MainThread]: On master: Close
[0m09:35:22.492465 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m09:35:22.493588 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_materials
[0m09:35:22.494775 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_norm_workload
[0m09:35:22.496495 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_pikets
[0m09:35:22.495932 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_1c_journal ............................. [RUN]
[0m09:35:22.497635 [info ] [Thread-2 (]: 2 of 11 START sql view model public.stg_1c_materials ........................... [RUN]
[0m09:35:22.499223 [info ] [Thread-3 (]: 3 of 11 START sql view model public.stg_1c_norm_workload ....................... [RUN]
[0m09:35:22.502704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m09:35:22.501099 [info ] [Thread-4 (]: 4 of 11 START sql view model public.stg_1c_pikets .............................. [RUN]
[0m09:35:22.504130 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_materials'
[0m09:35:22.505152 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_norm_workload'
[0m09:35:22.506288 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m09:35:22.507523 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_pikets'
[0m09:35:22.508706 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_materials
[0m09:35:22.509653 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_norm_workload
[0m09:35:22.521271 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_pikets
[0m09:35:22.524150 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m09:35:22.527819 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_materials"
[0m09:35:22.534272 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_norm_workload"
[0m09:35:22.538437 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_pikets"
[0m09:35:22.539855 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_materials
[0m09:35:22.540859 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m09:35:22.572637 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_pikets
[0m09:35:22.573407 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_norm_workload
[0m09:35:22.618270 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_pikets"
[0m09:35:22.620502 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m09:35:22.622456 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_materials"
[0m09:35:22.627106 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_norm_workload"
[0m09:35:22.628474 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:35:22.629134 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:35:22.630274 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: BEGIN
[0m09:35:22.631102 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:35:22.631829 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:35:22.632509 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m09:35:22.633422 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:35:22.633939 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: BEGIN
[0m09:35:22.634543 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: BEGIN
[0m09:35:22.635225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:22.636194 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:35:22.637143 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:35:22.649595 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m09:35:22.651192 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m09:35:22.652100 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m09:35:22.652724 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:35:22.653758 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m09:35:22.654302 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:35:22.654933 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:35:22.655605 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */

  create view "postgres"."public"."stg_1c_pikets__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(КлючСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетС::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеС::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(Объем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_pikets,
	КлючСтроки::uuid,
	ПикетС::numeric,
	ПикетПо::numeric,
	СмещениеС::numeric,
	СмещениеПо::numeric,
	Объем::numeric,
	ВидПикета_value::uuid,
	ВидПикета_codе::varchar,
	ВидПикета_name::varchar,
	ТипПикета_value::uuid,
	ТипПикета_codе::varchar,
	ТипПикета_name::varchar,
	ГруппаПикетовSpider_value::uuid,
	ГруппаПикетовSpider_codе::varchar,
	ГруппаПикетовSpider_name::varchar
    FROM 
        src_pikets
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name)
  );
[0m09:35:22.656418 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:35:22.657586 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m09:35:22.658526 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */

  create view "postgres"."public"."stg_1c_materials__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(НомерСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемМатериала::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_materials,
	НомерСтроки::int,
	Примечание::varchar,
	ОбъемМатериала::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar
    FROM 
        src_materials
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name)
  );
[0m09:35:22.659383 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */

  create view "postgres"."public"."stg_1c_norm_workload__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(Период::varchar, 'N\A')) || '|' || TRIM(COALESCE(РассчетныйОбъем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьНормативная::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьФактическая::varchar, 'N\A')) || '|' || TRIM(COALESCE(НаемныйРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(НесколькоКлючевыхРесурсов::varchar, 'N\A')) || '|' || TRIM(COALESCE(ЖУФВР::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючДокументаРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_norm_workload,
	Период::timestamptz,
	РассчетныйОбъем::numeric,
	ТрудоемкостьНормативная::numeric,
	ТрудоемкостьФактическая::numeric,
	НаемныйРесурс::bool,
	КлючевойРесурс_value::uuid,
	КлючевойРесурс_codе::varchar,
	КлючевойРесурс_name::varchar,
	НесколькоКлючевыхРесурсов::bool,
	ЖУФВР::uuid,
	КлючДокументаРесурс::uuid,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	РесурсSpider_value::uuid,
	РесурсSpider_codе::varchar,
	РесурсSpider_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar
    FROM 
        src_norm_workload
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name)
  );
[0m09:35:22.665381 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:35:22.666341 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:35:22.672497 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m09:35:22.673127 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m09:35:22.675852 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:35:22.679689 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:35:22.683530 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:35:22.687411 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:35:22.688500 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials" rename to "stg_1c_materials__dbt_backup"
[0m09:35:22.689058 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets" rename to "stg_1c_pikets__dbt_backup"
[0m09:35:22.689644 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload" rename to "stg_1c_norm_workload__dbt_backup"
[0m09:35:22.690281 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m09:35:22.691832 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:22.692490 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:22.693007 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:35:22.693517 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:35:22.696969 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:35:22.701783 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:35:22.705810 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:35:22.709201 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:35:22.709890 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials__dbt_tmp" rename to "stg_1c_materials"
[0m09:35:22.710520 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets__dbt_tmp" rename to "stg_1c_pikets"
[0m09:35:22.711149 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload__dbt_tmp" rename to "stg_1c_norm_workload"
[0m09:35:22.711838 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m09:35:22.713133 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:22.713822 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:22.714471 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:35:22.715031 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:35:22.754334 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m09:35:22.751093 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m09:35:22.758638 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m09:35:22.760732 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m09:35:22.761454 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:35:22.762080 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:35:22.762740 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:35:22.763313 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:35:22.763982 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m09:35:22.764584 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m09:35:22.765251 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m09:35:22.765891 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m09:35:22.779608 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m09:35:22.780236 [debug] [Thread-3 (]: SQL status: COMMIT in 0.014 seconds
[0m09:35:22.787589 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_materials__dbt_backup"
[0m09:35:22.790505 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_norm_workload__dbt_backup"
[0m09:35:22.797491 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:35:22.798590 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:35:22.799143 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
drop view if exists "postgres"."public"."stg_1c_materials__dbt_backup" cascade
[0m09:35:22.799737 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
drop view if exists "postgres"."public"."stg_1c_norm_workload__dbt_backup" cascade
[0m09:35:22.806116 [debug] [Thread-4 (]: SQL status: COMMIT in 0.039 seconds
[0m09:35:22.806840 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m09:35:22.809756 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."stg_1c_pikets__dbt_backup"
[0m09:35:22.812519 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m09:35:22.813678 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:35:22.814820 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:35:22.815421 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
drop view if exists "postgres"."public"."stg_1c_pikets__dbt_backup" cascade
[0m09:35:22.816066 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m09:35:22.836215 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.036 seconds
[0m09:35:22.836971 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.036 seconds
[0m09:35:22.839814 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: Close
[0m09:35:22.841430 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: Close
[0m09:35:22.845268 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94d8fe3d-8766-424e-9311-a134cfec79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a0475100>]}
[0m09:35:22.846484 [info ] [Thread-2 (]: 2 of 11 OK created sql view model public.stg_1c_materials ...................... [[32mCREATE VIEW[0m in 0.34s]
[0m09:35:22.847142 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94d8fe3d-8766-424e-9311-a134cfec79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a056c6e0>]}
[0m09:35:22.848065 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_materials
[0m09:35:22.848868 [info ] [Thread-3 (]: 3 of 11 OK created sql view model public.stg_1c_norm_workload .................. [[32mCREATE VIEW[0m in 0.34s]
[0m09:35:22.849814 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m09:35:22.850667 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_norm_workload
[0m09:35:22.851445 [info ] [Thread-2 (]: 5 of 11 START sql view model public.stg_1c_tech ................................ [RUN]
[0m09:35:22.852705 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_works
[0m09:35:22.853767 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_materials, now model.tsm_dwh.stg_1c_tech)
[0m09:35:22.855117 [info ] [Thread-3 (]: 6 of 11 START sql view model public.stg_1c_works ............................... [RUN]
[0m09:35:22.856309 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m09:35:22.857772 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_norm_workload, now model.tsm_dwh.stg_1c_works)
[0m09:35:22.859197 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.042 seconds
[0m09:35:22.866488 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.050 seconds
[0m09:35:22.867564 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m09:35:22.868650 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m09:35:22.871656 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: Close
[0m09:35:22.874171 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m09:35:22.878165 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m09:35:22.879401 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94d8fe3d-8766-424e-9311-a134cfec79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a059fa70>]}
[0m09:35:22.880103 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m09:35:22.880854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94d8fe3d-8766-424e-9311-a134cfec79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a5a06de0>]}
[0m09:35:22.881979 [info ] [Thread-4 (]: 4 of 11 OK created sql view model public.stg_1c_pikets ......................... [[32mCREATE VIEW[0m in 0.37s]
[0m09:35:22.883436 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m09:35:22.891413 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m09:35:22.892428 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_1c_journal ........................ [[32mCREATE VIEW[0m in 0.38s]
[0m09:35:22.893650 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_pikets
[0m09:35:22.902410 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m09:35:22.903770 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m09:35:22.905578 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:35:22.907460 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m09:35:22.908322 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m09:35:22.909149 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:35:22.910221 [info ] [Thread-4 (]: 7 of 11 START sql incremental model public.dv_hub_fact_journal ................. [RUN]
[0m09:35:22.911125 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:35:22.911941 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m09:35:22.912576 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_pikets, now model.tsm_dwh.dv_hub_fact_journal)
[0m09:35:22.913587 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:35:22.914777 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m09:35:22.932853 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m09:35:22.934432 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m09:35:22.935252 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m09:35:22.936116 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:35:22.937287 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:35:22.938838 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m09:35:22.940166 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m09:35:22.941496 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m09:35:22.958127 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m09:35:22.958956 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:35:22.962911 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:35:22.978086 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:35:22.990364 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech" rename to "stg_1c_tech__dbt_backup"
[0m09:35:23.003910 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:35:23.004534 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works" rename to "stg_1c_works__dbt_backup"
[0m09:35:23.005237 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

    
  
    

  create temporary table "dv_hub_fact_journal__dbt_tmp093522983849"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_journal" target
    where 
        target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_journal 
)

  );
  
  
[0m09:35:23.006072 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:23.007036 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:35:23.007755 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:23.011348 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:35:23.016591 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:35:23.017421 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech__dbt_tmp" rename to "stg_1c_tech"
[0m09:35:23.018057 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works__dbt_tmp" rename to "stg_1c_works"
[0m09:35:23.019661 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:35:23.020454 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:35:23.022729 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m09:35:23.025080 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m09:35:23.025753 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:35:23.026418 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:35:23.026983 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m09:35:23.027608 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.021 seconds
[0m09:35:23.028135 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m09:35:23.044494 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:35:23.045117 [debug] [Thread-3 (]: SQL status: COMMIT in 0.016 seconds
[0m09:35:23.045633 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: BEGIN
[0m09:35:23.048587 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_works__dbt_backup"
[0m09:35:23.049894 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:35:23.050481 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:23.050925 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
drop view if exists "postgres"."public"."stg_1c_works__dbt_backup" cascade
[0m09:35:23.051470 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:35:23.052043 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal__dbt_tmp093522983849'
        
      order by ordinal_position

  
[0m09:35:23.058451 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.006 seconds
[0m09:35:23.064290 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:35:23.064959 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:35:23.068284 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.003 seconds
[0m09:35:23.075228 [debug] [Thread-2 (]: SQL status: COMMIT in 0.041 seconds
[0m09:35:23.079302 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:35:23.081965 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_tech__dbt_backup"
[0m09:35:23.082542 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:35:23.083627 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:35:23.084382 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
drop view if exists "postgres"."public"."stg_1c_tech__dbt_backup" cascade
[0m09:35:23.086784 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.002 seconds
[0m09:35:23.097369 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_journal"
[0m09:35:23.098229 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.046 seconds
[0m09:35:23.100254 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: Close
[0m09:35:23.101302 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94d8fe3d-8766-424e-9311-a134cfec79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a1f1cec0>]}
[0m09:35:23.102519 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:35:23.103748 [info ] [Thread-3 (]: 6 of 11 OK created sql view model public.stg_1c_works .......................... [[32mCREATE VIEW[0m in 0.24s]
[0m09:35:23.104721 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      insert into "postgres"."public"."dv_hub_fact_journal" ("hk_dv_hub_fact_journal", "hkcode", "recsource", "loadts", "bk_жуфвр_uuid")
    (
        select "hk_dv_hub_fact_journal", "hkcode", "recsource", "loadts", "bk_жуфвр_uuid"
        from "dv_hub_fact_journal__dbt_tmp093522983849"
    )


  
[0m09:35:23.105646 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m09:35:23.106677 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m09:35:23.107272 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:35:23.107812 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:35:23.108533 [info ] [Thread-1 (]: 8 of 11 START sql incremental model public.dv_hub_fact_work .................... [RUN]
[0m09:35:23.109528 [info ] [Thread-3 (]: 9 of 11 START sql incremental model public.dv_lnk_fact_journal_fact_work ....... [RUN]
[0m09:35:23.112610 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m09:35:23.113891 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.029 seconds
[0m09:35:23.115193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_journal, now model.tsm_dwh.dv_hub_fact_work)
[0m09:35:23.116593 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_works, now model.tsm_dwh.dv_lnk_fact_journal_fact_work)
[0m09:35:23.117446 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:35:23.120000 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m09:35:23.121333 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m09:35:23.122417 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:35:23.123813 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m09:35:23.130268 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94d8fe3d-8766-424e-9311-a134cfec79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a034e450>]}
[0m09:35:23.131946 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m09:35:23.136981 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:35:23.138831 [info ] [Thread-2 (]: 5 of 11 OK created sql view model public.stg_1c_tech ........................... [[32mCREATE VIEW[0m in 0.28s]
[0m09:35:23.140219 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m09:35:23.141666 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m09:35:23.142421 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:35:23.148355 [debug] [Thread-4 (]: SQL status: COMMIT in 0.010 seconds
[0m09:35:23.149439 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:35:23.156409 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m09:35:23.157112 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m09:35:23.161030 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:35:23.162045 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

    
  
    

  create temporary table "dv_hub_fact_work__dbt_tmp093523145875"
  
  
    as
  
  (
    

SELECT distinct on (bk_работа_uuid)
        hk_dv_hub_fact_work,
        hkcode,
        recsource,
        loadts,
        bk_работа_uuid
FROM "postgres"."public"."stg_1c_works" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_work" target
    where 
        target.hk_dv_hub_fact_work = stg.hk_dv_hub_fact_work 
)

  );
  
  
[0m09:35:23.163194 [info ] [Thread-2 (]: 10 of 11 START sql incremental model public.dv_hub_tech ........................ [RUN]
[0m09:35:23.164477 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94d8fe3d-8766-424e-9311-a134cfec79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a04b17f0>]}
[0m09:35:23.165148 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

    
  
    

  create temporary table "dv_lnk_fact_journal_fact_work__dbt_tmp093523152580"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work)
        hk_dv_lnk_fact_journal_fact_work,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work
FROM "postgres"."public"."stg_1c_works" stg


where not exists (
    select 1
    from "postgres"."public"."dv_lnk_fact_journal_fact_work" target
    where 
        target.hk_dv_lnk_fact_journal_fact_work = stg.hk_dv_lnk_fact_journal_fact_work 
)

  );
  
  
[0m09:35:23.165759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:23.166489 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_hub_tech)
[0m09:35:23.167560 [info ] [Thread-4 (]: 7 of 11 OK created sql incremental model public.dv_hub_fact_journal ............ [[32mINSERT 0 0[0m in 0.25s]
[0m09:35:23.168396 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:35:23.169260 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m09:35:23.170854 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m09:35:23.180147 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:35:23.184170 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m09:35:23.184940 [info ] [Thread-4 (]: 11 of 11 START sql incremental model public.dv_lnk_fact_work_tech .............. [RUN]
[0m09:35:23.186250 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_fact_journal, now model.tsm_dwh.dv_lnk_fact_work_tech)
[0m09:35:23.187259 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:35:23.193559 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.025 seconds
[0m09:35:23.194188 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.028 seconds
[0m09:35:23.197241 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:35:23.197984 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m09:35:23.201417 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:35:23.205234 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:35:23.215123 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:35:23.215931 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: BEGIN
[0m09:35:23.216659 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: BEGIN
[0m09:35:23.217171 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:35:23.217955 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

    
  
    

  create temporary table "dv_hub_tech__dbt_tmp093523212458"
  
  
    as
  
  (
    

SELECT distinct on (bk_ресурс_uuid)
        hk_dv_hub_tech,
        hkcode,
        recsource,
        loadts,
        bk_ресурс_uuid
FROM "postgres"."public"."stg_1c_tech" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_tech" target
    where 
        target.hk_dv_hub_tech = stg.hk_dv_hub_tech 
)

  );
  
  
[0m09:35:23.277738 [debug] [Thread-3 (]: SQL status: BEGIN in 0.059 seconds
[0m09:35:23.278346 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m09:35:23.283202 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:35:23.283816 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:35:23.284451 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:35:23.285118 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:35:23.285811 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

    
  
    

  create temporary table "dv_lnk_fact_work_tech__dbt_tmp093523280782"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_work,
	hk_dv_hub_tech)
        hk_dv_lnk_fact_work_tech,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_work,
	hk_dv_hub_tech
FROM "postgres"."public"."stg_1c_tech" stg


where not exists (
    select 1
    from "postgres"."public"."dv_lnk_fact_work_tech" target
    where 
        target.hk_dv_lnk_fact_work_tech = stg.hk_dv_lnk_fact_work_tech 
)

  );
  
  
[0m09:35:23.286886 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work__dbt_tmp093523152580'
        
      order by ordinal_position

  
[0m09:35:23.287937 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work__dbt_tmp093523145875'
        
      order by ordinal_position

  
[0m09:35:23.288940 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:35:23.299030 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.009 seconds
[0m09:35:23.299979 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.010 seconds
[0m09:35:23.304988 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:35:23.308713 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:35:23.309199 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.025 seconds
[0m09:35:23.309985 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:35:23.310698 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:35:23.314713 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:35:23.315472 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.027 seconds
[0m09:35:23.316209 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: BEGIN
[0m09:35:23.319845 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:35:23.320573 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m09:35:23.321283 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.005 seconds
[0m09:35:23.321966 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:35:23.322496 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: BEGIN
[0m09:35:23.326222 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:35:23.329962 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:35:23.330661 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:35:23.331454 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:35:23.332149 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:35:23.332756 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m09:35:23.333270 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech__dbt_tmp093523212458'
        
      order by ordinal_position

  
[0m09:35:23.334098 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:35:23.335260 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech__dbt_tmp093523280782'
        
      order by ordinal_position

  
[0m09:35:23.337574 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.004 seconds
[0m09:35:23.338185 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m09:35:23.340553 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:35:23.343081 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_work"
[0m09:35:23.344306 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:35:23.345267 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.010 seconds
[0m09:35:23.346354 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.010 seconds
[0m09:35:23.347032 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      insert into "postgres"."public"."dv_hub_fact_work" ("hk_dv_hub_fact_work", "hkcode", "recsource", "loadts", "bk_работа_uuid")
    (
        select "hk_dv_hub_fact_work", "hkcode", "recsource", "loadts", "bk_работа_uuid"
        from "dv_hub_fact_work__dbt_tmp093523145875"
    )


  
[0m09:35:23.348152 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:35:23.351908 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:35:23.355534 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:35:23.356240 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      insert into "postgres"."public"."dv_lnk_fact_journal_fact_work" ("hk_dv_lnk_fact_journal_fact_work", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_journal", "hk_dv_hub_fact_work")
    (
        select "hk_dv_lnk_fact_journal_fact_work", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_journal", "hk_dv_hub_fact_work"
        from "dv_lnk_fact_journal_fact_work__dbt_tmp093523152580"
    )


  
[0m09:35:23.356951 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:35:23.357506 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:35:23.358070 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:35:23.360273 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m09:35:23.360977 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:35:23.361679 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:35:23.363787 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m09:35:23.364444 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m09:35:23.365054 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:35:23.365861 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.004 seconds
[0m09:35:23.366473 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m09:35:23.366994 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.006 seconds
[0m09:35:23.371299 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:35:23.377313 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:35:23.378145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m09:35:23.376774 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:35:23.379526 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: Close
[0m09:35:23.380245 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:35:23.381602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94d8fe3d-8766-424e-9311-a134cfec79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a053b290>]}
[0m09:35:23.382427 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.003 seconds
[0m09:35:23.383462 [info ] [Thread-1 (]: 8 of 11 OK created sql incremental model public.dv_hub_fact_work ............... [[32mINSERT 0 0[0m in 0.27s]
[0m09:35:23.386108 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:35:23.386683 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.006 seconds
[0m09:35:23.387616 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m09:35:23.391045 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_tech"
[0m09:35:23.392419 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:35:23.393710 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      insert into "postgres"."public"."dv_lnk_fact_work_tech" ("hk_dv_lnk_fact_work_tech", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_work", "hk_dv_hub_tech")
    (
        select "hk_dv_lnk_fact_work_tech", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_work", "hk_dv_hub_tech"
        from "dv_lnk_fact_work_tech__dbt_tmp093523280782"
    )


  
[0m09:35:23.394917 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:35:23.396209 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:35:23.397065 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      insert into "postgres"."public"."dv_hub_tech" ("hk_dv_hub_tech", "hkcode", "recsource", "loadts", "bk_ресурс_uuid")
    (
        select "hk_dv_hub_tech", "hkcode", "recsource", "loadts", "bk_ресурс_uuid"
        from "dv_hub_tech__dbt_tmp093523212458"
    )


  
[0m09:35:23.399236 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m09:35:23.400100 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:35:23.400818 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m09:35:23.401493 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:35:23.403823 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m09:35:23.404484 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:35:23.405114 [debug] [Thread-3 (]: SQL status: COMMIT in 0.033 seconds
[0m09:35:23.405792 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m09:35:23.407695 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: Close
[0m09:35:23.409274 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94d8fe3d-8766-424e-9311-a134cfec79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a047b4a0>]}
[0m09:35:23.410366 [info ] [Thread-3 (]: 9 of 11 OK created sql incremental model public.dv_lnk_fact_journal_fact_work .. [[32mINSERT 0 0[0m in 0.29s]
[0m09:35:23.411649 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:35:23.433435 [debug] [Thread-4 (]: SQL status: COMMIT in 0.031 seconds
[0m09:35:23.434547 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: Close
[0m09:35:23.435507 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94d8fe3d-8766-424e-9311-a134cfec79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a0478410>]}
[0m09:35:23.436790 [info ] [Thread-4 (]: 11 of 11 OK created sql incremental model public.dv_lnk_fact_work_tech ......... [[32mINSERT 0 0[0m in 0.25s]
[0m09:35:23.438591 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:35:23.457902 [debug] [Thread-2 (]: SQL status: COMMIT in 0.049 seconds
[0m09:35:23.459112 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: Close
[0m09:35:23.460007 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94d8fe3d-8766-424e-9311-a134cfec79ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a047b170>]}
[0m09:35:23.461140 [info ] [Thread-2 (]: 10 of 11 OK created sql incremental model public.dv_hub_tech ................... [[32mINSERT 0 0[0m in 0.29s]
[0m09:35:23.462285 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m09:35:23.464262 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:23.464882 [debug] [MainThread]: On master: BEGIN
[0m09:35:23.465346 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:35:23.477295 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:35:23.478031 [debug] [MainThread]: On master: COMMIT
[0m09:35:23.478916 [debug] [MainThread]: Using postgres connection "master"
[0m09:35:23.479500 [debug] [MainThread]: On master: COMMIT
[0m09:35:23.480202 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:35:23.480830 [debug] [MainThread]: On master: Close
[0m09:35:23.481620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:35:23.482602 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_work' was properly closed.
[0m09:35:23.483639 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_tech' was properly closed.
[0m09:35:23.484194 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work' was properly closed.
[0m09:35:23.484655 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_work_tech' was properly closed.
[0m09:35:23.485224 [info ] [MainThread]: 
[0m09:35:23.485967 [info ] [MainThread]: Finished running 5 incremental models, 6 view models in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m09:35:23.490338 [debug] [MainThread]: Command end result
[0m09:35:23.531703 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m09:35:23.534052 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m09:35:23.543780 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m09:35:23.544330 [info ] [MainThread]: 
[0m09:35:23.545079 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:35:23.545785 [info ] [MainThread]: 
[0m09:35:23.546649 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m09:35:23.548310 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.8652335, "process_in_blocks": "0", "process_kernel_time": 0.236301, "process_mem_max_rss": "122524", "process_out_blocks": "3008", "process_user_time": 3.124685}
[0m09:35:23.548969 [debug] [MainThread]: Command `dbt build` succeeded at 09:35:23.548829 after 1.87 seconds
[0m09:35:23.549475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a45a1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a50dc290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a3d1c440>]}
[0m09:35:23.549991 [debug] [MainThread]: Flushing usage events
[0m09:35:24.639733 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:29:17.491838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01051c8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0104cd1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f010504e900>]}


============================== 10:29:17.495668 | 357bac2b-3067-40ed-a47f-cfd496fffd82 ==============================
[0m10:29:17.495668 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:29:17.496641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -s +tag:sat', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:29:17.680587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '357bac2b-3067-40ed-a47f-cfd496fffd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0104626480>]}
[0m10:29:17.747458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '357bac2b-3067-40ed-a47f-cfd496fffd82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f010600c260>]}
[0m10:29:17.748471 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:29:17.873638 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:29:17.964380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:29:17.965145 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_sat_fact_tech.sql
[0m10:29:18.177665 [error] [MainThread]: Encountered an error:
Compilation Error in model dv_sat_fact_tech (tsm_dwh/models/dv/dv_sat_fact_tech.sql)
  expected token ':', got '}'
    line 7
      }}}}
[0m10:29:18.182242 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.75119555, "process_in_blocks": "680", "process_kernel_time": 0.195657, "process_mem_max_rss": "107516", "process_out_blocks": "16", "process_user_time": 2.14583}
[0m10:29:18.183234 [debug] [MainThread]: Command `dbt build` failed at 10:29:18.182987 after 0.75 seconds
[0m10:29:18.184257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01085b7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01084b4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0104626210>]}
[0m10:29:18.185304 [debug] [MainThread]: Flushing usage events
[0m10:29:19.170910 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:35:12.666096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f567c9f7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f567c5855b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f567cc33590>]}


============================== 10:35:12.670701 | 439ea6f7-8178-4543-920d-276e4a640a68 ==============================
[0m10:35:12.670701 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:35:12.671770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build -s +tag:sat', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:35:12.875423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '439ea6f7-8178-4543-920d-276e4a640a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f567ce08620>]}
[0m10:35:12.942209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '439ea6f7-8178-4543-920d-276e4a640a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f567c8c1e50>]}
[0m10:35:12.943218 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:35:13.076675 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:35:13.165454 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:35:13.165946 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:35:13.197468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '439ea6f7-8178-4543-920d-276e4a640a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f567c1f52e0>]}
[0m10:35:13.270564 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m10:35:13.273367 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m10:35:13.301959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '439ea6f7-8178-4543-920d-276e4a640a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f567b726e70>]}
[0m10:35:13.302738 [info ] [MainThread]: Found 17 models, 433 macros
[0m10:35:13.305445 [info ] [MainThread]: 
[0m10:35:13.306214 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:35:13.307058 [info ] [MainThread]: 
[0m10:35:13.308254 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:35:13.313769 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:35:13.366872 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:35:13.367443 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:35:13.367916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:13.389434 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.021 seconds
[0m10:35:13.391333 [debug] [ThreadPool]: On list_postgres: Close
[0m10:35:13.396796 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m10:35:13.404457 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:35:13.404982 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m10:35:13.405441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:35:13.414361 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m10:35:13.414917 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:35:13.415429 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:35:13.418693 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.003 seconds
[0m10:35:13.420712 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m10:35:13.421322 [debug] [ThreadPool]: On list_postgres_public: Close
[0m10:35:13.431433 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:13.431948 [debug] [MainThread]: On master: BEGIN
[0m10:35:13.432388 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:35:13.440922 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:35:13.441501 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:13.442358 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:35:13.451429 [debug] [MainThread]: SQL status: SELECT 7 in 0.008 seconds
[0m10:35:13.457346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '439ea6f7-8178-4543-920d-276e4a640a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5679229a90>]}
[0m10:35:13.458104 [debug] [MainThread]: On master: ROLLBACK
[0m10:35:13.458879 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:13.459328 [debug] [MainThread]: On master: BEGIN
[0m10:35:13.460265 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:35:13.460819 [debug] [MainThread]: On master: COMMIT
[0m10:35:13.461295 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:13.461792 [debug] [MainThread]: On master: COMMIT
[0m10:35:13.462409 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:35:13.462873 [debug] [MainThread]: On master: Close
[0m10:35:13.467040 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_sat_fact_journal
[0m10:35:13.468178 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_sat_fact_tech
[0m10:35:13.468876 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_sat_fact_work
[0m10:35:13.469579 [info ] [Thread-1 (]: 1 of 3 START sql incremental model public.dv_sat_fact_journal .................. [RUN]
[0m10:35:13.470684 [info ] [Thread-2 (]: 2 of 3 START sql incremental model public.dv_sat_fact_tech ..................... [RUN]
[0m10:35:13.471817 [info ] [Thread-3 (]: 3 of 3 START sql incremental model public.dv_sat_fact_work ..................... [RUN]
[0m10:35:13.472734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.dv_sat_fact_journal)
[0m10:35:13.473513 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_sat_fact_tech'
[0m10:35:13.474340 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_sat_fact_work'
[0m10:35:13.474916 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_sat_fact_journal
[0m10:35:13.475567 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_sat_fact_tech
[0m10:35:13.476565 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_sat_fact_work
[0m10:35:13.507228 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_work"
[0m10:35:13.511071 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_journal"
[0m10:35:13.512548 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_tech"
[0m10:35:13.513898 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_sat_fact_journal
[0m10:35:13.519813 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_sat_fact_work
[0m10:35:13.579121 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_sat_fact_tech
[0m10:35:13.632546 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_journal"
[0m10:35:13.633933 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_tech"
[0m10:35:13.637509 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_work"
[0m10:35:13.641816 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:35:13.642645 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: BEGIN
[0m10:35:13.643189 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:35:13.643927 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:35:13.644828 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:35:13.645698 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: BEGIN
[0m10:35:13.646668 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: BEGIN
[0m10:35:13.647688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:13.648466 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:35:13.655300 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m10:35:13.655890 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:35:13.656468 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_tech"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_lnk_fact_work_tech,
        s.hdiff_dv_sat_fact_tech,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_tech) over(PARTITION BY s.hk_dv_lnk_fact_work_tech ORDER BY s.loadts) AS lag_hdiff,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name

    FROM
        (SELECT
            s.hk_dv_lnk_fact_work_tech,
            s.hdiff_dv_sat_fact_tech,
            s.loadts,
            s.recsource,
            примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
        FROM stg_1c_tech s
        ) s
    )

    SELECT DISTINCT
        hk_dv_lnk_fact_work_tech,
        recsource,
        loadts,
        hdiff_dv_sat_fact_tech,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_tech <> lag_hdiff 
        
    ORDER BY loadts

  );
  
  
[0m10:35:13.661090 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m10:35:13.661801 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:35:13.662900 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_journal"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_hub_fact_journal,
        s.hdiff_dv_sat_fact_journal,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_journal) over(PARTITION BY s.hk_dv_hub_fact_journal ORDER BY s.loadts) AS lag_hdiff,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_journal,
            s.hdiff_dv_sat_fact_journal,
            s.loadts,
            s.recsource,
            rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
        FROM stg_1c_journal s
        ) s
    )

    SELECT DISTINCT
        hk_dv_hub_fact_journal,
        recsource,
        loadts,
        hdiff_dv_sat_fact_journal,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_journal <> lag_hdiff 
        
    ORDER BY loadts

  );
  
  
[0m10:35:13.663670 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m10:35:13.664253 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:35:13.664847 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_work"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_hub_fact_work,
        s.hdiff_dv_sat_fact_work,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_work) over(PARTITION BY s.hk_dv_hub_fact_work ORDER BY s.loadts) AS lag_hdiff,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_work,
            s.hdiff_dv_sat_fact_work,
            s.loadts,
            s.recsource,
            идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
        FROM stg_1c_works s
        ) s
    )

    SELECT DISTINCT
        hk_dv_hub_fact_work,
        recsource,
        loadts,
        hdiff_dv_sat_fact_work,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_work <> lag_hdiff 
        
    ORDER BY loadts

  );
  
  
[0m10:35:13.693002 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.027 seconds
[0m10:35:13.693762 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.037 seconds
[0m10:35:13.715229 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.051 seconds
[0m10:35:13.734958 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m10:35:13.735593 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:35:13.736106 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m10:35:13.738398 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m10:35:13.740718 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m10:35:13.741305 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:35:13.742084 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:35:13.742648 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m10:35:13.743257 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m10:35:13.746234 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m10:35:13.748566 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: Close
[0m10:35:13.751827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439ea6f7-8178-4543-920d-276e4a640a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f567cdac950>]}
[0m10:35:13.752747 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model public.dv_sat_fact_journal ............. [[32mSELECT 0[0m in 0.28s]
[0m10:35:13.753684 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_sat_fact_journal
[0m10:35:13.755061 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m10:35:13.756096 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: Close
[0m10:35:13.756803 [debug] [Thread-3 (]: SQL status: COMMIT in 0.013 seconds
[0m10:35:13.757972 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439ea6f7-8178-4543-920d-276e4a640a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5669efcb00>]}
[0m10:35:13.759752 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: Close
[0m10:35:13.761028 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model public.dv_sat_fact_tech ................ [[32mSELECT 0[0m in 0.28s]
[0m10:35:13.763108 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_sat_fact_tech
[0m10:35:13.764796 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439ea6f7-8178-4543-920d-276e4a640a68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5669efd820>]}
[0m10:35:13.766634 [info ] [Thread-3 (]: 3 of 3 OK created sql incremental model public.dv_sat_fact_work ................ [[32mSELECT 0[0m in 0.29s]
[0m10:35:13.768477 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_sat_fact_work
[0m10:35:13.770619 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:13.771202 [debug] [MainThread]: On master: BEGIN
[0m10:35:13.771830 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:35:13.782799 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m10:35:13.783789 [debug] [MainThread]: On master: COMMIT
[0m10:35:13.784360 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:13.784847 [debug] [MainThread]: On master: COMMIT
[0m10:35:13.785899 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:35:13.786403 [debug] [MainThread]: On master: Close
[0m10:35:13.787109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:35:13.787660 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_journal' was properly closed.
[0m10:35:13.788064 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_tech' was properly closed.
[0m10:35:13.788594 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_work' was properly closed.
[0m10:35:13.789399 [info ] [MainThread]: 
[0m10:35:13.789960 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m10:35:13.792411 [debug] [MainThread]: Command end result
[0m10:35:13.834587 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m10:35:13.836640 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m10:35:13.843970 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m10:35:13.844678 [info ] [MainThread]: 
[0m10:35:13.845767 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:35:13.846710 [info ] [MainThread]: 
[0m10:35:13.847460 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:35:13.849146 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.2394496, "process_in_blocks": "16216", "process_kernel_time": 0.273578, "process_mem_max_rss": "121060", "process_out_blocks": "2576", "process_user_time": 2.508966}
[0m10:35:13.849982 [debug] [MainThread]: Command `dbt build` succeeded at 10:35:13.849785 after 1.24 seconds
[0m10:35:13.850741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f567ca722a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f567cc33590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f567c170b00>]}
[0m10:35:13.851745 [debug] [MainThread]: Flushing usage events
[0m10:35:14.875076 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:46:48.207579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb15b4bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb15b4bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb15b4b4a0>]}


============================== 10:46:48.211408 | 31a93192-9f34-4a6b-b79a-7e013453f18c ==============================
[0m10:46:48.211408 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:46:48.212257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build -s +tag:sat', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:46:48.394590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31a93192-9f34-4a6b-b79a-7e013453f18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb162f4560>]}
[0m10:46:48.460934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31a93192-9f34-4a6b-b79a-7e013453f18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb160498e0>]}
[0m10:46:48.461925 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:46:48.583064 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:46:48.674569 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:46:48.675048 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:46:48.703937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31a93192-9f34-4a6b-b79a-7e013453f18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb1589deb0>]}
[0m10:46:48.776982 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m10:46:48.780149 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m10:46:48.808902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31a93192-9f34-4a6b-b79a-7e013453f18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb141f0b90>]}
[0m10:46:48.809571 [info ] [MainThread]: Found 17 models, 433 macros
[0m10:46:48.812207 [info ] [MainThread]: 
[0m10:46:48.812899 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:46:48.813714 [info ] [MainThread]: 
[0m10:46:48.814774 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:46:48.820700 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:46:48.871978 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:46:48.872605 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:46:48.873070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:48.884770 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.011 seconds
[0m10:46:48.886522 [debug] [ThreadPool]: On list_postgres: Close
[0m10:46:48.890589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m10:46:48.897358 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:46:48.897921 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m10:46:48.898394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:46:48.907128 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m10:46:48.907672 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:46:48.908177 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:46:48.911492 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m10:46:48.913471 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m10:46:48.914090 [debug] [ThreadPool]: On list_postgres_public: Close
[0m10:46:48.925277 [debug] [MainThread]: Using postgres connection "master"
[0m10:46:48.925867 [debug] [MainThread]: On master: BEGIN
[0m10:46:48.926303 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:46:48.935463 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:46:48.935970 [debug] [MainThread]: Using postgres connection "master"
[0m10:46:48.936507 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:46:48.943916 [debug] [MainThread]: SQL status: SELECT 7 in 0.007 seconds
[0m10:46:48.947136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31a93192-9f34-4a6b-b79a-7e013453f18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb157097c0>]}
[0m10:46:48.948097 [debug] [MainThread]: On master: ROLLBACK
[0m10:46:48.949320 [debug] [MainThread]: Using postgres connection "master"
[0m10:46:48.950582 [debug] [MainThread]: On master: BEGIN
[0m10:46:48.951817 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:46:48.952383 [debug] [MainThread]: On master: COMMIT
[0m10:46:48.952876 [debug] [MainThread]: Using postgres connection "master"
[0m10:46:48.953359 [debug] [MainThread]: On master: COMMIT
[0m10:46:48.954191 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:46:48.954961 [debug] [MainThread]: On master: Close
[0m10:46:48.959043 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_sat_fact_journal
[0m10:46:48.960314 [info ] [Thread-1 (]: 1 of 3 START sql incremental model public.dv_sat_fact_journal .................. [RUN]
[0m10:46:48.961535 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_sat_fact_tech
[0m10:46:48.962602 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_sat_fact_work
[0m10:46:48.963645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.dv_sat_fact_journal)
[0m10:46:48.964918 [info ] [Thread-2 (]: 2 of 3 START sql incremental model public.dv_sat_fact_tech ..................... [RUN]
[0m10:46:48.965945 [info ] [Thread-3 (]: 3 of 3 START sql incremental model public.dv_sat_fact_work ..................... [RUN]
[0m10:46:48.966794 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_sat_fact_journal
[0m10:46:48.967616 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_sat_fact_tech'
[0m10:46:48.968784 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_sat_fact_work'
[0m10:46:48.980137 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_sat_fact_tech
[0m10:46:48.992502 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_journal"
[0m10:46:48.993139 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_sat_fact_work
[0m10:46:48.998190 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_tech"
[0m10:46:49.004870 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_work"
[0m10:46:49.005790 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_sat_fact_journal
[0m10:46:49.030807 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_sat_fact_tech
[0m10:46:49.062386 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_sat_fact_work
[0m10:46:49.122222 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:46:49.124558 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:46:49.128943 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:46:49.129977 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

    
  
    

  create temporary table "dv_sat_fact_tech__dbt_tmp104649058995"
  
  
    as
  
  (
    



    WITH active_sat AS (
    SELECT DISTINCT ON (hk_dv_lnk_fact_work_tech) hk_dv_lnk_fact_work_tech, hdiff_dv_sat_fact_tech, loadts
    FROM dv_sat_fact_tech
    ORDER BY hk_dv_lnk_fact_work_tech, loadts DESC)

    , max_load AS (
    SELECT max(loadts) AS max_loadts
    FROM dv_sat_fact_tech
    )
    , stage_cte AS (

        SELECT
        s.hk_dv_lnk_fact_work_tech,
        s.hdiff_dv_sat_fact_tech,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_tech) over(PARTITION BY s.hk_dv_lnk_fact_work_tech ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_tech AS sat_hdiff,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name

    FROM
        (SELECT
            s.hk_dv_lnk_fact_work_tech,
            s.hdiff_dv_sat_fact_tech,
            s.loadts,
            s.recsource,
            примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
        FROM stg_1c_tech s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts
        ) s
    LEFT JOIN active_sat a ON a.hk_dv_lnk_fact_work_tech = s.hk_dv_lnk_fact_work_tech)

    SELECT DISTINCT
        hk_dv_lnk_fact_work_tech,
        recsource,
        loadts,
        hdiff_dv_sat_fact_tech,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_tech <> lag_hdiff 
            OR (hdiff_dv_sat_fact_tech <> sat_hdiff AND lag_hdiff IS NULL) 
            OR sat_hdiff IS NULL
    ORDER BY loadts


  );
  
  
[0m10:46:49.131164 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

    
  
    

  create temporary table "dv_sat_fact_work__dbt_tmp104649065336"
  
  
    as
  
  (
    



    WITH active_sat AS (
    SELECT DISTINCT ON (hk_dv_hub_fact_work) hk_dv_hub_fact_work, hdiff_dv_sat_fact_work, loadts
    FROM dv_sat_fact_work
    ORDER BY hk_dv_hub_fact_work, loadts DESC)

    , max_load AS (
    SELECT max(loadts) AS max_loadts
    FROM dv_sat_fact_work
    )
    , stage_cte AS (

        SELECT
        s.hk_dv_hub_fact_work,
        s.hdiff_dv_sat_fact_work,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_work) over(PARTITION BY s.hk_dv_hub_fact_work ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_work AS sat_hdiff,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_work,
            s.hdiff_dv_sat_fact_work,
            s.loadts,
            s.recsource,
            идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
        FROM stg_1c_works s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts
        ) s
    LEFT JOIN active_sat a ON a.hk_dv_hub_fact_work = s.hk_dv_hub_fact_work)

    SELECT DISTINCT
        hk_dv_hub_fact_work,
        recsource,
        loadts,
        hdiff_dv_sat_fact_work,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_work <> lag_hdiff 
            OR (hdiff_dv_sat_fact_work <> sat_hdiff AND lag_hdiff IS NULL) 
            OR sat_hdiff IS NULL
    ORDER BY loadts


  );
  
  
[0m10:46:49.132569 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

    
  
    

  create temporary table "dv_sat_fact_journal__dbt_tmp104649053571"
  
  
    as
  
  (
    



    WITH active_sat AS (
    SELECT DISTINCT ON (hk_dv_hub_fact_journal) hk_dv_hub_fact_journal, hdiff_dv_sat_fact_journal, loadts
    FROM dv_sat_fact_journal
    ORDER BY hk_dv_hub_fact_journal, loadts DESC)

    , max_load AS (
    SELECT max(loadts) AS max_loadts
    FROM dv_sat_fact_journal
    )
    , stage_cte AS (

        SELECT
        s.hk_dv_hub_fact_journal,
        s.hdiff_dv_sat_fact_journal,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_journal) over(PARTITION BY s.hk_dv_hub_fact_journal ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_journal AS sat_hdiff,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_journal,
            s.hdiff_dv_sat_fact_journal,
            s.loadts,
            s.recsource,
            rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
        FROM stg_1c_journal s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts
        ) s
    LEFT JOIN active_sat a ON a.hk_dv_hub_fact_journal = s.hk_dv_hub_fact_journal)

    SELECT DISTINCT
        hk_dv_hub_fact_journal,
        recsource,
        loadts,
        hdiff_dv_sat_fact_journal,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_journal <> lag_hdiff 
            OR (hdiff_dv_sat_fact_journal <> sat_hdiff AND lag_hdiff IS NULL) 
            OR sat_hdiff IS NULL
    ORDER BY loadts


  );
  
  
[0m10:46:49.134031 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:46:49.134926 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:46:49.135993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:46:49.158414 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.024 seconds
[0m10:46:49.164982 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.030 seconds
[0m10:46:49.175869 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:46:49.176534 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.041 seconds
[0m10:46:49.180054 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:46:49.180794 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: BEGIN
[0m10:46:49.184208 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:46:49.184808 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: BEGIN
[0m10:46:49.185801 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: BEGIN
[0m10:46:49.186494 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m10:46:49.187322 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:46:49.188249 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_tech__dbt_tmp104649058995'
        
      order by ordinal_position

  
[0m10:46:49.189166 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m10:46:49.189957 [debug] [Thread-3 (]: SQL status: BEGIN in 0.003 seconds
[0m10:46:49.190782 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:46:49.192047 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:46:49.193011 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_journal__dbt_tmp104649053571'
        
      order by ordinal_position

  
[0m10:46:49.193949 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_work__dbt_tmp104649065336'
        
      order by ordinal_position

  
[0m10:46:49.198553 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.008 seconds
[0m10:46:49.206161 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:46:49.206859 [debug] [Thread-1 (]: SQL status: SELECT 33 in 0.012 seconds
[0m10:46:49.207445 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.012 seconds
[0m10:46:49.208022 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:46:49.212510 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:46:49.216452 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:46:49.217280 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:46:49.218184 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:46:49.221709 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.004 seconds
[0m10:46:49.222452 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.003 seconds
[0m10:46:49.234528 [debug] [Thread-1 (]: SQL status: SELECT 33 in 0.016 seconds
[0m10:46:49.238779 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:46:49.239847 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:46:49.249079 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:46:49.250120 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:46:49.251163 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:46:49.251874 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:46:49.255559 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.003 seconds
[0m10:46:49.262801 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.010 seconds
[0m10:46:49.263496 [debug] [Thread-1 (]: SQL status: SELECT 33 in 0.010 seconds
[0m10:46:49.272942 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_work"
[0m10:46:49.275178 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_tech"
[0m10:46:49.278492 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_journal"
[0m10:46:49.280091 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:46:49.281046 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:46:49.281723 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      insert into "postgres"."public"."dv_sat_fact_tech" ("hk_dv_lnk_fact_work_tech", "recsource", "loadts", "hdiff_dv_sat_fact_tech", "примечание", "госномер_техника_не_найдена", "количество", "часы", "ресурс_value", "ресурс_codе", "ресурс_name", "аналитика_codе", "аналитика_name", "контрагент_value", "контрагент_codе", "контрагент_name")
    (
        select "hk_dv_lnk_fact_work_tech", "recsource", "loadts", "hdiff_dv_sat_fact_tech", "примечание", "госномер_техника_не_найдена", "количество", "часы", "ресурс_value", "ресурс_codе", "ресурс_name", "аналитика_codе", "аналитика_name", "контрагент_value", "контрагент_codе", "контрагент_name"
        from "dv_sat_fact_tech__dbt_tmp104649058995"
    )


  
[0m10:46:49.282304 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:46:49.283314 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      insert into "postgres"."public"."dv_sat_fact_journal" ("hk_dv_hub_fact_journal", "recsource", "loadts", "hdiff_dv_sat_fact_journal", "rabbit_uuid", "rabbit_дата", "проведен", "uuid_жуфвр", "пометка_удаления", "дата", "номер", "территория_value", "территория_codе", "территория_name", "подразделение_value", "подразделение_codе", "подразделение_name", "смена_value", "смена_codе", "смена_name", "прораб_value", "прораб_codе", "прораб_name", "комментарий", "ответственный_value", "ответственный_codе", "ответственный_name", "версия_жуфвр_value", "версия_жуфвр_codе", "версия_жуфвр_name", "направление_деятельности_value", "направление_деятельности_codе", "направление_деятельности_name")
    (
        select "hk_dv_hub_fact_journal", "recsource", "loadts", "hdiff_dv_sat_fact_journal", "rabbit_uuid", "rabbit_дата", "проведен", "uuid_жуфвр", "пометка_удаления", "дата", "номер", "территория_value", "территория_codе", "территория_name", "подразделение_value", "подразделение_codе", "подразделение_name", "смена_value", "смена_codе", "смена_name", "прораб_value", "прораб_codе", "прораб_name", "комментарий", "ответственный_value", "ответственный_codе", "ответственный_name", "версия_жуфвр_value", "версия_жуфвр_codе", "версия_жуфвр_name", "направление_деятельности_value", "направление_деятельности_codе", "направление_деятельности_name"
        from "dv_sat_fact_journal__dbt_tmp104649053571"
    )


  
[0m10:46:49.284156 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      insert into "postgres"."public"."dv_sat_fact_work" ("hk_dv_hub_fact_work", "recsource", "loadts", "hdiff_dv_sat_fact_work", "идентификатор", "объем_работы", "примечание", "кв", "пометка_удаления", "тип_spider", "структура_работ_value", "структура_работ_codе", "структура_работ_name", "видработ_value", "видработ_codе", "видработ_name")
    (
        select "hk_dv_hub_fact_work", "recsource", "loadts", "hdiff_dv_sat_fact_work", "идентификатор", "объем_работы", "примечание", "кв", "пометка_удаления", "тип_spider", "структура_работ_value", "структура_работ_codе", "структура_работ_name", "видработ_value", "видработ_codе", "видработ_name"
        from "dv_sat_fact_work__dbt_tmp104649065336"
    )


  
[0m10:46:49.285004 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m10:46:49.291712 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.006 seconds
[0m10:46:49.314865 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m10:46:49.315530 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.029 seconds
[0m10:46:49.317613 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m10:46:49.318208 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:46:49.320251 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m10:46:49.320945 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:46:49.321551 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m10:46:49.322079 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:46:49.322702 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m10:46:49.323461 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m10:46:49.338386 [debug] [Thread-2 (]: SQL status: COMMIT in 0.015 seconds
[0m10:46:49.340760 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: Close
[0m10:46:49.342881 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31a93192-9f34-4a6b-b79a-7e013453f18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb1271ae40>]}
[0m10:46:49.343751 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model public.dv_sat_fact_tech ................ [[32mINSERT 0 0[0m in 0.37s]
[0m10:46:49.344685 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_sat_fact_tech
[0m10:46:49.350535 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m10:46:49.351463 [debug] [Thread-3 (]: SQL status: COMMIT in 0.027 seconds
[0m10:46:49.353017 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: Close
[0m10:46:49.354974 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: Close
[0m10:46:49.356456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31a93192-9f34-4a6b-b79a-7e013453f18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb10684e00>]}
[0m10:46:49.357966 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31a93192-9f34-4a6b-b79a-7e013453f18c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb127f14c0>]}
[0m10:46:49.359004 [info ] [Thread-3 (]: 3 of 3 OK created sql incremental model public.dv_sat_fact_work ................ [[32mINSERT 0 0[0m in 0.39s]
[0m10:46:49.361576 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_sat_fact_work
[0m10:46:49.359907 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model public.dv_sat_fact_journal ............. [[32mINSERT 0 0[0m in 0.39s]
[0m10:46:49.363730 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_sat_fact_journal
[0m10:46:49.365989 [debug] [MainThread]: Using postgres connection "master"
[0m10:46:49.367065 [debug] [MainThread]: On master: BEGIN
[0m10:46:49.367951 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:46:49.379648 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:46:49.380563 [debug] [MainThread]: On master: COMMIT
[0m10:46:49.381392 [debug] [MainThread]: Using postgres connection "master"
[0m10:46:49.381892 [debug] [MainThread]: On master: COMMIT
[0m10:46:49.382813 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:46:49.383310 [debug] [MainThread]: On master: Close
[0m10:46:49.384454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:46:49.385519 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_journal' was properly closed.
[0m10:46:49.386800 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_tech' was properly closed.
[0m10:46:49.387441 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_work' was properly closed.
[0m10:46:49.388078 [info ] [MainThread]: 
[0m10:46:49.388959 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m10:46:49.391356 [debug] [MainThread]: Command end result
[0m10:46:49.430514 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m10:46:49.432918 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m10:46:49.440505 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m10:46:49.441240 [info ] [MainThread]: 
[0m10:46:49.441889 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:46:49.442576 [info ] [MainThread]: 
[0m10:46:49.443449 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:46:49.444880 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.2941172, "process_in_blocks": "0", "process_kernel_time": 0.253043, "process_mem_max_rss": "120628", "process_out_blocks": "2672", "process_user_time": 2.546086}
[0m10:46:49.445578 [debug] [MainThread]: Command `dbt build` succeeded at 10:46:49.445387 after 1.29 seconds
[0m10:46:49.446143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb197b7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb17111100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb106b3bf0>]}
[0m10:46:49.446718 [debug] [MainThread]: Flushing usage events
[0m10:46:50.517469 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:47:28.771630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2570e1460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2568588f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2570e3920>]}


============================== 10:47:28.775846 | c9539e5c-83e8-4cc9-849f-dd79dd4ea684 ==============================
[0m10:47:28.775846 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:47:28.776713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build -s +tag:sat', 'send_anonymous_usage_stats': 'True'}
[0m10:47:29.017556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9539e5c-83e8-4cc9-849f-dd79dd4ea684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2571046e0>]}
[0m10:47:29.086455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9539e5c-83e8-4cc9-849f-dd79dd4ea684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa256abfb00>]}
[0m10:47:29.087583 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:47:29.210244 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:47:29.301354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:47:29.301967 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:47:29.330903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9539e5c-83e8-4cc9-849f-dd79dd4ea684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25626aba0>]}
[0m10:47:29.402697 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m10:47:29.405172 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m10:47:29.432868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9539e5c-83e8-4cc9-849f-dd79dd4ea684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa254d156a0>]}
[0m10:47:29.433561 [info ] [MainThread]: Found 17 models, 433 macros
[0m10:47:29.436227 [info ] [MainThread]: 
[0m10:47:29.436967 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:47:29.437566 [info ] [MainThread]: 
[0m10:47:29.438479 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:47:29.446064 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:47:29.497657 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:47:29.498191 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:47:29.498671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:29.512599 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.014 seconds
[0m10:47:29.514318 [debug] [ThreadPool]: On list_postgres: Close
[0m10:47:29.517141 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m10:47:29.523958 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:47:29.524468 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m10:47:29.524900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:29.533549 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m10:47:29.534120 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:47:29.534627 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:47:29.537796 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.003 seconds
[0m10:47:29.539716 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m10:47:29.540327 [debug] [ThreadPool]: On list_postgres_public: Close
[0m10:47:29.550132 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:29.550681 [debug] [MainThread]: On master: BEGIN
[0m10:47:29.551127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:47:29.559701 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:47:29.560212 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:29.560784 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:47:29.567952 [debug] [MainThread]: SQL status: SELECT 7 in 0.007 seconds
[0m10:47:29.571045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9539e5c-83e8-4cc9-849f-dd79dd4ea684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa256268e60>]}
[0m10:47:29.571662 [debug] [MainThread]: On master: ROLLBACK
[0m10:47:29.572418 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:29.573105 [debug] [MainThread]: On master: BEGIN
[0m10:47:29.574184 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:47:29.575461 [debug] [MainThread]: On master: COMMIT
[0m10:47:29.576453 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:29.577259 [debug] [MainThread]: On master: COMMIT
[0m10:47:29.578135 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:47:29.578853 [debug] [MainThread]: On master: Close
[0m10:47:29.583220 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_sat_fact_journal
[0m10:47:29.583966 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_sat_fact_tech
[0m10:47:29.584916 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_sat_fact_work
[0m10:47:29.586189 [info ] [Thread-1 (]: 1 of 3 START sql incremental model public.dv_sat_fact_journal .................. [RUN]
[0m10:47:29.587477 [info ] [Thread-2 (]: 2 of 3 START sql incremental model public.dv_sat_fact_tech ..................... [RUN]
[0m10:47:29.588650 [info ] [Thread-3 (]: 3 of 3 START sql incremental model public.dv_sat_fact_work ..................... [RUN]
[0m10:47:29.590046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.dv_sat_fact_journal)
[0m10:47:29.591503 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_sat_fact_tech'
[0m10:47:29.592883 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_sat_fact_work'
[0m10:47:29.594080 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_sat_fact_journal
[0m10:47:29.595283 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_sat_fact_tech
[0m10:47:29.596132 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_sat_fact_work
[0m10:47:29.621567 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_tech"
[0m10:47:29.624513 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_journal"
[0m10:47:29.628903 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_work"
[0m10:47:29.630096 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_sat_fact_tech
[0m10:47:29.630903 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_sat_fact_journal
[0m10:47:29.636716 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_sat_fact_work
[0m10:47:29.770888 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_tech"
[0m10:47:29.780000 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_work"
[0m10:47:29.776462 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_journal"
[0m10:47:29.781844 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:47:29.782576 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: BEGIN
[0m10:47:29.783634 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:47:29.784183 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:47:29.784717 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:47:29.785418 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: BEGIN
[0m10:47:29.786041 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: BEGIN
[0m10:47:29.786885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:29.787968 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:47:29.797716 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m10:47:29.798829 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:47:29.800236 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_journal"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_hub_fact_journal,
        s.hdiff_dv_sat_fact_journal,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_journal) over(PARTITION BY s.hk_dv_hub_fact_journal ORDER BY s.loadts) AS lag_hdiff,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_journal,
            s.hdiff_dv_sat_fact_journal,
            s.loadts,
            s.recsource,
            rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
        FROM stg_1c_journal s
        ) s
    )

    SELECT DISTINCT
        hk_dv_hub_fact_journal,
        recsource,
        loadts,
        hdiff_dv_sat_fact_journal,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_journal <> lag_hdiff 
        OR sat_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m10:47:29.801486 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m10:47:29.802357 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m10:47:29.803082 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:47:29.803931 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:47:29.804582 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_work"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_hub_fact_work,
        s.hdiff_dv_sat_fact_work,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_work) over(PARTITION BY s.hk_dv_hub_fact_work ORDER BY s.loadts) AS lag_hdiff,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_work,
            s.hdiff_dv_sat_fact_work,
            s.loadts,
            s.recsource,
            идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
        FROM stg_1c_works s
        ) s
    )

    SELECT DISTINCT
        hk_dv_hub_fact_work,
        recsource,
        loadts,
        hdiff_dv_sat_fact_work,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_work <> lag_hdiff 
        OR sat_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m10:47:29.805340 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_tech"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_lnk_fact_work_tech,
        s.hdiff_dv_sat_fact_tech,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_tech) over(PARTITION BY s.hk_dv_lnk_fact_work_tech ORDER BY s.loadts) AS lag_hdiff,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name

    FROM
        (SELECT
            s.hk_dv_lnk_fact_work_tech,
            s.hdiff_dv_sat_fact_tech,
            s.loadts,
            s.recsource,
            примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
        FROM stg_1c_tech s
        ) s
    )

    SELECT DISTINCT
        hk_dv_lnk_fact_work_tech,
        recsource,
        loadts,
        hdiff_dv_sat_fact_tech,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_tech <> lag_hdiff 
        OR sat_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m10:47:29.807272 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "sat_hdiff" does not exist
LINE 130:         OR sat_hdiff IS NULL
                     ^
HINT:  Perhaps you meant to reference the column "stage_cte.lag_hdiff".

[0m10:47:29.807976 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: ROLLBACK
[0m10:47:29.808914 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "sat_hdiff" does not exist
LINE 79:         OR sat_hdiff IS NULL
                    ^
HINT:  Perhaps you meant to reference the column "stage_cte.lag_hdiff".

[0m10:47:29.809498 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "sat_hdiff" does not exist
LINE 79:         OR sat_hdiff IS NULL
                    ^
HINT:  Perhaps you meant to reference the column "stage_cte.lag_hdiff".

[0m10:47:29.810115 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: ROLLBACK
[0m10:47:29.810955 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: ROLLBACK
[0m10:47:29.811642 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: Close
[0m10:47:29.812641 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: Close
[0m10:47:29.813720 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: Close
[0m10:47:29.828965 [debug] [Thread-2 (]: Database Error in model dv_sat_fact_tech (tsm_dwh/models/dv/dv_sat_fact_tech.sql)
  column "sat_hdiff" does not exist
  LINE 79:         OR sat_hdiff IS NULL
                      ^
  HINT:  Perhaps you meant to reference the column "stage_cte.lag_hdiff".
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_sat_fact_tech.sql
[0m10:47:29.830958 [debug] [Thread-1 (]: Database Error in model dv_sat_fact_journal (tsm_dwh/models/dv/dv_sat_fact_journal.sql)
  column "sat_hdiff" does not exist
  LINE 130:         OR sat_hdiff IS NULL
                       ^
  HINT:  Perhaps you meant to reference the column "stage_cte.lag_hdiff".
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_sat_fact_journal.sql
[0m10:47:29.832716 [debug] [Thread-3 (]: Database Error in model dv_sat_fact_work (tsm_dwh/models/dv/dv_sat_fact_work.sql)
  column "sat_hdiff" does not exist
  LINE 79:         OR sat_hdiff IS NULL
                      ^
  HINT:  Perhaps you meant to reference the column "stage_cte.lag_hdiff".
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_sat_fact_work.sql
[0m10:47:29.835494 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9539e5c-83e8-4cc9-849f-dd79dd4ea684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2535cac00>]}
[0m10:47:29.836059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9539e5c-83e8-4cc9-849f-dd79dd4ea684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2534535c0>]}
[0m10:47:29.837521 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9539e5c-83e8-4cc9-849f-dd79dd4ea684', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2534f89e0>]}
[0m10:47:29.837038 [error] [Thread-2 (]: 2 of 3 ERROR creating sql incremental model public.dv_sat_fact_tech ............ [[31mERROR[0m in 0.24s]
[0m10:47:29.838919 [error] [Thread-1 (]: 1 of 3 ERROR creating sql incremental model public.dv_sat_fact_journal ......... [[31mERROR[0m in 0.25s]
[0m10:47:29.840061 [error] [Thread-3 (]: 3 of 3 ERROR creating sql incremental model public.dv_sat_fact_work ............ [[31mERROR[0m in 0.24s]
[0m10:47:29.841103 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_sat_fact_tech
[0m10:47:29.842019 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_sat_fact_journal
[0m10:47:29.843099 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_sat_fact_work
[0m10:47:29.844521 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_sat_fact_tech' to be skipped because of status 'error'.  Reason: Database Error in model dv_sat_fact_tech (tsm_dwh/models/dv/dv_sat_fact_tech.sql)
  column "sat_hdiff" does not exist
  LINE 79:         OR sat_hdiff IS NULL
                      ^
  HINT:  Perhaps you meant to reference the column "stage_cte.lag_hdiff".
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_sat_fact_tech.sql.
[0m10:47:29.846571 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_sat_fact_journal' to be skipped because of status 'error'.  Reason: Database Error in model dv_sat_fact_journal (tsm_dwh/models/dv/dv_sat_fact_journal.sql)
  column "sat_hdiff" does not exist
  LINE 130:         OR sat_hdiff IS NULL
                       ^
  HINT:  Perhaps you meant to reference the column "stage_cte.lag_hdiff".
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_sat_fact_journal.sql.
[0m10:47:29.847770 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_sat_fact_work' to be skipped because of status 'error'.  Reason: Database Error in model dv_sat_fact_work (tsm_dwh/models/dv/dv_sat_fact_work.sql)
  column "sat_hdiff" does not exist
  LINE 79:         OR sat_hdiff IS NULL
                      ^
  HINT:  Perhaps you meant to reference the column "stage_cte.lag_hdiff".
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_sat_fact_work.sql.
[0m10:47:29.850497 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:29.851490 [debug] [MainThread]: On master: BEGIN
[0m10:47:29.852138 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:47:29.863532 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m10:47:29.864146 [debug] [MainThread]: On master: COMMIT
[0m10:47:29.864793 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:29.865252 [debug] [MainThread]: On master: COMMIT
[0m10:47:29.865990 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:47:29.866474 [debug] [MainThread]: On master: Close
[0m10:47:29.867070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:47:29.867529 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_journal' was properly closed.
[0m10:47:29.868275 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_tech' was properly closed.
[0m10:47:29.868746 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_work' was properly closed.
[0m10:47:29.869648 [info ] [MainThread]: 
[0m10:47:29.870394 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m10:47:29.872080 [debug] [MainThread]: Command end result
[0m10:47:29.913453 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m10:47:29.915296 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m10:47:29.922536 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m10:47:29.923450 [info ] [MainThread]: 
[0m10:47:29.924482 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m10:47:29.925086 [info ] [MainThread]: 
[0m10:47:29.925760 [error] [MainThread]:   Database Error in model dv_sat_fact_tech (tsm_dwh/models/dv/dv_sat_fact_tech.sql)
  column "sat_hdiff" does not exist
  LINE 79:         OR sat_hdiff IS NULL
                      ^
  HINT:  Perhaps you meant to reference the column "stage_cte.lag_hdiff".
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_sat_fact_tech.sql
[0m10:47:29.926386 [info ] [MainThread]: 
[0m10:47:29.927017 [error] [MainThread]:   Database Error in model dv_sat_fact_journal (tsm_dwh/models/dv/dv_sat_fact_journal.sql)
  column "sat_hdiff" does not exist
  LINE 130:         OR sat_hdiff IS NULL
                       ^
  HINT:  Perhaps you meant to reference the column "stage_cte.lag_hdiff".
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_sat_fact_journal.sql
[0m10:47:29.927682 [info ] [MainThread]: 
[0m10:47:29.928630 [error] [MainThread]:   Database Error in model dv_sat_fact_work (tsm_dwh/models/dv/dv_sat_fact_work.sql)
  column "sat_hdiff" does not exist
  LINE 79:         OR sat_hdiff IS NULL
                      ^
  HINT:  Perhaps you meant to reference the column "stage_cte.lag_hdiff".
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_sat_fact_work.sql
[0m10:47:29.929199 [info ] [MainThread]: 
[0m10:47:29.930067 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m10:47:29.931584 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.218064, "process_in_blocks": "112", "process_kernel_time": 0.23547, "process_mem_max_rss": "122580", "process_out_blocks": "2584", "process_user_time": 2.522853}
[0m10:47:29.932188 [debug] [MainThread]: Command `dbt build` failed at 10:47:29.932040 after 1.22 seconds
[0m10:47:29.932762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2568588f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25695bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25695bc50>]}
[0m10:47:29.933282 [debug] [MainThread]: Flushing usage events
[0m10:47:30.761299 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:48:36.018212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe4443ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe4443e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe4443aa0>]}


============================== 10:48:36.022116 | 36b58c55-d7f3-494a-a8e8-aa68738378e5 ==============================
[0m10:48:36.022116 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:48:36.023112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build -s +tag:sat', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:48:36.207036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36b58c55-d7f3-494a-a8e8-aa68738378e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe412bc80>]}
[0m10:48:36.281077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36b58c55-d7f3-494a-a8e8-aa68738378e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe47900b0>]}
[0m10:48:36.282085 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:48:36.407602 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:48:36.497600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:48:36.498081 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:48:36.526495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36b58c55-d7f3-494a-a8e8-aa68738378e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe3503b00>]}
[0m10:48:36.599252 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m10:48:36.601976 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m10:48:36.629531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36b58c55-d7f3-494a-a8e8-aa68738378e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe210a750>]}
[0m10:48:36.630242 [info ] [MainThread]: Found 17 models, 433 macros
[0m10:48:36.633114 [info ] [MainThread]: 
[0m10:48:36.633899 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:48:36.635493 [info ] [MainThread]: 
[0m10:48:36.637019 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:48:36.643340 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:48:36.725392 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:48:36.726314 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:48:36.727441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:36.758790 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.031 seconds
[0m10:48:36.762231 [debug] [ThreadPool]: On list_postgres: Close
[0m10:48:36.766155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m10:48:36.775324 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:48:36.776297 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m10:48:36.777491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:36.791309 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m10:48:36.792351 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:48:36.793505 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:48:36.799280 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.004 seconds
[0m10:48:36.803499 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m10:48:36.804841 [debug] [ThreadPool]: On list_postgres_public: Close
[0m10:48:36.816036 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:36.816611 [debug] [MainThread]: On master: BEGIN
[0m10:48:36.817104 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:48:36.825899 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:48:36.826435 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:36.827015 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:48:36.834578 [debug] [MainThread]: SQL status: SELECT 7 in 0.007 seconds
[0m10:48:36.837672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36b58c55-d7f3-494a-a8e8-aa68738378e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe39e0d10>]}
[0m10:48:36.838235 [debug] [MainThread]: On master: ROLLBACK
[0m10:48:36.838941 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:36.839406 [debug] [MainThread]: On master: BEGIN
[0m10:48:36.840208 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:48:36.840710 [debug] [MainThread]: On master: COMMIT
[0m10:48:36.841193 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:36.841691 [debug] [MainThread]: On master: COMMIT
[0m10:48:36.842340 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:48:36.842842 [debug] [MainThread]: On master: Close
[0m10:48:36.846475 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_sat_fact_journal
[0m10:48:36.847212 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_sat_fact_tech
[0m10:48:36.849009 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_sat_fact_work
[0m10:48:36.848445 [info ] [Thread-1 (]: 1 of 3 START sql incremental model public.dv_sat_fact_journal .................. [RUN]
[0m10:48:36.850320 [info ] [Thread-2 (]: 2 of 3 START sql incremental model public.dv_sat_fact_tech ..................... [RUN]
[0m10:48:36.851368 [info ] [Thread-3 (]: 3 of 3 START sql incremental model public.dv_sat_fact_work ..................... [RUN]
[0m10:48:36.852235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.dv_sat_fact_journal)
[0m10:48:36.853134 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_sat_fact_tech'
[0m10:48:36.854115 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_sat_fact_work'
[0m10:48:36.855026 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_sat_fact_journal
[0m10:48:36.856073 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_sat_fact_tech
[0m10:48:36.856950 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_sat_fact_work
[0m10:48:36.893634 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_tech"
[0m10:48:36.897414 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_work"
[0m10:48:36.888865 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_journal"
[0m10:48:36.899127 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_sat_fact_tech
[0m10:48:36.900120 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_sat_fact_journal
[0m10:48:36.901104 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_sat_fact_work
[0m10:48:37.021750 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_work"
[0m10:48:37.022839 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_tech"
[0m10:48:37.026429 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_journal"
[0m10:48:37.028778 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:48:37.029592 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: BEGIN
[0m10:48:37.030302 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:48:37.031340 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:48:37.032129 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:48:37.032640 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: BEGIN
[0m10:48:37.033439 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: BEGIN
[0m10:48:37.034042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:37.034802 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:48:37.040741 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m10:48:37.041427 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:48:37.042016 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_work"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_hub_fact_work,
        s.hdiff_dv_sat_fact_work,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_work) over(PARTITION BY s.hk_dv_hub_fact_work ORDER BY s.loadts) AS lag_hdiff,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_work,
            s.hdiff_dv_sat_fact_work,
            s.loadts,
            s.recsource,
            идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
        FROM stg_1c_works s
        ) s
    )

    SELECT DISTINCT
        hk_dv_hub_fact_work,
        recsource,
        loadts,
        hdiff_dv_sat_fact_work,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_work <> lag_hdiff 
        OR lag_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m10:48:37.047713 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m10:48:37.048744 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m10:48:37.049683 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:48:37.050789 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:48:37.051784 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_tech"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_lnk_fact_work_tech,
        s.hdiff_dv_sat_fact_tech,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_tech) over(PARTITION BY s.hk_dv_lnk_fact_work_tech ORDER BY s.loadts) AS lag_hdiff,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name

    FROM
        (SELECT
            s.hk_dv_lnk_fact_work_tech,
            s.hdiff_dv_sat_fact_tech,
            s.loadts,
            s.recsource,
            примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
        FROM stg_1c_tech s
        ) s
    )

    SELECT DISTINCT
        hk_dv_lnk_fact_work_tech,
        recsource,
        loadts,
        hdiff_dv_sat_fact_tech,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_tech <> lag_hdiff 
        OR lag_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m10:48:37.052708 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_journal"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_hub_fact_journal,
        s.hdiff_dv_sat_fact_journal,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_journal) over(PARTITION BY s.hk_dv_hub_fact_journal ORDER BY s.loadts) AS lag_hdiff,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_journal,
            s.hdiff_dv_sat_fact_journal,
            s.loadts,
            s.recsource,
            rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
        FROM stg_1c_journal s
        ) s
    )

    SELECT DISTINCT
        hk_dv_hub_fact_journal,
        recsource,
        loadts,
        hdiff_dv_sat_fact_journal,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_journal <> lag_hdiff 
        OR lag_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m10:48:37.059170 [debug] [Thread-3 (]: SQL status: SELECT 22 in 0.016 seconds
[0m10:48:37.078225 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.024 seconds
[0m10:48:37.089515 [debug] [Thread-2 (]: SQL status: SELECT 63 in 0.036 seconds
[0m10:48:37.090597 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m10:48:37.091086 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m10:48:37.093182 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m10:48:37.093860 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:48:37.094407 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:48:37.095067 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:48:37.095763 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m10:48:37.096488 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m10:48:37.097147 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m10:48:37.115836 [debug] [Thread-3 (]: SQL status: COMMIT in 0.018 seconds
[0m10:48:37.116869 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m10:48:37.118943 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: Close
[0m10:48:37.120025 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: Close
[0m10:48:37.124150 [debug] [Thread-2 (]: SQL status: COMMIT in 0.026 seconds
[0m10:48:37.125173 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: Close
[0m10:48:37.125758 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36b58c55-d7f3-494a-a8e8-aa68738378e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe65ef8f0>]}
[0m10:48:37.126385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36b58c55-d7f3-494a-a8e8-aa68738378e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe4b94e90>]}
[0m10:48:37.127151 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36b58c55-d7f3-494a-a8e8-aa68738378e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe0612f90>]}
[0m10:48:37.128412 [info ] [Thread-3 (]: 3 of 3 OK created sql incremental model public.dv_sat_fact_work ................ [[32mSELECT 22[0m in 0.27s]
[0m10:48:37.129821 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model public.dv_sat_fact_journal ............. [[32mSELECT 1[0m in 0.27s]
[0m10:48:37.130908 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model public.dv_sat_fact_tech ................ [[32mSELECT 63[0m in 0.27s]
[0m10:48:37.131986 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_sat_fact_work
[0m10:48:37.133068 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_sat_fact_journal
[0m10:48:37.134254 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_sat_fact_tech
[0m10:48:37.137075 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:37.138108 [debug] [MainThread]: On master: BEGIN
[0m10:48:37.139022 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:48:37.150467 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m10:48:37.151038 [debug] [MainThread]: On master: COMMIT
[0m10:48:37.151697 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:37.152131 [debug] [MainThread]: On master: COMMIT
[0m10:48:37.152836 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:48:37.153289 [debug] [MainThread]: On master: Close
[0m10:48:37.153943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:37.154345 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_journal' was properly closed.
[0m10:48:37.154814 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_tech' was properly closed.
[0m10:48:37.155208 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_work' was properly closed.
[0m10:48:37.155832 [info ] [MainThread]: 
[0m10:48:37.156514 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m10:48:37.158102 [debug] [MainThread]: Command end result
[0m10:48:37.200347 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m10:48:37.202758 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m10:48:37.210203 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m10:48:37.211094 [info ] [MainThread]: 
[0m10:48:37.211964 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:48:37.212873 [info ] [MainThread]: 
[0m10:48:37.213942 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:48:37.215727 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.2562312, "process_in_blocks": "0", "process_kernel_time": 0.237516, "process_mem_max_rss": "121060", "process_out_blocks": "2576", "process_user_time": 2.55089}
[0m10:48:37.216429 [debug] [MainThread]: Command `dbt build` succeeded at 10:48:37.216240 after 1.26 seconds
[0m10:48:37.216990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe4443aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe29ec890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe42e3aa0>]}
[0m10:48:37.217893 [debug] [MainThread]: Flushing usage events
[0m10:48:38.141773 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:48:44.269845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2134cf590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd211472600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd211472b70>]}


============================== 10:48:44.273819 | 2f1ff6c3-7372-4d93-86bd-3aebdad449dc ==============================
[0m10:48:44.273819 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:48:44.274776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build -s +tag:sat', 'send_anonymous_usage_stats': 'True'}
[0m10:48:44.454481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f1ff6c3-7372-4d93-86bd-3aebdad449dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2110c36b0>]}
[0m10:48:44.520858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f1ff6c3-7372-4d93-86bd-3aebdad449dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2112dd4c0>]}
[0m10:48:44.521881 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:48:44.642458 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:48:44.733996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:48:44.734503 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:48:44.763810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f1ff6c3-7372-4d93-86bd-3aebdad449dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2109c6060>]}
[0m10:48:44.839657 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m10:48:44.842494 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m10:48:44.871810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f1ff6c3-7372-4d93-86bd-3aebdad449dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20f9b0ec0>]}
[0m10:48:44.872526 [info ] [MainThread]: Found 17 models, 433 macros
[0m10:48:44.875102 [info ] [MainThread]: 
[0m10:48:44.875764 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:48:44.876481 [info ] [MainThread]: 
[0m10:48:44.877251 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:48:44.884322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:48:44.935704 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:48:44.936351 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:48:44.936851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:44.949229 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.012 seconds
[0m10:48:44.951031 [debug] [ThreadPool]: On list_postgres: Close
[0m10:48:44.953876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m10:48:44.960533 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:48:44.961031 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m10:48:44.961484 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:48:44.970038 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:48:44.970595 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:48:44.971085 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:48:44.974462 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m10:48:44.976533 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m10:48:44.977164 [debug] [ThreadPool]: On list_postgres_public: Close
[0m10:48:44.987127 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:44.987667 [debug] [MainThread]: On master: BEGIN
[0m10:48:44.988128 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:48:44.997082 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:48:44.997646 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:44.998469 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:48:45.006206 [debug] [MainThread]: SQL status: SELECT 7 in 0.007 seconds
[0m10:48:45.009361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f1ff6c3-7372-4d93-86bd-3aebdad449dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21347e0c0>]}
[0m10:48:45.009978 [debug] [MainThread]: On master: ROLLBACK
[0m10:48:45.010697 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:45.011193 [debug] [MainThread]: On master: BEGIN
[0m10:48:45.012234 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:48:45.013144 [debug] [MainThread]: On master: COMMIT
[0m10:48:45.014343 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:45.015391 [debug] [MainThread]: On master: COMMIT
[0m10:48:45.016280 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:48:45.017036 [debug] [MainThread]: On master: Close
[0m10:48:45.021971 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_sat_fact_journal
[0m10:48:45.022921 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_sat_fact_tech
[0m10:48:45.023838 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_sat_fact_work
[0m10:48:45.025042 [info ] [Thread-1 (]: 1 of 3 START sql incremental model public.dv_sat_fact_journal .................. [RUN]
[0m10:48:45.026413 [info ] [Thread-2 (]: 2 of 3 START sql incremental model public.dv_sat_fact_tech ..................... [RUN]
[0m10:48:45.027482 [info ] [Thread-3 (]: 3 of 3 START sql incremental model public.dv_sat_fact_work ..................... [RUN]
[0m10:48:45.028459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.dv_sat_fact_journal)
[0m10:48:45.030079 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_sat_fact_tech'
[0m10:48:45.031729 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_sat_fact_work'
[0m10:48:45.032890 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_sat_fact_journal
[0m10:48:45.033840 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_sat_fact_tech
[0m10:48:45.034823 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_sat_fact_work
[0m10:48:45.072791 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_tech"
[0m10:48:45.075586 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_journal"
[0m10:48:45.077088 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_work"
[0m10:48:45.078239 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_sat_fact_journal
[0m10:48:45.079175 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_sat_fact_tech
[0m10:48:45.114685 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_sat_fact_work
[0m10:48:45.185358 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:48:45.192694 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:48:45.193418 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

    
  
    

  create temporary table "dv_sat_fact_tech__dbt_tmp104845135020"
  
  
    as
  
  (
    



    WITH active_sat AS (
    SELECT DISTINCT ON (hk_dv_lnk_fact_work_tech) hk_dv_lnk_fact_work_tech, hdiff_dv_sat_fact_tech, loadts
    FROM dv_sat_fact_tech
    ORDER BY hk_dv_lnk_fact_work_tech, loadts DESC)

    , max_load AS (
    SELECT max(loadts) AS max_loadts
    FROM dv_sat_fact_tech
    )
    , stage_cte AS (

        SELECT
        s.hk_dv_lnk_fact_work_tech,
        s.hdiff_dv_sat_fact_tech,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_tech) over(PARTITION BY s.hk_dv_lnk_fact_work_tech ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_tech AS sat_hdiff,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name

    FROM
        (SELECT
            s.hk_dv_lnk_fact_work_tech,
            s.hdiff_dv_sat_fact_tech,
            s.loadts,
            s.recsource,
            примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
        FROM stg_1c_tech s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts
        ) s
    LEFT JOIN active_sat a ON a.hk_dv_lnk_fact_work_tech = s.hk_dv_lnk_fact_work_tech)

    SELECT DISTINCT
        hk_dv_lnk_fact_work_tech,
        recsource,
        loadts,
        hdiff_dv_sat_fact_tech,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_tech <> lag_hdiff 
            OR (hdiff_dv_sat_fact_tech <> sat_hdiff AND lag_hdiff IS NULL) 
            OR sat_hdiff IS NULL
    ORDER BY loadts


  );
  
  
[0m10:48:45.190737 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:48:45.194663 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

    
  
    

  create temporary table "dv_sat_fact_journal__dbt_tmp104845127290"
  
  
    as
  
  (
    



    WITH active_sat AS (
    SELECT DISTINCT ON (hk_dv_hub_fact_journal) hk_dv_hub_fact_journal, hdiff_dv_sat_fact_journal, loadts
    FROM dv_sat_fact_journal
    ORDER BY hk_dv_hub_fact_journal, loadts DESC)

    , max_load AS (
    SELECT max(loadts) AS max_loadts
    FROM dv_sat_fact_journal
    )
    , stage_cte AS (

        SELECT
        s.hk_dv_hub_fact_journal,
        s.hdiff_dv_sat_fact_journal,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_journal) over(PARTITION BY s.hk_dv_hub_fact_journal ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_journal AS sat_hdiff,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_journal,
            s.hdiff_dv_sat_fact_journal,
            s.loadts,
            s.recsource,
            rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
        FROM stg_1c_journal s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts
        ) s
    LEFT JOIN active_sat a ON a.hk_dv_hub_fact_journal = s.hk_dv_hub_fact_journal)

    SELECT DISTINCT
        hk_dv_hub_fact_journal,
        recsource,
        loadts,
        hdiff_dv_sat_fact_journal,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_journal <> lag_hdiff 
            OR (hdiff_dv_sat_fact_journal <> sat_hdiff AND lag_hdiff IS NULL) 
            OR sat_hdiff IS NULL
    ORDER BY loadts


  );
  
  
[0m10:48:45.195329 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:48:45.196152 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

    
  
    

  create temporary table "dv_sat_fact_work__dbt_tmp104845159570"
  
  
    as
  
  (
    



    WITH active_sat AS (
    SELECT DISTINCT ON (hk_dv_hub_fact_work) hk_dv_hub_fact_work, hdiff_dv_sat_fact_work, loadts
    FROM dv_sat_fact_work
    ORDER BY hk_dv_hub_fact_work, loadts DESC)

    , max_load AS (
    SELECT max(loadts) AS max_loadts
    FROM dv_sat_fact_work
    )
    , stage_cte AS (

        SELECT
        s.hk_dv_hub_fact_work,
        s.hdiff_dv_sat_fact_work,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_work) over(PARTITION BY s.hk_dv_hub_fact_work ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_work AS sat_hdiff,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_work,
            s.hdiff_dv_sat_fact_work,
            s.loadts,
            s.recsource,
            идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
        FROM stg_1c_works s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts
        ) s
    LEFT JOIN active_sat a ON a.hk_dv_hub_fact_work = s.hk_dv_hub_fact_work)

    SELECT DISTINCT
        hk_dv_hub_fact_work,
        recsource,
        loadts,
        hdiff_dv_sat_fact_work,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_work <> lag_hdiff 
            OR (hdiff_dv_sat_fact_work <> sat_hdiff AND lag_hdiff IS NULL) 
            OR sat_hdiff IS NULL
    ORDER BY loadts


  );
  
  
[0m10:48:45.197013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:48:45.198058 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:48:45.214643 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.019 seconds
[0m10:48:45.222359 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.024 seconds
[0m10:48:45.232777 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:48:45.233460 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.036 seconds
[0m10:48:45.237009 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:48:45.237670 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: BEGIN
[0m10:48:45.241184 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:48:45.241970 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: BEGIN
[0m10:48:45.242853 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: BEGIN
[0m10:48:45.243577 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m10:48:45.244448 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:48:45.245021 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m10:48:45.245549 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_tech__dbt_tmp104845135020'
        
      order by ordinal_position

  
[0m10:48:45.246110 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m10:48:45.246769 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:48:45.247443 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:48:45.248110 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_work__dbt_tmp104845159570'
        
      order by ordinal_position

  
[0m10:48:45.248963 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_journal__dbt_tmp104845127290'
        
      order by ordinal_position

  
[0m10:48:45.253522 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.006 seconds
[0m10:48:45.259985 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:48:45.260623 [debug] [Thread-1 (]: SQL status: SELECT 33 in 0.011 seconds
[0m10:48:45.261203 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:48:45.261786 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.012 seconds
[0m10:48:45.265974 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:48:45.271237 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:48:45.272225 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.006 seconds
[0m10:48:45.272824 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:48:45.273411 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:48:45.284557 [debug] [Thread-1 (]: SQL status: SELECT 33 in 0.005 seconds
[0m10:48:45.285201 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:48:45.289815 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:48:45.290597 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.005 seconds
[0m10:48:45.291154 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:48:45.291849 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:48:45.295990 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:48:45.296811 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:48:45.299907 [debug] [Thread-1 (]: SQL status: SELECT 33 in 0.003 seconds
[0m10:48:45.300723 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.004 seconds
[0m10:48:45.313567 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_tech"
[0m10:48:45.311022 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_journal"
[0m10:48:45.314449 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.017 seconds
[0m10:48:45.317766 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_work"
[0m10:48:45.318649 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:48:45.319495 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      insert into "postgres"."public"."dv_sat_fact_journal" ("hk_dv_hub_fact_journal", "recsource", "loadts", "hdiff_dv_sat_fact_journal", "rabbit_uuid", "rabbit_дата", "проведен", "uuid_жуфвр", "пометка_удаления", "дата", "номер", "территория_value", "территория_codе", "территория_name", "подразделение_value", "подразделение_codе", "подразделение_name", "смена_value", "смена_codе", "смена_name", "прораб_value", "прораб_codе", "прораб_name", "комментарий", "ответственный_value", "ответственный_codе", "ответственный_name", "версия_жуфвр_value", "версия_жуфвр_codе", "версия_жуфвр_name", "направление_деятельности_value", "направление_деятельности_codе", "направление_деятельности_name")
    (
        select "hk_dv_hub_fact_journal", "recsource", "loadts", "hdiff_dv_sat_fact_journal", "rabbit_uuid", "rabbit_дата", "проведен", "uuid_жуфвр", "пометка_удаления", "дата", "номер", "территория_value", "территория_codе", "территория_name", "подразделение_value", "подразделение_codе", "подразделение_name", "смена_value", "смена_codе", "смена_name", "прораб_value", "прораб_codе", "прораб_name", "комментарий", "ответственный_value", "ответственный_codе", "ответственный_name", "версия_жуфвр_value", "версия_жуфвр_codе", "версия_жуфвр_name", "направление_деятельности_value", "направление_деятельности_codе", "направление_деятельности_name"
        from "dv_sat_fact_journal__dbt_tmp104845127290"
    )


  
[0m10:48:45.320179 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:48:45.320954 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:48:45.321828 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m10:48:45.322478 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      insert into "postgres"."public"."dv_sat_fact_tech" ("hk_dv_lnk_fact_work_tech", "recsource", "loadts", "hdiff_dv_sat_fact_tech", "примечание", "госномер_техника_не_найдена", "количество", "часы", "ресурс_value", "ресурс_codе", "ресурс_name", "аналитика_codе", "аналитика_name", "контрагент_value", "контрагент_codе", "контрагент_name")
    (
        select "hk_dv_lnk_fact_work_tech", "recsource", "loadts", "hdiff_dv_sat_fact_tech", "примечание", "госномер_техника_не_найдена", "количество", "часы", "ресурс_value", "ресурс_codе", "ресурс_name", "аналитика_codе", "аналитика_name", "контрагент_value", "контрагент_codе", "контрагент_name"
        from "dv_sat_fact_tech__dbt_tmp104845135020"
    )


  
[0m10:48:45.323184 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      insert into "postgres"."public"."dv_sat_fact_work" ("hk_dv_hub_fact_work", "recsource", "loadts", "hdiff_dv_sat_fact_work", "идентификатор", "объем_работы", "примечание", "кв", "пометка_удаления", "тип_spider", "структура_работ_value", "структура_работ_codе", "структура_работ_name", "видработ_value", "видработ_codе", "видработ_name")
    (
        select "hk_dv_hub_fact_work", "recsource", "loadts", "hdiff_dv_sat_fact_work", "идентификатор", "объем_работы", "примечание", "кв", "пометка_удаления", "тип_spider", "структура_работ_value", "структура_работ_codе", "структура_работ_name", "видработ_value", "видработ_codе", "видработ_name"
        from "dv_sat_fact_work__dbt_tmp104845159570"
    )


  
[0m10:48:45.340645 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m10:48:45.341157 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.007 seconds
[0m10:48:45.341999 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:48:45.342673 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m10:48:45.344618 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m10:48:45.345350 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m10:48:45.347493 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m10:48:45.348137 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:48:45.348855 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:48:45.349548 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m10:48:45.350086 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m10:48:45.356084 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m10:48:45.358215 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: Close
[0m10:48:45.360486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f1ff6c3-7372-4d93-86bd-3aebdad449dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20e0cf830>]}
[0m10:48:45.361303 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model public.dv_sat_fact_journal ............. [[32mINSERT 0 0[0m in 0.33s]
[0m10:48:45.362248 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_sat_fact_journal
[0m10:48:45.380800 [debug] [Thread-2 (]: SQL status: COMMIT in 0.030 seconds
[0m10:48:45.381928 [debug] [Thread-3 (]: SQL status: COMMIT in 0.031 seconds
[0m10:48:45.383121 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: Close
[0m10:48:45.384342 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_work: Close
[0m10:48:45.385487 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f1ff6c3-7372-4d93-86bd-3aebdad449dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20dfe8d40>]}
[0m10:48:45.386562 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f1ff6c3-7372-4d93-86bd-3aebdad449dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd20dfe8e90>]}
[0m10:48:45.387423 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model public.dv_sat_fact_tech ................ [[32mINSERT 0 0[0m in 0.36s]
[0m10:48:45.388765 [info ] [Thread-3 (]: 3 of 3 OK created sql incremental model public.dv_sat_fact_work ................ [[32mINSERT 0 0[0m in 0.36s]
[0m10:48:45.389924 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_sat_fact_tech
[0m10:48:45.390746 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_sat_fact_work
[0m10:48:45.392851 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:45.393395 [debug] [MainThread]: On master: BEGIN
[0m10:48:45.394203 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:48:45.405979 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:48:45.406575 [debug] [MainThread]: On master: COMMIT
[0m10:48:45.407578 [debug] [MainThread]: Using postgres connection "master"
[0m10:48:45.408398 [debug] [MainThread]: On master: COMMIT
[0m10:48:45.409062 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:48:45.409571 [debug] [MainThread]: On master: Close
[0m10:48:45.410241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:45.411036 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_journal' was properly closed.
[0m10:48:45.411851 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_tech' was properly closed.
[0m10:48:45.412772 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_work' was properly closed.
[0m10:48:45.413896 [info ] [MainThread]: 
[0m10:48:45.415117 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m10:48:45.417735 [debug] [MainThread]: Command end result
[0m10:48:45.455800 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m10:48:45.458212 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m10:48:45.465082 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m10:48:45.466011 [info ] [MainThread]: 
[0m10:48:45.467031 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:48:45.467981 [info ] [MainThread]: 
[0m10:48:45.468710 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:48:45.470027 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.2579011, "process_in_blocks": "0", "process_kernel_time": 0.247018, "process_mem_max_rss": "120036", "process_out_blocks": "2464", "process_user_time": 2.509871}
[0m10:48:45.470756 [debug] [MainThread]: Command `dbt build` succeeded at 10:48:45.470551 after 1.26 seconds
[0m10:48:45.471428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21139c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd214ffb6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2115efd40>]}
[0m10:48:45.471989 [debug] [MainThread]: Flushing usage events
[0m10:48:46.333152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:07:31.894923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65af6633b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ad8b9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ad8ba5a0>]}


============================== 11:07:31.901705 | 0776d9ca-0fdf-471d-bc51-4a6b7e803191 ==============================
[0m11:07:31.901705 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:07:31.903033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -s +tag:msat', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:07:32.093856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0776d9ca-0fdf-471d-bc51-4a6b7e803191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ae2f06b0>]}
[0m11:07:32.160222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0776d9ca-0fdf-471d-bc51-4a6b7e803191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65adfa2f30>]}
[0m11:07:32.161252 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:07:32.290630 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:07:32.380205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m11:07:32.380942 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_msat_fact_materials.sql
[0m11:07:32.381527 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_msat_norm_workload.sql
[0m11:07:32.382418 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_sat_fact_tech.sql
[0m11:07:32.383004 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_msat_fact_pikets.sql
[0m11:07:32.682111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0776d9ca-0fdf-471d-bc51-4a6b7e803191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ab9062d0>]}
[0m11:07:32.755748 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m11:07:32.758719 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m11:07:32.788740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0776d9ca-0fdf-471d-bc51-4a6b7e803191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ab57eb10>]}
[0m11:07:32.789463 [info ] [MainThread]: Found 17 models, 433 macros
[0m11:07:32.792136 [info ] [MainThread]: 
[0m11:07:32.792905 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:07:32.793565 [info ] [MainThread]: 
[0m11:07:32.794448 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:07:32.801853 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:07:32.850943 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:07:32.851497 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:07:32.851958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:32.863222 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.011 seconds
[0m11:07:32.864888 [debug] [ThreadPool]: On list_postgres: Close
[0m11:07:32.867758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m11:07:32.874800 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:07:32.875307 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m11:07:32.875833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:07:32.884300 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m11:07:32.884860 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:07:32.885422 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:07:32.888693 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m11:07:32.890756 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m11:07:32.891423 [debug] [ThreadPool]: On list_postgres_public: Close
[0m11:07:32.902302 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:32.902879 [debug] [MainThread]: On master: BEGIN
[0m11:07:32.903313 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:07:32.911753 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:07:32.912273 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:32.912908 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:07:32.920417 [debug] [MainThread]: SQL status: SELECT 7 in 0.007 seconds
[0m11:07:32.923536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0776d9ca-0fdf-471d-bc51-4a6b7e803191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ab933e90>]}
[0m11:07:32.924165 [debug] [MainThread]: On master: ROLLBACK
[0m11:07:32.924946 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:32.925673 [debug] [MainThread]: On master: BEGIN
[0m11:07:32.926492 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:07:32.926925 [debug] [MainThread]: On master: COMMIT
[0m11:07:32.927393 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:32.927844 [debug] [MainThread]: On master: COMMIT
[0m11:07:32.928427 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:07:32.928878 [debug] [MainThread]: On master: Close
[0m11:07:32.932440 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_msat_fact_materials
[0m11:07:32.933183 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_msat_fact_pikets
[0m11:07:32.934112 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_msat_norm_workload
[0m11:07:32.934843 [info ] [Thread-1 (]: 1 of 3 START sql incremental model public.dv_msat_fact_materials ............... [RUN]
[0m11:07:32.935773 [info ] [Thread-2 (]: 2 of 3 START sql incremental model public.dv_msat_fact_pikets .................. [RUN]
[0m11:07:32.936822 [info ] [Thread-3 (]: 3 of 3 START sql incremental model public.dv_msat_norm_workload ................ [RUN]
[0m11:07:32.937961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.dv_msat_fact_materials)
[0m11:07:32.938967 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_msat_fact_pikets'
[0m11:07:32.939706 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_msat_norm_workload'
[0m11:07:32.940599 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_msat_fact_materials
[0m11:07:32.941718 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_msat_fact_pikets
[0m11:07:32.942861 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_msat_norm_workload
[0m11:07:32.963552 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_materials"
[0m11:07:32.958334 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:07:32.969836 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_norm_workload"
[0m11:07:32.974319 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_msat_fact_pikets
[0m11:07:32.975285 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_msat_fact_materials
[0m11:07:32.981103 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_msat_norm_workload
[0m11:07:33.105517 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:07:33.107783 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_norm_workload"
[0m11:07:33.110709 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_materials"
[0m11:07:33.115385 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:07:33.116146 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: BEGIN
[0m11:07:33.116759 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:07:33.117730 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m11:07:33.118666 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m11:07:33.119413 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: BEGIN
[0m11:07:33.120445 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: BEGIN
[0m11:07:33.121182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:33.121760 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:07:33.128803 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m11:07:33.129630 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:07:33.130600 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */

      
  
    

  create  table "postgres"."public"."dv_msat_fact_pikets"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff,
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_pikets,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
                FROM stg_1c_pikets s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count,
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )

    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m11:07:33.132491 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m11:07:33.133103 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m11:07:33.133828 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */

      
  
    

  create  table "postgres"."public"."dv_msat_norm_workload"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff,
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_norm_workload,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
                FROM stg_1c_norm_workload s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count,
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )

    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m11:07:33.134715 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 43:         FROM (
                 ^

[0m11:07:33.135299 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m11:07:33.135886 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: ROLLBACK
[0m11:07:33.136489 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 48:         FROM (
                 ^

[0m11:07:33.137004 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m11:07:33.137707 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: ROLLBACK
[0m11:07:33.138408 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: Close
[0m11:07:33.139102 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */

      
  
    

  create  table "postgres"."public"."dv_msat_fact_materials"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff,
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_materials,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
                FROM stg_1c_materials s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count,
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )

    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m11:07:33.141535 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: Close
[0m11:07:33.142484 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 34:         FROM (
                 ^

[0m11:07:33.145541 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: ROLLBACK
[0m11:07:33.146630 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: Close
[0m11:07:33.158536 [debug] [Thread-3 (]: Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  syntax error at or near "FROM"
  LINE 48:         FROM (
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_norm_workload.sql
[0m11:07:33.160324 [debug] [Thread-1 (]: Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  syntax error at or near "FROM"
  LINE 34:         FROM (
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_materials.sql
[0m11:07:33.161925 [debug] [Thread-2 (]: Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  syntax error at or near "FROM"
  LINE 43:         FROM (
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_pikets.sql
[0m11:07:33.164326 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0776d9ca-0fdf-471d-bc51-4a6b7e803191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65aa582ea0>]}
[0m11:07:33.164985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0776d9ca-0fdf-471d-bc51-4a6b7e803191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ae294ec0>]}
[0m11:07:33.165660 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0776d9ca-0fdf-471d-bc51-4a6b7e803191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65aa7856a0>]}
[0m11:07:33.166655 [error] [Thread-3 (]: 3 of 3 ERROR creating sql incremental model public.dv_msat_norm_workload ....... [[31mERROR[0m in 0.22s]
[0m11:07:33.167753 [error] [Thread-1 (]: 1 of 3 ERROR creating sql incremental model public.dv_msat_fact_materials ...... [[31mERROR[0m in 0.23s]
[0m11:07:33.168657 [error] [Thread-2 (]: 2 of 3 ERROR creating sql incremental model public.dv_msat_fact_pikets ......... [[31mERROR[0m in 0.23s]
[0m11:07:33.169653 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_msat_norm_workload
[0m11:07:33.170362 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_msat_fact_materials
[0m11:07:33.171083 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_msat_fact_pikets
[0m11:07:33.171903 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_norm_workload' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  syntax error at or near "FROM"
  LINE 48:         FROM (
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_norm_workload.sql.
[0m11:07:33.173611 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_fact_materials' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  syntax error at or near "FROM"
  LINE 34:         FROM (
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_materials.sql.
[0m11:07:33.175023 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_fact_pikets' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  syntax error at or near "FROM"
  LINE 43:         FROM (
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_pikets.sql.
[0m11:07:33.177878 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:33.178942 [debug] [MainThread]: On master: BEGIN
[0m11:07:33.179740 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:07:33.190717 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m11:07:33.191319 [debug] [MainThread]: On master: COMMIT
[0m11:07:33.191845 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:33.192276 [debug] [MainThread]: On master: COMMIT
[0m11:07:33.192905 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:07:33.193361 [debug] [MainThread]: On master: Close
[0m11:07:33.194147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:33.195044 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_msat_fact_materials' was properly closed.
[0m11:07:33.196209 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_msat_fact_pikets' was properly closed.
[0m11:07:33.196862 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_msat_norm_workload' was properly closed.
[0m11:07:33.197427 [info ] [MainThread]: 
[0m11:07:33.198200 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m11:07:33.200125 [debug] [MainThread]: Command end result
[0m11:07:33.240672 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m11:07:33.242706 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m11:07:33.252009 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m11:07:33.252576 [info ] [MainThread]: 
[0m11:07:33.253289 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m11:07:33.254283 [info ] [MainThread]: 
[0m11:07:33.255475 [error] [MainThread]:   Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  syntax error at or near "FROM"
  LINE 48:         FROM (
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_norm_workload.sql
[0m11:07:33.256058 [info ] [MainThread]: 
[0m11:07:33.256740 [error] [MainThread]:   Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  syntax error at or near "FROM"
  LINE 34:         FROM (
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_materials.sql
[0m11:07:33.257268 [info ] [MainThread]: 
[0m11:07:33.258113 [error] [MainThread]:   Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  syntax error at or near "FROM"
  LINE 43:         FROM (
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_pikets.sql
[0m11:07:33.259026 [info ] [MainThread]: 
[0m11:07:33.259752 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m11:07:33.261198 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.42359, "process_in_blocks": "4688", "process_kernel_time": 0.254566, "process_mem_max_rss": "124076", "process_out_blocks": "3680", "process_user_time": 2.764347}
[0m11:07:33.262055 [debug] [MainThread]: Command `dbt build` failed at 11:07:33.261912 after 1.42 seconds
[0m11:07:33.262617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65af195b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65af0d4860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ae150500>]}
[0m11:07:33.263128 [debug] [MainThread]: Flushing usage events
[0m11:07:34.275788 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:09:24.357559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3372624860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f337063acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3370277ec0>]}


============================== 11:09:24.361478 | c7156228-1551-4b47-8f05-94be77359ab4 ==============================
[0m11:09:24.361478 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:09:24.362494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build -s +tag:msat', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:09:24.543383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7156228-1551-4b47-8f05-94be77359ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3370a20770>]}
[0m11:09:24.610561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7156228-1551-4b47-8f05-94be77359ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f336f75e330>]}
[0m11:09:24.611597 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:09:24.732135 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:09:24.826069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m11:09:24.826874 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_msat_norm_workload.sql
[0m11:09:24.827497 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_msat_fact_materials.sql
[0m11:09:24.828038 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_msat_fact_pikets.sql
[0m11:09:25.111070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7156228-1551-4b47-8f05-94be77359ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f336df5c560>]}
[0m11:09:25.179086 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m11:09:25.181783 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m11:09:25.210323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7156228-1551-4b47-8f05-94be77359ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f336dbb2d20>]}
[0m11:09:25.211412 [info ] [MainThread]: Found 17 models, 433 macros
[0m11:09:25.214175 [info ] [MainThread]: 
[0m11:09:25.214963 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:09:25.215579 [info ] [MainThread]: 
[0m11:09:25.216600 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:09:25.223776 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:09:25.272129 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:09:25.272672 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:09:25.273123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:25.284434 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.011 seconds
[0m11:09:25.286115 [debug] [ThreadPool]: On list_postgres: Close
[0m11:09:25.290242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m11:09:25.296941 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:09:25.297480 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m11:09:25.297956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:25.306583 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m11:09:25.307093 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:09:25.307621 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:09:25.310890 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m11:09:25.312836 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m11:09:25.313451 [debug] [ThreadPool]: On list_postgres_public: Close
[0m11:09:25.323473 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:25.323969 [debug] [MainThread]: On master: BEGIN
[0m11:09:25.324437 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:09:25.332446 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:09:25.333039 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:25.333675 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:09:25.341532 [debug] [MainThread]: SQL status: SELECT 7 in 0.007 seconds
[0m11:09:25.344908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7156228-1551-4b47-8f05-94be77359ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f336f78a0f0>]}
[0m11:09:25.345798 [debug] [MainThread]: On master: ROLLBACK
[0m11:09:25.346508 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:25.346996 [debug] [MainThread]: On master: BEGIN
[0m11:09:25.347806 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:09:25.348324 [debug] [MainThread]: On master: COMMIT
[0m11:09:25.348865 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:25.349580 [debug] [MainThread]: On master: COMMIT
[0m11:09:25.350264 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:09:25.350772 [debug] [MainThread]: On master: Close
[0m11:09:25.354963 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_msat_fact_materials
[0m11:09:25.356258 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_msat_fact_pikets
[0m11:09:25.356938 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_msat_norm_workload
[0m11:09:25.358150 [info ] [Thread-1 (]: 1 of 3 START sql incremental model public.dv_msat_fact_materials ............... [RUN]
[0m11:09:25.359562 [info ] [Thread-2 (]: 2 of 3 START sql incremental model public.dv_msat_fact_pikets .................. [RUN]
[0m11:09:25.360505 [info ] [Thread-3 (]: 3 of 3 START sql incremental model public.dv_msat_norm_workload ................ [RUN]
[0m11:09:25.361512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.dv_msat_fact_materials)
[0m11:09:25.362625 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_msat_fact_pikets'
[0m11:09:25.363578 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_msat_norm_workload'
[0m11:09:25.364744 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_msat_fact_materials
[0m11:09:25.365967 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_msat_fact_pikets
[0m11:09:25.367052 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_msat_norm_workload
[0m11:09:25.390644 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_materials"
[0m11:09:25.393327 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:09:25.399116 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_norm_workload"
[0m11:09:25.400447 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_msat_fact_materials
[0m11:09:25.401661 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_msat_fact_pikets
[0m11:09:25.431584 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_msat_norm_workload
[0m11:09:25.536649 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:09:25.541297 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_materials"
[0m11:09:25.546365 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_norm_workload"
[0m11:09:25.547875 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m11:09:25.548815 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:09:25.549706 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: BEGIN
[0m11:09:25.550257 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m11:09:25.550928 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: BEGIN
[0m11:09:25.551503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:09:25.552021 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: BEGIN
[0m11:09:25.552627 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:09:25.553508 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:09:25.563354 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m11:09:25.564131 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m11:09:25.565551 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */

      
  
    

  create  table "postgres"."public"."dv_msat_fact_materials"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff,
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_materials,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
                FROM stg_1c_materials s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )

    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m11:09:25.567281 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 34:         FROM (
                 ^

[0m11:09:25.567981 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m11:09:25.568504 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: ROLLBACK
[0m11:09:25.569006 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m11:09:25.569660 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m11:09:25.570427 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:09:25.571242 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */

      
  
    

  create  table "postgres"."public"."dv_msat_norm_workload"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff,
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_norm_workload,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
                FROM stg_1c_norm_workload s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )

    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m11:09:25.572104 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: Close
[0m11:09:25.572842 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */

      
  
    

  create  table "postgres"."public"."dv_msat_fact_pikets"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff,
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_pikets,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
                FROM stg_1c_pikets s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )

    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m11:09:25.576910 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 48:         FROM (
                 ^

[0m11:09:25.578015 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: ROLLBACK
[0m11:09:25.579066 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: Close
[0m11:09:25.579639 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 43:         FROM (
                 ^

[0m11:09:25.582160 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: ROLLBACK
[0m11:09:25.583850 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: Close
[0m11:09:25.591862 [debug] [Thread-1 (]: Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  syntax error at or near "FROM"
  LINE 34:         FROM (
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_materials.sql
[0m11:09:25.593399 [debug] [Thread-3 (]: Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  syntax error at or near "FROM"
  LINE 48:         FROM (
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_norm_workload.sql
[0m11:09:25.596147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7156228-1551-4b47-8f05-94be77359ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33709c4c50>]}
[0m11:09:25.597736 [debug] [Thread-2 (]: Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  syntax error at or near "FROM"
  LINE 43:         FROM (
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_pikets.sql
[0m11:09:25.598457 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7156228-1551-4b47-8f05-94be77359ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f336cb90560>]}
[0m11:09:25.599378 [error] [Thread-1 (]: 1 of 3 ERROR creating sql incremental model public.dv_msat_fact_materials ...... [[31mERROR[0m in 0.23s]
[0m11:09:25.600362 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7156228-1551-4b47-8f05-94be77359ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f336cb90650>]}
[0m11:09:25.601159 [error] [Thread-3 (]: 3 of 3 ERROR creating sql incremental model public.dv_msat_norm_workload ....... [[31mERROR[0m in 0.24s]
[0m11:09:25.602190 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_msat_fact_materials
[0m11:09:25.603514 [error] [Thread-2 (]: 2 of 3 ERROR creating sql incremental model public.dv_msat_fact_pikets ......... [[31mERROR[0m in 0.24s]
[0m11:09:25.604395 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_msat_norm_workload
[0m11:09:25.605804 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_msat_fact_pikets
[0m11:09:25.606742 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_fact_materials' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  syntax error at or near "FROM"
  LINE 34:         FROM (
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_materials.sql.
[0m11:09:25.608991 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_norm_workload' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  syntax error at or near "FROM"
  LINE 48:         FROM (
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_norm_workload.sql.
[0m11:09:25.610704 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_fact_pikets' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  syntax error at or near "FROM"
  LINE 43:         FROM (
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_pikets.sql.
[0m11:09:25.613347 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:25.614025 [debug] [MainThread]: On master: BEGIN
[0m11:09:25.614691 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:09:25.625488 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m11:09:25.626030 [debug] [MainThread]: On master: COMMIT
[0m11:09:25.626563 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:25.627147 [debug] [MainThread]: On master: COMMIT
[0m11:09:25.627838 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:09:25.628327 [debug] [MainThread]: On master: Close
[0m11:09:25.628983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:25.629431 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_msat_fact_materials' was properly closed.
[0m11:09:25.629851 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_msat_fact_pikets' was properly closed.
[0m11:09:25.630267 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_msat_norm_workload' was properly closed.
[0m11:09:25.630945 [info ] [MainThread]: 
[0m11:09:25.631473 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m11:09:25.632944 [debug] [MainThread]: Command end result
[0m11:09:25.680449 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m11:09:25.683024 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m11:09:25.690775 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m11:09:25.691310 [info ] [MainThread]: 
[0m11:09:25.691938 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m11:09:25.692557 [info ] [MainThread]: 
[0m11:09:25.693283 [error] [MainThread]:   Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  syntax error at or near "FROM"
  LINE 34:         FROM (
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_materials.sql
[0m11:09:25.693886 [info ] [MainThread]: 
[0m11:09:25.694634 [error] [MainThread]:   Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  syntax error at or near "FROM"
  LINE 48:         FROM (
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_norm_workload.sql
[0m11:09:25.695164 [info ] [MainThread]: 
[0m11:09:25.695917 [error] [MainThread]:   Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  syntax error at or near "FROM"
  LINE 43:         FROM (
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_pikets.sql
[0m11:09:25.696653 [info ] [MainThread]: 
[0m11:09:25.697320 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m11:09:25.699007 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.4011167, "process_in_blocks": "0", "process_kernel_time": 0.243213, "process_mem_max_rss": "124504", "process_out_blocks": "3680", "process_user_time": 2.707789}
[0m11:09:25.700101 [debug] [MainThread]: Command `dbt build` failed at 11:09:25.699835 after 1.40 seconds
[0m11:09:25.701185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f337078eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33717aa3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33702a88f0>]}
[0m11:09:25.702029 [debug] [MainThread]: Flushing usage events
[0m11:09:26.661459 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:11:20.679996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066e4e6de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066e3f2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066e40b890>]}


============================== 11:11:20.683804 | 22123e0e-1557-4f12-afe1-40da2b389663 ==============================
[0m11:11:20.683804 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:11:20.684752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build -s +tag:msat', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:11:20.882488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22123e0e-1557-4f12-afe1-40da2b389663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066e4c06b0>]}
[0m11:11:20.952064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22123e0e-1557-4f12-afe1-40da2b389663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066d8a9f40>]}
[0m11:11:20.953129 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:11:21.099780 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:11:21.188236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m11:11:21.189018 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_msat_norm_workload.sql
[0m11:11:21.189636 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_msat_fact_materials.sql
[0m11:11:21.190193 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_msat_fact_pikets.sql
[0m11:11:21.492801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22123e0e-1557-4f12-afe1-40da2b389663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066c142db0>]}
[0m11:11:21.560825 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m11:11:21.563470 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m11:11:21.592117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22123e0e-1557-4f12-afe1-40da2b389663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066c142e40>]}
[0m11:11:21.592832 [info ] [MainThread]: Found 17 models, 433 macros
[0m11:11:21.595344 [info ] [MainThread]: 
[0m11:11:21.596078 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:11:21.596775 [info ] [MainThread]: 
[0m11:11:21.597653 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:11:21.605083 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:11:21.654232 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:11:21.654804 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:11:21.655274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:21.666849 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.012 seconds
[0m11:11:21.668582 [debug] [ThreadPool]: On list_postgres: Close
[0m11:11:21.671544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m11:11:21.678457 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:11:21.678987 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m11:11:21.679427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:21.687916 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m11:11:21.688438 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:11:21.688908 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:11:21.692043 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m11:11:21.694011 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m11:11:21.694627 [debug] [ThreadPool]: On list_postgres_public: Close
[0m11:11:21.706800 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:21.707352 [debug] [MainThread]: On master: BEGIN
[0m11:11:21.707843 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:11:21.718968 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m11:11:21.719514 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:21.720042 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:11:21.737459 [debug] [MainThread]: SQL status: SELECT 7 in 0.017 seconds
[0m11:11:21.742345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22123e0e-1557-4f12-afe1-40da2b389663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066b572d80>]}
[0m11:11:21.743171 [debug] [MainThread]: On master: ROLLBACK
[0m11:11:21.744003 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:21.744614 [debug] [MainThread]: On master: BEGIN
[0m11:11:21.745556 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:11:21.746141 [debug] [MainThread]: On master: COMMIT
[0m11:11:21.746737 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:21.747214 [debug] [MainThread]: On master: COMMIT
[0m11:11:21.747904 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:11:21.748424 [debug] [MainThread]: On master: Close
[0m11:11:21.752434 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_msat_fact_materials
[0m11:11:21.753190 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_msat_fact_pikets
[0m11:11:21.754457 [info ] [Thread-1 (]: 1 of 3 START sql incremental model public.dv_msat_fact_materials ............... [RUN]
[0m11:11:21.755247 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_msat_norm_workload
[0m11:11:21.756103 [info ] [Thread-2 (]: 2 of 3 START sql incremental model public.dv_msat_fact_pikets .................. [RUN]
[0m11:11:21.757130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.dv_msat_fact_materials)
[0m11:11:21.758205 [info ] [Thread-3 (]: 3 of 3 START sql incremental model public.dv_msat_norm_workload ................ [RUN]
[0m11:11:21.759257 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_msat_fact_pikets'
[0m11:11:21.759912 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_msat_fact_materials
[0m11:11:21.760795 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_msat_norm_workload'
[0m11:11:21.761763 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_msat_fact_pikets
[0m11:11:21.768247 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_msat_norm_workload
[0m11:11:21.782518 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_materials"
[0m11:11:21.783145 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:11:21.789116 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_norm_workload"
[0m11:11:21.790510 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_msat_fact_materials
[0m11:11:21.791478 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_msat_fact_pikets
[0m11:11:21.797429 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_msat_norm_workload
[0m11:11:21.937347 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_materials"
[0m11:11:21.941445 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_norm_workload"
[0m11:11:21.945080 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:11:21.946567 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m11:11:21.947575 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m11:11:21.948081 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: BEGIN
[0m11:11:21.948764 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:11:21.949637 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: BEGIN
[0m11:11:21.950205 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:11:21.950856 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: BEGIN
[0m11:11:21.951330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:11:21.952341 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:11:21.962814 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m11:11:21.963484 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:11:21.964181 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */

      
  
    

  create  table "postgres"."public"."dv_msat_fact_pikets"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_pikets,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
                FROM stg_1c_pikets s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )

    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m11:11:21.965642 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m11:11:21.966244 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m11:11:21.967278 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */

      
  
    

  create  table "postgres"."public"."dv_msat_norm_workload"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_norm_workload,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
                FROM stg_1c_norm_workload s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )

    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m11:11:21.968032 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m11:11:21.968681 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m11:11:21.969333 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */

      
  
    

  create  table "postgres"."public"."dv_msat_fact_materials"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_materials,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
                FROM stg_1c_materials s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )

    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m11:11:22.017887 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.047 seconds
[0m11:11:22.023880 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.055 seconds
[0m11:11:22.024875 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.060 seconds
[0m11:11:22.049332 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: COMMIT
[0m11:11:22.051537 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: COMMIT
[0m11:11:22.052819 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: COMMIT
[0m11:11:22.053458 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:11:22.054035 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m11:11:22.054714 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m11:11:22.055403 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: COMMIT
[0m11:11:22.056016 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: COMMIT
[0m11:11:22.056681 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: COMMIT
[0m11:11:22.079205 [debug] [Thread-2 (]: SQL status: COMMIT in 0.022 seconds
[0m11:11:22.081816 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: Close
[0m11:11:22.083963 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22123e0e-1557-4f12-afe1-40da2b389663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066fccf9b0>]}
[0m11:11:22.084922 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model public.dv_msat_fact_pikets ............. [[32mSELECT 0[0m in 0.32s]
[0m11:11:22.085882 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_msat_fact_pikets
[0m11:11:22.093397 [debug] [Thread-1 (]: SQL status: COMMIT in 0.036 seconds
[0m11:11:22.094490 [debug] [Thread-3 (]: SQL status: COMMIT in 0.037 seconds
[0m11:11:22.095590 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: Close
[0m11:11:22.097389 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: Close
[0m11:11:22.098912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22123e0e-1557-4f12-afe1-40da2b389663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066a62d730>]}
[0m11:11:22.100831 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model public.dv_msat_fact_materials .......... [[32mSELECT 0[0m in 0.34s]
[0m11:11:22.102862 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_msat_fact_materials
[0m11:11:22.103823 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22123e0e-1557-4f12-afe1-40da2b389663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066a641a30>]}
[0m11:11:22.105189 [info ] [Thread-3 (]: 3 of 3 OK created sql incremental model public.dv_msat_norm_workload ........... [[32mSELECT 6[0m in 0.34s]
[0m11:11:22.106095 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_msat_norm_workload
[0m11:11:22.108568 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:22.109584 [debug] [MainThread]: On master: BEGIN
[0m11:11:22.110212 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:11:22.120137 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m11:11:22.120737 [debug] [MainThread]: On master: COMMIT
[0m11:11:22.121201 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:22.121683 [debug] [MainThread]: On master: COMMIT
[0m11:11:22.122321 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:11:22.123078 [debug] [MainThread]: On master: Close
[0m11:11:22.124107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:22.124940 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_msat_fact_materials' was properly closed.
[0m11:11:22.125791 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_msat_fact_pikets' was properly closed.
[0m11:11:22.126575 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_msat_norm_workload' was properly closed.
[0m11:11:22.127873 [info ] [MainThread]: 
[0m11:11:22.128883 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m11:11:22.130723 [debug] [MainThread]: Command end result
[0m11:11:22.175622 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m11:11:22.177778 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m11:11:22.184789 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m11:11:22.185317 [info ] [MainThread]: 
[0m11:11:22.186029 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:11:22.186668 [info ] [MainThread]: 
[0m11:11:22.187250 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:11:22.188470 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.5659093, "process_in_blocks": "0", "process_kernel_time": 0.235987, "process_mem_max_rss": "124924", "process_out_blocks": "3608", "process_user_time": 2.828261}
[0m11:11:22.189198 [debug] [MainThread]: Command `dbt build` succeeded at 11:11:22.189003 after 1.57 seconds
[0m11:11:22.189814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066dc717c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066dd2ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066f192e10>]}
[0m11:11:22.190391 [debug] [MainThread]: Flushing usage events
[0m11:11:23.145891 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:36:09.540394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1027e3aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd100fac0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd101905c10>]}


============================== 11:36:09.546084 | 7221637b-4a51-4207-bd63-dd18f3289200 ==============================
[0m11:36:09.546084 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:36:09.547292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build -s +tag:msat', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:36:09.765621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7221637b-4a51-4207-bd63-dd18f3289200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1019bc560>]}
[0m11:36:09.855485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7221637b-4a51-4207-bd63-dd18f3289200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd103299f40>]}
[0m11:36:09.856612 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:36:09.995318 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:36:10.098973 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m11:36:10.099768 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_msat_fact_materials.sql
[0m11:36:10.100324 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_msat_norm_workload.sql
[0m11:36:10.100919 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_msat_fact_pikets.sql
[0m11:36:10.390134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7221637b-4a51-4207-bd63-dd18f3289200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ff3ebda0>]}
[0m11:36:10.458407 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m11:36:10.461387 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m11:36:10.508840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7221637b-4a51-4207-bd63-dd18f3289200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ff3f8500>]}
[0m11:36:10.509480 [info ] [MainThread]: Found 17 models, 433 macros
[0m11:36:10.512036 [info ] [MainThread]: 
[0m11:36:10.512742 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:36:10.513237 [info ] [MainThread]: 
[0m11:36:10.514165 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:36:10.520485 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:36:10.581441 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:36:10.582063 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:36:10.582513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:10.605472 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.023 seconds
[0m11:36:10.607265 [debug] [ThreadPool]: On list_postgres: Close
[0m11:36:10.611532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m11:36:10.618491 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:36:10.619135 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m11:36:10.619637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:10.628671 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m11:36:10.629243 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:36:10.629794 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:36:10.633550 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m11:36:10.635727 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m11:36:10.636358 [debug] [ThreadPool]: On list_postgres_public: Close
[0m11:36:10.647904 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:10.648845 [debug] [MainThread]: On master: BEGIN
[0m11:36:10.649349 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:36:10.659282 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m11:36:10.659865 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:10.660406 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:36:10.676149 [debug] [MainThread]: SQL status: SELECT 7 in 0.015 seconds
[0m11:36:10.679942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7221637b-4a51-4207-bd63-dd18f3289200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ff3f9ca0>]}
[0m11:36:10.680582 [debug] [MainThread]: On master: ROLLBACK
[0m11:36:10.681306 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:10.681838 [debug] [MainThread]: On master: BEGIN
[0m11:36:10.682634 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:36:10.683098 [debug] [MainThread]: On master: COMMIT
[0m11:36:10.683559 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:10.684021 [debug] [MainThread]: On master: COMMIT
[0m11:36:10.684593 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:36:10.685058 [debug] [MainThread]: On master: Close
[0m11:36:10.689204 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_msat_fact_materials
[0m11:36:10.689963 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_msat_fact_pikets
[0m11:36:10.691248 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_msat_norm_workload
[0m11:36:10.690664 [info ] [Thread-1 (]: 1 of 3 START sql incremental model public.dv_msat_fact_materials ............... [RUN]
[0m11:36:10.692186 [info ] [Thread-2 (]: 2 of 3 START sql incremental model public.dv_msat_fact_pikets .................. [RUN]
[0m11:36:10.694245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.dv_msat_fact_materials)
[0m11:36:10.693265 [info ] [Thread-3 (]: 3 of 3 START sql incremental model public.dv_msat_norm_workload ................ [RUN]
[0m11:36:10.695323 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_msat_fact_pikets'
[0m11:36:10.696094 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_msat_fact_materials
[0m11:36:10.697330 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_msat_norm_workload'
[0m11:36:10.698306 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_msat_fact_pikets
[0m11:36:10.709785 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_msat_norm_workload
[0m11:36:10.714765 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_materials"
[0m11:36:10.721307 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:36:10.727070 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_norm_workload"
[0m11:36:10.728601 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_msat_fact_materials
[0m11:36:10.729314 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_msat_fact_pikets
[0m11:36:10.740416 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_msat_norm_workload
[0m11:36:10.899748 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:36:10.901248 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_materials"
[0m11:36:10.905134 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_norm_workload"
[0m11:36:10.909900 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:36:10.910730 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m11:36:10.911302 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: BEGIN
[0m11:36:10.911932 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m11:36:10.912532 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: BEGIN
[0m11:36:10.913215 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:36:10.913827 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: BEGIN
[0m11:36:10.914378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:36:10.915316 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:36:10.924197 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m11:36:10.925161 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:36:10.925815 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */

      
  
    

  create  table "postgres"."public"."dv_msat_fact_pikets"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_pikets,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
                FROM stg_1c_pikets s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            
            OR stg_lag_hdiff IS null

    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m11:36:10.928385 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m11:36:10.929411 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m11:36:10.930146 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m11:36:10.931481 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */

      
  
    

  create  table "postgres"."public"."dv_msat_fact_materials"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_materials,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
                FROM stg_1c_materials s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            
            OR stg_lag_hdiff IS null

    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m11:36:10.932619 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m11:36:10.933886 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */

      
  
    

  create  table "postgres"."public"."dv_msat_norm_workload"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_norm_workload,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
                FROM stg_1c_norm_workload s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            
            OR stg_lag_hdiff IS null

    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m11:36:10.958287 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.025 seconds
[0m11:36:10.959052 [debug] [Thread-3 (]: SQL status: SELECT 20 in 0.024 seconds
[0m11:36:10.994020 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: COMMIT
[0m11:36:10.996354 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: COMMIT
[0m11:36:10.996979 [debug] [Thread-2 (]: SQL status: SELECT 22 in 0.071 seconds
[0m11:36:10.997582 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m11:36:10.998283 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m11:36:11.000604 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: COMMIT
[0m11:36:11.001190 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: COMMIT
[0m11:36:11.001830 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: COMMIT
[0m11:36:11.002474 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:36:11.003245 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: COMMIT
[0m11:36:11.013645 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m11:36:11.016156 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: Close
[0m11:36:11.018238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7221637b-4a51-4207-bd63-dd18f3289200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1019688c0>]}
[0m11:36:11.019175 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model public.dv_msat_fact_materials .......... [[32mSELECT 15[0m in 0.32s]
[0m11:36:11.020147 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_msat_fact_materials
[0m11:36:11.023251 [debug] [Thread-2 (]: SQL status: COMMIT in 0.019 seconds
[0m11:36:11.023859 [debug] [Thread-3 (]: SQL status: COMMIT in 0.021 seconds
[0m11:36:11.025016 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: Close
[0m11:36:11.026399 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: Close
[0m11:36:11.027992 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7221637b-4a51-4207-bd63-dd18f3289200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0fdb9fa40>]}
[0m11:36:11.029772 [info ] [Thread-2 (]: 2 of 3 OK created sql incremental model public.dv_msat_fact_pikets ............. [[32mSELECT 22[0m in 0.33s]
[0m11:36:11.031441 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7221637b-4a51-4207-bd63-dd18f3289200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0fdb96a50>]}
[0m11:36:11.033142 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_msat_fact_pikets
[0m11:36:11.034804 [info ] [Thread-3 (]: 3 of 3 OK created sql incremental model public.dv_msat_norm_workload ........... [[32mSELECT 20[0m in 0.33s]
[0m11:36:11.036686 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_msat_norm_workload
[0m11:36:11.039619 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:11.040519 [debug] [MainThread]: On master: BEGIN
[0m11:36:11.041416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:36:11.052436 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m11:36:11.053147 [debug] [MainThread]: On master: COMMIT
[0m11:36:11.053780 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:11.054334 [debug] [MainThread]: On master: COMMIT
[0m11:36:11.055641 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:36:11.056181 [debug] [MainThread]: On master: Close
[0m11:36:11.056919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:11.057359 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_msat_fact_materials' was properly closed.
[0m11:36:11.057860 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_msat_fact_pikets' was properly closed.
[0m11:36:11.058626 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_msat_norm_workload' was properly closed.
[0m11:36:11.059219 [info ] [MainThread]: 
[0m11:36:11.060078 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m11:36:11.062030 [debug] [MainThread]: Command end result
[0m11:36:11.100220 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m11:36:11.102151 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m11:36:11.112016 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m11:36:11.112952 [info ] [MainThread]: 
[0m11:36:11.113835 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:36:11.114384 [info ] [MainThread]: 
[0m11:36:11.115054 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:36:11.116828 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.6361701, "process_in_blocks": "47944", "process_kernel_time": 0.302226, "process_mem_max_rss": "124748", "process_out_blocks": "3648", "process_user_time": 2.895919}
[0m11:36:11.117474 [debug] [MainThread]: Command `dbt build` succeeded at 11:36:11.117278 after 1.64 seconds
[0m11:36:11.118058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd104db7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd10344cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd101289df0>]}
[0m11:36:11.118581 [debug] [MainThread]: Flushing usage events
[0m11:36:12.149456 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:43.767508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81ec121af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81ec1211f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81ec121580>]}


============================== 11:38:43.773885 | fd83e913-d743-450e-a52b-4af715eeff10 ==============================
[0m11:38:43.773885 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:38:43.775003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:38:43.974116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81ec8b4650>]}
[0m11:38:44.043864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81ec3598e0>]}
[0m11:38:44.044930 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:38:44.191777 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:38:44.293805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:44.294332 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:44.324705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81eb962390>]}
[0m11:38:44.412689 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m11:38:44.416866 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m11:38:44.472948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81eadba3f0>]}
[0m11:38:44.473594 [info ] [MainThread]: Found 17 models, 433 macros
[0m11:38:44.476902 [info ] [MainThread]: 
[0m11:38:44.477502 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:38:44.478313 [info ] [MainThread]: 
[0m11:38:44.479357 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:38:44.486232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:38:44.592583 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:38:44.593740 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:38:44.594732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:44.624327 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.030 seconds
[0m11:38:44.627360 [debug] [ThreadPool]: On list_postgres: Close
[0m11:38:44.635106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m11:38:44.648637 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:38:44.649511 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m11:38:44.650266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:44.664578 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m11:38:44.665418 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:38:44.666223 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:38:44.677470 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.010 seconds
[0m11:38:44.681181 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m11:38:44.682285 [debug] [ThreadPool]: On list_postgres_public: Close
[0m11:38:44.705274 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:44.706172 [debug] [MainThread]: On master: BEGIN
[0m11:38:44.706918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:44.721601 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m11:38:44.722434 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:44.723438 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:38:44.744109 [debug] [MainThread]: SQL status: SELECT 7 in 0.019 seconds
[0m11:38:44.749949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81eadb9400>]}
[0m11:38:44.750908 [debug] [MainThread]: On master: ROLLBACK
[0m11:38:44.751914 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:44.752689 [debug] [MainThread]: On master: BEGIN
[0m11:38:44.753762 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:38:44.754580 [debug] [MainThread]: On master: COMMIT
[0m11:38:44.755461 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:44.756149 [debug] [MainThread]: On master: COMMIT
[0m11:38:44.757094 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:38:44.757889 [debug] [MainThread]: On master: Close
[0m11:38:44.767127 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_msat_fact_materials
[0m11:38:44.769207 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_msat_fact_pikets
[0m11:38:44.768367 [info ] [Thread-1 (]: 1 of 17 START sql incremental model public.dv_msat_fact_materials .............. [RUN]
[0m11:38:44.771619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.dv_msat_fact_materials)
[0m11:38:44.772384 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_msat_fact_materials
[0m11:38:44.773158 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_msat_norm_workload
[0m11:38:44.779553 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_sat_fact_journal
[0m11:38:44.770402 [info ] [Thread-2 (]: 2 of 17 START sql incremental model public.dv_msat_fact_pikets ................. [RUN]
[0m11:38:44.791459 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_msat_fact_pikets'
[0m11:38:44.800419 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_msat_fact_pikets
[0m11:38:44.780472 [info ] [Thread-3 (]: 3 of 17 START sql incremental model public.dv_msat_norm_workload ............... [RUN]
[0m11:38:44.815966 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_msat_norm_workload'
[0m11:38:44.816506 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_msat_norm_workload
[0m11:38:44.815131 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_materials"
[0m11:38:44.790183 [info ] [Thread-4 (]: 4 of 17 START sql incremental model public.dv_sat_fact_journal ................. [RUN]
[0m11:38:44.824063 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:38:44.826168 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_norm_workload"
[0m11:38:44.828156 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_sat_fact_journal'
[0m11:38:44.830395 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_msat_fact_materials
[0m11:38:44.831327 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_sat_fact_journal
[0m11:38:44.832426 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_msat_norm_workload
[0m11:38:44.833666 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_msat_fact_pikets
[0m11:38:44.861417 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_journal"
[0m11:38:44.950001 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m11:38:44.951035 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m11:38:44.954492 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:38:44.955276 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */

    
  
    

  create temporary table "dv_msat_fact_materials__dbt_tmp113844897047"
  
  
    as
  
  (
    


    WITH active_sat AS (
    SELECT *
    FROM (
        SELECT 
            hk_dv_hub_fact_work,
            hdiff_dv_msat_fact_materials,
            loadts,
            sub_seq,
            COUNT(*) OVER (PARTITION BY hk_dv_hub_fact_work, loadts) AS cnt,
            rank() OVER (
                PARTITION BY hk_dv_hub_fact_work
                ORDER BY loadts DESC
            ) AS rnk
        FROM dv_msat_fact_materials
        ) a (
            sat_id,
            sat_hdiff,
            sat_loadts,
            sat_sub_seq,
            sat_count,
            sat_rnk
        )
    WHERE sat_rnk = 1
    ),
    stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS 
                stg_lag_hdiff,
                sat_hdiff,
                sat_count,
                sat_sub_seq,
                sat_rnk
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_materials,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
                FROM stg_1c_materials s
                    CROSS JOIN (
                        SELECT max(loadts) AS max_loadts
                        FROM dv_msat_fact_materials
                    ) ml
                WHERE s.loadts > ml.max_loadts
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
        LEFT JOIN active_sat a ON sat_id = stg_id
        AND sat_sub_seq = stg_sub_seq
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count,
                    sat_hdiff,
                    sat_count,
                    sat_sub_seq,
                    sat_rnk
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            OR (
                (
                    stg_hdiff <> sat_hdiff
                    AND stg_lag_hdiff IS NULL
                )
                OR (
                    stg_count <> sat_count
                    AND stg_lag_count IS NULL
                )
            )
    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq


  );
  
  
[0m11:38:44.956465 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */

    
  
    

  create temporary table "dv_msat_norm_workload__dbt_tmp113844921049"
  
  
    as
  
  (
    


    WITH active_sat AS (
    SELECT *
    FROM (
        SELECT 
            hk_dv_hub_fact_work,
            hdiff_dv_msat_norm_workload,
            loadts,
            sub_seq,
            COUNT(*) OVER (PARTITION BY hk_dv_hub_fact_work, loadts) AS cnt,
            rank() OVER (
                PARTITION BY hk_dv_hub_fact_work
                ORDER BY loadts DESC
            ) AS rnk
        FROM dv_msat_norm_workload
        ) a (
            sat_id,
            sat_hdiff,
            sat_loadts,
            sat_sub_seq,
            sat_count,
            sat_rnk
        )
    WHERE sat_rnk = 1
    ),
    stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS 
                stg_lag_hdiff,
                sat_hdiff,
                sat_count,
                sat_sub_seq,
                sat_rnk
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_norm_workload,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
                FROM stg_1c_norm_workload s
                    CROSS JOIN (
                        SELECT max(loadts) AS max_loadts
                        FROM dv_msat_norm_workload
                    ) ml
                WHERE s.loadts > ml.max_loadts
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
        LEFT JOIN active_sat a ON sat_id = stg_id
        AND sat_sub_seq = stg_sub_seq
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count,
                    sat_hdiff,
                    sat_count,
                    sat_sub_seq,
                    sat_rnk
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            OR (
                (
                    stg_hdiff <> sat_hdiff
                    AND stg_lag_hdiff IS NULL
                )
                OR (
                    stg_count <> sat_count
                    AND stg_lag_count IS NULL
                )
            )
    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq


  );
  
  
[0m11:38:44.957357 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_sat_fact_journal
[0m11:38:44.958074 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */

    
  
    

  create temporary table "dv_msat_fact_pikets__dbt_tmp113844902922"
  
  
    as
  
  (
    


    WITH active_sat AS (
    SELECT *
    FROM (
        SELECT 
            hk_dv_hub_fact_work,
            hdiff_dv_msat_fact_pikets,
            loadts,
            sub_seq,
            COUNT(*) OVER (PARTITION BY hk_dv_hub_fact_work, loadts) AS cnt,
            rank() OVER (
                PARTITION BY hk_dv_hub_fact_work
                ORDER BY loadts DESC
            ) AS rnk
        FROM dv_msat_fact_pikets
        ) a (
            sat_id,
            sat_hdiff,
            sat_loadts,
            sat_sub_seq,
            sat_count,
            sat_rnk
        )
    WHERE sat_rnk = 1
    ),
    stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS 
                stg_lag_hdiff,
                sat_hdiff,
                sat_count,
                sat_sub_seq,
                sat_rnk
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_pikets,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
                FROM stg_1c_pikets s
                    CROSS JOIN (
                        SELECT max(loadts) AS max_loadts
                        FROM dv_msat_fact_pikets
                    ) ml
                WHERE s.loadts > ml.max_loadts
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
        LEFT JOIN active_sat a ON sat_id = stg_id
        AND sat_sub_seq = stg_sub_seq
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count,
                    sat_hdiff,
                    sat_count,
                    sat_sub_seq,
                    sat_rnk
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            OR (
                (
                    stg_hdiff <> sat_hdiff
                    AND stg_lag_hdiff IS NULL
                )
                OR (
                    stg_count <> sat_count
                    AND stg_lag_count IS NULL
                )
            )
    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq


  );
  
  
[0m11:38:44.958958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:44.959585 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:38:44.965477 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:38:44.964969 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m11:38:44.968058 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

    
  
    

  create temporary table "dv_sat_fact_journal__dbt_tmp113844962515"
  
  
    as
  
  (
    



    WITH active_sat AS (
    SELECT DISTINCT ON (hk_dv_hub_fact_journal) hk_dv_hub_fact_journal, hdiff_dv_sat_fact_journal, loadts
    FROM dv_sat_fact_journal
    ORDER BY hk_dv_hub_fact_journal, loadts DESC)

    , max_load AS (
    SELECT max(loadts) AS max_loadts
    FROM dv_sat_fact_journal
    )
    , stage_cte AS (

        SELECT
        s.hk_dv_hub_fact_journal,
        s.hdiff_dv_sat_fact_journal,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_journal) over(PARTITION BY s.hk_dv_hub_fact_journal ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_journal AS sat_hdiff,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_journal,
            s.hdiff_dv_sat_fact_journal,
            s.loadts,
            s.recsource,
            rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
        FROM stg_1c_journal s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts
        ) s
    LEFT JOIN active_sat a ON a.hk_dv_hub_fact_journal = s.hk_dv_hub_fact_journal)

    SELECT DISTINCT
        hk_dv_hub_fact_journal,
        recsource,
        loadts,
        hdiff_dv_sat_fact_journal,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_journal <> lag_hdiff 
            OR (hdiff_dv_sat_fact_journal <> sat_hdiff AND lag_hdiff IS NULL) 
            OR sat_hdiff IS NULL
    ORDER BY loadts


  );
  
  
[0m11:38:44.969997 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:38:44.986092 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "hk_dv_hub_fact_work" does not exist
LINE 20:             hk_dv_hub_fact_work,
                     ^

[0m11:38:44.987179 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "hk_dv_hub_fact_work" does not exist
LINE 20:             hk_dv_hub_fact_work,
                     ^

[0m11:38:44.988154 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: Close
[0m11:38:44.989048 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "hk_dv_hub_fact_work" does not exist
LINE 20:             hk_dv_hub_fact_work,
                     ^

[0m11:38:44.989799 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_norm_workload: Close
[0m11:38:44.990896 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: Close
[0m11:38:44.999323 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.030 seconds
[0m11:38:45.015859 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m11:38:45.016697 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: BEGIN
[0m11:38:45.020578 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m11:38:45.021335 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m11:38:45.022021 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_journal__dbt_tmp113844962515'
        
      order by ordinal_position

  
[0m11:38:45.032650 [debug] [Thread-3 (]: Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  column "hk_dv_hub_fact_work" does not exist
  LINE 20:             hk_dv_hub_fact_work,
                       ^
[0m11:38:45.033606 [debug] [Thread-4 (]: SQL status: SELECT 33 in 0.011 seconds
[0m11:38:45.044018 [debug] [Thread-2 (]: Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  column "hk_dv_hub_fact_work" does not exist
  LINE 20:             hk_dv_hub_fact_work,
                       ^
[0m11:38:45.046492 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m11:38:45.047132 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e8322540>]}
[0m11:38:45.049129 [debug] [Thread-1 (]: Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  column "hk_dv_hub_fact_work" does not exist
  LINE 20:             hk_dv_hub_fact_work,
                       ^
[0m11:38:45.049689 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:38:45.050113 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81ec858c20>]}
[0m11:38:45.051021 [error] [Thread-3 (]: 3 of 17 ERROR creating sql incremental model public.dv_msat_norm_workload ...... [[31mERROR[0m in 0.22s]
[0m11:38:45.051828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e83200b0>]}
[0m11:38:45.052799 [error] [Thread-2 (]: 2 of 17 ERROR creating sql incremental model public.dv_msat_fact_pikets ........ [[31mERROR[0m in 0.25s]
[0m11:38:45.053805 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_msat_norm_workload
[0m11:38:45.054627 [error] [Thread-1 (]: 1 of 17 ERROR creating sql incremental model public.dv_msat_fact_materials ..... [[31mERROR[0m in 0.28s]
[0m11:38:45.055497 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_msat_fact_pikets
[0m11:38:45.056237 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_sat_fact_tech
[0m11:38:45.057189 [debug] [Thread-4 (]: SQL status: SELECT 33 in 0.005 seconds
[0m11:38:45.058172 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_norm_workload' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  column "hk_dv_hub_fact_work" does not exist
  LINE 20:             hk_dv_hub_fact_work,
                       ^.
[0m11:38:45.059652 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_msat_fact_materials
[0m11:38:45.061006 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_sat_fact_work
[0m11:38:45.069826 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_fact_pikets' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  column "hk_dv_hub_fact_work" does not exist
  LINE 20:             hk_dv_hub_fact_work,
                       ^.
[0m11:38:45.076588 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m11:38:45.079158 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m11:38:45.062324 [info ] [Thread-3 (]: 5 of 17 START sql incremental model public.dv_sat_fact_tech .................... [RUN]
[0m11:38:45.080188 [info ] [Thread-2 (]: 6 of 17 START sql incremental model public.dv_sat_fact_work .................... [RUN]
[0m11:38:45.081044 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_fact_materials' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  column "hk_dv_hub_fact_work" does not exist
  LINE 20:             hk_dv_hub_fact_work,
                       ^.
[0m11:38:45.081789 [info ] [Thread-1 (]: 7 of 17 START sql view model public.stg_1c_journal ............................. [RUN]
[0m11:38:45.082480 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:38:45.083185 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_norm_workload, now model.tsm_dwh.dv_sat_fact_tech)
[0m11:38:45.084180 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_pikets, now model.tsm_dwh.dv_sat_fact_work)
[0m11:38:45.085052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_materials, now model.tsm_dwh.stg_1c_journal)
[0m11:38:45.086237 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_sat_fact_tech
[0m11:38:45.087859 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_sat_fact_work
[0m11:38:45.088996 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m11:38:45.098846 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_work"
[0m11:38:45.099410 [debug] [Thread-4 (]: SQL status: SELECT 33 in 0.013 seconds
[0m11:38:45.094615 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_tech"
[0m11:38:45.106498 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m11:38:45.118632 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_journal"
[0m11:38:45.119622 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_sat_fact_work
[0m11:38:45.121498 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_sat_fact_tech
[0m11:38:45.123162 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m11:38:45.129681 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m11:38:45.132028 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m11:38:45.137287 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m11:38:45.143321 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      insert into "postgres"."public"."dv_sat_fact_journal" ("hk_dv_hub_fact_journal", "recsource", "loadts", "hdiff_dv_sat_fact_journal", "rabbit_uuid", "rabbit_дата", "проведен", "uuid_жуфвр", "пометка_удаления", "дата", "номер", "территория_value", "территория_codе", "территория_name", "подразделение_value", "подразделение_codе", "подразделение_name", "смена_value", "смена_codе", "смена_name", "прораб_value", "прораб_codе", "прораб_name", "комментарий", "ответственный_value", "ответственный_codе", "ответственный_name", "версия_жуфвр_value", "версия_жуфвр_codе", "версия_жуфвр_name", "направление_деятельности_value", "направление_деятельности_codе", "направление_деятельности_name")
    (
        select "hk_dv_hub_fact_journal", "recsource", "loadts", "hdiff_dv_sat_fact_journal", "rabbit_uuid", "rabbit_дата", "проведен", "uuid_жуфвр", "пометка_удаления", "дата", "номер", "территория_value", "территория_codе", "территория_name", "подразделение_value", "подразделение_codе", "подразделение_name", "смена_value", "смена_codе", "смена_name", "прораб_value", "прораб_codе", "прораб_name", "комментарий", "ответственный_value", "ответственный_codе", "ответственный_name", "версия_жуфвр_value", "версия_жуфвр_codе", "версия_жуфвр_name", "направление_деятельности_value", "направление_деятельности_codе", "направление_деятельности_name"
        from "dv_sat_fact_journal__dbt_tmp113844962515"
    )


  
[0m11:38:45.149270 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

    
  
    

  create temporary table "dv_sat_fact_work__dbt_tmp113845127705"
  
  
    as
  
  (
    



    WITH active_sat AS (
    SELECT DISTINCT ON (hk_dv_hub_fact_work) hk_dv_hub_fact_work, hdiff_dv_sat_fact_work, loadts
    FROM dv_sat_fact_work
    ORDER BY hk_dv_hub_fact_work, loadts DESC)

    , max_load AS (
    SELECT max(loadts) AS max_loadts
    FROM dv_sat_fact_work
    )
    , stage_cte AS (

        SELECT
        s.hk_dv_hub_fact_work,
        s.hdiff_dv_sat_fact_work,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_work) over(PARTITION BY s.hk_dv_hub_fact_work ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_work AS sat_hdiff,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_work,
            s.hdiff_dv_sat_fact_work,
            s.loadts,
            s.recsource,
            идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
        FROM stg_1c_works s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts
        ) s
    LEFT JOIN active_sat a ON a.hk_dv_hub_fact_work = s.hk_dv_hub_fact_work)

    SELECT DISTINCT
        hk_dv_hub_fact_work,
        recsource,
        loadts,
        hdiff_dv_sat_fact_work,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_work <> lag_hdiff 
            OR (hdiff_dv_sat_fact_work <> sat_hdiff AND lag_hdiff IS NULL) 
            OR sat_hdiff IS NULL
    ORDER BY loadts


  );
  
  
[0m11:38:45.164798 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

    
  
    

  create temporary table "dv_sat_fact_tech__dbt_tmp113845134781"
  
  
    as
  
  (
    



    WITH active_sat AS (
    SELECT DISTINCT ON (hk_dv_lnk_fact_work_tech) hk_dv_lnk_fact_work_tech, hdiff_dv_sat_fact_tech, loadts
    FROM dv_sat_fact_tech
    ORDER BY hk_dv_lnk_fact_work_tech, loadts DESC)

    , max_load AS (
    SELECT max(loadts) AS max_loadts
    FROM dv_sat_fact_tech
    )
    , stage_cte AS (

        SELECT
        s.hk_dv_lnk_fact_work_tech,
        s.hdiff_dv_sat_fact_tech,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_tech) over(PARTITION BY s.hk_dv_lnk_fact_work_tech ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_tech AS sat_hdiff,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name

    FROM
        (SELECT
            s.hk_dv_lnk_fact_work_tech,
            s.hdiff_dv_sat_fact_tech,
            s.loadts,
            s.recsource,
            примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
        FROM stg_1c_tech s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts
        ) s
    LEFT JOIN active_sat a ON a.hk_dv_lnk_fact_work_tech = s.hk_dv_lnk_fact_work_tech)

    SELECT DISTINCT
        hk_dv_lnk_fact_work_tech,
        recsource,
        loadts,
        hdiff_dv_sat_fact_tech,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_tech <> lag_hdiff 
            OR (hdiff_dv_sat_fact_tech <> sat_hdiff AND lag_hdiff IS NULL) 
            OR sat_hdiff IS NULL
    ORDER BY loadts


  );
  
  
[0m11:38:45.164081 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m11:38:45.165914 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:38:45.166651 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m11:38:45.167216 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:38:45.186670 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m11:38:45.187327 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.021 seconds
[0m11:38:45.187819 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m11:38:45.194137 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m11:38:45.199016 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m11:38:45.199662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:45.200236 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m11:38:45.200792 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_work: BEGIN
[0m11:38:45.201561 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m11:38:45.202512 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.035 seconds
[0m11:38:45.208535 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m11:38:45.209665 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m11:38:45.210265 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_tech: BEGIN
[0m11:38:45.211043 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m11:38:45.212184 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m11:38:45.212978 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m11:38:45.213647 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_work__dbt_tmp113845127705'
        
      order by ordinal_position

  
[0m11:38:45.214266 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m11:38:45.214949 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m11:38:45.215536 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m11:38:45.216705 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m11:38:45.219535 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: Close
[0m11:38:45.220467 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_tech__dbt_tmp113845134781'
        
      order by ordinal_position

  
[0m11:38:45.222188 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81ee2e7800>]}
[0m11:38:45.223604 [info ] [Thread-4 (]: 4 of 17 OK created sql incremental model public.dv_sat_fact_journal ............ [[32mINSERT 0 0[0m in 0.39s]
[0m11:38:45.224857 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_sat_fact_journal
[0m11:38:45.225565 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.009 seconds
[0m11:38:45.226121 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_materials
[0m11:38:45.232058 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m11:38:45.233222 [info ] [Thread-4 (]: 8 of 17 START sql view model public.stg_1c_materials ........................... [RUN]
[0m11:38:45.231042 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m11:38:45.234518 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.013 seconds
[0m11:38:45.241175 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_journal, now model.tsm_dwh.stg_1c_materials)
[0m11:38:45.248350 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:38:45.249262 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m11:38:45.253492 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m11:38:45.254236 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_materials
[0m11:38:45.255061 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m11:38:45.255772 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:38:45.261098 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_materials"
[0m11:38:45.262029 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.007 seconds
[0m11:38:45.262696 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:38:45.267371 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m11:38:45.268366 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.005 seconds
[0m11:38:45.274290 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m11:38:45.275393 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:38:45.276412 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_materials
[0m11:38:45.281447 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m11:38:45.282417 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m11:38:45.296959 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_materials"
[0m11:38:45.298169 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.015 seconds
[0m11:38:45.298751 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:38:45.302022 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_work"
[0m11:38:45.302937 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:38:45.310352 [debug] [Thread-3 (]: SQL status: SELECT 16 in 0.006 seconds
[0m11:38:45.311340 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m11:38:45.314601 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m11:38:45.318391 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_tech"
[0m11:38:45.319078 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_materials: BEGIN
[0m11:38:45.319885 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m11:38:45.321213 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m11:38:45.322762 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:38:45.323625 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      insert into "postgres"."public"."dv_sat_fact_work" ("hk_dv_hub_fact_work", "recsource", "loadts", "hdiff_dv_sat_fact_work", "идентификатор", "объем_работы", "примечание", "кв", "пометка_удаления", "тип_spider", "структура_работ_value", "структура_работ_codе", "структура_работ_name", "видработ_value", "видработ_codе", "видработ_name")
    (
        select "hk_dv_hub_fact_work", "recsource", "loadts", "hdiff_dv_sat_fact_work", "идентификатор", "объем_работы", "примечание", "кв", "пометка_удаления", "тип_spider", "структура_работ_value", "структура_работ_codе", "структура_работ_name", "видработ_value", "видработ_codе", "видработ_name"
        from "dv_sat_fact_work__dbt_tmp113845127705"
    )


  
[0m11:38:45.324600 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m11:38:45.325831 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m11:38:45.327207 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      insert into "postgres"."public"."dv_sat_fact_tech" ("hk_dv_lnk_fact_work_tech", "recsource", "loadts", "hdiff_dv_sat_fact_tech", "примечание", "госномер_техника_не_найдена", "количество", "часы", "ресурс_value", "ресурс_codе", "ресурс_name", "аналитика_codе", "аналитика_name", "контрагент_value", "контрагент_codе", "контрагент_name")
    (
        select "hk_dv_lnk_fact_work_tech", "recsource", "loadts", "hdiff_dv_sat_fact_tech", "примечание", "госномер_техника_не_найдена", "количество", "часы", "ресурс_value", "ресурс_codе", "ресурс_name", "аналитика_codе", "аналитика_name", "контрагент_value", "контрагент_codе", "контрагент_name"
        from "dv_sat_fact_tech__dbt_tmp113845134781"
    )


  
[0m11:38:45.328830 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m11:38:45.334481 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m11:38:45.336010 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m11:38:45.337382 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m11:38:45.338128 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m11:38:45.339235 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.009 seconds
[0m11:38:45.339915 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m11:38:45.340567 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m11:38:45.342854 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m11:38:45.343851 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */

  create view "postgres"."public"."stg_1c_materials__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(НомерСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемМатериала::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_materials,
	НомерСтроки::int,
	Примечание::varchar,
	ОбъемМатериала::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar
    FROM 
        src_materials
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name)
  );
[0m11:38:45.351977 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m11:38:45.352659 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m11:38:45.359133 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m11:38:45.362938 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m11:38:45.363616 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m11:38:45.369639 [debug] [Thread-2 (]: SQL status: COMMIT in 0.028 seconds
[0m11:38:45.372721 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m11:38:45.373406 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m11:38:45.376516 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_work: Close
[0m11:38:45.377230 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials" rename to "stg_1c_materials__dbt_backup"
[0m11:38:45.378193 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e829faa0>]}
[0m11:38:45.379142 [info ] [Thread-2 (]: 6 of 17 OK created sql incremental model public.dv_sat_fact_work ............... [[32mINSERT 0 0[0m in 0.29s]
[0m11:38:45.379907 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:38:45.380720 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_sat_fact_work
[0m11:38:45.384652 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m11:38:45.385705 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_norm_workload
[0m11:38:45.386690 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials__dbt_tmp" rename to "stg_1c_materials"
[0m11:38:45.387776 [info ] [Thread-2 (]: 9 of 17 START sql view model public.stg_1c_norm_workload ....................... [RUN]
[0m11:38:45.389142 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_work, now model.tsm_dwh.stg_1c_norm_workload)
[0m11:38:45.390456 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_norm_workload
[0m11:38:45.391659 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:38:45.397093 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_norm_workload"
[0m11:38:45.398073 [debug] [Thread-3 (]: SQL status: COMMIT in 0.024 seconds
[0m11:38:45.400801 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m11:38:45.402276 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_tech: Close
[0m11:38:45.403049 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m11:38:45.403773 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m11:38:45.404295 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_norm_workload
[0m11:38:45.405067 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e8254bc0>]}
[0m11:38:45.413812 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_norm_workload"
[0m11:38:45.414639 [info ] [Thread-3 (]: 5 of 17 OK created sql incremental model public.dv_sat_fact_tech ............... [[32mINSERT 0 0[0m in 0.32s]
[0m11:38:45.415798 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_sat_fact_tech
[0m11:38:45.416597 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_pikets
[0m11:38:45.417571 [info ] [Thread-3 (]: 10 of 17 START sql view model public.stg_1c_pikets ............................. [RUN]
[0m11:38:45.418392 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m11:38:45.419484 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_tech, now model.tsm_dwh.stg_1c_pikets)
[0m11:38:45.420564 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.043 seconds
[0m11:38:45.421284 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_norm_workload: BEGIN
[0m11:38:45.422498 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_pikets
[0m11:38:45.425451 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m11:38:45.426891 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:38:45.431429 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_pikets"
[0m11:38:45.432658 [debug] [Thread-4 (]: SQL status: COMMIT in 0.027 seconds
[0m11:38:45.434191 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_pikets
[0m11:38:45.436085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e8cab590>]}
[0m11:38:45.440065 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."stg_1c_materials__dbt_backup"
[0m11:38:45.445428 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_pikets"
[0m11:38:45.446949 [info ] [Thread-1 (]: 7 of 17 OK created sql view model public.stg_1c_journal ........................ [[32mCREATE VIEW[0m in 0.35s]
[0m11:38:45.448164 [debug] [Thread-2 (]: SQL status: BEGIN in 0.022 seconds
[0m11:38:45.450493 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m11:38:45.451825 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m11:38:45.452637 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m11:38:45.453621 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
drop view if exists "postgres"."public"."stg_1c_materials__dbt_backup" cascade
[0m11:38:45.454792 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m11:38:45.456048 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m11:38:45.457175 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */

  create view "postgres"."public"."stg_1c_norm_workload__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(Период::varchar, 'N\A')) || '|' || TRIM(COALESCE(РассчетныйОбъем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьНормативная::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьФактическая::varchar, 'N\A')) || '|' || TRIM(COALESCE(НаемныйРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(НесколькоКлючевыхРесурсов::varchar, 'N\A')) || '|' || TRIM(COALESCE(ЖУФВР::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючДокументаРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_norm_workload,
	Период::timestamptz,
	РассчетныйОбъем::numeric,
	ТрудоемкостьНормативная::numeric,
	ТрудоемкостьФактическая::numeric,
	НаемныйРесурс::bool,
	КлючевойРесурс_value::uuid,
	КлючевойРесурс_codе::varchar,
	КлючевойРесурс_name::varchar,
	НесколькоКлючевыхРесурсов::bool,
	ЖУФВР::uuid,
	КлючДокументаРесурс::uuid,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	РесурсSpider_value::uuid,
	РесурсSpider_codе::varchar,
	РесурсSpider_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar
    FROM 
        src_norm_workload
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name)
  );
[0m11:38:45.458879 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_pikets: BEGIN
[0m11:38:45.460301 [info ] [Thread-1 (]: 11 of 17 START sql view model public.stg_1c_tech ............................... [RUN]
[0m11:38:45.461955 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:38:45.463159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_journal, now model.tsm_dwh.stg_1c_tech)
[0m11:38:45.464726 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m11:38:45.469533 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m11:38:45.470565 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m11:38:45.476902 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.018 seconds
[0m11:38:45.479315 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m11:38:45.480157 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m11:38:45.482085 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_materials: Close
[0m11:38:45.482676 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m11:38:45.483217 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload" rename to "stg_1c_norm_workload__dbt_backup"
[0m11:38:45.489349 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m11:38:45.491384 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e8241580>]}
[0m11:38:45.492812 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:38:45.487954 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m11:38:45.493720 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */

  create view "postgres"."public"."stg_1c_pikets__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(КлючСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетС::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеС::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(Объем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_pikets,
	КлючСтроки::uuid,
	ПикетС::numeric,
	ПикетПо::numeric,
	СмещениеС::numeric,
	СмещениеПо::numeric,
	Объем::numeric,
	ВидПикета_value::uuid,
	ВидПикета_codе::varchar,
	ВидПикета_name::varchar,
	ТипПикета_value::uuid,
	ТипПикета_codе::varchar,
	ТипПикета_name::varchar,
	ГруппаПикетовSpider_value::uuid,
	ГруппаПикетовSpider_codе::varchar,
	ГруппаПикетовSpider_name::varchar
    FROM 
        src_pikets
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name)
  );
[0m11:38:45.494934 [info ] [Thread-4 (]: 8 of 17 OK created sql view model public.stg_1c_materials ...................... [[32mCREATE VIEW[0m in 0.25s]
[0m11:38:45.499059 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m11:38:45.500291 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_materials
[0m11:38:45.501235 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m11:38:45.502324 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload__dbt_tmp" rename to "stg_1c_norm_workload"
[0m11:38:45.503265 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_works
[0m11:38:45.504301 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m11:38:45.505468 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m11:38:45.506975 [info ] [Thread-4 (]: 12 of 17 START sql view model public.stg_1c_works .............................. [RUN]
[0m11:38:45.508472 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:38:45.514964 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m11:38:45.515606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:45.517955 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_materials, now model.tsm_dwh.stg_1c_works)
[0m11:38:45.520434 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m11:38:45.521187 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets" rename to "stg_1c_pikets__dbt_backup"
[0m11:38:45.522798 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m11:38:45.524057 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m11:38:45.585525 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.060 seconds
[0m11:38:45.587339 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m11:38:45.588070 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m11:38:45.592193 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m11:38:45.592745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.077 seconds
[0m11:38:45.593688 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets__dbt_tmp" rename to "stg_1c_pikets"
[0m11:38:45.594422 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m11:38:45.594946 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m11:38:45.595840 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m11:38:45.596797 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:38:45.601613 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m11:38:45.604130 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m11:38:45.604769 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m11:38:45.605596 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:38:45.606173 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m11:38:45.609016 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_norm_workload__dbt_backup"
[0m11:38:45.612786 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m11:38:45.613504 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m11:38:45.614168 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m11:38:45.615312 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m11:38:45.615918 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech" rename to "stg_1c_tech__dbt_backup"
[0m11:38:45.616646 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m11:38:45.617206 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
drop view if exists "postgres"."public"."stg_1c_norm_workload__dbt_backup" cascade
[0m11:38:45.617933 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:38:45.618855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:38:45.624868 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m11:38:45.625714 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech__dbt_tmp" rename to "stg_1c_tech"
[0m11:38:45.626976 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:38:45.630316 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m11:38:45.631099 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m11:38:45.631996 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m11:38:45.632907 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m11:38:45.633585 [debug] [Thread-3 (]: SQL status: COMMIT in 0.017 seconds
[0m11:38:45.634132 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m11:38:45.637050 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_pikets__dbt_backup"
[0m11:38:45.637933 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m11:38:45.639495 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m11:38:45.640323 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
drop view if exists "postgres"."public"."stg_1c_pikets__dbt_backup" cascade
[0m11:38:45.645827 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m11:38:45.652305 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m11:38:45.653415 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works" rename to "stg_1c_works__dbt_backup"
[0m11:38:45.655046 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:38:45.658837 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m11:38:45.659346 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works__dbt_tmp" rename to "stg_1c_works"
[0m11:38:45.660467 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:38:45.663307 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m11:38:45.663994 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.045 seconds
[0m11:38:45.664573 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m11:38:45.666272 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_norm_workload: Close
[0m11:38:45.666928 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m11:38:45.667883 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e82bb6e0>]}
[0m11:38:45.668794 [info ] [Thread-2 (]: 9 of 17 OK created sql view model public.stg_1c_norm_workload .................. [[32mCREATE VIEW[0m in 0.28s]
[0m11:38:45.669806 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_norm_workload
[0m11:38:45.670702 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m11:38:45.671586 [info ] [Thread-2 (]: 13 of 17 START sql incremental model public.dv_hub_fact_journal ................ [RUN]
[0m11:38:45.672462 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_norm_workload, now model.tsm_dwh.dv_hub_fact_journal)
[0m11:38:45.673050 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m11:38:45.679134 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m11:38:45.680348 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m11:38:45.681352 [debug] [Thread-1 (]: SQL status: COMMIT in 0.048 seconds
[0m11:38:45.688325 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.047 seconds
[0m11:38:45.704267 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m11:38:45.713162 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

    
  
    

  create temporary table "dv_hub_fact_journal__dbt_tmp113845687070"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_journal" target
    where 
        target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_journal 
)

  );
  
  
[0m11:38:45.712046 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_pikets: Close
[0m11:38:45.707165 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_tech__dbt_backup"
[0m11:38:45.716742 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m11:38:45.709165 [debug] [Thread-4 (]: SQL status: COMMIT in 0.041 seconds
[0m11:38:45.719036 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e8cc2a20>]}
[0m11:38:45.728285 [info ] [Thread-3 (]: 10 of 17 OK created sql view model public.stg_1c_pikets ........................ [[32mCREATE VIEW[0m in 0.30s]
[0m11:38:45.729802 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_pikets
[0m11:38:45.714232 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:38:45.717921 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
drop view if exists "postgres"."public"."stg_1c_tech__dbt_backup" cascade
[0m11:38:45.736335 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."stg_1c_works__dbt_backup"
[0m11:38:45.738518 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m11:38:45.742772 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
drop view if exists "postgres"."public"."stg_1c_works__dbt_backup" cascade
[0m11:38:45.751037 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.015 seconds
[0m11:38:45.756529 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m11:38:45.757928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e8dcaff0>]}
[0m11:38:45.758993 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.045 seconds
[0m11:38:45.767600 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m11:38:45.760411 [info ] [Thread-1 (]: 11 of 17 OK created sql view model public.stg_1c_tech .......................... [[32mCREATE VIEW[0m in 0.29s]
[0m11:38:45.768958 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.025 seconds
[0m11:38:45.769979 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: BEGIN
[0m11:38:45.771395 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m11:38:45.775921 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m11:38:45.777152 [info ] [Thread-3 (]: 14 of 17 START sql incremental model public.dv_hub_tech ........................ [RUN]
[0m11:38:45.774380 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: Close
[0m11:38:45.782065 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81ebd7e630>]}
[0m11:38:45.779448 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m11:38:45.780462 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m11:38:45.785699 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m11:38:45.786774 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal__dbt_tmp113845687070'
        
      order by ordinal_position

  
[0m11:38:45.783677 [info ] [Thread-4 (]: 12 of 17 OK created sql view model public.stg_1c_works ......................... [[32mCREATE VIEW[0m in 0.27s]
[0m11:38:45.778366 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_pikets, now model.tsm_dwh.dv_hub_tech)
[0m11:38:45.790234 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m11:38:45.784806 [info ] [Thread-1 (]: 15 of 17 START sql incremental model public.dv_lnk_fact_work_tech .............. [RUN]
[0m11:38:45.800571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_lnk_fact_work_tech)
[0m11:38:45.788961 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m11:38:45.803323 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m11:38:45.806287 [info ] [Thread-4 (]: 16 of 17 START sql incremental model public.dv_hub_fact_work ................... [RUN]
[0m11:38:45.801682 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_work_tech
[0m11:38:45.808891 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.020 seconds
[0m11:38:45.807881 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_works, now model.tsm_dwh.dv_hub_fact_work)
[0m11:38:45.822725 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m11:38:45.826777 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m11:38:45.835293 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m11:38:45.836962 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m11:38:45.844936 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:38:45.844324 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m11:38:45.838618 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m11:38:45.855070 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_lnk_fact_work_tech
[0m11:38:45.866816 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m11:38:45.867954 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

    
  
    

  create temporary table "dv_hub_tech__dbt_tmp113845851359"
  
  
    as
  
  (
    

SELECT distinct on (bk_ресурс_uuid)
        hk_dv_hub_tech,
        hkcode,
        recsource,
        loadts,
        bk_ресурс_uuid
FROM "postgres"."public"."stg_1c_tech" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_tech" target
    where 
        target.hk_dv_hub_tech = stg.hk_dv_hub_tech 
)

  );
  
  
[0m11:38:45.874715 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m11:38:45.875475 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.030 seconds
[0m11:38:45.876133 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:38:45.876704 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m11:38:45.877245 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

    
  
    

  create temporary table "dv_lnk_fact_work_tech__dbt_tmp113845870499"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_work,
	hk_dv_hub_tech)
        hk_dv_lnk_fact_work_tech,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_work,
	hk_dv_hub_tech
FROM "postgres"."public"."stg_1c_tech" stg


where not exists (
    select 1
    from "postgres"."public"."dv_lnk_fact_work_tech" target
    where 
        target.hk_dv_lnk_fact_work_tech = stg.hk_dv_lnk_fact_work_tech 
)

  );
  
  
[0m11:38:45.881123 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m11:38:45.891392 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m11:38:45.892063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:45.892865 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:38:45.893873 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

    
  
    

  create temporary table "dv_hub_fact_work__dbt_tmp113845885319"
  
  
    as
  
  (
    

SELECT distinct on (bk_работа_uuid)
        hk_dv_hub_fact_work,
        hkcode,
        recsource,
        loadts,
        bk_работа_uuid
FROM "postgres"."public"."stg_1c_works" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_work" target
    where 
        target.hk_dv_hub_fact_work = stg.hk_dv_hub_fact_work 
)

  );
  
  
[0m11:38:45.894889 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:38:45.898657 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.004 seconds
[0m11:38:45.902334 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_journal"
[0m11:38:45.903297 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.027 seconds
[0m11:38:45.908381 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m11:38:45.909266 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: BEGIN
[0m11:38:45.910508 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m11:38:45.911569 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m11:38:45.912510 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      insert into "postgres"."public"."dv_hub_fact_journal" ("hk_dv_hub_fact_journal", "hkcode", "recsource", "loadts", "bk_жуфвр_uuid")
    (
        select "hk_dv_hub_fact_journal", "hkcode", "recsource", "loadts", "bk_жуфвр_uuid"
        from "dv_hub_fact_journal__dbt_tmp113845687070"
    )


  
[0m11:38:45.913760 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m11:38:45.914732 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.020 seconds
[0m11:38:45.915739 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech__dbt_tmp113845851359'
        
      order by ordinal_position

  
[0m11:38:45.917119 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m11:38:45.920744 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m11:38:45.921487 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.029 seconds
[0m11:38:45.923628 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m11:38:45.924225 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_work: BEGIN
[0m11:38:45.930178 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m11:38:45.931039 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.009 seconds
[0m11:38:45.931729 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m11:38:45.932758 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m11:38:45.936810 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m11:38:45.937461 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m11:38:45.938067 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: BEGIN
[0m11:38:45.938803 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:38:45.939723 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m11:38:45.940642 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work__dbt_tmp113845885319'
        
      order by ordinal_position

  
[0m11:38:45.941335 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m11:38:45.942489 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m11:38:45.943100 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech__dbt_tmp113845870499'
        
      order by ordinal_position

  
[0m11:38:45.944308 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.004 seconds
[0m11:38:45.951492 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m11:38:45.952596 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m11:38:45.953217 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:38:45.953805 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.011 seconds
[0m11:38:45.954365 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.011 seconds
[0m11:38:45.955357 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m11:38:45.959340 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m11:38:45.960057 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.004 seconds
[0m11:38:45.963597 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m11:38:45.964393 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:38:45.965728 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e83f2300>]}
[0m11:38:45.969045 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_tech"
[0m11:38:45.969691 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:38:45.970700 [info ] [Thread-2 (]: 13 of 17 OK created sql incremental model public.dv_hub_fact_journal ........... [[32mINSERT 0 0[0m in 0.29s]
[0m11:38:45.972141 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m11:38:45.972799 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m11:38:45.973648 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m11:38:45.974968 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      insert into "postgres"."public"."dv_hub_tech" ("hk_dv_hub_tech", "hkcode", "recsource", "loadts", "bk_ресурс_uuid")
    (
        select "hk_dv_hub_tech", "hkcode", "recsource", "loadts", "bk_ресурс_uuid"
        from "dv_hub_tech__dbt_tmp113845851359"
    )


  
[0m11:38:45.974338 [info ] [Thread-2 (]: 17 of 17 START sql incremental model public.dv_lnk_fact_journal_fact_work ...... [RUN]
[0m11:38:45.975865 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.006 seconds
[0m11:38:45.976631 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m11:38:45.977932 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_fact_journal, now model.tsm_dwh.dv_lnk_fact_journal_fact_work)
[0m11:38:45.979031 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m11:38:45.990499 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m11:38:45.991700 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m11:38:45.989632 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m11:38:45.994425 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m11:38:45.995296 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:38:45.999995 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m11:38:46.000669 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:38:46.001399 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m11:38:46.002559 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m11:38:46.003234 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m11:38:46.009674 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.008 seconds
[0m11:38:46.010211 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.008 seconds
[0m11:38:46.011036 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m11:38:46.015975 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_work"
[0m11:38:46.018361 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m11:38:46.019571 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

    
  
    

  create temporary table "dv_lnk_fact_journal_fact_work__dbt_tmp113846006950"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work)
        hk_dv_lnk_fact_journal_fact_work,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work
FROM "postgres"."public"."stg_1c_works" stg


where not exists (
    select 1
    from "postgres"."public"."dv_lnk_fact_journal_fact_work" target
    where 
        target.hk_dv_lnk_fact_journal_fact_work = stg.hk_dv_lnk_fact_journal_fact_work 
)

  );
  
  
[0m11:38:46.020699 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:38:46.021711 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m11:38:46.023908 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: Close
[0m11:38:46.025838 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e831ac30>]}
[0m11:38:46.028006 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m11:38:46.027167 [info ] [Thread-3 (]: 14 of 17 OK created sql incremental model public.dv_hub_tech ................... [[32mINSERT 0 0[0m in 0.25s]
[0m11:38:46.029272 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      insert into "postgres"."public"."dv_lnk_fact_work_tech" ("hk_dv_lnk_fact_work_tech", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_work", "hk_dv_hub_tech")
    (
        select "hk_dv_lnk_fact_work_tech", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_work", "hk_dv_hub_tech"
        from "dv_lnk_fact_work_tech__dbt_tmp113845870499"
    )


  
[0m11:38:46.030286 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m11:38:46.031761 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m11:38:46.032994 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      insert into "postgres"."public"."dv_hub_fact_work" ("hk_dv_hub_fact_work", "hkcode", "recsource", "loadts", "bk_работа_uuid")
    (
        select "hk_dv_hub_fact_work", "hkcode", "recsource", "loadts", "bk_работа_uuid"
        from "dv_hub_fact_work__dbt_tmp113845885319"
    )


  
[0m11:38:46.034209 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m11:38:46.039795 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m11:38:46.041315 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.021 seconds
[0m11:38:46.042866 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m11:38:46.044318 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.009 seconds
[0m11:38:46.049695 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m11:38:46.050359 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m11:38:46.052803 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m11:38:46.053890 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: BEGIN
[0m11:38:46.055087 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m11:38:46.056419 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m11:38:46.057584 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m11:38:46.058695 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m11:38:46.059779 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work__dbt_tmp113846006950'
        
      order by ordinal_position

  
[0m11:38:46.070407 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.010 seconds
[0m11:38:46.076530 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m11:38:46.078210 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:38:46.082983 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.004 seconds
[0m11:38:46.087129 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m11:38:46.087887 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m11:38:46.090943 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.002 seconds
[0m11:38:46.093513 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m11:38:46.094350 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m11:38:46.094897 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      insert into "postgres"."public"."dv_lnk_fact_journal_fact_work" ("hk_dv_lnk_fact_journal_fact_work", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_journal", "hk_dv_hub_fact_work")
    (
        select "hk_dv_lnk_fact_journal_fact_work", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_journal", "hk_dv_hub_fact_work"
        from "dv_lnk_fact_journal_fact_work__dbt_tmp113846006950"
    )


  
[0m11:38:46.095797 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m11:38:46.098067 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m11:38:46.098738 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m11:38:46.099441 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m11:38:46.137148 [debug] [Thread-4 (]: SQL status: COMMIT in 0.079 seconds
[0m11:38:46.137964 [debug] [Thread-1 (]: SQL status: COMMIT in 0.083 seconds
[0m11:38:46.138975 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_work: Close
[0m11:38:46.139946 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: Close
[0m11:38:46.140814 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e8312570>]}
[0m11:38:46.141599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e83c3d70>]}
[0m11:38:46.142357 [info ] [Thread-4 (]: 16 of 17 OK created sql incremental model public.dv_hub_fact_work .............. [[32mINSERT 0 0[0m in 0.33s]
[0m11:38:46.143595 [info ] [Thread-1 (]: 15 of 17 OK created sql incremental model public.dv_lnk_fact_work_tech ......... [[32mINSERT 0 0[0m in 0.34s]
[0m11:38:46.144790 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m11:38:46.145705 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m11:38:46.146701 [debug] [Thread-2 (]: SQL status: COMMIT in 0.047 seconds
[0m11:38:46.148382 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: Close
[0m11:38:46.149733 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd83e913-d743-450e-a52b-4af715eeff10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81e829d760>]}
[0m11:38:46.151121 [info ] [Thread-2 (]: 17 of 17 OK created sql incremental model public.dv_lnk_fact_journal_fact_work . [[32mINSERT 0 0[0m in 0.17s]
[0m11:38:46.152354 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m11:38:46.155023 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:46.156042 [debug] [MainThread]: On master: BEGIN
[0m11:38:46.156983 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:46.168516 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:38:46.169608 [debug] [MainThread]: On master: COMMIT
[0m11:38:46.170495 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:46.171310 [debug] [MainThread]: On master: COMMIT
[0m11:38:46.172687 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:38:46.173393 [debug] [MainThread]: On master: Close
[0m11:38:46.174523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:46.175087 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_work_tech' was properly closed.
[0m11:38:46.175772 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work' was properly closed.
[0m11:38:46.176212 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_tech' was properly closed.
[0m11:38:46.176859 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_work' was properly closed.
[0m11:38:46.178019 [info ] [MainThread]: 
[0m11:38:46.178625 [info ] [MainThread]: Finished running 11 incremental models, 6 view models in 0 hours 0 minutes and 1.70 seconds (1.70s).
[0m11:38:46.182287 [debug] [MainThread]: Command end result
[0m11:38:46.226953 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m11:38:46.229450 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m11:38:46.238150 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m11:38:46.238733 [info ] [MainThread]: 
[0m11:38:46.239437 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m11:38:46.240157 [info ] [MainThread]: 
[0m11:38:46.240988 [error] [MainThread]:   Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  column "hk_dv_hub_fact_work" does not exist
  LINE 20:             hk_dv_hub_fact_work,
                       ^
[0m11:38:46.241689 [info ] [MainThread]: 
[0m11:38:46.242639 [error] [MainThread]:   Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  column "hk_dv_hub_fact_work" does not exist
  LINE 20:             hk_dv_hub_fact_work,
                       ^
[0m11:38:46.243237 [info ] [MainThread]: 
[0m11:38:46.244010 [error] [MainThread]:   Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  column "hk_dv_hub_fact_work" does not exist
  LINE 20:             hk_dv_hub_fact_work,
                       ^
[0m11:38:46.244836 [info ] [MainThread]: 
[0m11:38:46.245595 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=3 SKIP=0 TOTAL=17
[0m11:38:46.247317 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.5403192, "process_in_blocks": "26152", "process_kernel_time": 0.351049, "process_mem_max_rss": "122340", "process_out_blocks": "3728", "process_user_time": 3.782802}
[0m11:38:46.247993 [debug] [MainThread]: Command `dbt build` failed at 11:38:46.247854 after 2.54 seconds
[0m11:38:46.248571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81ed6c7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81ec9fe870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81ec9ff950>]}
[0m11:38:46.249090 [debug] [MainThread]: Flushing usage events
[0m11:38:47.285999 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:44:49.683351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f1d11f0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f1f18ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f1d7f1850>]}


============================== 11:44:49.687163 | 781572ae-8176-41a9-b95e-09bf1b4af9b7 ==============================
[0m11:44:49.687163 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:44:49.688298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m11:44:49.878718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '781572ae-8176-41a9-b95e-09bf1b4af9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f1d704590>]}
[0m11:44:49.948165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '781572ae-8176-41a9-b95e-09bf1b4af9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f1cadb050>]}
[0m11:45:10.551372 [error] [MainThread]: Encountered an error:

[0m11:45:10.557585 [error] [MainThread]: Traceback (most recent call last):
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib64/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib64/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:45:10.560372 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 20.939552, "process_in_blocks": "5736", "process_kernel_time": 0.215762, "process_mem_max_rss": "102208", "process_out_blocks": "3368", "process_user_time": 1.769269}
[0m11:45:10.562061 [debug] [MainThread]: Command `dbt docs serve` failed at 11:45:10.561764 after 20.94 seconds
[0m11:45:10.563641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f1d7f1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f1ca43c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f1c5257f0>]}
[0m11:45:10.565734 [debug] [MainThread]: Flushing usage events
[0m11:45:11.595254 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:45:17.983700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44088cb410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440800bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4407f6cd70>]}


============================== 11:45:17.988678 | ffc2af68-117d-4009-ab7c-44be7c5dd178 ==============================
[0m11:45:17.988678 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:45:17.989695 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:45:18.186564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffc2af68-117d-4009-ab7c-44be7c5dd178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440a0baa80>]}
[0m11:45:18.254940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffc2af68-117d-4009-ab7c-44be7c5dd178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4407e24890>]}
[0m11:45:18.256007 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:45:18.391377 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:45:18.500114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m11:45:18.500879 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_msat_fact_materials.sql
[0m11:45:18.501559 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_sat_fact_journal.sql
[0m11:45:18.502093 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_sat_fact_tech.sql
[0m11:45:18.502646 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_msat_fact_pikets.sql
[0m11:45:18.503193 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_sat_fact_work.sql
[0m11:45:18.503745 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_msat_norm_workload.sql
[0m11:45:18.825711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffc2af68-117d-4009-ab7c-44be7c5dd178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4406703380>]}
[0m11:45:18.895378 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m11:45:18.898257 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m11:45:18.922759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffc2af68-117d-4009-ab7c-44be7c5dd178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4406f955e0>]}
[0m11:45:18.923739 [info ] [MainThread]: Found 17 models, 433 macros
[0m11:45:18.924310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffc2af68-117d-4009-ab7c-44be7c5dd178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4405f4d040>]}
[0m11:45:18.926971 [info ] [MainThread]: 
[0m11:45:18.927596 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:45:18.928155 [info ] [MainThread]: 
[0m11:45:18.929081 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:45:18.937406 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m11:45:19.003205 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:45:19.003774 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m11:45:19.004236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:19.023130 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m11:45:19.023967 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:45:19.024493 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:45:19.027900 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.003 seconds
[0m11:45:19.029993 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m11:45:19.030629 [debug] [ThreadPool]: On list_postgres_public: Close
[0m11:45:19.041512 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:19.042085 [debug] [MainThread]: On master: BEGIN
[0m11:45:19.042561 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:45:19.051430 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:45:19.052012 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:19.052666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:45:19.060882 [debug] [MainThread]: SQL status: SELECT 7 in 0.008 seconds
[0m11:45:19.064920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffc2af68-117d-4009-ab7c-44be7c5dd178', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4406f95250>]}
[0m11:45:19.065866 [debug] [MainThread]: On master: ROLLBACK
[0m11:45:19.066579 [debug] [MainThread]: On master: Close
[0m11:45:19.071259 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m11:45:19.072583 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_materials
[0m11:45:19.073378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m11:45:19.074652 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_norm_workload
[0m11:45:19.075739 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_pikets
[0m11:45:19.076774 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_materials'
[0m11:45:19.077520 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m11:45:19.079021 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_norm_workload'
[0m11:45:19.080240 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_pikets'
[0m11:45:19.081145 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_materials
[0m11:45:19.092625 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_norm_workload
[0m11:45:19.097648 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m11:45:19.098336 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_pikets
[0m11:45:19.101645 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_materials"
[0m11:45:19.105344 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_norm_workload"
[0m11:45:19.109259 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_pikets"
[0m11:45:19.110480 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m11:45:19.111821 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_materials
[0m11:45:19.113351 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m11:45:19.114811 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_materials
[0m11:45:19.115340 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_norm_workload
[0m11:45:19.116261 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m11:45:19.116791 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_pikets
[0m11:45:19.117482 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_works
[0m11:45:19.118711 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_norm_workload
[0m11:45:19.119456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_journal, now model.tsm_dwh.stg_1c_tech)
[0m11:45:19.120321 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_pikets
[0m11:45:19.121057 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_materials, now model.tsm_dwh.stg_1c_works)
[0m11:45:19.121764 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m11:45:19.122429 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m11:45:19.123225 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_msat_fact_materials
[0m11:45:19.123813 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m11:45:19.124621 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_norm_workload, now model.tsm_dwh.dv_hub_fact_journal)
[0m11:45:19.128067 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m11:45:19.128705 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_pikets, now model.tsm_dwh.dv_msat_fact_materials)
[0m11:45:19.132400 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m11:45:19.133273 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m11:45:19.134211 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_msat_fact_materials
[0m11:45:19.135325 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m11:45:19.143160 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m11:45:19.149672 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m11:45:19.150145 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m11:45:19.150659 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_materials"
[0m11:45:19.151583 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m11:45:19.152300 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_sat_fact_journal
[0m11:45:19.153284 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m11:45:19.154740 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m11:45:19.155665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_sat_fact_journal)
[0m11:45:19.156195 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_msat_fact_materials
[0m11:45:19.156803 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_msat_norm_workload
[0m11:45:19.157678 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_msat_fact_pikets
[0m11:45:19.158449 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_sat_fact_journal
[0m11:45:19.159380 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_msat_fact_materials
[0m11:45:19.159963 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_works, now model.tsm_dwh.dv_msat_norm_workload)
[0m11:45:19.160638 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_fact_journal, now model.tsm_dwh.dv_msat_fact_pikets)
[0m11:45:19.166598 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_journal"
[0m11:45:19.167223 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m11:45:19.167933 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_msat_norm_workload
[0m11:45:19.168603 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_msat_fact_pikets
[0m11:45:19.169513 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_materials, now model.tsm_dwh.dv_hub_tech)
[0m11:45:19.177339 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_norm_workload"
[0m11:45:19.183397 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m11:45:19.184060 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_sat_fact_journal
[0m11:45:19.184720 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:45:19.189455 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m11:45:19.190984 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_sat_fact_journal
[0m11:45:19.191960 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_msat_norm_workload
[0m11:45:19.193151 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m11:45:19.193994 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m11:45:19.194603 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_msat_fact_pikets
[0m11:45:19.195602 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_msat_norm_workload
[0m11:45:19.196408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_journal, now model.tsm_dwh.dv_lnk_fact_work_tech)
[0m11:45:19.197618 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m11:45:19.198485 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_msat_fact_pikets
[0m11:45:19.199179 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_sat_fact_tech
[0m11:45:19.199824 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_work_tech
[0m11:45:19.200385 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m11:45:19.201098 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m11:45:19.201825 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_norm_workload, now model.tsm_dwh.dv_sat_fact_tech)
[0m11:45:19.206286 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m11:45:19.206976 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_tech, now model.tsm_dwh.dv_hub_fact_work)
[0m11:45:19.207668 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_pikets, now model.tsm_dwh.dv_lnk_fact_journal_fact_work)
[0m11:45:19.208288 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_sat_fact_tech
[0m11:45:19.209011 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m11:45:19.209672 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m11:45:19.215454 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_lnk_fact_work_tech
[0m11:45:19.215201 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_tech"
[0m11:45:19.220297 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m11:45:19.224700 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m11:45:19.225755 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m11:45:19.227006 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_sat_fact_work
[0m11:45:19.227942 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m11:45:19.228495 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_sat_fact_tech
[0m11:45:19.229083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_lnk_fact_work_tech, now model.tsm_dwh.dv_sat_fact_work)
[0m11:45:19.229783 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m11:45:19.230860 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m11:45:19.231841 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_sat_fact_tech
[0m11:45:19.232458 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_sat_fact_work
[0m11:45:19.233486 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m11:45:19.240137 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_work"
[0m11:45:19.241177 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_sat_fact_work
[0m11:45:19.242068 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_sat_fact_work
[0m11:45:19.243600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:19.244460 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_work' was properly closed.
[0m11:45:19.245230 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_tech' was properly closed.
[0m11:45:19.245822 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work' was properly closed.
[0m11:45:19.246244 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_work' was properly closed.
[0m11:45:19.249495 [debug] [MainThread]: Command end result
[0m11:45:19.281806 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m11:45:19.284169 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m11:45:19.294294 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m11:45:19.296136 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.3716835, "process_in_blocks": "45664", "process_kernel_time": 0.328558, "process_mem_max_rss": "119180", "process_out_blocks": "3968", "process_user_time": 2.687581}
[0m11:45:19.296988 [debug] [MainThread]: Command `dbt compile` succeeded at 11:45:19.296856 after 1.37 seconds
[0m11:45:19.297526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440800bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440a21e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440770a9f0>]}
[0m11:45:19.298055 [debug] [MainThread]: Flushing usage events
[0m11:45:20.196849 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:45:25.124791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33b33ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33b08a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33ba16480>]}


============================== 11:45:25.128712 | 169674f4-b03e-4342-9aae-afe18b7c60c6 ==============================
[0m11:45:25.128712 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:45:25.129701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:45:25.312871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '169674f4-b03e-4342-9aae-afe18b7c60c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33bae45c0>]}
[0m11:45:25.379740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '169674f4-b03e-4342-9aae-afe18b7c60c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33d374b90>]}
[0m11:45:25.460325 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m11:45:25.463977 [error] [MainThread]: Traceback (most recent call last):
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib64/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib64/python3.12/socketserver.py", line 478, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m11:45:25.465809 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.39869872, "process_in_blocks": "1384", "process_kernel_time": 0.169423, "process_mem_max_rss": "101872", "process_out_blocks": "3360", "process_user_time": 1.732476}
[0m11:45:25.466718 [debug] [MainThread]: Command `dbt docs serve` failed at 11:45:25.466470 after 0.40 seconds
[0m11:45:25.467736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33efb7cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33a96d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33b6b2a80>]}
[0m11:45:25.468848 [debug] [MainThread]: Flushing usage events
[0m11:45:26.340464 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:01.797643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4846d83560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4844b51940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4844840590>]}


============================== 11:46:01.801356 | fb76a699-7edc-4cda-a00f-ae3aff477ffe ==============================
[0m11:46:01.801356 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:46:01.802256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:46:01.988066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb76a699-7edc-4cda-a00f-ae3aff477ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4845424620>]}
[0m11:46:02.055158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb76a699-7edc-4cda-a00f-ae3aff477ffe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4844764410>]}
[0m11:46:17.967954 [error] [MainThread]: Encountered an error:

[0m11:46:17.975085 [error] [MainThread]: Traceback (most recent call last):
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib64/python3.12/socketserver.py", line 240, in serve_forever
    self._handle_request_noblock()
  File "/usr/lib64/python3.12/socketserver.py", line 318, in _handle_request_noblock
    self.process_request(request, client_address)
  File "/usr/lib64/python3.12/socketserver.py", line 349, in process_request
    self.finish_request(request, client_address)
  File "/usr/lib64/python3.12/socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "/usr/lib64/python3.12/http/server.py", line 672, in __init__
    super().__init__(*args, **kwargs)
  File "/usr/lib64/python3.12/socketserver.py", line 766, in __init__
    self.handle()
  File "/usr/lib64/python3.12/http/server.py", line 436, in handle
    self.handle_one_request()
  File "/usr/lib64/python3.12/http/server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib64/python3.12/socket.py", line 720, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:46:17.976536 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 16.236435, "process_in_blocks": "64", "process_kernel_time": 0.167583, "process_mem_max_rss": "102268", "process_out_blocks": "3360", "process_user_time": 1.776011}
[0m11:46:17.977374 [debug] [MainThread]: Command `dbt docs serve` failed at 11:46:17.977201 after 16.24 seconds
[0m11:46:17.978327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4844fa23c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4844915a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4844914ec0>]}
[0m11:46:17.979345 [debug] [MainThread]: Flushing usage events
[0m11:46:18.872385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:26.814123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7206357710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72046fbd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7203f27380>]}


============================== 11:46:26.818045 | 59f6a6cd-2c96-4838-b80b-e9d053c3ae99 ==============================
[0m11:46:26.818045 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:46:26.819167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:46:27.003681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59f6a6cd-2c96-4838-b80b-e9d053c3ae99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7204a08560>]}
[0m11:46:27.071250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59f6a6cd-2c96-4838-b80b-e9d053c3ae99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f720455bb30>]}
[0m11:46:27.072266 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:46:27.201241 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:46:27.293183 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:46:27.293709 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:46:27.322724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59f6a6cd-2c96-4838-b80b-e9d053c3ae99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72037fb0e0>]}
[0m11:46:27.341995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59f6a6cd-2c96-4838-b80b-e9d053c3ae99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f720331d820>]}
[0m11:46:27.342678 [info ] [MainThread]: Found 17 models, 433 macros
[0m11:46:27.343359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f6a6cd-2c96-4838-b80b-e9d053c3ae99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7203714740>]}
[0m11:46:27.345951 [info ] [MainThread]: 
[0m11:46:27.346624 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:46:27.347373 [info ] [MainThread]: 
[0m11:46:27.348345 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:46:27.359074 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m11:46:27.414621 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:46:27.415155 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m11:46:27.415624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:27.426736 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m11:46:27.427261 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m11:46:27.427800 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:46:27.431087 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.003 seconds
[0m11:46:27.433142 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m11:46:27.433758 [debug] [ThreadPool]: On list_postgres_public: Close
[0m11:46:27.444207 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:27.444779 [debug] [MainThread]: On master: BEGIN
[0m11:46:27.445230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:46:27.454580 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:46:27.455124 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:27.455716 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:46:27.464051 [debug] [MainThread]: SQL status: SELECT 7 in 0.008 seconds
[0m11:46:27.467123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f6a6cd-2c96-4838-b80b-e9d053c3ae99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7203742a50>]}
[0m11:46:27.467685 [debug] [MainThread]: On master: ROLLBACK
[0m11:46:27.468329 [debug] [MainThread]: On master: Close
[0m11:46:27.472584 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m11:46:27.473344 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_materials
[0m11:46:27.473995 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_norm_workload
[0m11:46:27.474583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m11:46:27.475132 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_pikets
[0m11:46:27.475820 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_materials'
[0m11:46:27.476568 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_norm_workload'
[0m11:46:27.477222 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m11:46:27.477904 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_pikets'
[0m11:46:27.478609 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_materials
[0m11:46:27.479224 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_norm_workload
[0m11:46:27.489325 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m11:46:27.490185 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_pikets
[0m11:46:27.493581 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_materials"
[0m11:46:27.497180 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_norm_workload"
[0m11:46:27.501722 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_pikets"
[0m11:46:27.502947 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m11:46:27.503744 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_materials
[0m11:46:27.504690 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_norm_workload
[0m11:46:27.505871 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m11:46:27.506751 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_materials
[0m11:46:27.507803 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_norm_workload
[0m11:46:27.508524 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m11:46:27.509090 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_pikets
[0m11:46:27.510114 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_works
[0m11:46:27.510827 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m11:46:27.511651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_journal, now model.tsm_dwh.stg_1c_tech)
[0m11:46:27.512494 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_pikets
[0m11:46:27.513378 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_materials, now model.tsm_dwh.stg_1c_works)
[0m11:46:27.514046 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_norm_workload, now model.tsm_dwh.dv_hub_fact_journal)
[0m11:46:27.514675 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m11:46:27.515368 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_sat_fact_journal
[0m11:46:27.516079 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m11:46:27.516740 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m11:46:27.520474 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m11:46:27.521243 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_pikets, now model.tsm_dwh.dv_sat_fact_journal)
[0m11:46:27.524770 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m11:46:27.535304 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m11:46:27.536161 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_sat_fact_journal
[0m11:46:27.537183 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m11:46:27.538024 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m11:46:27.543911 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m11:46:27.544903 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_journal"
[0m11:46:27.545900 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m11:46:27.546907 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m11:46:27.547829 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m11:46:27.548685 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_msat_fact_materials
[0m11:46:27.549821 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_msat_norm_workload
[0m11:46:27.550662 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_sat_fact_journal
[0m11:46:27.551389 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_msat_fact_pikets
[0m11:46:27.552091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_msat_fact_materials)
[0m11:46:27.552972 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_works, now model.tsm_dwh.dv_msat_norm_workload)
[0m11:46:27.553913 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_sat_fact_journal
[0m11:46:27.554603 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_fact_journal, now model.tsm_dwh.dv_msat_fact_pikets)
[0m11:46:27.555162 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_msat_fact_materials
[0m11:46:27.555713 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_msat_norm_workload
[0m11:46:27.556378 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m11:46:27.557100 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_msat_fact_pikets
[0m11:46:27.564289 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_materials"
[0m11:46:27.570223 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_norm_workload"
[0m11:46:27.570952 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_journal, now model.tsm_dwh.dv_hub_tech)
[0m11:46:27.576611 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m11:46:27.577609 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m11:46:27.578717 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_msat_fact_materials
[0m11:46:27.579353 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_msat_norm_workload
[0m11:46:27.584533 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m11:46:27.585905 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_msat_fact_materials
[0m11:46:27.586520 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_msat_fact_pikets
[0m11:46:27.587345 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_msat_norm_workload
[0m11:46:27.588290 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m11:46:27.589490 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_msat_fact_pikets
[0m11:46:27.590024 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m11:46:27.590657 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_sat_fact_tech
[0m11:46:27.591375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_materials, now model.tsm_dwh.dv_lnk_fact_work_tech)
[0m11:46:27.592170 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m11:46:27.593095 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m11:46:27.593676 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_norm_workload, now model.tsm_dwh.dv_sat_fact_tech)
[0m11:46:27.594295 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_work_tech
[0m11:46:27.594990 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_pikets, now model.tsm_dwh.dv_hub_fact_work)
[0m11:46:27.595676 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m11:46:27.596444 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_sat_fact_tech
[0m11:46:27.601021 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m11:46:27.601736 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m11:46:27.602432 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_tech, now model.tsm_dwh.dv_lnk_fact_journal_fact_work)
[0m11:46:27.607753 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_tech"
[0m11:46:27.612374 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m11:46:27.613221 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m11:46:27.614191 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_lnk_fact_work_tech
[0m11:46:27.618770 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m11:46:27.619709 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m11:46:27.620765 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m11:46:27.621345 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_sat_fact_tech
[0m11:46:27.622479 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m11:46:27.623267 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_sat_fact_work
[0m11:46:27.623869 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m11:46:27.624874 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_sat_fact_tech
[0m11:46:27.625807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_lnk_fact_work_tech, now model.tsm_dwh.dv_sat_fact_work)
[0m11:46:27.626744 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m11:46:27.627438 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_sat_fact_work
[0m11:46:27.632955 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_work"
[0m11:46:27.634079 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_sat_fact_work
[0m11:46:27.635016 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_sat_fact_work
[0m11:46:27.636782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:27.637312 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_work' was properly closed.
[0m11:46:27.637867 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_tech' was properly closed.
[0m11:46:27.638325 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_work' was properly closed.
[0m11:46:27.638861 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work' was properly closed.
[0m11:46:27.642249 [debug] [MainThread]: Command end result
[0m11:46:27.733357 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m11:46:27.737696 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m11:46:27.747334 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m11:46:27.755228 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m11:46:27.755877 [info ] [MainThread]: Building catalog
[0m11:46:27.770563 [debug] [ThreadPool]: Acquiring new postgres connection 'postgres.information_schema'
[0m11:46:27.782830 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
[0m11:46:27.783451 [debug] [ThreadPool]: On postgres.information_schema: BEGIN
[0m11:46:27.784494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:27.793688 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m11:46:27.794592 [debug] [ThreadPool]: Using postgres connection "postgres.information_schema"
[0m11:46:27.795235 [debug] [ThreadPool]: On postgres.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "postgres.information_schema"} */

    
    

    select
        'postgres' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dv_sat_fact_journal')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_1c_materials')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_1c_works')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dv_hub_tech')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dv_msat_fact_materials')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dv_lnk_fact_journal_fact_work')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_1c_pikets')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_1c_journal')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dv_hub_fact_work')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_1c_tech')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_1c_norm_workload')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dv_sat_fact_tech')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dv_msat_fact_pikets')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dv_sat_fact_work')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dv_msat_norm_workload')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dv_lnk_fact_work_tech')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dv_hub_fact_journal')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m11:46:27.800751 [debug] [ThreadPool]: SQL status: SELECT 284 in 0.005 seconds
[0m11:46:27.816903 [debug] [ThreadPool]: On postgres.information_schema: ROLLBACK
[0m11:46:27.817625 [debug] [ThreadPool]: On postgres.information_schema: Close
[0m11:46:27.846944 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/egor/projects/TSM_DWH/target/catalog.json
[0m11:46:27.880613 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m11:46:27.882430 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m11:46:27.883204 [info ] [MainThread]: Catalog written to /home/egor/projects/TSM_DWH/target/catalog.json
[0m11:46:27.884597 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.1282166, "process_in_blocks": "24", "process_kernel_time": 0.223805, "process_mem_max_rss": "116620", "process_out_blocks": "6600", "process_user_time": 2.441784}
[0m11:46:27.885258 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:46:27.885129 after 1.13 seconds
[0m11:46:27.885742 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:46:27.886201 [debug] [MainThread]: Connection 'postgres.information_schema' was properly closed.
[0m11:46:27.887029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7204181760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7202ff13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7215ad7c50>]}
[0m11:46:27.887705 [debug] [MainThread]: Flushing usage events
[0m11:46:28.702451 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:37.367954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46a1c38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa469ebe870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46a1c23c0>]}


============================== 11:46:37.373074 | b3483da6-00ef-4464-85a1-0c75a175e106 ==============================
[0m11:46:37.373074 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:46:37.374048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:46:37.559300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3483da6-00ef-4464-85a1-0c75a175e106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46a0fc800>]}
[0m11:46:37.625641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3483da6-00ef-4464-85a1-0c75a175e106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa469174a40>]}
[0m11:46:37.669738 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m11:46:37.671877 [error] [MainThread]: Traceback (most recent call last):
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib64/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib64/python3.12/socketserver.py", line 478, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m11:46:37.673135 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.36365637, "process_in_blocks": "0", "process_kernel_time": 0.150163, "process_mem_max_rss": "101828", "process_out_blocks": "3360", "process_user_time": 1.75031}
[0m11:46:37.673850 [debug] [MainThread]: Command `dbt docs serve` failed at 11:46:37.673718 after 0.36 seconds
[0m11:46:37.674344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46aec9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa46922d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4691ca300>]}
[0m11:46:37.674876 [debug] [MainThread]: Flushing usage events
[0m11:46:38.533028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:58.173772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e736a420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e763f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e92c8bc0>]}


============================== 11:46:58.177496 | d531cab9-fd41-4699-9ceb-6dd15291f978 ==============================
[0m11:46:58.177496 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:46:58.178489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:46:58.359175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd531cab9-fd41-4699-9ceb-6dd15291f978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e78146e0>]}
[0m11:46:58.425245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd531cab9-fd41-4699-9ceb-6dd15291f978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e6feb050>]}
[0m11:46:58.468548 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m11:46:58.470773 [error] [MainThread]: Traceback (most recent call last):
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib64/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib64/python3.12/socketserver.py", line 478, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m11:46:58.472115 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.35481378, "process_in_blocks": "0", "process_kernel_time": 0.166801, "process_mem_max_rss": "101820", "process_out_blocks": "3384", "process_user_time": 1.736374}
[0m11:46:58.472805 [debug] [MainThread]: Command `dbt docs serve` failed at 11:46:58.472672 after 0.36 seconds
[0m11:46:58.473367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e6d678c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e651cda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e65a11c0>]}
[0m11:46:58.474080 [debug] [MainThread]: Flushing usage events
[0m11:46:59.320140 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:51.475827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2432f79a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2431acd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243179ecc0>]}


============================== 11:47:51.479842 | ae983ff6-2528-495e-a08a-5a41849dccdb ==============================
[0m11:47:51.479842 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:47:51.480776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:47:51.664239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae983ff6-2528-495e-a08a-5a41849dccdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24320e86b0>]}
[0m11:47:51.731564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae983ff6-2528-495e-a08a-5a41849dccdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24312118e0>]}
[0m11:50:49.664338 [error] [MainThread]: Encountered an error:

[0m11:50:49.688806 [error] [MainThread]: Traceback (most recent call last):
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib64/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib64/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:50:49.691988 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 178.27289, "process_in_blocks": "192", "process_kernel_time": 0.173548, "process_mem_max_rss": "101988", "process_out_blocks": "3360", "process_user_time": 1.739389}
[0m11:50:49.693003 [debug] [MainThread]: Command `dbt docs serve` failed at 11:50:49.692780 after 178.27 seconds
[0m11:50:49.693951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2431e55df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24315dd1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2431211a30>]}
[0m11:50:49.695188 [debug] [MainThread]: Flushing usage events
[0m11:50:50.621621 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:50:55.142120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f160c3c52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f160a9ba270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f160a9b96d0>]}


============================== 11:50:55.145896 | 56e0dd14-50f4-46fd-b0b8-baa12addbe0f ==============================
[0m11:50:55.145896 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:50:55.146729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve --no-browser', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:50:55.339392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56e0dd14-50f4-46fd-b0b8-baa12addbe0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f160a8ec6b0>]}
[0m11:50:55.406689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56e0dd14-50f4-46fd-b0b8-baa12addbe0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1609e90200>]}
[0m11:51:26.032976 [error] [MainThread]: Encountered an error:

[0m11:51:26.035394 [error] [MainThread]: Traceback (most recent call last):
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib64/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib64/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:51:26.037390 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 30.956707, "process_in_blocks": "4816", "process_kernel_time": 0.191309, "process_mem_max_rss": "102072", "process_out_blocks": "3448", "process_user_time": 1.826172}
[0m11:51:26.038225 [debug] [MainThread]: Command `dbt docs serve` failed at 11:51:26.038092 after 30.96 seconds
[0m11:51:26.039093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f160a8caf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16095059a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1609a39c70>]}
[0m11:51:26.039862 [debug] [MainThread]: Flushing usage events
[0m11:51:26.892529 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:51:44.213687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa21654a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa216a435c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa216a43500>]}


============================== 11:51:44.217582 | ee57ab30-6f80-4e21-aa86-3a3edfe1b0f2 ==============================
[0m11:51:44.217582 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:51:44.218588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve --no-browser', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:51:44.411337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee57ab30-6f80-4e21-aa86-3a3edfe1b0f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa216c1c5c0>]}
[0m11:51:44.487250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee57ab30-6f80-4e21-aa86-3a3edfe1b0f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa216910e60>]}
[0m11:51:44.504770 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m11:51:44.507982 [error] [MainThread]: Traceback (most recent call last):
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib64/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/usr/lib64/python3.12/socketserver.py", line 478, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m11:51:44.509810 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 0.359976, "process_in_blocks": "0", "process_kernel_time": 0.166797, "process_mem_max_rss": "101912", "process_out_blocks": "3384", "process_user_time": 1.836383}
[0m11:51:44.510742 [debug] [MainThread]: Command `dbt docs serve` failed at 11:51:44.510464 after 0.36 seconds
[0m11:51:44.511970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa21a0b5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa21592cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa216bf7ec0>]}
[0m11:51:44.513126 [debug] [MainThread]: Flushing usage events
[0m11:51:45.324626 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:40:04.615189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c9984a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c96f3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ca0e8f80>]}


============================== 09:40:04.626153 | 8a779689-dc09-4955-ad7e-dd0d98edb5ea ==============================
[0m09:40:04.626153 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:40:04.627531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:40:04.909839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a779689-dc09-4955-ad7e-dd0d98edb5ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c91e3e90>]}
[0m09:40:04.944699 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:40:04.948289 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:40:04.951314 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46461514, "process_in_blocks": "120", "process_kernel_time": 0.220855, "process_mem_max_rss": "97416", "process_out_blocks": "72", "process_user_time": 2.676627}
[0m09:40:04.952498 [debug] [MainThread]: Command `cli deps` succeeded at 09:40:04.952206 after 0.47 seconds
[0m09:40:04.953431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6cd1b7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c8e7d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6c94a0cb0>]}
[0m09:40:04.954347 [debug] [MainThread]: Flushing usage events
[0m09:40:05.974201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:52:59.104867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff78173daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff783cc9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7818a61b0>]}


============================== 09:52:59.108898 | fabeb0de-22fe-4b21-be41-5b6fd7fe7aec ==============================
[0m09:52:59.108898 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:52:59.109780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:52:59.291908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff780d043b0>]}
[0m09:52:59.359311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff78163d730>]}
[0m09:52:59.360336 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:52:59.488303 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:52:59.578950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:52:59.579503 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:52:59.608184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff78131ce30>]}
[0m09:52:59.681579 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m09:52:59.684330 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m09:52:59.721296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77f50e1b0>]}
[0m09:52:59.722010 [info ] [MainThread]: Found 17 models, 433 macros
[0m09:52:59.725121 [info ] [MainThread]: 
[0m09:52:59.725817 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:52:59.726452 [info ] [MainThread]: 
[0m09:52:59.727409 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:52:59.734606 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:52:59.794461 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:52:59.795009 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:52:59.795553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:59.808765 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.013 seconds
[0m09:52:59.810652 [debug] [ThreadPool]: On list_postgres: Close
[0m09:52:59.813381 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m09:52:59.820178 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m09:52:59.820772 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m09:52:59.821243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:59.829408 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m09:52:59.829996 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m09:52:59.830638 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:52:59.833868 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.003 seconds
[0m09:52:59.835768 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m09:52:59.836359 [debug] [ThreadPool]: On list_postgres_public: Close
[0m09:52:59.845103 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:59.845684 [debug] [MainThread]: On master: BEGIN
[0m09:52:59.846176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:52:59.854873 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:52:59.855449 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:59.856023 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:52:59.862573 [debug] [MainThread]: SQL status: SELECT 7 in 0.006 seconds
[0m09:52:59.868501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77f12e120>]}
[0m09:52:59.869461 [debug] [MainThread]: On master: ROLLBACK
[0m09:52:59.870417 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:59.871150 [debug] [MainThread]: On master: BEGIN
[0m09:52:59.872033 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:52:59.872941 [debug] [MainThread]: On master: COMMIT
[0m09:52:59.873615 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:59.874059 [debug] [MainThread]: On master: COMMIT
[0m09:52:59.874950 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:52:59.875893 [debug] [MainThread]: On master: Close
[0m09:52:59.881340 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m09:52:59.883624 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_materials
[0m09:52:59.884337 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_norm_workload
[0m09:52:59.882745 [info ] [Thread-1 (]: 1 of 17 START sql view model public.stg_1c_journal ............................. [RUN]
[0m09:52:59.885353 [info ] [Thread-2 (]: 2 of 17 START sql view model public.stg_1c_materials ........................... [RUN]
[0m09:52:59.886355 [info ] [Thread-3 (]: 3 of 17 START sql view model public.stg_1c_norm_workload ....................... [RUN]
[0m09:52:59.887348 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_pikets
[0m09:52:59.887885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m09:52:59.888683 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_materials'
[0m09:52:59.889581 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_norm_workload'
[0m09:52:59.891473 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m09:52:59.890718 [info ] [Thread-4 (]: 4 of 17 START sql view model public.stg_1c_pikets .............................. [RUN]
[0m09:52:59.892350 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_materials
[0m09:52:59.892970 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_norm_workload
[0m09:52:59.899799 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_pikets'
[0m09:52:59.907498 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m09:52:59.911349 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_materials"
[0m09:52:59.919490 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_norm_workload"
[0m09:52:59.920506 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_pikets
[0m09:52:59.921710 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m09:52:59.933157 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_materials
[0m09:52:59.933899 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_norm_workload
[0m09:52:59.934976 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_pikets"
[0m09:53:00.008828 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_materials"
[0m09:53:00.010833 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m09:53:00.007807 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_norm_workload"
[0m09:53:00.012587 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_pikets
[0m09:53:00.014078 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:53:00.015156 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:53:00.020215 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_pikets"
[0m09:53:00.020891 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: BEGIN
[0m09:53:00.021494 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m09:53:00.022583 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:53:00.023290 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:53:00.023924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:00.024809 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: BEGIN
[0m09:53:00.025370 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:53:00.026419 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:53:00.027275 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: BEGIN
[0m09:53:00.028598 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:53:00.038101 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m09:53:00.039112 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:53:00.040206 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m09:53:00.041629 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m09:53:00.042811 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:53:00.043614 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m09:53:00.044320 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m09:53:00.045396 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */

  create view "postgres"."public"."stg_1c_materials__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(НомерСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемМатериала::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_materials,
	НомерСтроки::int,
	Примечание::varchar,
	ОбъемМатериала::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar
    FROM 
        src_materials
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name)
  );
[0m09:53:00.046069 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:53:00.046736 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:53:00.048211 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */

  create view "postgres"."public"."stg_1c_norm_workload__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(Период::varchar, 'N\A')) || '|' || TRIM(COALESCE(РассчетныйОбъем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьНормативная::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьФактическая::varchar, 'N\A')) || '|' || TRIM(COALESCE(НаемныйРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(НесколькоКлючевыхРесурсов::varchar, 'N\A')) || '|' || TRIM(COALESCE(ЖУФВР::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючДокументаРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_norm_workload,
	Период::timestamptz,
	РассчетныйОбъем::numeric,
	ТрудоемкостьНормативная::numeric,
	ТрудоемкостьФактическая::numeric,
	НаемныйРесурс::bool,
	КлючевойРесурс_value::uuid,
	КлючевойРесурс_codе::varchar,
	КлючевойРесурс_name::varchar,
	НесколькоКлючевыхРесурсов::bool,
	ЖУФВР::uuid,
	КлючДокументаРесурс::uuid,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	РесурсSpider_value::uuid,
	РесурсSpider_codе::varchar,
	РесурсSpider_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar
    FROM 
        src_norm_workload
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name)
  );
[0m09:53:00.050234 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:53:00.049574 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */

  create view "postgres"."public"."stg_1c_pikets__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(КлючСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетС::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеС::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(Объем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_pikets,
	КлючСтроки::uuid,
	ПикетС::numeric,
	ПикетПо::numeric,
	СмещениеС::numeric,
	СмещениеПо::numeric,
	Объем::numeric,
	ВидПикета_value::uuid,
	ВидПикета_codе::varchar,
	ВидПикета_name::varchar,
	ТипПикета_value::uuid,
	ТипПикета_codе::varchar,
	ТипПикета_name::varchar,
	ГруппаПикетовSpider_value::uuid,
	ГруппаПикетовSpider_codе::varchar,
	ГруппаПикетовSpider_name::varchar
    FROM 
        src_pikets
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name)
  );
[0m09:53:00.050887 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:53:00.058840 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:53:00.059472 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:53:00.065762 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:53:00.066376 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:53:00.066885 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m09:53:00.070526 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:53:00.071055 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials" rename to "stg_1c_materials__dbt_backup"
[0m09:53:00.074937 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:53:00.075774 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload" rename to "stg_1c_norm_workload__dbt_backup"
[0m09:53:00.076420 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:53:00.077084 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets" rename to "stg_1c_pikets__dbt_backup"
[0m09:53:00.077789 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:53:00.081657 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:53:00.082431 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:53:00.087206 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:53:00.087909 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:53:00.088475 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m09:53:00.091919 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:53:00.092543 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials__dbt_tmp" rename to "stg_1c_materials"
[0m09:53:00.096025 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:53:00.096840 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload__dbt_tmp" rename to "stg_1c_norm_workload"
[0m09:53:00.097646 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:53:00.098616 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets__dbt_tmp" rename to "stg_1c_pikets"
[0m09:53:00.099296 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:53:00.105651 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:53:00.117295 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:53:00.121868 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m09:53:00.124234 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m09:53:00.126634 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m09:53:00.128750 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m09:53:00.129374 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:53:00.129989 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:53:00.130695 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:53:00.131311 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:53:00.131927 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m09:53:00.132508 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m09:53:00.133154 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m09:53:00.133811 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m09:53:00.166117 [debug] [Thread-1 (]: SQL status: COMMIT in 0.032 seconds
[0m09:53:00.173249 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m09:53:00.179743 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:53:00.180408 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m09:53:00.201293 [debug] [Thread-4 (]: SQL status: COMMIT in 0.066 seconds
[0m09:53:00.201977 [debug] [Thread-3 (]: SQL status: COMMIT in 0.067 seconds
[0m09:53:00.202520 [debug] [Thread-2 (]: SQL status: COMMIT in 0.068 seconds
[0m09:53:00.205593 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."stg_1c_pikets__dbt_backup"
[0m09:53:00.208509 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_norm_workload__dbt_backup"
[0m09:53:00.211478 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_materials__dbt_backup"
[0m09:53:00.212304 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.031 seconds
[0m09:53:00.213566 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:53:00.214844 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:53:00.215917 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:53:00.218804 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m09:53:00.219486 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
drop view if exists "postgres"."public"."stg_1c_pikets__dbt_backup" cascade
[0m09:53:00.220120 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
drop view if exists "postgres"."public"."stg_1c_norm_workload__dbt_backup" cascade
[0m09:53:00.220805 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
drop view if exists "postgres"."public"."stg_1c_materials__dbt_backup" cascade
[0m09:53:00.223503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7839a7b00>]}
[0m09:53:00.224800 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public.stg_1c_journal ........................ [[32mCREATE VIEW[0m in 0.33s]
[0m09:53:00.226037 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m09:53:00.226705 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m09:53:00.227479 [info ] [Thread-1 (]: 5 of 17 START sql view model public.stg_1c_tech ................................ [RUN]
[0m09:53:00.228458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_journal, now model.tsm_dwh.stg_1c_tech)
[0m09:53:00.229122 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m09:53:00.233783 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m09:53:00.234794 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.013 seconds
[0m09:53:00.235942 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m09:53:00.238061 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: Close
[0m09:53:00.244248 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.021 seconds
[0m09:53:00.245220 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.022 seconds
[0m09:53:00.247787 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m09:53:00.248729 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77e337650>]}
[0m09:53:00.252054 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: Close
[0m09:53:00.254262 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: Close
[0m09:53:00.255489 [info ] [Thread-4 (]: 4 of 17 OK created sql view model public.stg_1c_pikets ......................... [[32mCREATE VIEW[0m in 0.35s]
[0m09:53:00.256988 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77e329190>]}
[0m09:53:00.257980 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff780d78800>]}
[0m09:53:00.259404 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_pikets
[0m09:53:00.260714 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:53:00.262451 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public.stg_1c_norm_workload .................. [[32mCREATE VIEW[0m in 0.37s]
[0m09:53:00.264408 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_works
[0m09:53:00.263411 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public.stg_1c_materials ...................... [[32mCREATE VIEW[0m in 0.37s]
[0m09:53:00.265373 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m09:53:00.266372 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_norm_workload
[0m09:53:00.267390 [info ] [Thread-4 (]: 6 of 17 START sql view model public.stg_1c_works ............................... [RUN]
[0m09:53:00.268948 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_materials
[0m09:53:00.270097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:00.270871 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m09:53:00.271872 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_pikets, now model.tsm_dwh.stg_1c_works)
[0m09:53:00.272638 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_sat_fact_journal
[0m09:53:00.274268 [info ] [Thread-3 (]: 7 of 17 START sql incremental model public.dv_hub_fact_journal ................. [RUN]
[0m09:53:00.275030 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m09:53:00.276179 [info ] [Thread-2 (]: 8 of 17 START sql incremental model public.dv_sat_fact_journal ................. [RUN]
[0m09:53:00.277328 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_norm_workload, now model.tsm_dwh.dv_hub_fact_journal)
[0m09:53:00.284389 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m09:53:00.285206 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_materials, now model.tsm_dwh.dv_sat_fact_journal)
[0m09:53:00.286426 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m09:53:00.287591 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m09:53:00.289117 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m09:53:00.290000 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_sat_fact_journal
[0m09:53:00.303002 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:53:00.304777 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m09:53:00.310679 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m09:53:00.316413 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_journal"
[0m09:53:00.317456 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m09:53:00.319160 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m09:53:00.320668 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_sat_fact_journal
[0m09:53:00.321865 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:53:00.343448 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m09:53:00.349205 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m09:53:00.376300 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:53:00.394722 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:53:00.415645 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech" rename to "stg_1c_tech__dbt_backup"
[0m09:53:00.425915 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_journal"
[0m09:53:00.426961 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_journal"
[0m09:53:00.428417 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m09:53:00.429109 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:53:00.429930 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_journal: BEGIN
[0m09:53:00.433667 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:53:00.434316 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:53:00.435038 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:53:00.436054 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech__dbt_tmp" rename to "stg_1c_tech"
[0m09:53:00.436918 [debug] [Thread-4 (]: SQL status: BEGIN in 0.042 seconds
[0m09:53:00.437857 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: BEGIN
[0m09:53:00.438673 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:53:00.439964 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:53:00.440712 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:53:00.441631 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m09:53:00.443908 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m09:53:00.444996 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:53:00.446692 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m09:53:00.448071 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m09:53:00.448788 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m09:53:00.449361 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:53:00.450342 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_journal"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_hub_fact_journal,
        s.hdiff_dv_sat_fact_journal,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_journal) over(PARTITION BY s.hk_dv_hub_fact_journal ORDER BY s.loadts) AS lag_hdiff,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_journal,
            s.hdiff_dv_sat_fact_journal,
            s.loadts,
            s.recsource,
            rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
        FROM "postgres"."public"."stg_1c_journal" s
        ) s
    )

    SELECT DISTINCT
        hk_dv_hub_fact_journal,
        recsource,
        loadts,
        hdiff_dv_sat_fact_journal,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_journal <> lag_hdiff 
        OR lag_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m09:53:00.456409 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:53:00.457128 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m09:53:00.457880 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works" rename to "stg_1c_works__dbt_backup"
[0m09:53:00.458547 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:53:00.459521 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m09:53:00.460479 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      
  
    

  create  table "postgres"."public"."dv_hub_fact_journal"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal" stg


  );
  
  
[0m09:53:00.461396 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:53:00.465520 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_tech__dbt_backup"
[0m09:53:00.469429 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:53:00.470989 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:53:00.471684 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works__dbt_tmp" rename to "stg_1c_works"
[0m09:53:00.472350 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
drop view if exists "postgres"."public"."stg_1c_tech__dbt_backup" cascade
[0m09:53:00.473637 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:53:00.476110 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m09:53:00.476722 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:53:00.477294 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m09:53:00.483549 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m09:53:00.485523 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m09:53:00.486375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77c2ccef0>]}
[0m09:53:00.487203 [info ] [Thread-1 (]: 5 of 17 OK created sql view model public.stg_1c_tech ........................... [[32mCREATE VIEW[0m in 0.26s]
[0m09:53:00.488324 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m09:53:00.488955 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_msat_fact_pikets
[0m09:53:00.489725 [info ] [Thread-1 (]: 9 of 17 START sql incremental model public.dv_msat_fact_pikets ................. [RUN]
[0m09:53:00.490719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_msat_fact_pikets)
[0m09:53:00.491435 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_msat_fact_pikets
[0m09:53:00.492228 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.026 seconds
[0m09:53:00.498195 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.040 seconds
[0m09:53:00.504698 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m09:53:00.505877 [debug] [Thread-4 (]: SQL status: COMMIT in 0.028 seconds
[0m09:53:00.516037 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m09:53:00.517530 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m09:53:00.521511 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."stg_1c_works__dbt_backup"
[0m09:53:00.522432 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m09:53:00.523516 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_msat_fact_pikets
[0m09:53:00.524236 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:53:00.525839 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:53:00.526596 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m09:53:00.532392 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m09:53:00.532891 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m09:53:00.533446 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
drop view if exists "postgres"."public"."stg_1c_works__dbt_backup" cascade
[0m09:53:00.534686 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m09:53:00.535856 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_pikets: BEGIN
[0m09:53:00.536718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:00.544470 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m09:53:00.545815 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_journal: Close
[0m09:53:00.546502 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m09:53:00.547736 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m09:53:00.548719 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77c2d23c0>]}
[0m09:53:00.550096 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */

      
  
    

  create  table "postgres"."public"."dv_msat_fact_pikets"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_pikets,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
                FROM "postgres"."public"."stg_1c_pikets" s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            
            OR stg_lag_hdiff IS null

    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m09:53:00.551421 [info ] [Thread-2 (]: 8 of 17 OK created sql incremental model public.dv_sat_fact_journal ............ [[32mSELECT 1[0m in 0.26s]
[0m09:53:00.552582 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_sat_fact_journal
[0m09:53:00.553315 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_msat_norm_workload
[0m09:53:00.553869 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.018 seconds
[0m09:53:00.555303 [debug] [Thread-3 (]: SQL status: COMMIT in 0.021 seconds
[0m09:53:00.554749 [info ] [Thread-2 (]: 10 of 17 START sql incremental model public.dv_msat_norm_workload .............. [RUN]
[0m09:53:00.558348 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: Close
[0m09:53:00.559885 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m09:53:00.560533 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_journal, now model.tsm_dwh.dv_msat_norm_workload)
[0m09:53:00.561493 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77c1131d0>]}
[0m09:53:00.562909 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77c2ab1d0>]}
[0m09:53:00.564270 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_msat_norm_workload
[0m09:53:00.565518 [info ] [Thread-4 (]: 6 of 17 OK created sql view model public.stg_1c_works .......................... [[32mCREATE VIEW[0m in 0.29s]
[0m09:53:00.567232 [info ] [Thread-3 (]: 7 of 17 OK created sql incremental model public.dv_hub_fact_journal ............ [[32mSELECT 1[0m in 0.29s]
[0m09:53:00.573647 [debug] [Thread-1 (]: SQL status: SELECT 22 in 0.021 seconds
[0m09:53:00.578915 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_norm_workload"
[0m09:53:00.580224 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m09:53:00.581502 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m09:53:00.585824 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_pikets: COMMIT
[0m09:53:00.587336 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_msat_fact_materials
[0m09:53:00.589032 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m09:53:00.590220 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_msat_norm_workload
[0m09:53:00.591158 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m09:53:00.592014 [info ] [Thread-4 (]: 11 of 17 START sql incremental model public.dv_msat_fact_materials ............. [RUN]
[0m09:53:00.593021 [info ] [Thread-3 (]: 12 of 17 START sql incremental model public.dv_hub_tech ........................ [RUN]
[0m09:53:00.602215 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_norm_workload"
[0m09:53:00.602978 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_pikets: COMMIT
[0m09:53:00.603822 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_works, now model.tsm_dwh.dv_msat_fact_materials)
[0m09:53:00.604528 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_fact_journal, now model.tsm_dwh.dv_hub_tech)
[0m09:53:00.605696 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_msat_fact_materials
[0m09:53:00.606922 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m09:53:00.607880 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m09:53:00.613854 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_materials"
[0m09:53:00.614743 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: BEGIN
[0m09:53:00.615639 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m09:53:00.622101 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m09:53:00.623486 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:53:00.625190 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_pikets: Close
[0m09:53:00.625932 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_msat_fact_materials
[0m09:53:00.627819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77c15e840>]}
[0m09:53:00.629143 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m09:53:00.637994 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_materials"
[0m09:53:00.638993 [info ] [Thread-1 (]: 9 of 17 OK created sql incremental model public.dv_msat_fact_pikets ............ [[32mSELECT 22[0m in 0.14s]
[0m09:53:00.647510 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_tech"
[0m09:53:00.648250 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m09:53:00.649508 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_msat_fact_pikets
[0m09:53:00.650279 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m09:53:00.651309 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m09:53:00.652341 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:53:00.653133 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:53:00.654201 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_fact_materials: BEGIN
[0m09:53:00.656091 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */

      
  
    

  create  table "postgres"."public"."dv_msat_norm_workload"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_norm_workload,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
                FROM "postgres"."public"."stg_1c_norm_workload" s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            
            OR stg_lag_hdiff IS null

    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m09:53:00.659358 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: BEGIN
[0m09:53:00.662278 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:53:00.658297 [info ] [Thread-1 (]: 13 of 17 START sql incremental model public.dv_lnk_fact_work_tech .............. [RUN]
[0m09:53:00.660848 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:53:00.663834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_pikets, now model.tsm_dwh.dv_lnk_fact_work_tech)
[0m09:53:00.669072 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:53:00.736092 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:53:00.736850 [debug] [Thread-4 (]: SQL status: BEGIN in 0.076 seconds
[0m09:53:00.737418 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.075 seconds
[0m09:53:00.737986 [debug] [Thread-3 (]: SQL status: BEGIN in 0.076 seconds
[0m09:53:00.738873 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m09:53:00.741421 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: COMMIT
[0m09:53:00.742116 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:53:00.742891 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:53:00.743526 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */

      
  
    

  create  table "postgres"."public"."dv_msat_fact_materials"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_materials,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
                FROM "postgres"."public"."stg_1c_materials" s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            
            OR stg_lag_hdiff IS null

    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m09:53:00.744279 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m09:53:00.744956 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      
  
    

  create  table "postgres"."public"."dv_hub_tech"
  
  
    as
  
  (
    

SELECT distinct on (bk_ресурс_uuid)
        hk_dv_hub_tech,
        hkcode,
        recsource,
        loadts,
        bk_ресурс_uuid
FROM "postgres"."public"."stg_1c_tech" stg


  );
  
  
[0m09:53:00.750300 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:53:00.751371 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: COMMIT
[0m09:53:00.752606 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:53:00.753869 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: BEGIN
[0m09:53:00.754932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:00.763075 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m09:53:00.764955 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: Close
[0m09:53:00.766106 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77c286990>]}
[0m09:53:00.767303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:53:00.768407 [info ] [Thread-2 (]: 10 of 17 OK created sql incremental model public.dv_msat_norm_workload ......... [[32mSELECT 20[0m in 0.21s]
[0m09:53:00.769342 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:53:00.770355 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_msat_norm_workload
[0m09:53:00.771088 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      
  
    

  create  table "postgres"."public"."dv_lnk_fact_work_tech"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_work,
	hk_dv_hub_tech)
        hk_dv_lnk_fact_work_tech,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_work,
	hk_dv_hub_tech
FROM "postgres"."public"."stg_1c_tech" stg


  );
  
  
[0m09:53:00.771854 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_sat_fact_tech
[0m09:53:00.772704 [info ] [Thread-2 (]: 14 of 17 START sql incremental model public.dv_sat_fact_tech ................... [RUN]
[0m09:53:00.773565 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_norm_workload, now model.tsm_dwh.dv_sat_fact_tech)
[0m09:53:00.774495 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_sat_fact_tech
[0m09:53:00.775663 [debug] [Thread-3 (]: SQL status: SELECT 17 in 0.024 seconds
[0m09:53:00.776744 [debug] [Thread-4 (]: SQL status: SELECT 15 in 0.025 seconds
[0m09:53:00.785205 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_tech"
[0m09:53:00.789322 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m09:53:00.790100 [debug] [Thread-1 (]: SQL status: SELECT 63 in 0.018 seconds
[0m09:53:00.793194 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_fact_materials: COMMIT
[0m09:53:00.794242 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:53:00.796984 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m09:53:00.798039 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_sat_fact_tech
[0m09:53:00.798724 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m09:53:00.799876 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m09:53:00.800483 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:53:00.806412 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_tech"
[0m09:53:00.806921 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_fact_materials: COMMIT
[0m09:53:00.807567 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m09:53:00.808814 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m09:53:00.809417 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: BEGIN
[0m09:53:00.809915 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:53:00.817401 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m09:53:00.818922 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: Close
[0m09:53:00.819935 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77c1c3ef0>]}
[0m09:53:00.820984 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m09:53:00.822194 [info ] [Thread-3 (]: 12 of 17 OK created sql incremental model public.dv_hub_tech ................... [[32mSELECT 17[0m in 0.22s]
[0m09:53:00.823478 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m09:53:00.824851 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m09:53:00.825747 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_tech"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_lnk_fact_work_tech,
        s.hdiff_dv_sat_fact_tech,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_tech) over(PARTITION BY s.hk_dv_lnk_fact_work_tech ORDER BY s.loadts) AS lag_hdiff,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name

    FROM
        (SELECT
            s.hk_dv_lnk_fact_work_tech,
            s.hdiff_dv_sat_fact_tech,
            s.loadts,
            s.recsource,
            примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
        FROM "postgres"."public"."stg_1c_tech" s
        ) s
    )

    SELECT DISTINCT
        hk_dv_lnk_fact_work_tech,
        recsource,
        loadts,
        hdiff_dv_sat_fact_tech,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_tech <> lag_hdiff 
        OR lag_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m09:53:00.826802 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m09:53:00.827363 [debug] [Thread-4 (]: SQL status: COMMIT in 0.019 seconds
[0m09:53:00.827889 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m09:53:00.828983 [info ] [Thread-3 (]: 15 of 17 START sql incremental model public.dv_hub_fact_work ................... [RUN]
[0m09:53:00.830947 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_fact_materials: Close
[0m09:53:00.832305 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: Close
[0m09:53:00.833074 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_tech, now model.tsm_dwh.dv_hub_fact_work)
[0m09:53:00.834929 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77c28c7a0>]}
[0m09:53:00.836759 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m09:53:00.837957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77c26b260>]}
[0m09:53:00.846386 [info ] [Thread-1 (]: 13 of 17 OK created sql incremental model public.dv_lnk_fact_work_tech ......... [[32mSELECT 63[0m in 0.17s]
[0m09:53:00.839239 [info ] [Thread-4 (]: 11 of 17 OK created sql incremental model public.dv_msat_fact_materials ........ [[32mSELECT 15[0m in 0.23s]
[0m09:53:00.848014 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m09:53:00.848889 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:53:00.849496 [debug] [Thread-2 (]: SQL status: SELECT 63 in 0.021 seconds
[0m09:53:00.850443 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_msat_fact_materials
[0m09:53:00.851870 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:53:00.855527 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m09:53:00.856351 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m09:53:00.857201 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_sat_fact_work
[0m09:53:00.858111 [info ] [Thread-1 (]: 16 of 17 START sql incremental model public.dv_lnk_fact_journal_fact_work ...... [RUN]
[0m09:53:00.859054 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m09:53:00.869057 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_work"
[0m09:53:00.870700 [info ] [Thread-4 (]: 17 of 17 START sql incremental model public.dv_sat_fact_work ................... [RUN]
[0m09:53:00.871944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_lnk_fact_work_tech, now model.tsm_dwh.dv_lnk_fact_journal_fact_work)
[0m09:53:00.872956 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m09:53:00.874273 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_materials, now model.tsm_dwh.dv_sat_fact_work)
[0m09:53:00.875087 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:53:00.875825 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:53:00.876674 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_sat_fact_work
[0m09:53:00.882738 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:53:00.884045 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: BEGIN
[0m09:53:00.890643 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m09:53:00.891687 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_work"
[0m09:53:00.892361 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:53:00.893207 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:53:00.894588 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: Close
[0m09:53:00.895903 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_sat_fact_work
[0m09:53:00.906477 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:53:00.912889 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77c1754c0>]}
[0m09:53:00.917140 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_work"
[0m09:53:00.918377 [debug] [Thread-3 (]: SQL status: BEGIN in 0.026 seconds
[0m09:53:00.919574 [info ] [Thread-2 (]: 14 of 17 OK created sql incremental model public.dv_sat_fact_tech .............. [[32mSELECT 63[0m in 0.14s]
[0m09:53:00.920847 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:53:00.921771 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:53:00.922678 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_sat_fact_tech
[0m09:53:00.923428 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_hub_fact_work"
  
  
    as
  
  (
    

SELECT distinct on (bk_работа_uuid)
        hk_dv_hub_fact_work,
        hkcode,
        recsource,
        loadts,
        bk_работа_uuid
FROM "postgres"."public"."stg_1c_works" stg


  );
  
  
[0m09:53:00.924290 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m09:53:00.924939 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: BEGIN
[0m09:53:00.925985 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: BEGIN
[0m09:53:00.927071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:00.928128 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:53:00.937472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m09:53:00.938213 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:53:00.939509 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m09:53:00.940402 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_lnk_fact_journal_fact_work"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work)
        hk_dv_lnk_fact_journal_fact_work,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work
FROM "postgres"."public"."stg_1c_works" stg


  );
  
  
[0m09:53:00.941445 [debug] [Thread-3 (]: SQL status: SELECT 22 in 0.016 seconds
[0m09:53:00.942573 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m09:53:00.946484 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m09:53:00.947628 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_work"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_hub_fact_work,
        s.hdiff_dv_sat_fact_work,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_work) over(PARTITION BY s.hk_dv_hub_fact_work ORDER BY s.loadts) AS lag_hdiff,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_work,
            s.hdiff_dv_sat_fact_work,
            s.loadts,
            s.recsource,
            идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
        FROM "postgres"."public"."stg_1c_works" s
        ) s
    )

    SELECT DISTINCT
        hk_dv_hub_fact_work,
        recsource,
        loadts,
        hdiff_dv_sat_fact_work,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_work <> lag_hdiff 
        OR lag_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m09:53:00.948995 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:53:00.949968 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m09:53:00.965029 [debug] [Thread-1 (]: SQL status: SELECT 22 in 0.021 seconds
[0m09:53:00.967438 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m09:53:00.968351 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:53:00.969029 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m09:53:00.972707 [debug] [Thread-3 (]: SQL status: COMMIT in 0.022 seconds
[0m09:53:00.973753 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: Close
[0m09:53:00.974329 [debug] [Thread-4 (]: SQL status: SELECT 22 in 0.025 seconds
[0m09:53:00.975326 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77c17eba0>]}
[0m09:53:00.978178 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m09:53:00.979143 [info ] [Thread-3 (]: 15 of 17 OK created sql incremental model public.dv_hub_fact_work .............. [[32mSELECT 22[0m in 0.14s]
[0m09:53:00.979958 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m09:53:00.980858 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m09:53:00.981685 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m09:53:00.982334 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m09:53:00.983693 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: Close
[0m09:53:00.984879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77c2cfb60>]}
[0m09:53:00.986704 [info ] [Thread-1 (]: 16 of 17 OK created sql incremental model public.dv_lnk_fact_journal_fact_work . [[32mSELECT 22[0m in 0.11s]
[0m09:53:00.988296 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:53:00.993757 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m09:53:00.994842 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: Close
[0m09:53:00.995570 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fabeb0de-22fe-4b21-be41-5b6fd7fe7aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77c177050>]}
[0m09:53:00.996355 [info ] [Thread-4 (]: 17 of 17 OK created sql incremental model public.dv_sat_fact_work .............. [[32mSELECT 22[0m in 0.12s]
[0m09:53:00.997164 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_sat_fact_work
[0m09:53:00.999405 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:01.000348 [debug] [MainThread]: On master: BEGIN
[0m09:53:01.001174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:53:01.011349 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:53:01.012348 [debug] [MainThread]: On master: COMMIT
[0m09:53:01.013018 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:01.013767 [debug] [MainThread]: On master: COMMIT
[0m09:53:01.014603 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:53:01.015205 [debug] [MainThread]: On master: Close
[0m09:53:01.015891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:01.016349 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work' was properly closed.
[0m09:53:01.016828 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_tech' was properly closed.
[0m09:53:01.017247 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_work' was properly closed.
[0m09:53:01.017949 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_work' was properly closed.
[0m09:53:01.018659 [info ] [MainThread]: 
[0m09:53:01.019452 [info ] [MainThread]: Finished running 11 incremental models, 6 view models in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m09:53:01.024867 [debug] [MainThread]: Command end result
[0m09:53:01.068438 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m09:53:01.070354 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m09:53:01.079745 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m09:53:01.080270 [info ] [MainThread]: 
[0m09:53:01.080911 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:53:01.081489 [info ] [MainThread]: 
[0m09:53:01.082205 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m09:53:01.083508 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.0354297, "process_in_blocks": "3472", "process_kernel_time": 0.290992, "process_mem_max_rss": "122768", "process_out_blocks": "3488", "process_user_time": 3.226515}
[0m09:53:01.084121 [debug] [MainThread]: Command `dbt build` succeeded at 09:53:01.083971 after 2.04 seconds
[0m09:53:01.084710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff78148e870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77fd33470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7812fec00>]}
[0m09:53:01.085243 [debug] [MainThread]: Flushing usage events
[0m09:53:02.172387 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:53:06.024279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38ac53a8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38ac35ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38ac45f4a0>]}


============================== 09:53:06.027975 | a2086b9e-7175-437e-893b-3b654a05d91f ==============================
[0m09:53:06.027975 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:53:06.028878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:53:06.205843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38acccc4d0>]}
[0m09:53:06.271238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38ae1456a0>]}
[0m09:53:06.272315 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:53:06.390170 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:53:06.481105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:53:06.481598 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:53:06.510007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38abdd1580>]}
[0m09:53:06.582715 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m09:53:06.585694 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m09:53:06.615161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38aa9e6150>]}
[0m09:53:06.615949 [info ] [MainThread]: Found 17 models, 433 macros
[0m09:53:06.619021 [info ] [MainThread]: 
[0m09:53:06.619721 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:53:06.620439 [info ] [MainThread]: 
[0m09:53:06.621347 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:53:06.631113 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:53:06.684363 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:53:06.684936 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:53:06.685425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:06.696843 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.011 seconds
[0m09:53:06.698544 [debug] [ThreadPool]: On list_postgres: Close
[0m09:53:06.702500 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m09:53:06.709432 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m09:53:06.709957 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m09:53:06.710601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:06.719469 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m09:53:06.720080 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m09:53:06.720684 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:53:06.723904 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.003 seconds
[0m09:53:06.725932 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m09:53:06.726638 [debug] [ThreadPool]: On list_postgres_public: Close
[0m09:53:06.736528 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:06.737027 [debug] [MainThread]: On master: BEGIN
[0m09:53:06.737619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:06.746421 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:53:06.747024 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:06.747720 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:53:06.755864 [debug] [MainThread]: SQL status: SELECT 7 in 0.008 seconds
[0m09:53:06.759122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38aa100110>]}
[0m09:53:06.759966 [debug] [MainThread]: On master: ROLLBACK
[0m09:53:06.761154 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:06.762224 [debug] [MainThread]: On master: BEGIN
[0m09:53:06.763384 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:53:06.764058 [debug] [MainThread]: On master: COMMIT
[0m09:53:06.764776 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:06.765471 [debug] [MainThread]: On master: COMMIT
[0m09:53:06.766294 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:53:06.767034 [debug] [MainThread]: On master: Close
[0m09:53:06.772752 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m09:53:06.774959 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_materials
[0m09:53:06.777564 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_norm_workload
[0m09:53:06.778423 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_pikets
[0m09:53:06.774008 [info ] [Thread-1 (]: 1 of 17 START sql view model public.stg_1c_journal ............................. [RUN]
[0m09:53:06.776458 [info ] [Thread-2 (]: 2 of 17 START sql view model public.stg_1c_materials ........................... [RUN]
[0m09:53:06.779357 [info ] [Thread-3 (]: 3 of 17 START sql view model public.stg_1c_norm_workload ....................... [RUN]
[0m09:53:06.780571 [info ] [Thread-4 (]: 4 of 17 START sql view model public.stg_1c_pikets .............................. [RUN]
[0m09:53:06.781572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m09:53:06.782678 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_materials'
[0m09:53:06.783879 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_norm_workload'
[0m09:53:06.784927 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_pikets'
[0m09:53:06.785822 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m09:53:06.786496 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_materials
[0m09:53:06.787328 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_norm_workload
[0m09:53:06.788128 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_pikets
[0m09:53:06.808532 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_materials"
[0m09:53:06.810094 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m09:53:06.814748 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_norm_workload"
[0m09:53:06.818455 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_pikets"
[0m09:53:06.819702 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m09:53:06.820397 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_materials
[0m09:53:06.862835 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_pikets
[0m09:53:06.898874 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m09:53:06.899942 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_pikets"
[0m09:53:06.900504 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_norm_workload
[0m09:53:06.901401 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_materials"
[0m09:53:06.906708 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_norm_workload"
[0m09:53:06.907420 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:53:06.908371 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:53:06.909299 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m09:53:06.910236 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:53:06.910782 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: BEGIN
[0m09:53:06.911490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:06.912291 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:53:06.912791 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: BEGIN
[0m09:53:06.913413 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:53:06.914346 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: BEGIN
[0m09:53:06.915300 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:53:06.916610 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:53:06.927237 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m09:53:06.928125 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:53:06.929693 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m09:53:06.931506 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m09:53:06.932126 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m09:53:06.932845 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m09:53:06.933687 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:53:06.934542 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:53:06.935277 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:53:06.935910 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:53:06.936520 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */

  create view "postgres"."public"."stg_1c_materials__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(НомерСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемМатериала::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_materials,
	НомерСтроки::int,
	Примечание::varchar,
	ОбъемМатериала::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar
    FROM 
        src_materials
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name)
  );
[0m09:53:06.937453 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */

  create view "postgres"."public"."stg_1c_pikets__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(КлючСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетС::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеС::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(Объем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_pikets,
	КлючСтроки::uuid,
	ПикетС::numeric,
	ПикетПо::numeric,
	СмещениеС::numeric,
	СмещениеПо::numeric,
	Объем::numeric,
	ВидПикета_value::uuid,
	ВидПикета_codе::varchar,
	ВидПикета_name::varchar,
	ТипПикета_value::uuid,
	ТипПикета_codе::varchar,
	ТипПикета_name::varchar,
	ГруппаПикетовSpider_value::uuid,
	ГруппаПикетовSpider_codе::varchar,
	ГруппаПикетовSpider_name::varchar
    FROM 
        src_pikets
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name)
  );
[0m09:53:06.938440 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */

  create view "postgres"."public"."stg_1c_norm_workload__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(Период::varchar, 'N\A')) || '|' || TRIM(COALESCE(РассчетныйОбъем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьНормативная::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьФактическая::varchar, 'N\A')) || '|' || TRIM(COALESCE(НаемныйРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(НесколькоКлючевыхРесурсов::varchar, 'N\A')) || '|' || TRIM(COALESCE(ЖУФВР::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючДокументаРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_norm_workload,
	Период::timestamptz,
	РассчетныйОбъем::numeric,
	ТрудоемкостьНормативная::numeric,
	ТрудоемкостьФактическая::numeric,
	НаемныйРесурс::bool,
	КлючевойРесурс_value::uuid,
	КлючевойРесурс_codе::varchar,
	КлючевойРесурс_name::varchar,
	НесколькоКлючевыхРесурсов::bool,
	ЖУФВР::uuid,
	КлючДокументаРесурс::uuid,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	РесурсSpider_value::uuid,
	РесурсSpider_codе::varchar,
	РесурсSpider_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar
    FROM 
        src_norm_workload
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name)
  );
[0m09:53:06.946196 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:53:06.947497 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m09:53:06.951224 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:53:06.955768 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:53:06.956443 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:53:06.957242 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m09:53:06.957794 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m09:53:06.958341 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m09:53:06.962140 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:53:06.965994 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:53:06.970329 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:53:06.971076 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets" rename to "stg_1c_pikets__dbt_backup"
[0m09:53:06.971997 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:53:06.972560 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials" rename to "stg_1c_materials__dbt_backup"
[0m09:53:06.973334 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload" rename to "stg_1c_norm_workload__dbt_backup"
[0m09:53:06.985515 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m09:53:06.994612 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m09:53:06.998600 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:53:06.999334 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:53:07.000137 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:53:07.000762 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:53:07.001354 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets__dbt_tmp" rename to "stg_1c_pikets"
[0m09:53:07.001949 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m09:53:07.005402 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:53:07.008998 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:53:07.009862 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials__dbt_tmp" rename to "stg_1c_materials"
[0m09:53:07.010512 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload__dbt_tmp" rename to "stg_1c_norm_workload"
[0m09:53:07.011386 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:53:07.014221 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m09:53:07.014880 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:53:07.015411 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:53:07.015895 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:53:07.017960 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m09:53:07.020168 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m09:53:07.020795 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m09:53:07.021336 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:53:07.021957 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:53:07.022697 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m09:53:07.023365 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m09:53:07.024003 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m09:53:07.031885 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m09:53:07.038658 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:53:07.039395 [debug] [Thread-4 (]: SQL status: COMMIT in 0.017 seconds
[0m09:53:07.039979 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m09:53:07.043499 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."stg_1c_pikets__dbt_backup"
[0m09:53:07.045207 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:53:07.046016 [debug] [Thread-2 (]: SQL status: COMMIT in 0.021 seconds
[0m09:53:07.046557 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
drop view if exists "postgres"."public"."stg_1c_pikets__dbt_backup" cascade
[0m09:53:07.047145 [debug] [Thread-3 (]: SQL status: COMMIT in 0.017 seconds
[0m09:53:07.050064 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_materials__dbt_backup"
[0m09:53:07.053417 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_norm_workload__dbt_backup"
[0m09:53:07.054643 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:53:07.055932 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:53:07.056525 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
drop view if exists "postgres"."public"."stg_1c_materials__dbt_backup" cascade
[0m09:53:07.057172 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.013 seconds
[0m09:53:07.057773 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
drop view if exists "postgres"."public"."stg_1c_norm_workload__dbt_backup" cascade
[0m09:53:07.060689 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m09:53:07.062904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38ae6d7a10>]}
[0m09:53:07.063871 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public.stg_1c_journal ........................ [[32mCREATE VIEW[0m in 0.28s]
[0m09:53:07.064843 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m09:53:07.065434 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m09:53:07.066345 [info ] [Thread-1 (]: 5 of 17 START sql view model public.stg_1c_tech ................................ [RUN]
[0m09:53:07.067426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_journal, now model.tsm_dwh.stg_1c_tech)
[0m09:53:07.068236 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m09:53:07.073246 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m09:53:07.074045 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.023 seconds
[0m09:53:07.077022 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: Close
[0m09:53:07.078673 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.017 seconds
[0m09:53:07.080112 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.022 seconds
[0m09:53:07.081568 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a9181f70>]}
[0m09:53:07.084391 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: Close
[0m09:53:07.087250 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: Close
[0m09:53:07.088390 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m09:53:07.089218 [info ] [Thread-4 (]: 4 of 17 OK created sql view model public.stg_1c_pikets ......................... [[32mCREATE VIEW[0m in 0.29s]
[0m09:53:07.090505 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a9035dc0>]}
[0m09:53:07.091973 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a879f560>]}
[0m09:53:07.099071 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m09:53:07.099984 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_pikets
[0m09:53:07.101111 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public.stg_1c_norm_workload .................. [[32mCREATE VIEW[0m in 0.31s]
[0m09:53:07.103699 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_works
[0m09:53:07.102541 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public.stg_1c_materials ...................... [[32mCREATE VIEW[0m in 0.31s]
[0m09:53:07.105904 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_norm_workload
[0m09:53:07.107548 [info ] [Thread-4 (]: 6 of 17 START sql view model public.stg_1c_works ............................... [RUN]
[0m09:53:07.108811 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:53:07.109853 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_materials
[0m09:53:07.110877 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m09:53:07.111530 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_pikets, now model.tsm_dwh.stg_1c_works)
[0m09:53:07.112307 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m09:53:07.113040 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_sat_fact_journal
[0m09:53:07.114416 [info ] [Thread-3 (]: 7 of 17 START sql incremental model public.dv_hub_fact_journal ................. [RUN]
[0m09:53:07.115459 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m09:53:07.116146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:07.117037 [info ] [Thread-2 (]: 8 of 17 START sql incremental model public.dv_sat_fact_journal ................. [RUN]
[0m09:53:07.118003 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_norm_workload, now model.tsm_dwh.dv_hub_fact_journal)
[0m09:53:07.125130 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m09:53:07.126542 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_materials, now model.tsm_dwh.dv_sat_fact_journal)
[0m09:53:07.127760 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m09:53:07.129359 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_sat_fact_journal
[0m09:53:07.135414 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m09:53:07.146980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m09:53:07.150538 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m09:53:07.158628 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_journal"
[0m09:53:07.163497 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m09:53:07.164269 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:53:07.166046 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m09:53:07.167670 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m09:53:07.173597 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:53:07.179507 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m09:53:07.189815 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m09:53:07.190473 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_sat_fact_journal
[0m09:53:07.209442 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:53:07.222801 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:53:07.223363 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:53:07.229357 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech" rename to "stg_1c_tech__dbt_backup"
[0m09:53:07.228799 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m09:53:07.230380 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

    
  
    

  create temporary table "dv_hub_fact_journal__dbt_tmp095307200720"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_journal" target
    where 
        target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_journal 
)

  );
  
  
[0m09:53:07.231999 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

    
  
    

  create temporary table "dv_sat_fact_journal__dbt_tmp095307226417"
  
  
    as
  
  (
    



    WITH active_sat AS (
    SELECT DISTINCT ON (hk_dv_hub_fact_journal) hk_dv_hub_fact_journal, hdiff_dv_sat_fact_journal, loadts
    FROM "postgres"."public"."dv_sat_fact_journal"
    ORDER BY hk_dv_hub_fact_journal, loadts DESC)

    , max_load AS (
    SELECT max(loadts) AS max_loadts
    FROM "postgres"."public"."dv_sat_fact_journal"
    )
    , stage_cte AS (

        SELECT
        s.hk_dv_hub_fact_journal,
        s.hdiff_dv_sat_fact_journal,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_journal) over(PARTITION BY s.hk_dv_hub_fact_journal ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_journal AS sat_hdiff,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_journal,
            s.hdiff_dv_sat_fact_journal,
            s.loadts,
            s.recsource,
            rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
        FROM "postgres"."public"."stg_1c_journal" s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts
        ) s
    LEFT JOIN active_sat a ON a.hk_dv_hub_fact_journal = s.hk_dv_hub_fact_journal)

    SELECT DISTINCT
        hk_dv_hub_fact_journal,
        recsource,
        loadts,
        hdiff_dv_sat_fact_journal,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_journal <> lag_hdiff 
            OR (hdiff_dv_sat_fact_journal <> sat_hdiff AND lag_hdiff IS NULL) 
            OR sat_hdiff IS NULL
    ORDER BY loadts


  );
  
  
[0m09:53:07.232868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:53:07.233396 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:53:07.234045 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:53:07.238007 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:53:07.239692 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech__dbt_tmp" rename to "stg_1c_tech"
[0m09:53:07.241308 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m09:53:07.242161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:53:07.242911 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:53:07.246271 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m09:53:07.247495 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m09:53:07.248507 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:53:07.249810 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m09:53:07.253615 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.020 seconds
[0m09:53:07.254719 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:53:07.264642 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:53:07.265310 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works" rename to "stg_1c_works__dbt_backup"
[0m09:53:07.266310 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m09:53:07.270640 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_tech__dbt_backup"
[0m09:53:07.271341 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:53:07.282006 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:53:07.282874 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.049 seconds
[0m09:53:07.284173 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:53:07.288156 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:53:07.289028 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: BEGIN
[0m09:53:07.293704 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m09:53:07.294353 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
drop view if exists "postgres"."public"."stg_1c_tech__dbt_backup" cascade
[0m09:53:07.295005 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works__dbt_tmp" rename to "stg_1c_works"
[0m09:53:07.295781 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_journal: BEGIN
[0m09:53:07.296392 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:53:07.297338 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m09:53:07.298301 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:53:07.298881 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:53:07.299498 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m09:53:07.301955 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m09:53:07.302563 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal__dbt_tmp095307200720'
        
      order by ordinal_position

  
[0m09:53:07.303396 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_journal__dbt_tmp095307226417'
        
      order by ordinal_position

  
[0m09:53:07.303952 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:53:07.304754 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m09:53:07.306383 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.009 seconds
[0m09:53:07.309341 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m09:53:07.310600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a8725010>]}
[0m09:53:07.311754 [debug] [Thread-2 (]: SQL status: SELECT 33 in 0.007 seconds
[0m09:53:07.313394 [info ] [Thread-1 (]: 5 of 17 OK created sql view model public.stg_1c_tech ........................... [[32mCREATE VIEW[0m in 0.24s]
[0m09:53:07.314400 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.010 seconds
[0m09:53:07.322152 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m09:53:07.323543 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m09:53:07.324392 [debug] [Thread-4 (]: SQL status: COMMIT in 0.019 seconds
[0m09:53:07.330797 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:53:07.331505 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:53:07.332315 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_msat_fact_pikets
[0m09:53:07.336147 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."stg_1c_works__dbt_backup"
[0m09:53:07.337140 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:53:07.339707 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:53:07.338140 [info ] [Thread-1 (]: 9 of 17 START sql incremental model public.dv_msat_fact_pikets ................. [RUN]
[0m09:53:07.341948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_msat_fact_pikets)
[0m09:53:07.340845 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
drop view if exists "postgres"."public"."stg_1c_works__dbt_backup" cascade
[0m09:53:07.343951 [debug] [Thread-2 (]: SQL status: SELECT 33 in 0.006 seconds
[0m09:53:07.342912 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_msat_fact_pikets
[0m09:53:07.360775 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.016 seconds
[0m09:53:07.361908 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m09:53:07.362963 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.022 seconds
[0m09:53:07.365217 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: Close
[0m09:53:07.367463 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m09:53:07.373715 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:53:07.374746 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:53:07.375519 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a879f140>]}
[0m09:53:07.376028 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_msat_fact_pikets
[0m09:53:07.376766 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:53:07.378153 [info ] [Thread-4 (]: 6 of 17 OK created sql view model public.stg_1c_works .......................... [[32mCREATE VIEW[0m in 0.26s]
[0m09:53:07.384927 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m09:53:07.385848 [debug] [Thread-2 (]: SQL status: SELECT 33 in 0.008 seconds
[0m09:53:07.387061 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m09:53:07.388747 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */

    
  
    

  create temporary table "dv_msat_fact_pikets__dbt_tmp095307382053"
  
  
    as
  
  (
    


    WITH active_sat AS (
    SELECT *
    FROM (
        SELECT 
            hk_dv_hub_fact_work,
            hdiff_dv_msat_fact_pikets,
            loadts,
            sub_seq,
            COUNT(*) OVER (PARTITION BY hk_dv_hub_fact_work, loadts) AS cnt,
            rank() OVER (
                PARTITION BY hk_dv_hub_fact_work
                ORDER BY loadts DESC
            ) AS rnk
        FROM "postgres"."public"."dv_msat_fact_pikets"
        ) a (
            sat_id,
            sat_hdiff,
            sat_loadts,
            sat_sub_seq,
            sat_count,
            sat_rnk
        )
    WHERE sat_rnk = 1
    ),
    stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS 
                stg_lag_hdiff,
                sat_hdiff,
                sat_count,
                sat_sub_seq,
                sat_rnk
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_pikets,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
                FROM "postgres"."public"."stg_1c_pikets" s
                    CROSS JOIN (
                        SELECT max(loadts) AS max_loadts
                        FROM "postgres"."public"."dv_msat_fact_pikets"
                    ) ml
                WHERE s.loadts > ml.max_loadts
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
        LEFT JOIN active_sat a ON sat_id = stg_id
        AND sat_sub_seq = stg_sub_seq
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count,
                    sat_hdiff,
                    sat_count,
                    sat_sub_seq,
                    sat_rnk
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            OR (
                (
                    stg_hdiff <> sat_hdiff
                    AND stg_lag_hdiff IS NULL
                )
                OR (
                    stg_count <> sat_count
                    AND stg_lag_count IS NULL
                )
            )
    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq


  );
  
  
[0m09:53:07.390557 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.004 seconds
[0m09:53:07.401621 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_msat_norm_workload
[0m09:53:07.407484 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_journal"
[0m09:53:07.408435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:07.411171 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_journal"
[0m09:53:07.412427 [info ] [Thread-4 (]: 10 of 17 START sql incremental model public.dv_msat_norm_workload .............. [RUN]
[0m09:53:07.414281 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:53:07.415176 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m09:53:07.416298 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_works, now model.tsm_dwh.dv_msat_norm_workload)
[0m09:53:07.416946 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      insert into "postgres"."public"."dv_hub_fact_journal" ("hk_dv_hub_fact_journal", "hkcode", "recsource", "loadts", "bk_жуфвр_uuid")
    (
        select "hk_dv_hub_fact_journal", "hkcode", "recsource", "loadts", "bk_жуфвр_uuid"
        from "dv_hub_fact_journal__dbt_tmp095307200720"
    )


  
[0m09:53:07.417753 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      insert into "postgres"."public"."dv_sat_fact_journal" ("hk_dv_hub_fact_journal", "recsource", "loadts", "hdiff_dv_sat_fact_journal", "rabbit_uuid", "rabbit_дата", "проведен", "uuid_жуфвр", "пометка_удаления", "дата", "номер", "территория_value", "территория_codе", "территория_name", "подразделение_value", "подразделение_codе", "подразделение_name", "смена_value", "смена_codе", "смена_name", "прораб_value", "прораб_codе", "прораб_name", "комментарий", "ответственный_value", "ответственный_codе", "ответственный_name", "версия_жуфвр_value", "версия_жуфвр_codе", "версия_жуфвр_name", "направление_деятельности_value", "направление_деятельности_codе", "направление_деятельности_name")
    (
        select "hk_dv_hub_fact_journal", "recsource", "loadts", "hdiff_dv_sat_fact_journal", "rabbit_uuid", "rabbit_дата", "проведен", "uuid_жуфвр", "пометка_удаления", "дата", "номер", "территория_value", "территория_codе", "территория_name", "подразделение_value", "подразделение_codе", "подразделение_name", "смена_value", "смена_codе", "смена_name", "прораб_value", "прораб_codе", "прораб_name", "комментарий", "ответственный_value", "ответственный_codе", "ответственный_name", "версия_жуфвр_value", "версия_жуфвр_codе", "версия_жуфвр_name", "направление_деятельности_value", "направление_деятельности_codе", "направление_деятельности_name"
        from "dv_sat_fact_journal__dbt_tmp095307226417"
    )


  
[0m09:53:07.418696 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_msat_norm_workload
[0m09:53:07.431868 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.012 seconds
[0m09:53:07.432672 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.013 seconds
[0m09:53:07.435414 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m09:53:07.431360 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_norm_workload"
[0m09:53:07.436427 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "hk_dv_hub_fact_work" does not exist
LINE 20:             hk_dv_hub_fact_work,
                     ^

[0m09:53:07.438663 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m09:53:07.439330 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m09:53:07.440480 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_pikets: Close
[0m09:53:07.441162 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:53:07.441992 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m09:53:07.442694 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_msat_norm_workload
[0m09:53:07.448081 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m09:53:07.506335 [debug] [Thread-2 (]: SQL status: COMMIT in 0.057 seconds
[0m09:53:07.509867 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m09:53:07.511045 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_journal: Close
[0m09:53:07.511954 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */

    
  
    

  create temporary table "dv_msat_norm_workload__dbt_tmp095307507303"
  
  
    as
  
  (
    


    WITH active_sat AS (
    SELECT *
    FROM (
        SELECT 
            hk_dv_hub_fact_work,
            hdiff_dv_msat_norm_workload,
            loadts,
            sub_seq,
            COUNT(*) OVER (PARTITION BY hk_dv_hub_fact_work, loadts) AS cnt,
            rank() OVER (
                PARTITION BY hk_dv_hub_fact_work
                ORDER BY loadts DESC
            ) AS rnk
        FROM "postgres"."public"."dv_msat_norm_workload"
        ) a (
            sat_id,
            sat_hdiff,
            sat_loadts,
            sat_sub_seq,
            sat_count,
            sat_rnk
        )
    WHERE sat_rnk = 1
    ),
    stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS 
                stg_lag_hdiff,
                sat_hdiff,
                sat_count,
                sat_sub_seq,
                sat_rnk
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_norm_workload,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
                FROM "postgres"."public"."stg_1c_norm_workload" s
                    CROSS JOIN (
                        SELECT max(loadts) AS max_loadts
                        FROM "postgres"."public"."dv_msat_norm_workload"
                    ) ml
                WHERE s.loadts > ml.max_loadts
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
        LEFT JOIN active_sat a ON sat_id = stg_id
        AND sat_sub_seq = stg_sub_seq
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count,
                    sat_hdiff,
                    sat_count,
                    sat_sub_seq,
                    sat_rnk
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            OR (
                (
                    stg_hdiff <> sat_hdiff
                    AND stg_lag_hdiff IS NULL
                )
                OR (
                    stg_count <> sat_count
                    AND stg_lag_count IS NULL
                )
            )
    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq


  );
  
  
[0m09:53:07.513185 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a867b9b0>]}
[0m09:53:07.514297 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:53:07.515509 [info ] [Thread-2 (]: 8 of 17 OK created sql incremental model public.dv_sat_fact_journal ............ [[32mINSERT 0 0[0m in 0.39s]
[0m09:53:07.517606 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_sat_fact_journal
[0m09:53:07.518445 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_msat_fact_materials
[0m09:53:07.519243 [info ] [Thread-2 (]: 11 of 17 START sql incremental model public.dv_msat_fact_materials ............. [RUN]
[0m09:53:07.520442 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_journal, now model.tsm_dwh.dv_msat_fact_materials)
[0m09:53:07.521208 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_msat_fact_materials
[0m09:53:07.533808 [debug] [Thread-3 (]: SQL status: COMMIT in 0.026 seconds
[0m09:53:07.535933 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m09:53:07.537455 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a8728710>]}
[0m09:53:07.539267 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "hk_dv_hub_fact_work" does not exist
LINE 20:             hk_dv_hub_fact_work,
                     ^

[0m09:53:07.540754 [info ] [Thread-3 (]: 7 of 17 OK created sql incremental model public.dv_hub_fact_journal ............ [[32mINSERT 0 0[0m in 0.42s]
[0m09:53:07.533217 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_materials"
[0m09:53:07.542506 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_norm_workload: Close
[0m09:53:07.543234 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m09:53:07.544403 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m09:53:07.548343 [info ] [Thread-3 (]: 12 of 17 START sql incremental model public.dv_hub_tech ........................ [RUN]
[0m09:53:07.549780 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_fact_journal, now model.tsm_dwh.dv_hub_tech)
[0m09:53:07.550979 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_msat_fact_materials
[0m09:53:07.551775 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m09:53:07.560582 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m09:53:07.565747 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m09:53:07.566764 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */

    
  
    

  create temporary table "dv_msat_fact_materials__dbt_tmp095307556671"
  
  
    as
  
  (
    


    WITH active_sat AS (
    SELECT *
    FROM (
        SELECT 
            hk_dv_hub_fact_work,
            hdiff_dv_msat_fact_materials,
            loadts,
            sub_seq,
            COUNT(*) OVER (PARTITION BY hk_dv_hub_fact_work, loadts) AS cnt,
            rank() OVER (
                PARTITION BY hk_dv_hub_fact_work
                ORDER BY loadts DESC
            ) AS rnk
        FROM "postgres"."public"."dv_msat_fact_materials"
        ) a (
            sat_id,
            sat_hdiff,
            sat_loadts,
            sat_sub_seq,
            sat_count,
            sat_rnk
        )
    WHERE sat_rnk = 1
    ),
    stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS 
                stg_lag_hdiff,
                sat_hdiff,
                sat_count,
                sat_sub_seq,
                sat_rnk
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_materials,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
                FROM "postgres"."public"."stg_1c_materials" s
                    CROSS JOIN (
                        SELECT max(loadts) AS max_loadts
                        FROM "postgres"."public"."dv_msat_fact_materials"
                    ) ml
                WHERE s.loadts > ml.max_loadts
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
        LEFT JOIN active_sat a ON sat_id = stg_id
        AND sat_sub_seq = stg_sub_seq
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count,
                    sat_hdiff,
                    sat_count,
                    sat_sub_seq,
                    sat_rnk
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            OR (
                (
                    stg_hdiff <> sat_hdiff
                    AND stg_lag_hdiff IS NULL
                )
                OR (
                    stg_count <> sat_count
                    AND stg_lag_count IS NULL
                )
            )
    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq


  );
  
  
[0m09:53:07.568472 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:53:07.570221 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m09:53:07.581063 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:53:07.582056 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

    
  
    

  create temporary table "dv_hub_tech__dbt_tmp095307575373"
  
  
    as
  
  (
    

SELECT distinct on (bk_ресурс_uuid)
        hk_dv_hub_tech,
        hkcode,
        recsource,
        loadts,
        bk_ресурс_uuid
FROM "postgres"."public"."stg_1c_tech" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_tech" target
    where 
        target.hk_dv_hub_tech = stg.hk_dv_hub_tech 
)

  );
  
  
[0m09:53:07.583438 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:53:07.586690 [debug] [Thread-4 (]: Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  column "hk_dv_hub_fact_work" does not exist
  LINE 20:             hk_dv_hub_fact_work,
                       ^
[0m09:53:07.587728 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a8729400>]}
[0m09:53:07.588764 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "hk_dv_hub_fact_work" does not exist
LINE 20:             hk_dv_hub_fact_work,
                     ^

[0m09:53:07.590055 [error] [Thread-4 (]: 10 of 17 ERROR creating sql incremental model public.dv_msat_norm_workload ..... [[31mERROR[0m in 0.17s]
[0m09:53:07.592167 [debug] [Thread-1 (]: Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  column "hk_dv_hub_fact_work" does not exist
  LINE 20:             hk_dv_hub_fact_work,
                       ^
[0m09:53:07.593131 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_materials: Close
[0m09:53:07.594378 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_msat_norm_workload
[0m09:53:07.595441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a9180440>]}
[0m09:53:07.601330 [debug] [Thread-2 (]: Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  column "hk_dv_hub_fact_work" does not exist
  LINE 20:             hk_dv_hub_fact_work,
                       ^
[0m09:53:07.602138 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.019 seconds
[0m09:53:07.603082 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:53:07.604447 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_norm_workload' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  column "hk_dv_hub_fact_work" does not exist
  LINE 20:             hk_dv_hub_fact_work,
                       ^.
[0m09:53:07.605955 [error] [Thread-1 (]: 9 of 17 ERROR creating sql incremental model public.dv_msat_fact_pikets ........ [[31mERROR[0m in 0.25s]
[0m09:53:07.607405 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a90d8800>]}
[0m09:53:07.613668 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:53:07.614889 [info ] [Thread-4 (]: 13 of 17 START sql incremental model public.dv_lnk_fact_work_tech .............. [RUN]
[0m09:53:07.616899 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_msat_fact_pikets
[0m09:53:07.617863 [error] [Thread-2 (]: 11 of 17 ERROR creating sql incremental model public.dv_msat_fact_materials .... [[31mERROR[0m in 0.09s]
[0m09:53:07.618770 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: BEGIN
[0m09:53:07.619667 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_norm_workload, now model.tsm_dwh.dv_lnk_fact_work_tech)
[0m09:53:07.620525 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_sat_fact_tech
[0m09:53:07.621895 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_fact_pikets' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  column "hk_dv_hub_fact_work" does not exist
  LINE 20:             hk_dv_hub_fact_work,
                       ^.
[0m09:53:07.623112 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_msat_fact_materials
[0m09:53:07.624056 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:53:07.624796 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m09:53:07.625468 [info ] [Thread-1 (]: 14 of 17 START sql incremental model public.dv_sat_fact_tech ................... [RUN]
[0m09:53:07.626352 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m09:53:07.632641 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_fact_materials' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  column "hk_dv_hub_fact_work" does not exist
  LINE 20:             hk_dv_hub_fact_work,
                       ^.
[0m09:53:07.634108 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:53:07.634885 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:53:07.636133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_pikets, now model.tsm_dwh.dv_sat_fact_tech)
[0m09:53:07.637338 [info ] [Thread-2 (]: 15 of 17 START sql incremental model public.dv_hub_fact_work ................... [RUN]
[0m09:53:07.638724 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech__dbt_tmp095307575373'
        
      order by ordinal_position

  
[0m09:53:07.639846 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_sat_fact_tech
[0m09:53:07.640683 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_materials, now model.tsm_dwh.dv_hub_fact_work)
[0m09:53:07.647542 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m09:53:07.641233 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:53:07.658661 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m09:53:07.660123 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_tech"
[0m09:53:07.660804 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.019 seconds
[0m09:53:07.667305 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:53:07.668370 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m09:53:07.674914 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

    
  
    

  create temporary table "dv_lnk_fact_work_tech__dbt_tmp095307664652"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_work,
	hk_dv_hub_tech)
        hk_dv_lnk_fact_work_tech,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_work,
	hk_dv_hub_tech
FROM "postgres"."public"."stg_1c_tech" stg


where not exists (
    select 1
    from "postgres"."public"."dv_lnk_fact_work_tech" target
    where 
        target.hk_dv_lnk_fact_work_tech = stg.hk_dv_lnk_fact_work_tech 
)

  );
  
  
[0m09:53:07.676029 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_sat_fact_tech
[0m09:53:07.678297 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:53:07.684668 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:53:07.685370 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:53:07.690663 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m09:53:07.691405 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:53:07.692063 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

    
  
    

  create temporary table "dv_hub_fact_work__dbt_tmp095307681914"
  
  
    as
  
  (
    

SELECT distinct on (bk_работа_uuid)
        hk_dv_hub_fact_work,
        hkcode,
        recsource,
        loadts,
        bk_работа_uuid
FROM "postgres"."public"."stg_1c_works" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_work" target
    where 
        target.hk_dv_hub_fact_work = stg.hk_dv_hub_fact_work 
)

  );
  
  
[0m09:53:07.693188 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

    
  
    

  create temporary table "dv_sat_fact_tech__dbt_tmp095307688152"
  
  
    as
  
  (
    



    WITH active_sat AS (
    SELECT DISTINCT ON (hk_dv_lnk_fact_work_tech) hk_dv_lnk_fact_work_tech, hdiff_dv_sat_fact_tech, loadts
    FROM "postgres"."public"."dv_sat_fact_tech"
    ORDER BY hk_dv_lnk_fact_work_tech, loadts DESC)

    , max_load AS (
    SELECT max(loadts) AS max_loadts
    FROM "postgres"."public"."dv_sat_fact_tech"
    )
    , stage_cte AS (

        SELECT
        s.hk_dv_lnk_fact_work_tech,
        s.hdiff_dv_sat_fact_tech,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_tech) over(PARTITION BY s.hk_dv_lnk_fact_work_tech ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_tech AS sat_hdiff,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name

    FROM
        (SELECT
            s.hk_dv_lnk_fact_work_tech,
            s.hdiff_dv_sat_fact_tech,
            s.loadts,
            s.recsource,
            примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
        FROM "postgres"."public"."stg_1c_tech" s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts
        ) s
    LEFT JOIN active_sat a ON a.hk_dv_lnk_fact_work_tech = s.hk_dv_lnk_fact_work_tech)

    SELECT DISTINCT
        hk_dv_lnk_fact_work_tech,
        recsource,
        loadts,
        hdiff_dv_sat_fact_tech,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_tech <> lag_hdiff 
            OR (hdiff_dv_sat_fact_tech <> sat_hdiff AND lag_hdiff IS NULL) 
            OR sat_hdiff IS NULL
    ORDER BY loadts


  );
  
  
[0m09:53:07.694227 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:53:07.695303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:07.699523 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.005 seconds
[0m09:53:07.706058 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:53:07.707327 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:53:07.712850 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.004 seconds
[0m09:53:07.714198 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.020 seconds
[0m09:53:07.714814 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.029 seconds
[0m09:53:07.718233 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_tech"
[0m09:53:07.718991 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.024 seconds
[0m09:53:07.722486 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:53:07.725978 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:53:07.729857 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m09:53:07.730641 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: BEGIN
[0m09:53:07.731496 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:53:07.732004 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: BEGIN
[0m09:53:07.732645 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_tech: BEGIN
[0m09:53:07.733328 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      insert into "postgres"."public"."dv_hub_tech" ("hk_dv_hub_tech", "hkcode", "recsource", "loadts", "bk_ресурс_uuid")
    (
        select "hk_dv_hub_tech", "hkcode", "recsource", "loadts", "bk_ресурс_uuid"
        from "dv_hub_tech__dbt_tmp095307575373"
    )


  
[0m09:53:07.733998 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m09:53:07.735024 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m09:53:07.735710 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:53:07.736323 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m09:53:07.736853 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m09:53:07.737380 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m09:53:07.737988 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work__dbt_tmp095307681914'
        
      order by ordinal_position

  
[0m09:53:07.738573 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:53:07.740703 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m09:53:07.741346 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_tech__dbt_tmp095307688152'
        
      order by ordinal_position

  
[0m09:53:07.742189 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech__dbt_tmp095307664652'
        
      order by ordinal_position

  
[0m09:53:07.743243 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:53:07.744087 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m09:53:07.750641 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.007 seconds
[0m09:53:07.751354 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.009 seconds
[0m09:53:07.755216 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:53:07.755977 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m09:53:07.759625 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:53:07.760220 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.016 seconds
[0m09:53:07.760892 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:53:07.761962 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: Close
[0m09:53:07.762585 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:53:07.766989 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m09:53:07.768356 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a87c3ec0>]}
[0m09:53:07.769301 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:53:07.770696 [info ] [Thread-3 (]: 12 of 17 OK created sql incremental model public.dv_hub_tech ................... [[32mINSERT 0 0[0m in 0.22s]
[0m09:53:07.772409 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m09:53:07.773206 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.004 seconds
[0m09:53:07.773879 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.006 seconds
[0m09:53:07.774863 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:53:07.775665 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.004 seconds
[0m09:53:07.783849 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:53:07.790500 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:53:07.791416 [info ] [Thread-3 (]: 16 of 17 START sql incremental model public.dv_lnk_fact_journal_fact_work ...... [RUN]
[0m09:53:07.797950 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:53:07.797109 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m09:53:07.799936 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:53:07.801282 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_tech, now model.tsm_dwh.dv_lnk_fact_journal_fact_work)
[0m09:53:07.802410 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:53:07.803309 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:53:07.810318 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:53:07.811489 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.007 seconds
[0m09:53:07.812118 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.009 seconds
[0m09:53:07.812972 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.011 seconds
[0m09:53:07.818246 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_tech"
[0m09:53:07.822751 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:53:07.823496 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:53:07.826133 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_work"
[0m09:53:07.827694 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:53:07.835023 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:53:07.836046 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m09:53:07.837062 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      insert into "postgres"."public"."dv_lnk_fact_work_tech" ("hk_dv_lnk_fact_work_tech", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_work", "hk_dv_hub_tech")
    (
        select "hk_dv_lnk_fact_work_tech", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_work", "hk_dv_hub_tech"
        from "dv_lnk_fact_work_tech__dbt_tmp095307664652"
    )


  
[0m09:53:07.837886 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:53:07.838523 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

    
  
    

  create temporary table "dv_lnk_fact_journal_fact_work__dbt_tmp095307832430"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work)
        hk_dv_lnk_fact_journal_fact_work,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work
FROM "postgres"."public"."stg_1c_works" stg


where not exists (
    select 1
    from "postgres"."public"."dv_lnk_fact_journal_fact_work" target
    where 
        target.hk_dv_lnk_fact_journal_fact_work = stg.hk_dv_lnk_fact_journal_fact_work 
)

  );
  
  
[0m09:53:07.839089 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      insert into "postgres"."public"."dv_sat_fact_tech" ("hk_dv_lnk_fact_work_tech", "recsource", "loadts", "hdiff_dv_sat_fact_tech", "примечание", "госномер_техника_не_найдена", "количество", "часы", "ресурс_value", "ресурс_codе", "ресурс_name", "аналитика_codе", "аналитика_name", "контрагент_value", "контрагент_codе", "контрагент_name")
    (
        select "hk_dv_lnk_fact_work_tech", "recsource", "loadts", "hdiff_dv_sat_fact_tech", "примечание", "госномер_техника_не_найдена", "количество", "часы", "ресурс_value", "ресурс_codе", "ресурс_name", "аналитика_codе", "аналитика_name", "контрагент_value", "контрагент_codе", "контрагент_name"
        from "dv_sat_fact_tech__dbt_tmp095307688152"
    )


  
[0m09:53:07.839904 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      insert into "postgres"."public"."dv_hub_fact_work" ("hk_dv_hub_fact_work", "hkcode", "recsource", "loadts", "bk_работа_uuid")
    (
        select "hk_dv_hub_fact_work", "hkcode", "recsource", "loadts", "bk_работа_uuid"
        from "dv_hub_fact_work__dbt_tmp095307681914"
    )


  
[0m09:53:07.840588 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:53:07.841232 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m09:53:07.842365 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m09:53:07.846119 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m09:53:07.847035 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.005 seconds
[0m09:53:07.849885 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m09:53:07.850887 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:53:07.853141 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m09:53:07.853805 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:53:07.854540 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m09:53:07.855450 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m09:53:07.856088 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.016 seconds
[0m09:53:07.856722 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m09:53:07.857355 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m09:53:07.861473 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:53:07.862812 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: BEGIN
[0m09:53:07.864074 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m09:53:07.864747 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:53:07.865340 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work__dbt_tmp095307832430'
        
      order by ordinal_position

  
[0m09:53:07.869553 [debug] [Thread-4 (]: SQL status: COMMIT in 0.012 seconds
[0m09:53:07.870700 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: Close
[0m09:53:07.871610 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a862d550>]}
[0m09:53:07.872628 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.007 seconds
[0m09:53:07.873483 [info ] [Thread-4 (]: 13 of 17 OK created sql incremental model public.dv_lnk_fact_work_tech ......... [[32mINSERT 0 0[0m in 0.25s]
[0m09:53:07.877521 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:53:07.878557 [debug] [Thread-2 (]: SQL status: COMMIT in 0.016 seconds
[0m09:53:07.879174 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m09:53:07.880398 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:53:07.881223 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:53:07.882379 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: Close
[0m09:53:07.883805 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_tech: Close
[0m09:53:07.884756 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_sat_fact_work
[0m09:53:07.885832 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a91695b0>]}
[0m09:53:07.887048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a91a4fe0>]}
[0m09:53:07.888364 [info ] [Thread-4 (]: 17 of 17 START sql incremental model public.dv_sat_fact_work ................... [RUN]
[0m09:53:07.889957 [info ] [Thread-2 (]: 15 of 17 OK created sql incremental model public.dv_hub_fact_work .............. [[32mINSERT 0 0[0m in 0.25s]
[0m09:53:07.891135 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.006 seconds
[0m09:53:07.892650 [info ] [Thread-1 (]: 14 of 17 OK created sql incremental model public.dv_sat_fact_tech .............. [[32mINSERT 0 0[0m in 0.25s]
[0m09:53:07.893852 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_lnk_fact_work_tech, now model.tsm_dwh.dv_sat_fact_work)
[0m09:53:07.895315 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m09:53:07.902985 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:53:07.904390 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_sat_fact_tech
[0m09:53:07.905376 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_sat_fact_work
[0m09:53:07.906471 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:53:07.914802 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_work"
[0m09:53:07.916327 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_sat_fact_work
[0m09:53:07.922706 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.009 seconds
[0m09:53:07.922201 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m09:53:07.927372 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:53:07.928595 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

    
  
    

  create temporary table "dv_sat_fact_work__dbt_tmp095307919570"
  
  
    as
  
  (
    



    WITH active_sat AS (
    SELECT DISTINCT ON (hk_dv_hub_fact_work) hk_dv_hub_fact_work, hdiff_dv_sat_fact_work, loadts
    FROM "postgres"."public"."dv_sat_fact_work"
    ORDER BY hk_dv_hub_fact_work, loadts DESC)

    , max_load AS (
    SELECT max(loadts) AS max_loadts
    FROM "postgres"."public"."dv_sat_fact_work"
    )
    , stage_cte AS (

        SELECT
        s.hk_dv_hub_fact_work,
        s.hdiff_dv_sat_fact_work,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_work) over(PARTITION BY s.hk_dv_hub_fact_work ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_work AS sat_hdiff,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_work,
            s.hdiff_dv_sat_fact_work,
            s.loadts,
            s.recsource,
            идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
        FROM "postgres"."public"."stg_1c_works" s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts
        ) s
    LEFT JOIN active_sat a ON a.hk_dv_hub_fact_work = s.hk_dv_hub_fact_work)

    SELECT DISTINCT
        hk_dv_hub_fact_work,
        recsource,
        loadts,
        hdiff_dv_sat_fact_work,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_work <> lag_hdiff 
            OR (hdiff_dv_sat_fact_work <> sat_hdiff AND lag_hdiff IS NULL) 
            OR sat_hdiff IS NULL
    ORDER BY loadts


  );
  
  
[0m09:53:07.929828 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:53:07.931044 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:53:07.932327 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      insert into "postgres"."public"."dv_lnk_fact_journal_fact_work" ("hk_dv_lnk_fact_journal_fact_work", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_journal", "hk_dv_hub_fact_work")
    (
        select "hk_dv_lnk_fact_journal_fact_work", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_journal", "hk_dv_hub_fact_work"
        from "dv_lnk_fact_journal_fact_work__dbt_tmp095307832430"
    )


  
[0m09:53:07.933544 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m09:53:07.937106 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m09:53:07.937993 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:53:07.938755 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m09:53:07.946803 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m09:53:07.948857 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: Close
[0m09:53:07.949786 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.020 seconds
[0m09:53:07.951262 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a87db650>]}
[0m09:53:07.959726 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m09:53:07.960843 [info ] [Thread-3 (]: 16 of 17 OK created sql incremental model public.dv_lnk_fact_journal_fact_work . [[32mINSERT 0 0[0m in 0.15s]
[0m09:53:07.961701 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: BEGIN
[0m09:53:07.962966 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:53:07.964406 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m09:53:07.964959 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m09:53:07.965574 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_work__dbt_tmp095307919570'
        
      order by ordinal_position

  
[0m09:53:07.972717 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.006 seconds
[0m09:53:07.978160 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m09:53:07.978914 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:53:07.983055 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.003 seconds
[0m09:53:07.989177 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m09:53:07.989862 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m09:53:07.993078 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.003 seconds
[0m09:53:07.996508 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_work"
[0m09:53:07.997486 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m09:53:07.998074 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      insert into "postgres"."public"."dv_sat_fact_work" ("hk_dv_hub_fact_work", "recsource", "loadts", "hdiff_dv_sat_fact_work", "идентификатор", "объем_работы", "примечание", "кв", "пометка_удаления", "тип_spider", "структура_работ_value", "структура_работ_codе", "структура_работ_name", "видработ_value", "видработ_codе", "видработ_name")
    (
        select "hk_dv_hub_fact_work", "recsource", "loadts", "hdiff_dv_sat_fact_work", "идентификатор", "объем_работы", "примечание", "кв", "пометка_удаления", "тип_spider", "структура_работ_value", "структура_работ_codе", "структура_работ_name", "видработ_value", "видработ_codе", "видработ_name"
        from "dv_sat_fact_work__dbt_tmp095307919570"
    )


  
[0m09:53:07.999130 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m09:53:08.001511 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m09:53:08.002069 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m09:53:08.002620 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m09:53:08.010855 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m09:53:08.012322 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: Close
[0m09:53:08.013428 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2086b9e-7175-437e-893b-3b654a05d91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38ab1c7fb0>]}
[0m09:53:08.014713 [info ] [Thread-4 (]: 17 of 17 OK created sql incremental model public.dv_sat_fact_work .............. [[32mINSERT 0 0[0m in 0.12s]
[0m09:53:08.015540 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_sat_fact_work
[0m09:53:08.017482 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:08.017980 [debug] [MainThread]: On master: BEGIN
[0m09:53:08.018468 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:53:08.028000 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:53:08.028621 [debug] [MainThread]: On master: COMMIT
[0m09:53:08.029129 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:08.029669 [debug] [MainThread]: On master: COMMIT
[0m09:53:08.030294 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:53:08.030760 [debug] [MainThread]: On master: Close
[0m09:53:08.031391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:08.031824 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_tech' was properly closed.
[0m09:53:08.032241 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_work' was properly closed.
[0m09:53:08.032787 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work' was properly closed.
[0m09:53:08.033532 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_work' was properly closed.
[0m09:53:08.034342 [info ] [MainThread]: 
[0m09:53:08.035063 [info ] [MainThread]: Finished running 11 incremental models, 6 view models in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m09:53:08.039852 [debug] [MainThread]: Command end result
[0m09:53:08.082525 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m09:53:08.085232 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m09:53:08.094009 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m09:53:08.095083 [info ] [MainThread]: 
[0m09:53:08.095929 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m09:53:08.096650 [info ] [MainThread]: 
[0m09:53:08.097504 [error] [MainThread]:   Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  column "hk_dv_hub_fact_work" does not exist
  LINE 20:             hk_dv_hub_fact_work,
                       ^
[0m09:53:08.098656 [info ] [MainThread]: 
[0m09:53:08.099986 [error] [MainThread]:   Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  column "hk_dv_hub_fact_work" does not exist
  LINE 20:             hk_dv_hub_fact_work,
                       ^
[0m09:53:08.100886 [info ] [MainThread]: 
[0m09:53:08.102167 [error] [MainThread]:   Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  column "hk_dv_hub_fact_work" does not exist
  LINE 20:             hk_dv_hub_fact_work,
                       ^
[0m09:53:08.103281 [info ] [MainThread]: 
[0m09:53:08.104314 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=3 SKIP=0 TOTAL=17
[0m09:53:08.106500 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.139963, "process_in_blocks": "152", "process_kernel_time": 0.263289, "process_mem_max_rss": "122724", "process_out_blocks": "3256", "process_user_time": 3.451922}
[0m09:53:08.107870 [debug] [MainThread]: Command `dbt build` failed at 09:53:08.107588 after 2.14 seconds
[0m09:53:08.109150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a8722660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a87c3bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38a87c2e40>]}
[0m09:53:08.110130 [debug] [MainThread]: Flushing usage events
[0m09:53:09.135306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:54:08.409121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd274e63530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2742b7d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd272c46180>]}


============================== 09:54:08.412968 | 37c16f4b-899e-44e1-8c0d-fccb77e96c1b ==============================
[0m09:54:08.412968 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:54:08.413932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:54:08.593022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd272a41820>]}
[0m09:54:08.659873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2732e18e0>]}
[0m09:54:08.660865 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:54:08.779824 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:54:08.870166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:54:08.870710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:54:08.899268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27230e4e0>]}
[0m09:54:08.970766 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m09:54:08.973434 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m09:54:09.001182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270b127e0>]}
[0m09:54:09.001940 [info ] [MainThread]: Found 17 models, 433 macros
[0m09:54:09.005079 [info ] [MainThread]: 
[0m09:54:09.005730 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:54:09.006291 [info ] [MainThread]: 
[0m09:54:09.007076 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:54:09.014951 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m09:54:09.066842 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m09:54:09.067401 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m09:54:09.067863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:09.081707 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.014 seconds
[0m09:54:09.083324 [debug] [ThreadPool]: On list_postgres: Close
[0m09:54:09.087310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m09:54:09.094541 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m09:54:09.095076 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m09:54:09.095611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:54:09.104061 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m09:54:09.104710 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m09:54:09.105170 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:54:09.108707 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.003 seconds
[0m09:54:09.110687 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m09:54:09.111293 [debug] [ThreadPool]: On list_postgres_public: Close
[0m09:54:09.119770 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:09.120295 [debug] [MainThread]: On master: BEGIN
[0m09:54:09.120740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:54:09.129185 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m09:54:09.129811 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:09.130398 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:54:09.136311 [debug] [MainThread]: SQL status: SELECT 7 in 0.005 seconds
[0m09:54:09.139487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270735dc0>]}
[0m09:54:09.140117 [debug] [MainThread]: On master: ROLLBACK
[0m09:54:09.140764 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:09.141181 [debug] [MainThread]: On master: BEGIN
[0m09:54:09.141852 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:54:09.142622 [debug] [MainThread]: On master: COMMIT
[0m09:54:09.143478 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:09.143995 [debug] [MainThread]: On master: COMMIT
[0m09:54:09.144998 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:54:09.145555 [debug] [MainThread]: On master: Close
[0m09:54:09.148918 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m09:54:09.150963 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_materials
[0m09:54:09.151933 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_norm_workload
[0m09:54:09.150140 [info ] [Thread-1 (]: 1 of 17 START sql view model public.stg_1c_journal ............................. [RUN]
[0m09:54:09.156227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m09:54:09.157411 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m09:54:09.154941 [info ] [Thread-3 (]: 3 of 17 START sql view model public.stg_1c_norm_workload ....................... [RUN]
[0m09:54:09.153321 [info ] [Thread-2 (]: 2 of 17 START sql view model public.stg_1c_materials ........................... [RUN]
[0m09:54:09.153840 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_pikets
[0m09:54:09.169288 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_norm_workload'
[0m09:54:09.174805 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m09:54:09.176029 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_materials'
[0m09:54:09.177336 [info ] [Thread-4 (]: 4 of 17 START sql view model public.stg_1c_pikets .............................. [RUN]
[0m09:54:09.178557 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_norm_workload
[0m09:54:09.179627 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_materials
[0m09:54:09.180866 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_pikets'
[0m09:54:09.185673 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_norm_workload"
[0m09:54:09.186350 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m09:54:09.190002 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_materials"
[0m09:54:09.191096 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_pikets
[0m09:54:09.208093 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_norm_workload
[0m09:54:09.223954 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_pikets"
[0m09:54:09.250564 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_materials
[0m09:54:09.273158 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_pikets
[0m09:54:09.272437 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_norm_workload"
[0m09:54:09.276038 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m09:54:09.276885 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_materials"
[0m09:54:09.281232 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_pikets"
[0m09:54:09.282773 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:54:09.283616 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:54:09.284358 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: BEGIN
[0m09:54:09.285099 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m09:54:09.285880 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:54:09.286412 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:54:09.286928 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:54:09.287668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:09.288332 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: BEGIN
[0m09:54:09.289172 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: BEGIN
[0m09:54:09.290345 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:54:09.291459 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:54:09.301846 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m09:54:09.302740 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:54:09.303805 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */

  create view "postgres"."public"."stg_1c_norm_workload__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(Период::varchar, 'N\A')) || '|' || TRIM(COALESCE(РассчетныйОбъем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьНормативная::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьФактическая::varchar, 'N\A')) || '|' || TRIM(COALESCE(НаемныйРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(НесколькоКлючевыхРесурсов::varchar, 'N\A')) || '|' || TRIM(COALESCE(ЖУФВР::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючДокументаРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_norm_workload,
	Период::timestamptz,
	РассчетныйОбъем::numeric,
	ТрудоемкостьНормативная::numeric,
	ТрудоемкостьФактическая::numeric,
	НаемныйРесурс::bool,
	КлючевойРесурс_value::uuid,
	КлючевойРесурс_codе::varchar,
	КлючевойРесурс_name::varchar,
	НесколькоКлючевыхРесурсов::bool,
	ЖУФВР::uuid,
	КлючДокументаРесурс::uuid,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	РесурсSpider_value::uuid,
	РесурсSpider_codе::varchar,
	РесурсSpider_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar
    FROM 
        src_norm_workload
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name)
  );
[0m09:54:09.304659 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m09:54:09.305629 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:54:09.306527 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m09:54:09.307598 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m09:54:09.308934 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m09:54:09.309849 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:54:09.310645 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:54:09.311396 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:54:09.321209 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:54:09.322109 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */

  create view "postgres"."public"."stg_1c_materials__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(НомерСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемМатериала::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_materials,
	НомерСтроки::int,
	Примечание::varchar,
	ОбъемМатериала::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar
    FROM 
        src_materials
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name)
  );
[0m09:54:09.322785 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m09:54:09.323515 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */

  create view "postgres"."public"."stg_1c_pikets__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(КлючСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетС::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеС::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(Объем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_pikets,
	КлючСтроки::uuid,
	ПикетС::numeric,
	ПикетПо::numeric,
	СмещениеС::numeric,
	СмещениеПо::numeric,
	Объем::numeric,
	ВидПикета_value::uuid,
	ВидПикета_codе::varchar,
	ВидПикета_name::varchar,
	ТипПикета_value::uuid,
	ТипПикета_codе::varchar,
	ТипПикета_name::varchar,
	ГруппаПикетовSpider_value::uuid,
	ГруппаПикетовSpider_codе::varchar,
	ГруппаПикетовSpider_name::varchar
    FROM 
        src_pikets
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name)
  );
[0m09:54:09.324344 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload" rename to "stg_1c_norm_workload__dbt_backup"
[0m09:54:09.328819 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:54:09.329505 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:54:09.330344 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m09:54:09.334443 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:54:09.335017 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:54:09.335585 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:54:09.336312 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials" rename to "stg_1c_materials__dbt_backup"
[0m09:54:09.337337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:54:09.340741 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:54:09.344547 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:54:09.349494 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:54:09.350290 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload__dbt_tmp" rename to "stg_1c_norm_workload"
[0m09:54:09.350836 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:54:09.351513 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets" rename to "stg_1c_pikets__dbt_backup"
[0m09:54:09.352285 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m09:54:09.356188 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:54:09.356873 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:54:09.357683 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials__dbt_tmp" rename to "stg_1c_materials"
[0m09:54:09.358658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:54:09.364782 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m09:54:09.376128 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:54:09.379852 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m09:54:09.382023 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m09:54:09.385824 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:54:09.387930 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m09:54:09.388599 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:54:09.389270 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:54:09.389942 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets__dbt_tmp" rename to "stg_1c_pikets"
[0m09:54:09.390488 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:54:09.391135 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m09:54:09.391782 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m09:54:09.392589 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m09:54:09.393314 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:54:09.397340 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m09:54:09.397915 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:54:09.398431 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m09:54:09.409062 [debug] [Thread-3 (]: SQL status: COMMIT in 0.016 seconds
[0m09:54:09.416706 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_norm_workload__dbt_backup"
[0m09:54:09.423523 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m09:54:09.424153 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
drop view if exists "postgres"."public"."stg_1c_norm_workload__dbt_backup" cascade
[0m09:54:09.441553 [debug] [Thread-2 (]: SQL status: COMMIT in 0.047 seconds
[0m09:54:09.442450 [debug] [Thread-1 (]: SQL status: COMMIT in 0.049 seconds
[0m09:54:09.443213 [debug] [Thread-4 (]: SQL status: COMMIT in 0.044 seconds
[0m09:54:09.446540 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_materials__dbt_backup"
[0m09:54:09.449525 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m09:54:09.452413 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."stg_1c_pikets__dbt_backup"
[0m09:54:09.453875 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m09:54:09.455543 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m09:54:09.456889 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m09:54:09.457519 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
drop view if exists "postgres"."public"."stg_1c_materials__dbt_backup" cascade
[0m09:54:09.458047 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m09:54:09.458754 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
drop view if exists "postgres"."public"."stg_1c_pikets__dbt_backup" cascade
[0m09:54:09.498490 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.073 seconds
[0m09:54:09.501652 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: Close
[0m09:54:09.503648 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd274f4b830>]}
[0m09:54:09.504577 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public.stg_1c_norm_workload .................. [[32mCREATE VIEW[0m in 0.33s]
[0m09:54:09.505498 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_norm_workload
[0m09:54:09.506068 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m09:54:09.506908 [info ] [Thread-3 (]: 5 of 17 START sql view model public.stg_1c_tech ................................ [RUN]
[0m09:54:09.507896 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_norm_workload, now model.tsm_dwh.stg_1c_tech)
[0m09:54:09.508666 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m09:54:09.513515 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m09:54:09.514135 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.055 seconds
[0m09:54:09.514662 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.055 seconds
[0m09:54:09.515399 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.056 seconds
[0m09:54:09.518851 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: Close
[0m09:54:09.521427 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m09:54:09.522211 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m09:54:09.523934 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: Close
[0m09:54:09.525141 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26f945be0>]}
[0m09:54:09.531520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26c811610>]}
[0m09:54:09.536142 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m09:54:09.537224 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26f9457f0>]}
[0m09:54:09.538166 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public.stg_1c_materials ...................... [[32mCREATE VIEW[0m in 0.35s]
[0m09:54:09.539401 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public.stg_1c_journal ........................ [[32mCREATE VIEW[0m in 0.38s]
[0m09:54:09.540805 [info ] [Thread-4 (]: 4 of 17 OK created sql view model public.stg_1c_pikets ......................... [[32mCREATE VIEW[0m in 0.36s]
[0m09:54:09.542359 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_materials
[0m09:54:09.543466 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m09:54:09.544866 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_pikets
[0m09:54:09.545758 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:54:09.546751 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_works
[0m09:54:09.547982 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_msat_norm_workload
[0m09:54:09.548887 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_msat_fact_materials
[0m09:54:09.549959 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m09:54:09.550810 [info ] [Thread-2 (]: 6 of 17 START sql view model public.stg_1c_works ............................... [RUN]
[0m09:54:09.551852 [info ] [Thread-1 (]: 7 of 17 START sql incremental model public.dv_msat_norm_workload ............... [RUN]
[0m09:54:09.554272 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:54:09.555307 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_materials, now model.tsm_dwh.stg_1c_works)
[0m09:54:09.553319 [info ] [Thread-4 (]: 8 of 17 START sql incremental model public.dv_msat_fact_materials .............. [RUN]
[0m09:54:09.556457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_journal, now model.tsm_dwh.dv_msat_norm_workload)
[0m09:54:09.557584 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m09:54:09.558790 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_pikets, now model.tsm_dwh.dv_msat_fact_materials)
[0m09:54:09.560235 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_msat_norm_workload
[0m09:54:09.567754 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_msat_fact_materials
[0m09:54:09.573809 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m09:54:09.580420 [debug] [Thread-3 (]: SQL status: BEGIN in 0.026 seconds
[0m09:54:09.586139 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_norm_workload"
[0m09:54:09.592189 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_materials"
[0m09:54:09.593097 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:54:09.594015 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m09:54:09.595527 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m09:54:09.596934 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_msat_fact_materials
[0m09:54:09.597956 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_msat_norm_workload
[0m09:54:09.602831 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m09:54:09.624512 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m09:54:09.628934 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:54:09.629592 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech" rename to "stg_1c_tech__dbt_backup"
[0m09:54:09.639108 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:54:09.678639 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m09:54:09.684389 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:54:09.684981 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.045 seconds
[0m09:54:09.689453 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_materials"
[0m09:54:09.693076 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_norm_workload"
[0m09:54:09.697687 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:54:09.698773 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech__dbt_tmp" rename to "stg_1c_tech"
[0m09:54:09.699369 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m09:54:09.700002 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_fact_materials: BEGIN
[0m09:54:09.700705 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:54:09.701286 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:54:09.701991 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m09:54:09.704709 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m09:54:09.705373 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m09:54:09.706146 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_norm_workload: BEGIN
[0m09:54:09.707076 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:54:09.708183 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:54:09.709074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:09.709785 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m09:54:09.710845 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m09:54:09.715557 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:54:09.720214 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:54:09.720851 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works" rename to "stg_1c_works__dbt_backup"
[0m09:54:09.721517 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m09:54:09.722340 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:54:09.722903 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m09:54:09.723425 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m09:54:09.724005 [debug] [Thread-3 (]: SQL status: COMMIT in 0.012 seconds
[0m09:54:09.727412 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:54:09.728076 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */

      
  
    

  create  table "postgres"."public"."dv_msat_fact_materials"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_materials,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
                FROM "postgres"."public"."stg_1c_materials" s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            
            OR stg_lag_hdiff IS null

    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
    FROM stage_cte s (hk_dv_hub_fact_work, recsource, loadts, hdiff_dv_msat_fact_materials, sub_seq, номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name)
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m09:54:09.728928 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m09:54:09.732748 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_tech__dbt_backup"
[0m09:54:09.733403 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works__dbt_tmp" rename to "stg_1c_works"
[0m09:54:09.734500 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */

      
  
    

  create  table "postgres"."public"."dv_msat_norm_workload"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_norm_workload,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
                FROM "postgres"."public"."stg_1c_norm_workload" s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            
            OR stg_lag_hdiff IS null

    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
    FROM stage_cte s (hk_dv_hub_fact_work, recsource, loadts, hdiff_dv_msat_norm_workload, sub_seq, период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name)
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m09:54:09.735852 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m09:54:09.736475 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "stg_id" does not exist
LINE 77:         stg_id,
                 ^

[0m09:54:09.737206 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
drop view if exists "postgres"."public"."stg_1c_tech__dbt_backup" cascade
[0m09:54:09.737875 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:54:09.738495 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_fact_materials: ROLLBACK
[0m09:54:09.739573 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "stg_id" does not exist
LINE 105:         stg_id,
                  ^

[0m09:54:09.742185 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m09:54:09.742937 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_norm_workload: ROLLBACK
[0m09:54:09.743674 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_fact_materials: Close
[0m09:54:09.744291 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:54:09.745138 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m09:54:09.746055 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_norm_workload: Close
[0m09:54:09.755987 [debug] [Thread-1 (]: Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  column "stg_id" does not exist
  LINE 105:         stg_id,
                    ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_norm_workload.sql
[0m09:54:09.756893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26c703770>]}
[0m09:54:09.758458 [debug] [Thread-4 (]: Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  column "stg_id" does not exist
  LINE 77:         stg_id,
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_materials.sql
[0m09:54:09.759236 [error] [Thread-1 (]: 7 of 17 ERROR creating sql incremental model public.dv_msat_norm_workload ...... [[31mERROR[0m in 0.20s]
[0m09:54:09.760014 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26c759850>]}
[0m09:54:09.760939 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_msat_norm_workload
[0m09:54:09.761811 [error] [Thread-4 (]: 8 of 17 ERROR creating sql incremental model public.dv_msat_fact_materials ..... [[31mERROR[0m in 0.20s]
[0m09:54:09.762716 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m09:54:09.763548 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_norm_workload' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  column "stg_id" does not exist
  LINE 105:         stg_id,
                    ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_norm_workload.sql.
[0m09:54:09.764207 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_msat_fact_materials
[0m09:54:09.765050 [info ] [Thread-1 (]: 9 of 17 START sql incremental model public.dv_hub_fact_journal ................. [RUN]
[0m09:54:09.766111 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.026 seconds
[0m09:54:09.766959 [debug] [Thread-2 (]: SQL status: COMMIT in 0.020 seconds
[0m09:54:09.768413 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_msat_fact_pikets
[0m09:54:09.769186 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_fact_materials' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  column "stg_id" does not exist
  LINE 77:         stg_id,
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_materials.sql.
[0m09:54:09.769789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_norm_workload, now model.tsm_dwh.dv_hub_fact_journal)
[0m09:54:09.771521 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m09:54:09.777022 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_works__dbt_backup"
[0m09:54:09.778303 [info ] [Thread-4 (]: 10 of 17 START sql incremental model public.dv_msat_fact_pikets ................ [RUN]
[0m09:54:09.779626 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m09:54:09.781082 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26c70b740>]}
[0m09:54:09.783413 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m09:54:09.784690 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_materials, now model.tsm_dwh.dv_msat_fact_pikets)
[0m09:54:09.791235 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m09:54:09.792382 [info ] [Thread-3 (]: 5 of 17 OK created sql view model public.stg_1c_tech ........................... [[32mCREATE VIEW[0m in 0.27s]
[0m09:54:09.793391 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
drop view if exists "postgres"."public"."stg_1c_works__dbt_backup" cascade
[0m09:54:09.793941 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_msat_fact_pikets
[0m09:54:09.794928 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m09:54:09.795647 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m09:54:09.804795 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m09:54:09.805762 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_sat_fact_journal
[0m09:54:09.812167 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_journal"
[0m09:54:09.812804 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.017 seconds
[0m09:54:09.814304 [info ] [Thread-3 (]: 11 of 17 START sql incremental model public.dv_sat_fact_journal ................ [RUN]
[0m09:54:09.815827 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_msat_fact_pikets
[0m09:54:09.819314 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: Close
[0m09:54:09.820552 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_sat_fact_journal)
[0m09:54:09.826896 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:54:09.827705 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m09:54:09.828381 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_sat_fact_journal
[0m09:54:09.829374 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26c8ac530>]}
[0m09:54:09.830510 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: BEGIN
[0m09:54:09.839685 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_journal"
[0m09:54:09.841132 [info ] [Thread-2 (]: 6 of 17 OK created sql view model public.stg_1c_works .......................... [[32mCREATE VIEW[0m in 0.27s]
[0m09:54:09.842132 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m09:54:09.842873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:09.844044 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m09:54:09.844719 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_fact_pikets: BEGIN
[0m09:54:09.845333 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_sat_fact_journal
[0m09:54:09.846366 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m09:54:09.847544 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:54:09.856178 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_journal"
[0m09:54:09.857111 [info ] [Thread-2 (]: 12 of 17 START sql incremental model public.dv_hub_tech ........................ [RUN]
[0m09:54:09.859035 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m09:54:09.860287 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_works, now model.tsm_dwh.dv_hub_tech)
[0m09:54:09.861088 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:54:09.861922 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m09:54:09.862657 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m09:54:09.863550 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      
  
    

  create  table "postgres"."public"."dv_hub_fact_journal"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal" stg


  );
  
  
[0m09:54:09.864567 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_journal: BEGIN
[0m09:54:09.872905 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m09:54:09.873820 [debug] [Thread-4 (]: SQL status: BEGIN in 0.026 seconds
[0m09:54:09.874541 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:54:09.875408 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m09:54:09.876368 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m09:54:09.887124 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_tech"
[0m09:54:09.888924 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */

      
  
    

  create  table "postgres"."public"."dv_msat_fact_pikets"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_pikets,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
                FROM "postgres"."public"."stg_1c_pikets" s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            
            OR stg_lag_hdiff IS null

    )

    SELECT DISTINCT 
        stg_id,
        stg_recsource,
        stg_loadts,
        stg_hdiff,
        stg_sub_seq,
        ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
    FROM stage_cte s (hk_dv_hub_fact_work, recsource, loadts, hdiff_dv_msat_fact_pikets, sub_seq, ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name)
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m09:54:09.891103 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m09:54:09.891928 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m09:54:09.892573 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m09:54:09.893387 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "stg_id" does not exist
LINE 95:         stg_id,
                 ^

[0m09:54:09.901785 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m09:54:09.902962 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:54:09.904082 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_journal"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_hub_fact_journal,
        s.hdiff_dv_sat_fact_journal,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_journal) over(PARTITION BY s.hk_dv_hub_fact_journal ORDER BY s.loadts) AS lag_hdiff,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_journal,
            s.hdiff_dv_sat_fact_journal,
            s.loadts,
            s.recsource,
            rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
        FROM "postgres"."public"."stg_1c_journal" s
        ) s
    )

    SELECT DISTINCT
        hk_dv_hub_fact_journal,
        recsource,
        loadts,
        hdiff_dv_sat_fact_journal,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_journal <> lag_hdiff 
        OR lag_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m09:54:09.904929 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_fact_pikets: ROLLBACK
[0m09:54:09.905535 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m09:54:09.906210 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: BEGIN
[0m09:54:09.907208 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m09:54:09.907900 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_fact_pikets: Close
[0m09:54:09.908457 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:54:09.914484 [debug] [Thread-4 (]: Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  column "stg_id" does not exist
  LINE 95:         stg_id,
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_pikets.sql
[0m09:54:09.915514 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26c605820>]}
[0m09:54:09.916683 [error] [Thread-4 (]: 10 of 17 ERROR creating sql incremental model public.dv_msat_fact_pikets ....... [[31mERROR[0m in 0.13s]
[0m09:54:09.917884 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_msat_fact_pikets
[0m09:54:09.918907 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:54:09.919798 [info ] [Thread-4 (]: 13 of 17 START sql incremental model public.dv_lnk_fact_work_tech .............. [RUN]
[0m09:54:09.920718 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_fact_pikets' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  column "stg_id" does not exist
  LINE 95:         stg_id,
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_pikets.sql.
[0m09:54:09.921525 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_pikets, now model.tsm_dwh.dv_lnk_fact_work_tech)
[0m09:54:09.922468 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m09:54:09.923628 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:54:09.924363 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m09:54:09.925296 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m09:54:09.932070 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:54:09.932677 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:54:09.933764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26c604b60>]}
[0m09:54:09.935109 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      
  
    

  create  table "postgres"."public"."dv_hub_tech"
  
  
    as
  
  (
    

SELECT distinct on (bk_ресурс_uuid)
        hk_dv_hub_tech,
        hkcode,
        recsource,
        loadts,
        bk_ресурс_uuid
FROM "postgres"."public"."stg_1c_tech" stg


  );
  
  
[0m09:54:09.936313 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.029 seconds
[0m09:54:09.937844 [info ] [Thread-1 (]: 9 of 17 OK created sql incremental model public.dv_hub_fact_journal ............ [[32mSELECT 1[0m in 0.16s]
[0m09:54:09.939136 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:54:09.944054 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m09:54:09.945799 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m09:54:10.010008 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:54:10.010691 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.070 seconds
[0m09:54:10.011338 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m09:54:10.011946 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_sat_fact_tech
[0m09:54:10.014365 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m09:54:10.015120 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m09:54:10.015860 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:54:10.016588 [info ] [Thread-1 (]: 14 of 17 START sql incremental model public.dv_sat_fact_tech ................... [RUN]
[0m09:54:10.017435 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m09:54:10.018413 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: BEGIN
[0m09:54:10.019591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_fact_journal, now model.tsm_dwh.dv_sat_fact_tech)
[0m09:54:10.020267 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m09:54:10.021073 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:54:10.021889 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_sat_fact_tech
[0m09:54:10.032536 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_tech"
[0m09:54:10.033395 [debug] [Thread-3 (]: SQL status: COMMIT in 0.015 seconds
[0m09:54:10.035500 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_journal: Close
[0m09:54:10.037187 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_sat_fact_tech
[0m09:54:10.038348 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26c605af0>]}
[0m09:54:10.039340 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m09:54:10.045876 [info ] [Thread-3 (]: 11 of 17 OK created sql incremental model public.dv_sat_fact_journal ........... [[32mSELECT 1[0m in 0.22s]
[0m09:54:10.047426 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_tech"
[0m09:54:10.047991 [debug] [Thread-2 (]: SQL status: COMMIT in 0.025 seconds
[0m09:54:10.048764 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:54:10.049849 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_sat_fact_journal
[0m09:54:10.051641 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: Close
[0m09:54:10.052747 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      
  
    

  create  table "postgres"."public"."dv_lnk_fact_work_tech"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_work,
	hk_dv_hub_tech)
        hk_dv_lnk_fact_work_tech,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_work,
	hk_dv_hub_tech
FROM "postgres"."public"."stg_1c_tech" stg


  );
  
  
[0m09:54:10.053883 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m09:54:10.054812 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m09:54:10.055893 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_tech: BEGIN
[0m09:54:10.057604 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26c622a80>]}
[0m09:54:10.059500 [info ] [Thread-3 (]: 15 of 17 START sql incremental model public.dv_hub_fact_work ................... [RUN]
[0m09:54:10.060956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:10.062047 [info ] [Thread-2 (]: 12 of 17 OK created sql incremental model public.dv_hub_tech ................... [[32mSELECT 17[0m in 0.20s]
[0m09:54:10.063172 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_journal, now model.tsm_dwh.dv_hub_fact_work)
[0m09:54:10.064754 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m09:54:10.065960 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m09:54:10.067683 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:54:10.074491 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m09:54:10.075499 [info ] [Thread-2 (]: 16 of 17 START sql incremental model public.dv_lnk_fact_journal_fact_work ...... [RUN]
[0m09:54:10.076483 [debug] [Thread-4 (]: SQL status: SELECT 63 in 0.021 seconds
[0m09:54:10.077189 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m09:54:10.078036 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_tech, now model.tsm_dwh.dv_lnk_fact_journal_fact_work)
[0m09:54:10.081797 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m09:54:10.082553 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m09:54:10.083201 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m09:54:10.084084 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:54:10.085352 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m09:54:10.093229 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_work"
[0m09:54:10.093986 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_tech"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_lnk_fact_work_tech,
        s.hdiff_dv_sat_fact_tech,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_tech) over(PARTITION BY s.hk_dv_lnk_fact_work_tech ORDER BY s.loadts) AS lag_hdiff,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name

    FROM
        (SELECT
            s.hk_dv_lnk_fact_work_tech,
            s.hdiff_dv_sat_fact_tech,
            s.loadts,
            s.recsource,
            примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
        FROM "postgres"."public"."stg_1c_tech" s
        ) s
    )

    SELECT DISTINCT
        hk_dv_lnk_fact_work_tech,
        recsource,
        loadts,
        hdiff_dv_sat_fact_tech,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_tech <> lag_hdiff 
        OR lag_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m09:54:10.098551 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:54:10.099191 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m09:54:10.100528 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:54:10.109463 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:54:10.110455 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:54:10.111465 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: BEGIN
[0m09:54:10.112197 [debug] [Thread-4 (]: SQL status: COMMIT in 0.012 seconds
[0m09:54:10.112897 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:54:10.113424 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:54:10.114610 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: Close
[0m09:54:10.115209 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: BEGIN
[0m09:54:10.116244 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:54:10.118489 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26c607290>]}
[0m09:54:10.120312 [info ] [Thread-4 (]: 13 of 17 OK created sql incremental model public.dv_lnk_fact_work_tech ......... [[32mSELECT 63[0m in 0.20s]
[0m09:54:10.121501 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m09:54:10.122301 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_sat_fact_work
[0m09:54:10.123227 [info ] [Thread-4 (]: 17 of 17 START sql incremental model public.dv_sat_fact_work ................... [RUN]
[0m09:54:10.124238 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_lnk_fact_work_tech, now model.tsm_dwh.dv_sat_fact_work)
[0m09:54:10.125056 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_sat_fact_work
[0m09:54:10.132134 [debug] [Thread-1 (]: SQL status: SELECT 63 in 0.032 seconds
[0m09:54:10.135966 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m09:54:10.139000 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_work"
[0m09:54:10.139935 [debug] [Thread-2 (]: SQL status: BEGIN in 0.024 seconds
[0m09:54:10.140780 [debug] [Thread-3 (]: SQL status: BEGIN in 0.027 seconds
[0m09:54:10.141493 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m09:54:10.142337 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:54:10.143031 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:54:10.143922 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m09:54:10.144957 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_lnk_fact_journal_fact_work"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work)
        hk_dv_lnk_fact_journal_fact_work,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work
FROM "postgres"."public"."stg_1c_works" stg


  );
  
  
[0m09:54:10.145629 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_sat_fact_work
[0m09:54:10.146331 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_hub_fact_work"
  
  
    as
  
  (
    

SELECT distinct on (bk_работа_uuid)
        hk_dv_hub_fact_work,
        hkcode,
        recsource,
        loadts,
        bk_работа_uuid
FROM "postgres"."public"."stg_1c_works" stg


  );
  
  
[0m09:54:10.155900 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_work"
[0m09:54:10.157078 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m09:54:10.157764 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m09:54:10.158379 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: BEGIN
[0m09:54:10.159758 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_tech: Close
[0m09:54:10.160370 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:54:10.161538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26c73b920>]}
[0m09:54:10.163168 [info ] [Thread-1 (]: 14 of 17 OK created sql incremental model public.dv_sat_fact_tech .............. [[32mSELECT 63[0m in 0.14s]
[0m09:54:10.164660 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_sat_fact_tech
[0m09:54:10.170062 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m09:54:10.171109 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m09:54:10.172352 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_work"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_hub_fact_work,
        s.hdiff_dv_sat_fact_work,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_work) over(PARTITION BY s.hk_dv_hub_fact_work ORDER BY s.loadts) AS lag_hdiff,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_work,
            s.hdiff_dv_sat_fact_work,
            s.loadts,
            s.recsource,
            идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
        FROM "postgres"."public"."stg_1c_works" s
        ) s
    )

    SELECT DISTINCT
        hk_dv_hub_fact_work,
        recsource,
        loadts,
        hdiff_dv_sat_fact_work,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_work <> lag_hdiff 
        OR lag_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m09:54:10.173583 [debug] [Thread-2 (]: SQL status: SELECT 22 in 0.026 seconds
[0m09:54:10.177795 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m09:54:10.178831 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m09:54:10.179662 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m09:54:10.188409 [debug] [Thread-3 (]: SQL status: SELECT 22 in 0.032 seconds
[0m09:54:10.191109 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m09:54:10.191747 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m09:54:10.192283 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m09:54:10.200790 [debug] [Thread-4 (]: SQL status: SELECT 22 in 0.027 seconds
[0m09:54:10.203265 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m09:54:10.203899 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m09:54:10.204423 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m09:54:10.212439 [debug] [Thread-3 (]: SQL status: COMMIT in 0.019 seconds
[0m09:54:10.213328 [debug] [Thread-2 (]: SQL status: COMMIT in 0.033 seconds
[0m09:54:10.214350 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: Close
[0m09:54:10.215381 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: Close
[0m09:54:10.216381 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26f950e90>]}
[0m09:54:10.217175 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26f9514c0>]}
[0m09:54:10.218782 [info ] [Thread-2 (]: 16 of 17 OK created sql incremental model public.dv_lnk_fact_journal_fact_work . [[32mSELECT 22[0m in 0.14s]
[0m09:54:10.221063 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m09:54:10.219864 [info ] [Thread-3 (]: 15 of 17 OK created sql incremental model public.dv_hub_fact_work .............. [[32mSELECT 22[0m in 0.15s]
[0m09:54:10.222623 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m09:54:10.223289 [debug] [Thread-4 (]: SQL status: COMMIT in 0.018 seconds
[0m09:54:10.224720 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: Close
[0m09:54:10.225625 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c16f4b-899e-44e1-8c0d-fccb77e96c1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26f9509e0>]}
[0m09:54:10.227483 [info ] [Thread-4 (]: 17 of 17 OK created sql incremental model public.dv_sat_fact_work .............. [[32mSELECT 22[0m in 0.10s]
[0m09:54:10.229117 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_sat_fact_work
[0m09:54:10.232154 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:10.232873 [debug] [MainThread]: On master: BEGIN
[0m09:54:10.233474 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:54:10.243658 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:54:10.244352 [debug] [MainThread]: On master: COMMIT
[0m09:54:10.244936 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:10.245450 [debug] [MainThread]: On master: COMMIT
[0m09:54:10.246059 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:54:10.246563 [debug] [MainThread]: On master: Close
[0m09:54:10.247166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:54:10.247607 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_tech' was properly closed.
[0m09:54:10.248021 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_work' was properly closed.
[0m09:54:10.248446 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work' was properly closed.
[0m09:54:10.248858 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_work' was properly closed.
[0m09:54:10.249597 [info ] [MainThread]: 
[0m09:54:10.250490 [info ] [MainThread]: Finished running 11 incremental models, 6 view models in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m09:54:10.257454 [debug] [MainThread]: Command end result
[0m09:54:10.297863 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m09:54:10.299804 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m09:54:10.309903 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m09:54:10.310627 [info ] [MainThread]: 
[0m09:54:10.311291 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m09:54:10.311872 [info ] [MainThread]: 
[0m09:54:10.312587 [error] [MainThread]:   Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  column "stg_id" does not exist
  LINE 105:         stg_id,
                    ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_norm_workload.sql
[0m09:54:10.313116 [info ] [MainThread]: 
[0m09:54:10.313840 [error] [MainThread]:   Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  column "stg_id" does not exist
  LINE 77:         stg_id,
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_materials.sql
[0m09:54:10.314530 [info ] [MainThread]: 
[0m09:54:10.315382 [error] [MainThread]:   Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  column "stg_id" does not exist
  LINE 95:         stg_id,
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_msat_fact_pikets.sql
[0m09:54:10.315918 [info ] [MainThread]: 
[0m09:54:10.316756 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=3 SKIP=0 TOTAL=17
[0m09:54:10.318979 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.9653331, "process_in_blocks": "0", "process_kernel_time": 0.270932, "process_mem_max_rss": "123092", "process_out_blocks": "3472", "process_user_time": 3.198368}
[0m09:54:10.320173 [debug] [MainThread]: Command `dbt build` failed at 09:54:10.319944 after 1.97 seconds
[0m09:54:10.321164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2733ae870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27230e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd272b08890>]}
[0m09:54:10.322146 [debug] [MainThread]: Flushing usage events
[0m09:54:11.701914 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:10:36.621185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbe5c8b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbc3a6a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbbf04920>]}


============================== 10:10:36.625124 | c7575e3a-4be2-40b9-83f9-dc646274c790 ==============================
[0m10:10:36.625124 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:10:36.626115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m10:10:36.804609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbc8f0680>]}
[0m10:10:36.871701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbbe0da90>]}
[0m10:10:36.872712 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:10:36.991843 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:10:37.083225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:10:37.083830 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:10:37.113363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbb302510>]}
[0m10:10:37.185412 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m10:10:37.188099 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m10:10:37.216496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dba306600>]}
[0m10:10:37.217219 [info ] [MainThread]: Found 17 models, 433 macros
[0m10:10:37.220363 [info ] [MainThread]: 
[0m10:10:37.220949 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:10:37.221462 [info ] [MainThread]: 
[0m10:10:37.222216 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:10:37.232157 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:10:37.282685 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:10:37.283245 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:10:37.283758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:37.295051 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.011 seconds
[0m10:10:37.296749 [debug] [ThreadPool]: On list_postgres: Close
[0m10:10:37.300703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m10:10:37.307545 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:10:37.308058 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m10:10:37.308600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:10:37.316824 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:10:37.317365 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:10:37.317859 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:10:37.321051 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.003 seconds
[0m10:10:37.323032 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m10:10:37.323698 [debug] [ThreadPool]: On list_postgres_public: Close
[0m10:10:37.333101 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:37.333635 [debug] [MainThread]: On master: BEGIN
[0m10:10:37.334064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:10:37.342719 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:10:37.343225 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:37.343802 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:10:37.351160 [debug] [MainThread]: SQL status: SELECT 7 in 0.007 seconds
[0m10:10:37.354357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbb6bbd70>]}
[0m10:10:37.354942 [debug] [MainThread]: On master: ROLLBACK
[0m10:10:37.355623 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:37.356074 [debug] [MainThread]: On master: BEGIN
[0m10:10:37.356990 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:10:37.357565 [debug] [MainThread]: On master: COMMIT
[0m10:10:37.358028 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:37.358534 [debug] [MainThread]: On master: COMMIT
[0m10:10:37.359126 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:10:37.359633 [debug] [MainThread]: On master: Close
[0m10:10:37.363069 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m10:10:37.363777 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_materials
[0m10:10:37.364362 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_norm_workload
[0m10:10:37.365445 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_pikets
[0m10:10:37.364969 [info ] [Thread-1 (]: 1 of 17 START sql view model public.stg_1c_journal ............................. [RUN]
[0m10:10:37.366856 [info ] [Thread-2 (]: 2 of 17 START sql view model public.stg_1c_materials ........................... [RUN]
[0m10:10:37.367736 [info ] [Thread-3 (]: 3 of 17 START sql view model public.stg_1c_norm_workload ....................... [RUN]
[0m10:10:37.368752 [info ] [Thread-4 (]: 4 of 17 START sql view model public.stg_1c_pikets .............................. [RUN]
[0m10:10:37.369811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m10:10:37.370621 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_materials'
[0m10:10:37.371909 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_norm_workload'
[0m10:10:37.373250 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_pikets'
[0m10:10:37.373957 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m10:10:37.374522 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_materials
[0m10:10:37.375022 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_norm_workload
[0m10:10:37.375575 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_pikets
[0m10:10:37.390485 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_materials"
[0m10:10:37.392483 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m10:10:37.398438 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_norm_workload"
[0m10:10:37.402295 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_pikets"
[0m10:10:37.403794 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_materials
[0m10:10:37.404570 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_norm_workload
[0m10:10:37.405122 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m10:10:37.447671 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_pikets
[0m10:10:37.468886 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m10:10:37.469412 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_materials"
[0m10:10:37.471169 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_norm_workload"
[0m10:10:37.476335 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_pikets"
[0m10:10:37.478214 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:10:37.479290 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m10:10:37.480019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:37.480974 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:10:37.481970 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:10:37.482918 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:10:37.483838 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: BEGIN
[0m10:10:37.484961 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: BEGIN
[0m10:10:37.485882 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: BEGIN
[0m10:10:37.486668 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:10:37.487396 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:10:37.487974 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:10:37.493769 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m10:10:37.494603 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:10:37.495689 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m10:10:37.501045 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m10:10:37.502218 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:10:37.502972 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:10:37.503884 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */

  create view "postgres"."public"."stg_1c_norm_workload__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(Период::varchar, 'N\A')) || '|' || TRIM(COALESCE(РассчетныйОбъем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьНормативная::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьФактическая::varchar, 'N\A')) || '|' || TRIM(COALESCE(НаемныйРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(НесколькоКлючевыхРесурсов::varchar, 'N\A')) || '|' || TRIM(COALESCE(ЖУФВР::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючДокументаРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_norm_workload,
	Период::timestamptz,
	РассчетныйОбъем::numeric,
	ТрудоемкостьНормативная::numeric,
	ТрудоемкостьФактическая::numeric,
	НаемныйРесурс::bool,
	КлючевойРесурс_value::uuid,
	КлючевойРесурс_codе::varchar,
	КлючевойРесурс_name::varchar,
	НесколькоКлючевыхРесурсов::bool,
	ЖУФВР::uuid,
	КлючДокументаРесурс::uuid,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	РесурсSpider_value::uuid,
	РесурсSpider_codе::varchar,
	РесурсSpider_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar
    FROM 
        src_norm_workload
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name)
  );
[0m10:10:37.504662 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m10:10:37.505468 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m10:10:37.513571 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:10:37.514279 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:10:37.514934 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:10:37.515841 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m10:10:37.516890 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */

  create view "postgres"."public"."stg_1c_pikets__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(КлючСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетС::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеС::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(Объем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_pikets,
	КлючСтроки::uuid,
	ПикетС::numeric,
	ПикетПо::numeric,
	СмещениеС::numeric,
	СмещениеПо::numeric,
	Объем::numeric,
	ВидПикета_value::uuid,
	ВидПикета_codе::varchar,
	ВидПикета_name::varchar,
	ТипПикета_value::uuid,
	ТипПикета_codе::varchar,
	ТипПикета_name::varchar,
	ГруппаПикетовSpider_value::uuid,
	ГруппаПикетовSpider_codе::varchar,
	ГруппаПикетовSpider_name::varchar
    FROM 
        src_pikets
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name)
  );
[0m10:10:37.518599 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */

  create view "postgres"."public"."stg_1c_materials__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(НомерСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемМатериала::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_materials,
	НомерСтроки::int,
	Примечание::varchar,
	ОбъемМатериала::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar
    FROM 
        src_materials
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name)
  );
[0m10:10:37.519773 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:10:37.526346 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:10:37.525797 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:10:37.527074 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:10:37.530959 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:10:37.531509 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:10:37.532093 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload" rename to "stg_1c_norm_workload__dbt_backup"
[0m10:10:37.535902 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:10:37.536601 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials" rename to "stg_1c_materials__dbt_backup"
[0m10:10:37.540124 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:10:37.540821 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets" rename to "stg_1c_pikets__dbt_backup"
[0m10:10:37.541479 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:37.542279 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m10:10:37.542908 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:37.547872 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:10:37.548562 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:10:37.552139 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:10:37.552817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:10:37.553378 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload__dbt_tmp" rename to "stg_1c_norm_workload"
[0m10:10:37.556753 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:10:37.557384 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials__dbt_tmp" rename to "stg_1c_materials"
[0m10:10:37.574046 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:10:37.577904 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m10:10:37.578625 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets__dbt_tmp" rename to "stg_1c_pikets"
[0m10:10:37.581148 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m10:10:37.581851 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:10:37.582458 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:10:37.583199 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:10:37.583987 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:37.584528 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m10:10:37.586689 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m10:10:37.587346 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m10:10:37.589316 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m10:10:37.589940 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:10:37.590776 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:10:37.591550 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m10:10:37.592317 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m10:10:37.603550 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m10:10:37.611897 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m10:10:37.618556 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:10:37.619676 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m10:10:37.620400 [debug] [Thread-2 (]: SQL status: COMMIT in 0.027 seconds
[0m10:10:37.620913 [debug] [Thread-3 (]: SQL status: COMMIT in 0.030 seconds
[0m10:10:37.621511 [debug] [Thread-4 (]: SQL status: COMMIT in 0.028 seconds
[0m10:10:37.627317 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_materials__dbt_backup"
[0m10:10:37.632671 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_norm_workload__dbt_backup"
[0m10:10:37.637377 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."stg_1c_pikets__dbt_backup"
[0m10:10:37.639897 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:10:37.641305 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:10:37.641936 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.020 seconds
[0m10:10:37.643044 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:10:37.643717 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
drop view if exists "postgres"."public"."stg_1c_materials__dbt_backup" cascade
[0m10:10:37.644310 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
drop view if exists "postgres"."public"."stg_1c_norm_workload__dbt_backup" cascade
[0m10:10:37.647217 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m10:10:37.648216 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
drop view if exists "postgres"."public"."stg_1c_pikets__dbt_backup" cascade
[0m10:10:37.652249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbe34b920>]}
[0m10:10:37.653383 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public.stg_1c_journal ........................ [[32mCREATE VIEW[0m in 0.28s]
[0m10:10:37.654437 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m10:10:37.655121 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m10:10:37.656119 [info ] [Thread-1 (]: 5 of 17 START sql view model public.stg_1c_tech ................................ [RUN]
[0m10:10:37.657125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_journal, now model.tsm_dwh.stg_1c_tech)
[0m10:10:37.657825 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m10:10:37.663761 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m10:10:37.665110 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m10:10:37.674085 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.025 seconds
[0m10:10:37.674756 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m10:10:37.678423 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: Close
[0m10:10:37.679698 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db8408050>]}
[0m10:10:37.681664 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public.stg_1c_materials ...................... [[32mCREATE VIEW[0m in 0.31s]
[0m10:10:37.683148 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.034 seconds
[0m10:10:37.683845 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.032 seconds
[0m10:10:37.684578 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_materials
[0m10:10:37.685328 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:10:37.687301 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: Close
[0m10:10:37.689845 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: Close
[0m10:10:37.690602 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_works
[0m10:10:37.691372 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m10:10:37.692494 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db8d23ce0>]}
[0m10:10:37.695064 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db842b920>]}
[0m10:10:37.693885 [info ] [Thread-2 (]: 6 of 17 START sql view model public.stg_1c_works ............................... [RUN]
[0m10:10:37.696176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:37.697120 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public.stg_1c_norm_workload .................. [[32mCREATE VIEW[0m in 0.32s]
[0m10:10:37.698392 [info ] [Thread-4 (]: 4 of 17 OK created sql view model public.stg_1c_pikets ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m10:10:37.699357 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_materials, now model.tsm_dwh.stg_1c_works)
[0m10:10:37.700625 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_norm_workload
[0m10:10:37.702260 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_pikets
[0m10:10:37.703055 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m10:10:37.703724 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m10:10:37.704359 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_sat_fact_journal
[0m10:10:37.709148 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m10:10:37.710478 [info ] [Thread-3 (]: 7 of 17 START sql incremental model public.dv_hub_fact_journal ................. [RUN]
[0m10:10:37.711397 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m10:10:37.712529 [info ] [Thread-4 (]: 8 of 17 START sql incremental model public.dv_sat_fact_journal ................. [RUN]
[0m10:10:37.715295 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m10:10:37.714397 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:10:37.713658 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_norm_workload, now model.tsm_dwh.dv_hub_fact_journal)
[0m10:10:37.716487 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_pikets, now model.tsm_dwh.dv_sat_fact_journal)
[0m10:10:37.724979 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m10:10:37.726097 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m10:10:37.726991 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m10:10:37.727548 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_sat_fact_journal
[0m10:10:37.728695 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:10:37.745904 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m10:10:37.746771 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:10:37.747755 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m10:10:37.753154 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m10:10:37.756151 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_journal"
[0m10:10:37.760526 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:10:37.761765 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m10:10:37.762710 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_sat_fact_journal
[0m10:10:37.763635 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech" rename to "stg_1c_tech__dbt_backup"
[0m10:10:37.764190 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m10:10:37.826797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:10:37.836310 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_journal"
[0m10:10:37.841479 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_journal"
[0m10:10:37.842107 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:10:37.845631 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:10:37.847053 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m10:10:37.848647 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:10:37.849403 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech__dbt_tmp" rename to "stg_1c_tech"
[0m10:10:37.850563 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:10:37.851466 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: BEGIN
[0m10:10:37.852486 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: BEGIN
[0m10:10:37.852992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:37.853791 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:10:37.854524 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:10:37.854965 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:10:37.857065 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m10:10:37.861846 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:10:37.862670 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:10:37.863690 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works" rename to "stg_1c_works__dbt_backup"
[0m10:10:37.864763 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m10:10:37.866473 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:37.872377 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m10:10:37.872023 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:10:37.874812 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:10:37.875752 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works__dbt_tmp" rename to "stg_1c_works"
[0m10:10:37.876444 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m10:10:37.877334 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_journal__dbt_tmp"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_hub_fact_journal,
        s.hdiff_dv_sat_fact_journal,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_journal) over(PARTITION BY s.hk_dv_hub_fact_journal ORDER BY s.loadts) AS lag_hdiff,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_journal,
            s.hdiff_dv_sat_fact_journal,
            s.loadts,
            s.recsource,
            rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
        FROM "postgres"."public"."stg_1c_journal" s
        ) s
    )

    SELECT DISTINCT
        hk_dv_hub_fact_journal,
        recsource,
        loadts,
        hdiff_dv_sat_fact_journal,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_journal <> lag_hdiff 
        OR lag_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m10:10:37.878142 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:10:37.878973 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:37.879711 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      
  
    

  create  table "postgres"."public"."dv_hub_fact_journal__dbt_tmp"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal" stg


  );
  
  
[0m10:10:37.883288 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m10:10:37.884324 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m10:10:37.885068 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:10:37.890175 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_tech__dbt_backup"
[0m10:10:37.890889 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m10:10:37.892064 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:10:37.892813 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
drop view if exists "postgres"."public"."stg_1c_tech__dbt_backup" cascade
[0m10:10:37.902379 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.023 seconds
[0m10:10:37.905945 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:10:37.906537 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */
alter table "postgres"."public"."dv_sat_fact_journal" rename to "dv_sat_fact_journal__dbt_backup"
[0m10:10:37.907437 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:10:37.910881 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:10:37.911469 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */
alter table "postgres"."public"."dv_sat_fact_journal__dbt_tmp" rename to "dv_sat_fact_journal"
[0m10:10:37.912274 [debug] [Thread-2 (]: SQL status: COMMIT in 0.019 seconds
[0m10:10:37.912939 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.028 seconds
[0m10:10:37.913430 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:37.916161 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_works__dbt_backup"
[0m10:10:37.919814 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:10:37.925915 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.033 seconds
[0m10:10:37.926585 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m10:10:37.927844 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:10:37.928511 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */
alter table "postgres"."public"."dv_hub_fact_journal" rename to "dv_hub_fact_journal__dbt_backup"
[0m10:10:37.930125 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m10:10:37.930711 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:10:37.931335 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
drop view if exists "postgres"."public"."stg_1c_works__dbt_backup" cascade
[0m10:10:37.932197 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m10:10:37.932995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db8d42e10>]}
[0m10:10:37.933563 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:10:37.934771 [info ] [Thread-1 (]: 5 of 17 OK created sql view model public.stg_1c_tech ........................... [[32mCREATE VIEW[0m in 0.28s]
[0m10:10:37.938592 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:10:37.939488 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m10:10:37.940042 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */
alter table "postgres"."public"."dv_hub_fact_journal__dbt_tmp" rename to "dv_hub_fact_journal"
[0m10:10:37.940760 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_msat_fact_materials
[0m10:10:37.942442 [info ] [Thread-1 (]: 9 of 17 START sql incremental model public.dv_msat_fact_materials .............. [RUN]
[0m10:10:37.943714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_msat_fact_materials)
[0m10:10:37.944645 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:10:37.945889 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_msat_fact_materials
[0m10:10:37.947341 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m10:10:37.951653 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m10:10:37.958849 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.025 seconds
[0m10:10:37.959954 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_materials"
[0m10:10:37.962812 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."dv_sat_fact_journal__dbt_backup"
[0m10:10:37.963401 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:10:37.965903 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: Close
[0m10:10:37.973174 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:10:37.974156 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_msat_fact_materials
[0m10:10:37.974870 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m10:10:37.975628 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */
drop table if exists "postgres"."public"."dv_sat_fact_journal__dbt_backup" cascade
[0m10:10:37.976634 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbbd016a0>]}
[0m10:10:37.983213 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_materials"
[0m10:10:37.985069 [info ] [Thread-2 (]: 6 of 17 OK created sql view model public.stg_1c_works .......................... [[32mCREATE VIEW[0m in 0.28s]
[0m10:10:37.986670 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m10:10:37.987488 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_msat_norm_workload
[0m10:10:37.988789 [info ] [Thread-2 (]: 10 of 17 START sql incremental model public.dv_msat_norm_workload .............. [RUN]
[0m10:10:37.990246 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m10:10:37.991489 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_works, now model.tsm_dwh.dv_msat_norm_workload)
[0m10:10:37.992538 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: BEGIN
[0m10:10:37.993269 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_msat_norm_workload
[0m10:10:37.994034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:37.994800 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m10:10:38.000969 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_norm_workload"
[0m10:10:38.006611 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."dv_hub_fact_journal__dbt_backup"
[0m10:10:38.008938 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:10:38.010101 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */
drop table if exists "postgres"."public"."dv_hub_fact_journal__dbt_backup" cascade
[0m10:10:38.011516 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_msat_norm_workload
[0m10:10:38.018236 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m10:10:38.075163 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.063 seconds
[0m10:10:38.075751 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m10:10:38.076351 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.092 seconds
[0m10:10:38.078110 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m10:10:38.080420 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_norm_workload"
[0m10:10:38.081092 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */

      
  
    

  create  table "postgres"."public"."dv_msat_fact_materials"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_materials,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
                FROM "postgres"."public"."stg_1c_materials" s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            
            OR stg_lag_hdiff IS null

    )

    SELECT DISTINCT 
        stg_id as hk_dv_hub_fact_work,
        stg_recsource as recsource,
        stg_loadts as loadts,
        stg_hdiff as hdiff_dv_msat_fact_materials,
        stg_sub_seq as sub_seq,
        номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m10:10:38.082920 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: Close
[0m10:10:38.084004 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db847b4d0>]}
[0m10:10:38.085547 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db847ae70>]}
[0m10:10:38.087760 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m10:10:38.086779 [info ] [Thread-3 (]: 7 of 17 OK created sql incremental model public.dv_hub_fact_journal ............ [[32mSELECT 1[0m in 0.37s]
[0m10:10:38.089429 [info ] [Thread-4 (]: 8 of 17 OK created sql incremental model public.dv_sat_fact_journal ............ [[32mSELECT 1[0m in 0.37s]
[0m10:10:38.090638 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: BEGIN
[0m10:10:38.091565 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m10:10:38.092784 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_sat_fact_journal
[0m10:10:38.093401 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:10:38.094480 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_msat_fact_pikets
[0m10:10:38.095311 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m10:10:38.096872 [info ] [Thread-3 (]: 11 of 17 START sql incremental model public.dv_msat_fact_pikets ................ [RUN]
[0m10:10:38.098474 [info ] [Thread-4 (]: 12 of 17 START sql incremental model public.dv_hub_tech ........................ [RUN]
[0m10:10:38.100023 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_fact_journal, now model.tsm_dwh.dv_msat_fact_pikets)
[0m10:10:38.101282 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_journal, now model.tsm_dwh.dv_hub_tech)
[0m10:10:38.101991 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_msat_fact_pikets
[0m10:10:38.102833 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m10:10:38.109776 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.025 seconds
[0m10:10:38.114643 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:10:38.119696 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m10:10:38.120435 [debug] [Thread-2 (]: SQL status: BEGIN in 0.027 seconds
[0m10:10:38.122979 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: COMMIT
[0m10:10:38.124354 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m10:10:38.125515 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_msat_fact_pikets
[0m10:10:38.126837 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m10:10:38.127861 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m10:10:38.129470 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */

      
  
    

  create  table "postgres"."public"."dv_msat_norm_workload"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_norm_workload,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
                FROM "postgres"."public"."stg_1c_norm_workload" s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            
            OR stg_lag_hdiff IS null

    )

    SELECT DISTINCT 
        stg_id as hk_dv_hub_fact_work,
        stg_recsource as recsource,
        stg_loadts as loadts,
        stg_hdiff as hdiff_dv_msat_norm_workload,
        stg_sub_seq as sub_seq,
        период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m10:10:38.135739 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:10:38.136369 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: COMMIT
[0m10:10:38.142358 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_tech"
[0m10:10:38.143920 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:10:38.145301 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:10:38.146379 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_pikets: BEGIN
[0m10:10:38.147354 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: BEGIN
[0m10:10:38.148337 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:10:38.148913 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:10:38.155836 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:10:38.157673 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: Close
[0m10:10:38.159336 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m10:10:38.160021 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m10:10:38.160633 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:10:38.161230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db838ce30>]}
[0m10:10:38.161976 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:10:38.162664 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      
  
    

  create  table "postgres"."public"."dv_hub_tech__dbt_tmp"
  
  
    as
  
  (
    

SELECT distinct on (bk_ресурс_uuid)
        hk_dv_hub_tech,
        hkcode,
        recsource,
        loadts,
        bk_ресурс_uuid
FROM "postgres"."public"."stg_1c_tech" stg


  );
  
  
[0m10:10:38.163560 [info ] [Thread-1 (]: 9 of 17 OK created sql incremental model public.dv_msat_fact_materials ......... [[32mSELECT 15[0m in 0.22s]
[0m10:10:38.164491 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */

      
  
    

  create  table "postgres"."public"."dv_msat_fact_pikets"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_pikets,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
                FROM "postgres"."public"."stg_1c_pikets" s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            
            OR stg_lag_hdiff IS null

    )

    SELECT DISTINCT 
        stg_id as hk_dv_hub_fact_work,
        stg_recsource as recsource,
        stg_loadts as loadts,
        stg_hdiff as hdiff_dv_msat_fact_pikets,
        stg_sub_seq as sub_seq,
        ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m10:10:38.165519 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_msat_fact_materials
[0m10:10:38.166332 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m10:10:38.167587 [info ] [Thread-1 (]: 13 of 17 START sql incremental model public.dv_lnk_fact_work_tech .............. [RUN]
[0m10:10:38.168783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_materials, now model.tsm_dwh.dv_lnk_fact_work_tech)
[0m10:10:38.169999 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_work_tech
[0m10:10:38.175838 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:10:38.176530 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.033 seconds
[0m10:10:38.179750 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: COMMIT
[0m10:10:38.181034 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_lnk_fact_work_tech
[0m10:10:38.182194 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m10:10:38.190546 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:10:38.191849 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.027 seconds
[0m10:10:38.193062 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: COMMIT
[0m10:10:38.198947 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:10:38.199912 [debug] [Thread-3 (]: SQL status: SELECT 22 in 0.034 seconds
[0m10:10:38.200682 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */
alter table "postgres"."public"."dv_hub_tech" rename to "dv_hub_tech__dbt_backup"
[0m10:10:38.201838 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:10:38.204450 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_pikets: COMMIT
[0m10:10:38.205212 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: BEGIN
[0m10:10:38.206342 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:38.207032 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:10:38.207833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:38.211658 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:10:38.212345 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_pikets: COMMIT
[0m10:10:38.213393 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */
alter table "postgres"."public"."dv_hub_tech__dbt_tmp" rename to "dv_hub_tech"
[0m10:10:38.214379 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m10:10:38.215668 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: Close
[0m10:10:38.216296 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:38.219918 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m10:10:38.220501 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db84dfb60>]}
[0m10:10:38.221637 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:10:38.223202 [info ] [Thread-2 (]: 10 of 17 OK created sql incremental model public.dv_msat_norm_workload ......... [[32mSELECT 20[0m in 0.23s]
[0m10:10:38.224362 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m10:10:38.224981 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m10:10:38.225703 [debug] [Thread-3 (]: SQL status: COMMIT in 0.012 seconds
[0m10:10:38.226527 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_msat_norm_workload
[0m10:10:38.227304 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:10:38.228422 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_pikets: Close
[0m10:10:38.229217 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_sat_fact_tech
[0m10:10:38.230294 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      
  
    

  create  table "postgres"."public"."dv_lnk_fact_work_tech__dbt_tmp"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_work,
	hk_dv_hub_tech)
        hk_dv_lnk_fact_work_tech,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_work,
	hk_dv_hub_tech
FROM "postgres"."public"."stg_1c_tech" stg


  );
  
  
[0m10:10:38.231640 [info ] [Thread-2 (]: 14 of 17 START sql incremental model public.dv_sat_fact_tech ................... [RUN]
[0m10:10:38.232753 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db84df6b0>]}
[0m10:10:38.233840 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_norm_workload, now model.tsm_dwh.dv_sat_fact_tech)
[0m10:10:38.235071 [info ] [Thread-3 (]: 11 of 17 OK created sql incremental model public.dv_msat_fact_pikets ........... [[32mSELECT 22[0m in 0.13s]
[0m10:10:38.236112 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_sat_fact_tech
[0m10:10:38.237940 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_msat_fact_pikets
[0m10:10:38.239025 [debug] [Thread-4 (]: SQL status: COMMIT in 0.012 seconds
[0m10:10:38.248199 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_tech"
[0m10:10:38.248958 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m10:10:38.254033 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."dv_hub_tech__dbt_backup"
[0m10:10:38.257527 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_sat_fact_tech
[0m10:10:38.256321 [info ] [Thread-3 (]: 15 of 17 START sql incremental model public.dv_hub_fact_work ................... [RUN]
[0m10:10:38.254969 [debug] [Thread-1 (]: SQL status: SELECT 63 in 0.022 seconds
[0m10:10:38.260133 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:10:38.266891 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_tech"
[0m10:10:38.267937 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_pikets, now model.tsm_dwh.dv_hub_fact_work)
[0m10:10:38.273124 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:10:38.274341 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */
drop table if exists "postgres"."public"."dv_hub_tech__dbt_backup" cascade
[0m10:10:38.275250 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m10:10:38.275929 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */
alter table "postgres"."public"."dv_lnk_fact_work_tech" rename to "dv_lnk_fact_work_tech__dbt_backup"
[0m10:10:38.276677 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:10:38.283848 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m10:10:38.285018 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: BEGIN
[0m10:10:38.286362 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:10:38.287393 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:10:38.291976 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:10:38.293070 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.015 seconds
[0m10:10:38.293664 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m10:10:38.294468 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */
alter table "postgres"."public"."dv_lnk_fact_work_tech__dbt_tmp" rename to "dv_lnk_fact_work_tech"
[0m10:10:38.297574 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: Close
[0m10:10:38.304625 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_work"
[0m10:10:38.305374 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:10:38.306116 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m10:10:38.307175 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db8413e60>]}
[0m10:10:38.310511 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m10:10:38.311298 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:10:38.311938 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:10:38.313199 [info ] [Thread-4 (]: 12 of 17 OK created sql incremental model public.dv_hub_tech ................... [[32mSELECT 17[0m in 0.21s]
[0m10:10:38.313886 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:10:38.314499 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_tech__dbt_tmp"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_lnk_fact_work_tech,
        s.hdiff_dv_sat_fact_tech,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_tech) over(PARTITION BY s.hk_dv_lnk_fact_work_tech ORDER BY s.loadts) AS lag_hdiff,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name

    FROM
        (SELECT
            s.hk_dv_lnk_fact_work_tech,
            s.hdiff_dv_sat_fact_tech,
            s.loadts,
            s.recsource,
            примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
        FROM "postgres"."public"."stg_1c_tech" s
        ) s
    )

    SELECT DISTINCT
        hk_dv_lnk_fact_work_tech,
        recsource,
        loadts,
        hdiff_dv_sat_fact_tech,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_tech <> lag_hdiff 
        OR lag_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m10:10:38.315291 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: BEGIN
[0m10:10:38.316124 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m10:10:38.316959 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m10:10:38.317698 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:10:38.318359 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m10:10:38.319986 [info ] [Thread-4 (]: 16 of 17 START sql incremental model public.dv_lnk_fact_journal_fact_work ...... [RUN]
[0m10:10:38.321327 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_tech, now model.tsm_dwh.dv_lnk_fact_journal_fact_work)
[0m10:10:38.322396 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m10:10:38.330171 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:10:38.331397 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:10:38.332194 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m10:10:38.335776 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."dv_lnk_fact_work_tech__dbt_backup"
[0m10:10:38.336671 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:10:38.337390 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m10:10:38.338570 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:10:38.339305 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_hub_fact_work__dbt_tmp"
  
  
    as
  
  (
    

SELECT distinct on (bk_работа_uuid)
        hk_dv_hub_fact_work,
        hkcode,
        recsource,
        loadts,
        bk_работа_uuid
FROM "postgres"."public"."stg_1c_works" stg


  );
  
  
[0m10:10:38.348282 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:10:38.349012 [debug] [Thread-2 (]: SQL status: SELECT 63 in 0.031 seconds
[0m10:10:38.349632 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */
drop table if exists "postgres"."public"."dv_lnk_fact_work_tech__dbt_backup" cascade
[0m10:10:38.350743 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:10:38.355294 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:10:38.356444 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: BEGIN
[0m10:10:38.357610 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */
alter table "postgres"."public"."dv_sat_fact_tech" rename to "dv_sat_fact_tech__dbt_backup"
[0m10:10:38.358777 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:10:38.360425 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:10:38.368019 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:10:38.369351 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */
alter table "postgres"."public"."dv_sat_fact_tech__dbt_tmp" rename to "dv_sat_fact_tech"
[0m10:10:38.370028 [debug] [Thread-3 (]: SQL status: SELECT 22 in 0.020 seconds
[0m10:10:38.370732 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m10:10:38.375629 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:10:38.376273 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:10:38.377154 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:10:38.377805 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */
alter table "postgres"."public"."dv_hub_fact_work" rename to "dv_hub_fact_work__dbt_backup"
[0m10:10:38.380808 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m10:10:38.381482 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.025 seconds
[0m10:10:38.381976 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_lnk_fact_journal_fact_work__dbt_tmp"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work)
        hk_dv_lnk_fact_journal_fact_work,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work
FROM "postgres"."public"."stg_1c_works" stg


  );
  
  
[0m10:10:38.382656 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:10:38.383389 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:38.385298 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: Close
[0m10:10:38.386008 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m10:10:38.391868 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:10:38.393190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db8d41700>]}
[0m10:10:38.394566 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */
alter table "postgres"."public"."dv_hub_fact_work__dbt_tmp" rename to "dv_hub_fact_work"
[0m10:10:38.395674 [info ] [Thread-1 (]: 13 of 17 OK created sql incremental model public.dv_lnk_fact_work_tech ......... [[32mSELECT 63[0m in 0.22s]
[0m10:10:38.397032 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m10:10:38.397808 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:38.398908 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_sat_fact_work
[0m10:10:38.403018 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m10:10:38.405112 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:10:38.405892 [debug] [Thread-4 (]: SQL status: SELECT 22 in 0.020 seconds
[0m10:10:38.406681 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m10:10:38.404398 [info ] [Thread-1 (]: 17 of 17 START sql incremental model public.dv_sat_fact_work ................... [RUN]
[0m10:10:38.412473 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:10:38.413480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_lnk_fact_work_tech, now model.tsm_dwh.dv_sat_fact_work)
[0m10:10:38.414249 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */
alter table "postgres"."public"."dv_lnk_fact_journal_fact_work" rename to "dv_lnk_fact_journal_fact_work__dbt_backup"
[0m10:10:38.415359 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_sat_fact_work
[0m10:10:38.416090 [debug] [Thread-2 (]: SQL status: COMMIT in 0.022 seconds
[0m10:10:38.417800 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:38.424976 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_work"
[0m10:10:38.429949 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."dv_sat_fact_tech__dbt_backup"
[0m10:10:38.430777 [debug] [Thread-3 (]: SQL status: COMMIT in 0.018 seconds
[0m10:10:38.434603 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:10:38.436590 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:10:38.441183 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."dv_hub_fact_work__dbt_backup"
[0m10:10:38.441982 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_sat_fact_work
[0m10:10:38.442741 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */
alter table "postgres"."public"."dv_lnk_fact_journal_fact_work__dbt_tmp" rename to "dv_lnk_fact_journal_fact_work"
[0m10:10:38.443375 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */
drop table if exists "postgres"."public"."dv_sat_fact_tech__dbt_backup" cascade
[0m10:10:38.444743 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:10:38.450121 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_work"
[0m10:10:38.451085 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */
drop table if exists "postgres"."public"."dv_hub_fact_work__dbt_backup" cascade
[0m10:10:38.452214 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:38.455725 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m10:10:38.456419 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:10:38.457212 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m10:10:38.457893 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:10:38.458643 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: BEGIN
[0m10:10:38.459272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:38.467619 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m10:10:38.468405 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:10:38.469220 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_work__dbt_tmp"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_hub_fact_work,
        s.hdiff_dv_sat_fact_work,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_work) over(PARTITION BY s.hk_dv_hub_fact_work ORDER BY s.loadts) AS lag_hdiff,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_work,
            s.hdiff_dv_sat_fact_work,
            s.loadts,
            s.recsource,
            идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
        FROM "postgres"."public"."stg_1c_works" s
        ) s
    )

    SELECT DISTINCT
        hk_dv_hub_fact_work,
        recsource,
        loadts,
        hdiff_dv_sat_fact_work,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_work <> lag_hdiff 
        OR lag_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m10:10:38.470165 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.019 seconds
[0m10:10:38.472879 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: Close
[0m10:10:38.474148 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db8348200>]}
[0m10:10:38.475675 [info ] [Thread-2 (]: 14 of 17 OK created sql incremental model public.dv_sat_fact_tech .............. [[32mSELECT 63[0m in 0.24s]
[0m10:10:38.477158 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_sat_fact_tech
[0m10:10:38.486096 [debug] [Thread-4 (]: SQL status: COMMIT in 0.027 seconds
[0m10:10:38.486877 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.033 seconds
[0m10:10:38.492184 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."dv_lnk_fact_journal_fact_work__dbt_backup"
[0m10:10:38.494606 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: Close
[0m10:10:38.495869 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:10:38.497372 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db8d375c0>]}
[0m10:10:38.498878 [debug] [Thread-1 (]: SQL status: SELECT 22 in 0.028 seconds
[0m10:10:38.499691 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */
drop table if exists "postgres"."public"."dv_lnk_fact_journal_fact_work__dbt_backup" cascade
[0m10:10:38.500966 [info ] [Thread-3 (]: 15 of 17 OK created sql incremental model public.dv_hub_fact_work .............. [[32mSELECT 22[0m in 0.23s]
[0m10:10:38.504629 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:10:38.505570 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m10:10:38.506619 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */
alter table "postgres"."public"."dv_sat_fact_work" rename to "dv_sat_fact_work__dbt_backup"
[0m10:10:38.508346 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:10:38.514662 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:10:38.515242 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */
alter table "postgres"."public"."dv_sat_fact_work__dbt_tmp" rename to "dv_sat_fact_work"
[0m10:10:38.516376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:10:38.519105 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m10:10:38.521643 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.015 seconds
[0m10:10:38.522709 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:10:38.525598 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: Close
[0m10:10:38.526844 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m10:10:38.528185 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db8d37890>]}
[0m10:10:38.529389 [info ] [Thread-4 (]: 16 of 17 OK created sql incremental model public.dv_lnk_fact_journal_fact_work . [[32mSELECT 22[0m in 0.21s]
[0m10:10:38.530527 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m10:10:38.542366 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m10:10:38.545326 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."dv_sat_fact_work__dbt_backup"
[0m10:10:38.546536 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:10:38.547032 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */
drop table if exists "postgres"."public"."dv_sat_fact_work__dbt_backup" cascade
[0m10:10:38.560073 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m10:10:38.562204 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: Close
[0m10:10:38.563391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7575e3a-4be2-40b9-83f9-dc646274c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db84604d0>]}
[0m10:10:38.565021 [info ] [Thread-1 (]: 17 of 17 OK created sql incremental model public.dv_sat_fact_work .............. [[32mSELECT 22[0m in 0.15s]
[0m10:10:38.566845 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_sat_fact_work
[0m10:10:38.569001 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:38.569885 [debug] [MainThread]: On master: BEGIN
[0m10:10:38.570729 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:10:38.581634 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m10:10:38.582170 [debug] [MainThread]: On master: COMMIT
[0m10:10:38.582779 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:38.583263 [debug] [MainThread]: On master: COMMIT
[0m10:10:38.583886 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:10:38.584576 [debug] [MainThread]: On master: Close
[0m10:10:38.585247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:38.586093 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_work' was properly closed.
[0m10:10:38.587078 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_tech' was properly closed.
[0m10:10:38.587749 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_work' was properly closed.
[0m10:10:38.588176 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work' was properly closed.
[0m10:10:38.589068 [info ] [MainThread]: 
[0m10:10:38.590220 [info ] [MainThread]: Finished running 11 incremental models, 6 view models in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m10:10:38.597656 [debug] [MainThread]: Command end result
[0m10:10:38.639148 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m10:10:38.642120 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m10:10:38.652236 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m10:10:38.652778 [info ] [MainThread]: 
[0m10:10:38.653658 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:10:38.654399 [info ] [MainThread]: 
[0m10:10:38.655456 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m10:10:38.657420 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.0937893, "process_in_blocks": "0", "process_kernel_time": 0.280882, "process_mem_max_rss": "123548", "process_out_blocks": "3720", "process_user_time": 3.36148}
[0m10:10:38.658513 [debug] [MainThread]: Command `dbt build` succeeded at 10:10:38.658318 after 2.10 seconds
[0m10:10:38.659409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbbf6d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbc1c6240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dbbc56360>]}
[0m10:10:38.660332 [debug] [MainThread]: Flushing usage events
[0m10:10:39.969149 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:10:47.651482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a68434a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a6962660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a6961790>]}


============================== 10:10:47.655285 | 0a041a72-79a7-4209-9dae-3961db9c2e79 ==============================
[0m10:10:47.655285 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:10:47.656186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:10:47.833378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a6a18530>]}
[0m10:10:47.902038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a6addcd0>]}
[0m10:10:47.903061 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:10:48.022128 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:10:48.112157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:10:48.112644 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:10:48.141384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a57ab8c0>]}
[0m10:10:48.212843 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m10:10:48.215345 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m10:10:48.243472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a4324b30>]}
[0m10:10:48.244165 [info ] [MainThread]: Found 17 models, 433 macros
[0m10:10:48.247394 [info ] [MainThread]: 
[0m10:10:48.248058 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:10:48.248785 [info ] [MainThread]: 
[0m10:10:48.249734 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:10:48.258335 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:10:48.308757 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:10:48.309506 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:10:48.310042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:48.321587 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.012 seconds
[0m10:10:48.323294 [debug] [ThreadPool]: On list_postgres: Close
[0m10:10:48.327234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m10:10:48.334303 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:10:48.334866 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m10:10:48.335406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:10:48.343794 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:10:48.344316 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:10:48.344811 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:10:48.347991 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.003 seconds
[0m10:10:48.350093 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m10:10:48.350755 [debug] [ThreadPool]: On list_postgres_public: Close
[0m10:10:48.362038 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:48.362662 [debug] [MainThread]: On master: BEGIN
[0m10:10:48.363106 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:10:48.371262 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:10:48.371812 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:48.372438 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:10:48.380597 [debug] [MainThread]: SQL status: SELECT 7 in 0.008 seconds
[0m10:10:48.383719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a530e0c0>]}
[0m10:10:48.384353 [debug] [MainThread]: On master: ROLLBACK
[0m10:10:48.385025 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:48.385931 [debug] [MainThread]: On master: BEGIN
[0m10:10:48.386783 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:10:48.387579 [debug] [MainThread]: On master: COMMIT
[0m10:10:48.388095 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:48.388609 [debug] [MainThread]: On master: COMMIT
[0m10:10:48.389215 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:10:48.389698 [debug] [MainThread]: On master: Close
[0m10:10:48.393811 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m10:10:48.394890 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_materials
[0m10:10:48.397094 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_norm_workload
[0m10:10:48.396230 [info ] [Thread-1 (]: 1 of 17 START sql view model public.stg_1c_journal ............................. [RUN]
[0m10:10:48.400025 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_pikets
[0m10:10:48.398333 [info ] [Thread-2 (]: 2 of 17 START sql view model public.stg_1c_materials ........................... [RUN]
[0m10:10:48.402397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m10:10:48.401182 [info ] [Thread-3 (]: 3 of 17 START sql view model public.stg_1c_norm_workload ....................... [RUN]
[0m10:10:48.404059 [info ] [Thread-4 (]: 4 of 17 START sql view model public.stg_1c_pikets .............................. [RUN]
[0m10:10:48.405376 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_materials'
[0m10:10:48.406123 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m10:10:48.407436 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_norm_workload'
[0m10:10:48.408442 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_pikets'
[0m10:10:48.409045 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_materials
[0m10:10:48.425481 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_norm_workload
[0m10:10:48.425076 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m10:10:48.426473 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_pikets
[0m10:10:48.429764 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_materials"
[0m10:10:48.435148 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_norm_workload"
[0m10:10:48.439590 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_pikets"
[0m10:10:48.440550 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m10:10:48.441592 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_norm_workload
[0m10:10:48.442655 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_materials
[0m10:10:48.491335 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_pikets
[0m10:10:48.526782 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_norm_workload"
[0m10:10:48.527688 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_materials"
[0m10:10:48.529383 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m10:10:48.534166 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_pikets"
[0m10:10:48.535347 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:10:48.536328 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:10:48.537176 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: BEGIN
[0m10:10:48.538003 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: BEGIN
[0m10:10:48.538634 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:10:48.539566 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:10:48.540190 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:10:48.540806 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:10:48.541399 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: BEGIN
[0m10:10:48.542482 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m10:10:48.543304 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:10:48.544364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:48.554144 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m10:10:48.555173 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:10:48.555879 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */

  create view "postgres"."public"."stg_1c_materials__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(НомерСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемМатериала::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_materials,
	НомерСтроки::int,
	Примечание::varchar,
	ОбъемМатериала::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar
    FROM 
        src_materials
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name)
  );
[0m10:10:48.556641 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m10:10:48.557962 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:10:48.559023 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m10:10:48.559539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m10:10:48.560524 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */

  create view "postgres"."public"."stg_1c_norm_workload__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(Период::varchar, 'N\A')) || '|' || TRIM(COALESCE(РассчетныйОбъем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьНормативная::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьФактическая::varchar, 'N\A')) || '|' || TRIM(COALESCE(НаемныйРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(НесколькоКлючевыхРесурсов::varchar, 'N\A')) || '|' || TRIM(COALESCE(ЖУФВР::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючДокументаРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_norm_workload,
	Период::timestamptz,
	РассчетныйОбъем::numeric,
	ТрудоемкостьНормативная::numeric,
	ТрудоемкостьФактическая::numeric,
	НаемныйРесурс::bool,
	КлючевойРесурс_value::uuid,
	КлючевойРесурс_codе::varchar,
	КлючевойРесурс_name::varchar,
	НесколькоКлючевыхРесурсов::bool,
	ЖУФВР::uuid,
	КлючДокументаРесурс::uuid,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	РесурсSpider_value::uuid,
	РесурсSpider_codе::varchar,
	РесурсSpider_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar
    FROM 
        src_norm_workload
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name)
  );
[0m10:10:48.561175 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:10:48.561954 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:10:48.562635 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:10:48.568472 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:10:48.571394 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:10:48.572388 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */

  create view "postgres"."public"."stg_1c_pikets__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(КлючСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетС::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеС::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(Объем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_pikets,
	КлючСтроки::uuid,
	ПикетС::numeric,
	ПикетПо::numeric,
	СмещениеС::numeric,
	СмещениеПо::numeric,
	Объем::numeric,
	ВидПикета_value::uuid,
	ВидПикета_codе::varchar,
	ВидПикета_name::varchar,
	ТипПикета_value::uuid,
	ТипПикета_codе::varchar,
	ТипПикета_name::varchar,
	ГруппаПикетовSpider_value::uuid,
	ГруппаПикетовSpider_codе::varchar,
	ГруппаПикетовSpider_name::varchar
    FROM 
        src_pikets
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name)
  );
[0m10:10:48.573530 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m10:10:48.577579 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:10:48.578212 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials" rename to "stg_1c_materials__dbt_backup"
[0m10:10:48.579150 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload" rename to "stg_1c_norm_workload__dbt_backup"
[0m10:10:48.580544 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:48.581297 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:48.585392 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:10:48.586074 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:10:48.586611 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m10:10:48.590099 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:10:48.591041 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials__dbt_tmp" rename to "stg_1c_materials"
[0m10:10:48.596760 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:10:48.600688 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:10:48.601363 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload__dbt_tmp" rename to "stg_1c_norm_workload"
[0m10:10:48.602038 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m10:10:48.602734 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets" rename to "stg_1c_pikets__dbt_backup"
[0m10:10:48.603359 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:48.609818 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:10:48.615524 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:10:48.624227 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:10:48.630175 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.026 seconds
[0m10:10:48.630725 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m10:10:48.639457 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m10:10:48.640389 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m10:10:48.644261 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:10:48.644990 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:10:48.645583 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:10:48.646220 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:48.646830 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets__dbt_tmp" rename to "stg_1c_pikets"
[0m10:10:48.647436 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m10:10:48.648054 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m10:10:48.650316 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m10:10:48.651510 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:10:48.652118 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:48.652656 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m10:10:48.655358 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m10:10:48.655971 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:10:48.656549 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m10:10:48.665269 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m10:10:48.672382 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_materials__dbt_backup"
[0m10:10:48.678693 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:10:48.679310 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
drop view if exists "postgres"."public"."stg_1c_materials__dbt_backup" cascade
[0m10:10:48.692676 [debug] [Thread-3 (]: SQL status: COMMIT in 0.041 seconds
[0m10:10:48.693593 [debug] [Thread-1 (]: SQL status: COMMIT in 0.038 seconds
[0m10:10:48.696497 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_norm_workload__dbt_backup"
[0m10:10:48.697116 [debug] [Thread-4 (]: SQL status: COMMIT in 0.040 seconds
[0m10:10:48.700009 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m10:10:48.701374 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:10:48.704380 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."stg_1c_pikets__dbt_backup"
[0m10:10:48.705029 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.025 seconds
[0m10:10:48.706207 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:10:48.706938 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
drop view if exists "postgres"."public"."stg_1c_norm_workload__dbt_backup" cascade
[0m10:10:48.708042 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:10:48.710817 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: Close
[0m10:10:48.711502 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m10:10:48.712318 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
drop view if exists "postgres"."public"."stg_1c_pikets__dbt_backup" cascade
[0m10:10:48.715340 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a827fad0>]}
[0m10:10:48.716524 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public.stg_1c_materials ...................... [[32mCREATE VIEW[0m in 0.31s]
[0m10:10:48.717538 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_materials
[0m10:10:48.718182 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m10:10:48.718959 [info ] [Thread-2 (]: 5 of 17 START sql view model public.stg_1c_tech ................................ [RUN]
[0m10:10:48.719721 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_materials, now model.tsm_dwh.stg_1c_tech)
[0m10:10:48.720380 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m10:10:48.725684 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m10:10:48.726636 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.014 seconds
[0m10:10:48.729105 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: Close
[0m10:10:48.730455 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a2c27ce0>]}
[0m10:10:48.731636 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m10:10:48.732748 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public.stg_1c_norm_workload .................. [[32mCREATE VIEW[0m in 0.32s]
[0m10:10:48.739174 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.026 seconds
[0m10:10:48.740770 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_norm_workload
[0m10:10:48.742844 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m10:10:48.743646 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.029 seconds
[0m10:10:48.745828 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m10:10:48.746514 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_works
[0m10:10:48.748824 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: Close
[0m10:10:48.750571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a2d73320>]}
[0m10:10:48.751629 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:10:48.752847 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a2d86630>]}
[0m10:10:48.750061 [info ] [Thread-3 (]: 6 of 17 START sql view model public.stg_1c_works ............................... [RUN]
[0m10:10:48.754776 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public.stg_1c_journal ........................ [[32mCREATE VIEW[0m in 0.35s]
[0m10:10:48.756124 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m10:10:48.757216 [info ] [Thread-4 (]: 4 of 17 OK created sql view model public.stg_1c_pikets ......................... [[32mCREATE VIEW[0m in 0.34s]
[0m10:10:48.758448 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_norm_workload, now model.tsm_dwh.stg_1c_works)
[0m10:10:48.759468 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m10:10:48.760088 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:10:48.760864 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_pikets
[0m10:10:48.761404 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m10:10:48.762112 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_msat_fact_materials
[0m10:10:48.763727 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_msat_norm_workload
[0m10:10:48.774315 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m10:10:48.770558 [info ] [Thread-1 (]: 7 of 17 START sql incremental model public.dv_msat_fact_materials .............. [RUN]
[0m10:10:48.776529 [info ] [Thread-4 (]: 8 of 17 START sql incremental model public.dv_msat_norm_workload ............... [RUN]
[0m10:10:48.777701 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m10:10:48.778651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_journal, now model.tsm_dwh.dv_msat_fact_materials)
[0m10:10:48.779371 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_pikets, now model.tsm_dwh.dv_msat_norm_workload)
[0m10:10:48.780008 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:10:48.780683 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_msat_fact_materials
[0m10:10:48.781437 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m10:10:48.781996 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_msat_norm_workload
[0m10:10:48.783137 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m10:10:48.798434 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m10:10:48.804698 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_materials"
[0m10:10:48.813501 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_norm_workload"
[0m10:10:48.814829 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:10:48.815903 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m10:10:48.816779 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:10:48.817346 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:10:48.817809 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_msat_norm_workload
[0m10:10:48.818312 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_msat_fact_materials
[0m10:10:48.823398 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:10:48.850389 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech" rename to "stg_1c_tech__dbt_backup"
[0m10:10:48.856600 [debug] [Thread-3 (]: SQL status: BEGIN in 0.039 seconds
[0m10:10:48.862350 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:10:48.862970 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m10:10:48.873398 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m10:10:48.891824 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:10:48.921672 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m10:10:48.918944 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m10:10:48.922933 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech__dbt_tmp" rename to "stg_1c_tech"
[0m10:10:48.923903 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */

    
  
    

  create temporary table "dv_msat_norm_workload__dbt_tmp101048885773"
  
  
    as
  
  (
    


    WITH active_sat AS (
    SELECT *
    FROM (
        SELECT 
            hk_dv_hub_fact_work,
            hdiff_dv_msat_norm_workload,
            loadts,
            sub_seq,
            COUNT(*) OVER (PARTITION BY hk_dv_hub_fact_work, loadts) AS cnt,
            rank() OVER (
                PARTITION BY hk_dv_hub_fact_work
                ORDER BY loadts DESC
            ) AS rnk
        FROM "postgres"."public"."dv_msat_norm_workload"
        ) a (
            sat_id,
            sat_hdiff,
            sat_loadts,
            sat_sub_seq,
            sat_count,
            sat_rnk
        )
    WHERE sat_rnk = 1
    ),
    stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS 
                stg_lag_hdiff,
                sat_hdiff,
                sat_count,
                sat_sub_seq,
                sat_rnk
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_norm_workload,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
                FROM "postgres"."public"."stg_1c_norm_workload" s
                    CROSS JOIN (
                        SELECT max(loadts) AS max_loadts
                        FROM "postgres"."public"."dv_msat_norm_workload"
                    ) ml
                WHERE s.loadts > ml.max_loadts
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
        LEFT JOIN active_sat a ON sat_id = stg_id
        AND sat_sub_seq = stg_sub_seq
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count,
                    sat_hdiff,
                    sat_count,
                    sat_sub_seq,
                    sat_rnk
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            OR (
                (
                    stg_hdiff <> sat_hdiff
                    AND stg_lag_hdiff IS NULL
                )
                OR (
                    stg_count <> sat_count
                    AND stg_lag_count IS NULL
                )
            )
    )

    SELECT DISTINCT 
        stg_id as hk_dv_hub_fact_work,
        stg_recsource as recsource,
        stg_loadts as loadts,
        stg_hdiff as hdiff_dv_msat_norm_workload,
        stg_sub_seq as sub_seq,
        период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
    FROM stage_cte s (hk_dv_hub_fact_work, recsource, loadts, hdiff_dv_msat_norm_workload, sub_seq, период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name)
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq


  );
  
  
[0m10:10:48.925357 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */

    
  
    

  create temporary table "dv_msat_fact_materials__dbt_tmp101048892518"
  
  
    as
  
  (
    


    WITH active_sat AS (
    SELECT *
    FROM (
        SELECT 
            hk_dv_hub_fact_work,
            hdiff_dv_msat_fact_materials,
            loadts,
            sub_seq,
            COUNT(*) OVER (PARTITION BY hk_dv_hub_fact_work, loadts) AS cnt,
            rank() OVER (
                PARTITION BY hk_dv_hub_fact_work
                ORDER BY loadts DESC
            ) AS rnk
        FROM "postgres"."public"."dv_msat_fact_materials"
        ) a (
            sat_id,
            sat_hdiff,
            sat_loadts,
            sat_sub_seq,
            sat_count,
            sat_rnk
        )
    WHERE sat_rnk = 1
    ),
    stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS 
                stg_lag_hdiff,
                sat_hdiff,
                sat_count,
                sat_sub_seq,
                sat_rnk
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_materials,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
                FROM "postgres"."public"."stg_1c_materials" s
                    CROSS JOIN (
                        SELECT max(loadts) AS max_loadts
                        FROM "postgres"."public"."dv_msat_fact_materials"
                    ) ml
                WHERE s.loadts > ml.max_loadts
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
        LEFT JOIN active_sat a ON sat_id = stg_id
        AND sat_sub_seq = stg_sub_seq
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count,
                    sat_hdiff,
                    sat_count,
                    sat_sub_seq,
                    sat_rnk
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            OR (
                (
                    stg_hdiff <> sat_hdiff
                    AND stg_lag_hdiff IS NULL
                )
                OR (
                    stg_count <> sat_count
                    AND stg_lag_count IS NULL
                )
            )
    )

    SELECT DISTINCT 
        stg_id as hk_dv_hub_fact_work,
        stg_recsource as recsource,
        stg_loadts as loadts,
        stg_hdiff as hdiff_dv_msat_fact_materials,
        stg_sub_seq as sub_seq,
        номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
    FROM stage_cte s (hk_dv_hub_fact_work, recsource, loadts, hdiff_dv_msat_fact_materials, sub_seq, номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name)
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq


  );
  
  
[0m10:10:48.926210 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:10:48.927040 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:10:48.927967 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:48.928650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:48.933652 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:10:48.936562 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m10:10:48.937621 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works" rename to "stg_1c_works__dbt_backup"
[0m10:10:48.938587 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:10:48.939672 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m10:10:48.940462 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:48.946218 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:10:48.947130 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works__dbt_tmp" rename to "stg_1c_works"
[0m10:10:48.948826 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:10:48.951580 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m10:10:48.952339 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "stg_id" does not exist
LINE 152:         stg_id as hk_dv_hub_fact_work,
                  ^

[0m10:10:48.952895 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:10:48.953739 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_norm_workload: Close
[0m10:10:48.954338 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m10:10:48.954929 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m10:10:48.956046 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "stg_id" does not exist
LINE 124:         stg_id as hk_dv_hub_fact_work,
                  ^

[0m10:10:48.960634 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_tech__dbt_backup"
[0m10:10:48.962374 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: Close
[0m10:10:48.964323 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:10:48.966632 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
drop view if exists "postgres"."public"."stg_1c_tech__dbt_backup" cascade
[0m10:10:48.972161 [debug] [Thread-4 (]: Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  column "stg_id" does not exist
  LINE 152:         stg_id as hk_dv_hub_fact_work,
                    ^
[0m10:10:48.972944 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m10:10:48.973918 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a2c5cf80>]}
[0m10:10:48.977176 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_works__dbt_backup"
[0m10:10:48.978495 [error] [Thread-4 (]: 8 of 17 ERROR creating sql incremental model public.dv_msat_norm_workload ...... [[31mERROR[0m in 0.19s]
[0m10:10:48.979892 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:10:48.981519 [debug] [Thread-1 (]: Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  column "stg_id" does not exist
  LINE 124:         stg_id as hk_dv_hub_fact_work,
                    ^
[0m10:10:48.982321 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_msat_norm_workload
[0m10:10:48.983180 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
drop view if exists "postgres"."public"."stg_1c_works__dbt_backup" cascade
[0m10:10:48.983778 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.016 seconds
[0m10:10:48.984521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a2c5cf80>]}
[0m10:10:48.985415 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m10:10:48.986438 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_norm_workload' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  column "stg_id" does not exist
  LINE 152:         stg_id as hk_dv_hub_fact_work,
                    ^.
[0m10:10:48.990241 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m10:10:48.991641 [error] [Thread-1 (]: 7 of 17 ERROR creating sql incremental model public.dv_msat_fact_materials ..... [[31mERROR[0m in 0.21s]
[0m10:10:48.993047 [info ] [Thread-4 (]: 9 of 17 START sql incremental model public.dv_hub_fact_journal ................. [RUN]
[0m10:10:48.994837 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_msat_fact_materials
[0m10:10:48.995720 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a2c16e40>]}
[0m10:10:48.996742 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_norm_workload, now model.tsm_dwh.dv_hub_fact_journal)
[0m10:10:48.997961 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_sat_fact_journal
[0m10:10:48.999488 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_fact_materials' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  column "stg_id" does not exist
  LINE 124:         stg_id as hk_dv_hub_fact_work,
                    ^.
[0m10:10:49.000077 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.013 seconds
[0m10:10:49.001677 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m10:10:49.000989 [info ] [Thread-2 (]: 5 of 17 OK created sql view model public.stg_1c_tech ........................... [[32mCREATE VIEW[0m in 0.28s]
[0m10:10:49.002997 [info ] [Thread-1 (]: 10 of 17 START sql incremental model public.dv_sat_fact_journal ................ [RUN]
[0m10:10:49.006032 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: Close
[0m10:10:49.012014 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m10:10:49.013355 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m10:10:49.014550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_materials, now model.tsm_dwh.dv_sat_fact_journal)
[0m10:10:49.015616 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a2d736e0>]}
[0m10:10:49.016836 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_msat_fact_pikets
[0m10:10:49.018514 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m10:10:49.019100 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_sat_fact_journal
[0m10:10:49.020052 [info ] [Thread-3 (]: 6 of 17 OK created sql view model public.stg_1c_works .......................... [[32mCREATE VIEW[0m in 0.26s]
[0m10:10:49.021101 [info ] [Thread-2 (]: 11 of 17 START sql incremental model public.dv_msat_fact_pikets ................ [RUN]
[0m10:10:49.030602 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:10:49.037607 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m10:10:49.040440 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_journal"
[0m10:10:49.041074 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_msat_fact_pikets)
[0m10:10:49.041930 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

    
  
    

  create temporary table "dv_hub_fact_journal__dbt_tmp101049025598"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_journal" target
    where 
        target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_journal 
)

  );
  
  
[0m10:10:49.042718 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m10:10:49.043978 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_msat_fact_pikets
[0m10:10:49.044774 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:10:49.045442 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_sat_fact_journal
[0m10:10:49.046487 [info ] [Thread-3 (]: 12 of 17 START sql incremental model public.dv_hub_tech ........................ [RUN]
[0m10:10:49.056595 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:10:49.064007 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:10:49.065302 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_works, now model.tsm_dwh.dv_hub_tech)
[0m10:10:49.067678 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

    
  
    

  create temporary table "dv_sat_fact_journal__dbt_tmp101049060597"
  
  
    as
  
  (
    



    WITH active_sat AS (
    SELECT DISTINCT ON (hk_dv_hub_fact_journal) hk_dv_hub_fact_journal, hdiff_dv_sat_fact_journal, loadts
    FROM "postgres"."public"."dv_sat_fact_journal"
    ORDER BY hk_dv_hub_fact_journal, loadts DESC)

    , max_load AS (
    SELECT max(loadts) AS max_loadts
    FROM "postgres"."public"."dv_sat_fact_journal"
    )
    , stage_cte AS (

        SELECT
        s.hk_dv_hub_fact_journal,
        s.hdiff_dv_sat_fact_journal,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_journal) over(PARTITION BY s.hk_dv_hub_fact_journal ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_journal AS sat_hdiff,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_journal,
            s.hdiff_dv_sat_fact_journal,
            s.loadts,
            s.recsource,
            rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
        FROM "postgres"."public"."stg_1c_journal" s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts
        ) s
    LEFT JOIN active_sat a ON a.hk_dv_hub_fact_journal = s.hk_dv_hub_fact_journal)

    SELECT DISTINCT
        hk_dv_hub_fact_journal,
        recsource,
        loadts,
        hdiff_dv_sat_fact_journal,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_journal <> lag_hdiff 
            OR (hdiff_dv_sat_fact_journal <> sat_hdiff AND lag_hdiff IS NULL) 
            OR sat_hdiff IS NULL
    ORDER BY loadts


  );
  
  
[0m10:10:49.069249 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m10:10:49.069986 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_msat_fact_pikets
[0m10:10:49.070766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:49.076893 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.032 seconds
[0m10:10:49.077796 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m10:10:49.083090 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:10:49.101120 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m10:10:49.161207 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.090 seconds
[0m10:10:49.165930 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:10:49.166759 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */

    
  
    

  create temporary table "dv_msat_fact_pikets__dbt_tmp101049080450"
  
  
    as
  
  (
    


    WITH active_sat AS (
    SELECT *
    FROM (
        SELECT 
            hk_dv_hub_fact_work,
            hdiff_dv_msat_fact_pikets,
            loadts,
            sub_seq,
            COUNT(*) OVER (PARTITION BY hk_dv_hub_fact_work, loadts) AS cnt,
            rank() OVER (
                PARTITION BY hk_dv_hub_fact_work
                ORDER BY loadts DESC
            ) AS rnk
        FROM "postgres"."public"."dv_msat_fact_pikets"
        ) a (
            sat_id,
            sat_hdiff,
            sat_loadts,
            sat_sub_seq,
            sat_count,
            sat_rnk
        )
    WHERE sat_rnk = 1
    ),
    stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS 
                stg_lag_hdiff,
                sat_hdiff,
                sat_count,
                sat_sub_seq,
                sat_rnk
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_pikets,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
                FROM "postgres"."public"."stg_1c_pikets" s
                    CROSS JOIN (
                        SELECT max(loadts) AS max_loadts
                        FROM "postgres"."public"."dv_msat_fact_pikets"
                    ) ml
                WHERE s.loadts > ml.max_loadts
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
        LEFT JOIN active_sat a ON sat_id = stg_id
        AND sat_sub_seq = stg_sub_seq
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count,
                    sat_hdiff,
                    sat_count,
                    sat_sub_seq,
                    sat_rnk
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            OR (
                (
                    stg_hdiff <> sat_hdiff
                    AND stg_lag_hdiff IS NULL
                )
                OR (
                    stg_count <> sat_count
                    AND stg_lag_count IS NULL
                )
            )
    )

    SELECT DISTINCT 
        stg_id as hk_dv_hub_fact_work,
        stg_recsource as recsource,
        stg_loadts as loadts,
        stg_hdiff as hdiff_dv_msat_fact_pikets,
        stg_sub_seq as sub_seq,
        ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
    FROM stage_cte s (hk_dv_hub_fact_work, recsource, loadts, hdiff_dv_msat_fact_pikets, sub_seq, ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name)
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq


  );
  
  
[0m10:10:49.172245 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:10:49.175944 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:10:49.176785 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: BEGIN
[0m10:10:49.177368 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:10:49.178062 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

    
  
    

  create temporary table "dv_hub_tech__dbt_tmp101049169807"
  
  
    as
  
  (
    

SELECT distinct on (bk_ресурс_uuid)
        hk_dv_hub_tech,
        hkcode,
        recsource,
        loadts,
        bk_ресурс_uuid
FROM "postgres"."public"."stg_1c_tech" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_tech" target
    where 
        target.hk_dv_hub_tech = stg.hk_dv_hub_tech 
)

  );
  
  
[0m10:10:49.178736 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: BEGIN
[0m10:10:49.179661 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m10:10:49.180632 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:10:49.181864 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:10:49.182499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m10:10:49.183576 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal__dbt_tmp101049025598'
        
      order by ordinal_position

  
[0m10:10:49.184687 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:10:49.185573 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_journal__dbt_tmp101049060597'
        
      order by ordinal_position

  
[0m10:10:49.193577 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "stg_id" does not exist
LINE 142:         stg_id as hk_dv_hub_fact_work,
                  ^

[0m10:10:49.194725 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.009 seconds
[0m10:10:49.195769 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_fact_pikets: Close
[0m10:10:49.196449 [debug] [Thread-1 (]: SQL status: SELECT 33 in 0.010 seconds
[0m10:10:49.202802 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:10:49.203394 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.023 seconds
[0m10:10:49.211143 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:10:49.211879 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:10:49.215457 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:10:49.216053 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:10:49.217016 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: BEGIN
[0m10:10:49.220060 [debug] [Thread-2 (]: Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  column "stg_id" does not exist
  LINE 142:         stg_id as hk_dv_hub_fact_work,
                    ^
[0m10:10:49.221564 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m10:10:49.222505 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.006 seconds
[0m10:10:49.223466 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:10:49.224285 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a572d010>]}
[0m10:10:49.233753 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:10:49.234372 [debug] [Thread-1 (]: SQL status: SELECT 33 in 0.013 seconds
[0m10:10:49.234921 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech__dbt_tmp101049169807'
        
      order by ordinal_position

  
[0m10:10:49.235862 [error] [Thread-2 (]: 11 of 17 ERROR creating sql incremental model public.dv_msat_fact_pikets ....... [[31mERROR[0m in 0.18s]
[0m10:10:49.236780 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:10:49.241631 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:10:49.243223 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_msat_fact_pikets
[0m10:10:49.244113 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:10:49.246320 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_msat_fact_pikets' to be skipped because of status 'error'.  Reason: Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  column "stg_id" does not exist
  LINE 142:         stg_id as hk_dv_hub_fact_work,
                    ^.
[0m10:10:49.244898 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m10:10:49.247709 [info ] [Thread-2 (]: 13 of 17 START sql incremental model public.dv_lnk_fact_work_tech .............. [RUN]
[0m10:10:49.249535 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_pikets, now model.tsm_dwh.dv_lnk_fact_work_tech)
[0m10:10:49.250557 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_work_tech
[0m10:10:49.257562 [debug] [Thread-1 (]: SQL status: SELECT 33 in 0.011 seconds
[0m10:10:49.263620 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.020 seconds
[0m10:10:49.264686 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.022 seconds
[0m10:10:49.279224 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:10:49.285681 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:10:49.286615 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_journal"
[0m10:10:49.287360 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:10:49.289866 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_journal"
[0m10:10:49.291349 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_lnk_fact_work_tech
[0m10:10:49.301602 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:10:49.302395 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:10:49.303075 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

    
  
    

  create temporary table "dv_lnk_fact_work_tech__dbt_tmp101049298456"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_work,
	hk_dv_hub_tech)
        hk_dv_lnk_fact_work_tech,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_work,
	hk_dv_hub_tech
FROM "postgres"."public"."stg_1c_tech" stg


where not exists (
    select 1
    from "postgres"."public"."dv_lnk_fact_work_tech" target
    where 
        target.hk_dv_lnk_fact_work_tech = stg.hk_dv_lnk_fact_work_tech 
)

  );
  
  
[0m10:10:49.303785 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.013 seconds
[0m10:10:49.304433 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      insert into "postgres"."public"."dv_hub_fact_journal" ("hk_dv_hub_fact_journal", "hkcode", "recsource", "loadts", "bk_жуфвр_uuid")
    (
        select "hk_dv_hub_fact_journal", "hkcode", "recsource", "loadts", "bk_жуфвр_uuid"
        from "dv_hub_fact_journal__dbt_tmp101049025598"
    )


  
[0m10:10:49.305098 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:10:49.305689 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:10:49.309738 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:10:49.310522 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      insert into "postgres"."public"."dv_sat_fact_journal" ("hk_dv_hub_fact_journal", "recsource", "loadts", "hdiff_dv_sat_fact_journal", "rabbit_uuid", "rabbit_дата", "проведен", "uuid_жуфвр", "пометка_удаления", "дата", "номер", "территория_value", "территория_codе", "территория_name", "подразделение_value", "подразделение_codе", "подразделение_name", "смена_value", "смена_codе", "смена_name", "прораб_value", "прораб_codе", "прораб_name", "комментарий", "ответственный_value", "ответственный_codе", "ответственный_name", "версия_жуфвр_value", "версия_жуфвр_codе", "версия_жуфвр_name", "направление_деятельности_value", "направление_деятельности_codе", "направление_деятельности_name")
    (
        select "hk_dv_hub_fact_journal", "recsource", "loadts", "hdiff_dv_sat_fact_journal", "rabbit_uuid", "rabbit_дата", "проведен", "uuid_жуфвр", "пометка_удаления", "дата", "номер", "территория_value", "территория_codе", "территория_name", "подразделение_value", "подразделение_codе", "подразделение_name", "смена_value", "смена_codе", "смена_name", "прораб_value", "прораб_codе", "прораб_name", "комментарий", "ответственный_value", "ответственный_codе", "ответственный_name", "версия_жуфвр_value", "версия_жуфвр_codе", "версия_жуфвр_name", "направление_деятельности_value", "направление_деятельности_codе", "направление_деятельности_name"
        from "dv_sat_fact_journal__dbt_tmp101049060597"
    )


  
[0m10:10:49.311619 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m10:10:49.312654 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:10:49.316458 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m10:10:49.317340 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m10:10:49.318092 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:10:49.321401 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m10:10:49.322118 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m10:10:49.322721 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.005 seconds
[0m10:10:49.323454 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:10:49.326289 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_tech"
[0m10:10:49.326945 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m10:10:49.327857 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:10:49.328428 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      insert into "postgres"."public"."dv_hub_tech" ("hk_dv_hub_tech", "hkcode", "recsource", "loadts", "bk_ресурс_uuid")
    (
        select "hk_dv_hub_tech", "hkcode", "recsource", "loadts", "bk_ресурс_uuid"
        from "dv_hub_tech__dbt_tmp101049169807"
    )


  
[0m10:10:49.329093 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.023 seconds
[0m10:10:49.332868 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:10:49.333444 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m10:10:49.333904 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: BEGIN
[0m10:10:49.336162 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m10:10:49.336863 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m10:10:49.337558 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:10:49.338149 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m10:10:49.339177 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m10:10:49.339760 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m10:10:49.340355 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:10:49.341231 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a827fad0>]}
[0m10:10:49.342013 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech__dbt_tmp101049298456'
        
      order by ordinal_position

  
[0m10:10:49.342995 [info ] [Thread-4 (]: 9 of 17 OK created sql incremental model public.dv_hub_fact_journal ............ [[32mINSERT 0 0[0m in 0.34s]
[0m10:10:49.344508 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m10:10:49.345505 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_sat_fact_tech
[0m10:10:49.346476 [info ] [Thread-4 (]: 14 of 17 START sql incremental model public.dv_sat_fact_tech ................... [RUN]
[0m10:10:49.347205 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_fact_journal, now model.tsm_dwh.dv_sat_fact_tech)
[0m10:10:49.347904 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_sat_fact_tech
[0m10:10:49.348485 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m10:10:49.354394 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.010 seconds
[0m10:10:49.359711 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_tech"
[0m10:10:49.360907 [debug] [Thread-3 (]: SQL status: COMMIT in 0.019 seconds
[0m10:10:49.362162 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: Close
[0m10:10:49.365909 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:10:49.367859 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: Close
[0m10:10:49.369442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a030b770>]}
[0m10:10:49.370880 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_sat_fact_tech
[0m10:10:49.371822 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:10:49.373146 [info ] [Thread-1 (]: 10 of 17 OK created sql incremental model public.dv_sat_fact_journal ........... [[32mINSERT 0 0[0m in 0.35s]
[0m10:10:49.374484 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a9eb4320>]}
[0m10:10:49.381044 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:10:49.382312 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_sat_fact_journal
[0m10:10:49.385082 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

    
  
    

  create temporary table "dv_sat_fact_tech__dbt_tmp101049377610"
  
  
    as
  
  (
    



    WITH active_sat AS (
    SELECT DISTINCT ON (hk_dv_lnk_fact_work_tech) hk_dv_lnk_fact_work_tech, hdiff_dv_sat_fact_tech, loadts
    FROM "postgres"."public"."dv_sat_fact_tech"
    ORDER BY hk_dv_lnk_fact_work_tech, loadts DESC)

    , max_load AS (
    SELECT max(loadts) AS max_loadts
    FROM "postgres"."public"."dv_sat_fact_tech"
    )
    , stage_cte AS (

        SELECT
        s.hk_dv_lnk_fact_work_tech,
        s.hdiff_dv_sat_fact_tech,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_tech) over(PARTITION BY s.hk_dv_lnk_fact_work_tech ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_tech AS sat_hdiff,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name

    FROM
        (SELECT
            s.hk_dv_lnk_fact_work_tech,
            s.hdiff_dv_sat_fact_tech,
            s.loadts,
            s.recsource,
            примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
        FROM "postgres"."public"."stg_1c_tech" s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts
        ) s
    LEFT JOIN active_sat a ON a.hk_dv_lnk_fact_work_tech = s.hk_dv_lnk_fact_work_tech)

    SELECT DISTINCT
        hk_dv_lnk_fact_work_tech,
        recsource,
        loadts,
        hdiff_dv_sat_fact_tech,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_tech <> lag_hdiff 
            OR (hdiff_dv_sat_fact_tech <> sat_hdiff AND lag_hdiff IS NULL) 
            OR sat_hdiff IS NULL
    ORDER BY loadts


  );
  
  
[0m10:10:49.383822 [info ] [Thread-3 (]: 12 of 17 OK created sql incremental model public.dv_hub_tech ................... [[32mINSERT 0 0[0m in 0.31s]
[0m10:10:49.387053 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.005 seconds
[0m10:10:49.387961 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m10:10:49.388727 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:10:49.390100 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m10:10:49.399180 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:10:49.400419 [info ] [Thread-1 (]: 15 of 17 START sql incremental model public.dv_hub_fact_work ................... [RUN]
[0m10:10:49.402573 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m10:10:49.404089 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:10:49.405139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_journal, now model.tsm_dwh.dv_hub_fact_work)
[0m10:10:49.406891 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m10:10:49.406052 [info ] [Thread-3 (]: 16 of 17 START sql incremental model public.dv_lnk_fact_journal_fact_work ...... [RUN]
[0m10:10:49.413574 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_tech, now model.tsm_dwh.dv_lnk_fact_journal_fact_work)
[0m10:10:49.414868 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m10:10:49.421054 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.014 seconds
[0m10:10:49.424431 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:10:49.425980 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m10:10:49.428282 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:10:49.428827 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.040 seconds
[0m10:10:49.429756 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m10:10:49.430383 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m10:10:49.437988 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:10:49.445734 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:10:49.446381 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:10:49.453859 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:10:49.454514 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_tech: BEGIN
[0m10:10:49.455105 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

    
  
    

  create temporary table "dv_lnk_fact_journal_fact_work__dbt_tmp101049441141"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work)
        hk_dv_lnk_fact_journal_fact_work,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work
FROM "postgres"."public"."stg_1c_works" stg


where not exists (
    select 1
    from "postgres"."public"."dv_lnk_fact_journal_fact_work" target
    where 
        target.hk_dv_lnk_fact_journal_fact_work = stg.hk_dv_lnk_fact_journal_fact_work 
)

  );
  
  
[0m10:10:49.455704 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      insert into "postgres"."public"."dv_lnk_fact_work_tech" ("hk_dv_lnk_fact_work_tech", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_work", "hk_dv_hub_tech")
    (
        select "hk_dv_lnk_fact_work_tech", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_work", "hk_dv_hub_tech"
        from "dv_lnk_fact_work_tech__dbt_tmp101049298456"
    )


  
[0m10:10:49.456422 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

    
  
    

  create temporary table "dv_hub_fact_work__dbt_tmp101049450690"
  
  
    as
  
  (
    

SELECT distinct on (bk_работа_uuid)
        hk_dv_hub_fact_work,
        hkcode,
        recsource,
        loadts,
        bk_работа_uuid
FROM "postgres"."public"."stg_1c_works" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_work" target
    where 
        target.hk_dv_hub_fact_work = stg.hk_dv_hub_fact_work 
)

  );
  
  
[0m10:10:49.457329 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:10:49.458157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:49.458840 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m10:10:49.459365 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m10:10:49.460433 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:10:49.463990 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m10:10:49.465083 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_tech__dbt_tmp101049377610'
        
      order by ordinal_position

  
[0m10:10:49.465958 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:10:49.466865 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m10:10:49.474418 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.008 seconds
[0m10:10:49.475162 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.018 seconds
[0m10:10:49.479769 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:10:49.480580 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m10:10:49.481401 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.023 seconds
[0m10:10:49.485021 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:10:49.485749 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:10:49.486737 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: Close
[0m10:10:49.490095 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:10:49.490765 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: BEGIN
[0m10:10:49.491539 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: BEGIN
[0m10:10:49.492434 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a2d4cda0>]}
[0m10:10:49.494879 [debug] [Thread-3 (]: SQL status: BEGIN in 0.002 seconds
[0m10:10:49.495654 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m10:10:49.494003 [info ] [Thread-2 (]: 13 of 17 OK created sql incremental model public.dv_lnk_fact_work_tech ......... [[32mINSERT 0 0[0m in 0.24s]
[0m10:10:49.496490 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:10:49.497125 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.006 seconds
[0m10:10:49.497769 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:10:49.498540 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m10:10:49.499361 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work__dbt_tmp101049441141'
        
      order by ordinal_position

  
[0m10:10:49.505795 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:10:49.506874 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work__dbt_tmp101049450690'
        
      order by ordinal_position

  
[0m10:10:49.507873 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_sat_fact_work
[0m10:10:49.510532 [info ] [Thread-2 (]: 17 of 17 START sql incremental model public.dv_sat_fact_work ................... [RUN]
[0m10:10:49.509209 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:10:49.511560 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_lnk_fact_work_tech, now model.tsm_dwh.dv_sat_fact_work)
[0m10:10:49.512657 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_sat_fact_work
[0m10:10:49.522927 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_work"
[0m10:10:49.523819 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.014 seconds
[0m10:10:49.528575 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:10:49.529346 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.020 seconds
[0m10:10:49.530216 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:10:49.530866 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.018 seconds
[0m10:10:49.536369 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:10:49.542832 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_sat_fact_work
[0m10:10:49.542408 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_tech"
[0m10:10:49.543911 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m10:10:49.544803 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:10:49.552994 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:10:49.557477 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:10:49.558383 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:10:49.559212 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

    
  
    

  create temporary table "dv_sat_fact_work__dbt_tmp101049548650"
  
  
    as
  
  (
    



    WITH active_sat AS (
    SELECT DISTINCT ON (hk_dv_hub_fact_work) hk_dv_hub_fact_work, hdiff_dv_sat_fact_work, loadts
    FROM "postgres"."public"."dv_sat_fact_work"
    ORDER BY hk_dv_hub_fact_work, loadts DESC)

    , max_load AS (
    SELECT max(loadts) AS max_loadts
    FROM "postgres"."public"."dv_sat_fact_work"
    )
    , stage_cte AS (

        SELECT
        s.hk_dv_hub_fact_work,
        s.hdiff_dv_sat_fact_work,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_work) over(PARTITION BY s.hk_dv_hub_fact_work ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_work AS sat_hdiff,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_work,
            s.hdiff_dv_sat_fact_work,
            s.loadts,
            s.recsource,
            идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
        FROM "postgres"."public"."stg_1c_works" s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts
        ) s
    LEFT JOIN active_sat a ON a.hk_dv_hub_fact_work = s.hk_dv_hub_fact_work)

    SELECT DISTINCT
        hk_dv_hub_fact_work,
        recsource,
        loadts,
        hdiff_dv_sat_fact_work,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_work <> lag_hdiff 
            OR (hdiff_dv_sat_fact_work <> sat_hdiff AND lag_hdiff IS NULL) 
            OR sat_hdiff IS NULL
    ORDER BY loadts


  );
  
  
[0m10:10:49.560343 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:10:49.560957 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      insert into "postgres"."public"."dv_sat_fact_tech" ("hk_dv_lnk_fact_work_tech", "recsource", "loadts", "hdiff_dv_sat_fact_tech", "примечание", "госномер_техника_не_найдена", "количество", "часы", "ресурс_value", "ресурс_codе", "ресурс_name", "аналитика_codе", "аналитика_name", "контрагент_value", "контрагент_codе", "контрагент_name")
    (
        select "hk_dv_lnk_fact_work_tech", "recsource", "loadts", "hdiff_dv_sat_fact_tech", "примечание", "госномер_техника_не_найдена", "количество", "часы", "ресурс_value", "ресурс_codе", "ресурс_name", "аналитика_codе", "аналитика_name", "контрагент_value", "контрагент_codе", "контрагент_name"
        from "dv_sat_fact_tech__dbt_tmp101049377610"
    )


  
[0m10:10:49.561582 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:10:49.562163 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.004 seconds
[0m10:10:49.569107 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.006 seconds
[0m10:10:49.569993 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.007 seconds
[0m10:10:49.572728 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m10:10:49.574320 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:10:49.576716 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_work"
[0m10:10:49.577565 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:10:49.578441 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:10:49.579339 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m10:10:49.580270 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:10:49.581436 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      insert into "postgres"."public"."dv_hub_fact_work" ("hk_dv_hub_fact_work", "hkcode", "recsource", "loadts", "bk_работа_uuid")
    (
        select "hk_dv_hub_fact_work", "hkcode", "recsource", "loadts", "bk_работа_uuid"
        from "dv_hub_fact_work__dbt_tmp101049450690"
    )


  
[0m10:10:49.582160 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.021 seconds
[0m10:10:49.583094 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.003 seconds
[0m10:10:49.583738 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m10:10:49.588417 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:10:49.590921 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:10:49.593391 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m10:10:49.594143 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m10:10:49.594711 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_work: BEGIN
[0m10:10:49.595520 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:10:49.596742 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_tech: Close
[0m10:10:49.597393 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:10:49.598425 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m10:10:49.599081 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m10:10:49.600052 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a0308350>]}
[0m10:10:49.601291 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      insert into "postgres"."public"."dv_lnk_fact_journal_fact_work" ("hk_dv_lnk_fact_journal_fact_work", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_journal", "hk_dv_hub_fact_work")
    (
        select "hk_dv_lnk_fact_journal_fact_work", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_journal", "hk_dv_hub_fact_work"
        from "dv_lnk_fact_journal_fact_work__dbt_tmp101049441141"
    )


  
[0m10:10:49.602168 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:10:49.603086 [info ] [Thread-4 (]: 14 of 17 OK created sql incremental model public.dv_sat_fact_tech .............. [[32mINSERT 0 0[0m in 0.25s]
[0m10:10:49.603979 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_work__dbt_tmp101049548650'
        
      order by ordinal_position

  
[0m10:10:49.604797 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m10:10:49.605557 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_sat_fact_tech
[0m10:10:49.607709 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m10:10:49.608478 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:10:49.609207 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m10:10:49.613395 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.007 seconds
[0m10:10:49.621669 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:10:49.622474 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:10:49.623868 [debug] [Thread-3 (]: SQL status: COMMIT in 0.014 seconds
[0m10:10:49.624421 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m10:10:49.625567 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: Close
[0m10:10:49.626627 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: Close
[0m10:10:49.627424 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.004 seconds
[0m10:10:49.628348 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a037c0b0>]}
[0m10:10:49.629285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a2cb2ba0>]}
[0m10:10:49.634209 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:10:49.635214 [info ] [Thread-3 (]: 16 of 17 OK created sql incremental model public.dv_lnk_fact_journal_fact_work . [[32mINSERT 0 0[0m in 0.21s]
[0m10:10:49.636138 [info ] [Thread-1 (]: 15 of 17 OK created sql incremental model public.dv_hub_fact_work .............. [[32mINSERT 0 0[0m in 0.22s]
[0m10:10:49.637056 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:10:49.637971 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m10:10:49.638851 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m10:10:49.643034 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.003 seconds
[0m10:10:49.646331 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_work"
[0m10:10:49.647522 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:10:49.649001 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      insert into "postgres"."public"."dv_sat_fact_work" ("hk_dv_hub_fact_work", "recsource", "loadts", "hdiff_dv_sat_fact_work", "идентификатор", "объем_работы", "примечание", "кв", "пометка_удаления", "тип_spider", "структура_работ_value", "структура_работ_codе", "структура_работ_name", "видработ_value", "видработ_codе", "видработ_name")
    (
        select "hk_dv_hub_fact_work", "recsource", "loadts", "hdiff_dv_sat_fact_work", "идентификатор", "объем_работы", "примечание", "кв", "пометка_удаления", "тип_spider", "структура_работ_value", "структура_работ_codе", "структура_работ_name", "видработ_value", "видработ_codе", "видработ_name"
        from "dv_sat_fact_work__dbt_tmp101049548650"
    )


  
[0m10:10:49.653094 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m10:10:49.659456 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m10:10:49.660723 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:10:49.662011 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m10:10:49.676906 [debug] [Thread-2 (]: SQL status: COMMIT in 0.011 seconds
[0m10:10:49.678899 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_work: Close
[0m10:10:49.680354 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a041a72-79a7-4209-9dae-3961db9c2e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a2cc8350>]}
[0m10:10:49.682652 [info ] [Thread-2 (]: 17 of 17 OK created sql incremental model public.dv_sat_fact_work .............. [[32mINSERT 0 0[0m in 0.17s]
[0m10:10:49.685100 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_sat_fact_work
[0m10:10:49.691183 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:49.692139 [debug] [MainThread]: On master: BEGIN
[0m10:10:49.693097 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:10:49.709491 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m10:10:49.710444 [debug] [MainThread]: On master: COMMIT
[0m10:10:49.711286 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:49.712105 [debug] [MainThread]: On master: COMMIT
[0m10:10:49.713050 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:10:49.713853 [debug] [MainThread]: On master: Close
[0m10:10:49.717541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:49.718463 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_work' was properly closed.
[0m10:10:49.719342 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_work' was properly closed.
[0m10:10:49.720287 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work' was properly closed.
[0m10:10:49.721318 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_tech' was properly closed.
[0m10:10:49.722610 [info ] [MainThread]: 
[0m10:10:49.723696 [info ] [MainThread]: Finished running 11 incremental models, 6 view models in 0 hours 0 minutes and 1.47 seconds (1.47s).
[0m10:10:49.730328 [debug] [MainThread]: Command end result
[0m10:10:49.784491 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m10:10:49.786380 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m10:10:49.794713 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m10:10:49.795244 [info ] [MainThread]: 
[0m10:10:49.796141 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m10:10:49.796881 [info ] [MainThread]: 
[0m10:10:49.797566 [error] [MainThread]:   Database Error in model dv_msat_norm_workload (tsm_dwh/models/dv/dv_msat_norm_workload.sql)
  column "stg_id" does not exist
  LINE 152:         stg_id as hk_dv_hub_fact_work,
                    ^
[0m10:10:49.798044 [info ] [MainThread]: 
[0m10:10:49.798672 [error] [MainThread]:   Database Error in model dv_msat_fact_materials (tsm_dwh/models/dv/dv_msat_fact_materials.sql)
  column "stg_id" does not exist
  LINE 124:         stg_id as hk_dv_hub_fact_work,
                    ^
[0m10:10:49.799172 [info ] [MainThread]: 
[0m10:10:49.799800 [error] [MainThread]:   Database Error in model dv_msat_fact_pikets (tsm_dwh/models/dv/dv_msat_fact_pikets.sql)
  column "stg_id" does not exist
  LINE 142:         stg_id as hk_dv_hub_fact_work,
                    ^
[0m10:10:49.800387 [info ] [MainThread]: 
[0m10:10:49.800952 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=3 SKIP=0 TOTAL=17
[0m10:10:49.802679 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.207206, "process_in_blocks": "0", "process_kernel_time": 0.286735, "process_mem_max_rss": "123956", "process_out_blocks": "3296", "process_user_time": 3.492907}
[0m10:10:49.803630 [debug] [MainThread]: Command `dbt build` failed at 10:10:49.803449 after 2.21 seconds
[0m10:10:49.804361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a9fbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a0346060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72a5d547a0>]}
[0m10:10:49.804966 [debug] [MainThread]: Flushing usage events
[0m10:10:50.826049 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:11:07.645532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7201f3f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7201d689e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7201d69a00>]}


============================== 10:11:07.649365 | eec63dce-e147-4a7d-bb11-bc23ba01611e ==============================
[0m10:11:07.649365 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:11:07.650421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --full-refresh', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:11:07.829202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7201ad5850>]}
[0m10:11:07.895432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7201cb18e0>]}
[0m10:11:07.896466 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:11:08.016435 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:11:08.109035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:11:08.109522 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:11:08.138226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7201569760>]}
[0m10:11:08.211921 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m10:11:08.214511 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m10:11:08.243101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f720158e510>]}
[0m10:11:08.243947 [info ] [MainThread]: Found 17 models, 433 macros
[0m10:11:08.247137 [info ] [MainThread]: 
[0m10:11:08.247880 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:11:08.248774 [info ] [MainThread]: 
[0m10:11:08.250023 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:11:08.259075 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:11:08.306861 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:11:08.307417 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:11:08.307902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:08.319083 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.011 seconds
[0m10:11:08.320781 [debug] [ThreadPool]: On list_postgres: Close
[0m10:11:08.324770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m10:11:08.331504 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:11:08.331997 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m10:11:08.332473 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:11:08.340955 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:11:08.341518 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:11:08.341970 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:11:08.345220 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.003 seconds
[0m10:11:08.347247 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m10:11:08.347876 [debug] [ThreadPool]: On list_postgres_public: Close
[0m10:11:08.357821 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:08.358378 [debug] [MainThread]: On master: BEGIN
[0m10:11:08.358835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:11:08.367385 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:11:08.367879 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:08.368449 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:11:08.376371 [debug] [MainThread]: SQL status: SELECT 7 in 0.007 seconds
[0m10:11:08.379438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ff9243b0>]}
[0m10:11:08.380023 [debug] [MainThread]: On master: ROLLBACK
[0m10:11:08.380661 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:08.381072 [debug] [MainThread]: On master: BEGIN
[0m10:11:08.381748 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:11:08.382190 [debug] [MainThread]: On master: COMMIT
[0m10:11:08.382671 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:08.383099 [debug] [MainThread]: On master: COMMIT
[0m10:11:08.383675 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:11:08.384093 [debug] [MainThread]: On master: Close
[0m10:11:08.388614 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m10:11:08.389330 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_materials
[0m10:11:08.389845 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_norm_workload
[0m10:11:08.390507 [info ] [Thread-1 (]: 1 of 17 START sql view model public.stg_1c_journal ............................. [RUN]
[0m10:11:08.391394 [info ] [Thread-2 (]: 2 of 17 START sql view model public.stg_1c_materials ........................... [RUN]
[0m10:11:08.392414 [info ] [Thread-3 (]: 3 of 17 START sql view model public.stg_1c_norm_workload ....................... [RUN]
[0m10:11:08.393192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m10:11:08.393819 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_pikets
[0m10:11:08.394617 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_materials'
[0m10:11:08.395612 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_norm_workload'
[0m10:11:08.396193 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m10:11:08.398020 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_materials
[0m10:11:08.397373 [info ] [Thread-4 (]: 4 of 17 START sql view model public.stg_1c_pikets .............................. [RUN]
[0m10:11:08.398964 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_norm_workload
[0m10:11:08.413245 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_materials"
[0m10:11:08.416184 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m10:11:08.417459 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_pikets'
[0m10:11:08.421915 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_norm_workload"
[0m10:11:08.423233 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_pikets
[0m10:11:08.424038 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_materials
[0m10:11:08.424732 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m10:11:08.429020 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_pikets"
[0m10:11:08.430417 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_norm_workload
[0m10:11:08.504920 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_pikets
[0m10:11:08.524405 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_materials"
[0m10:11:08.525357 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_pikets"
[0m10:11:08.528529 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_norm_workload"
[0m10:11:08.529752 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m10:11:08.530672 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:11:08.531993 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:11:08.532867 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: BEGIN
[0m10:11:08.533797 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:11:08.534806 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:11:08.535347 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: BEGIN
[0m10:11:08.535869 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:11:08.536504 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: BEGIN
[0m10:11:08.537121 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m10:11:08.537749 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:11:08.538599 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:11:08.539693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:11:08.550868 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m10:11:08.551939 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:11:08.553010 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */

  create view "postgres"."public"."stg_1c_materials__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(НомерСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемМатериала::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_materials,
	НомерСтроки::int,
	Примечание::varchar,
	ОбъемМатериала::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar
    FROM 
        src_materials
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name)
  );
[0m10:11:08.554170 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m10:11:08.555219 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m10:11:08.556189 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:11:08.557104 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m10:11:08.557759 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:11:08.558347 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:11:08.559430 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */

  create view "postgres"."public"."stg_1c_norm_workload__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(Период::varchar, 'N\A')) || '|' || TRIM(COALESCE(РассчетныйОбъем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьНормативная::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьФактическая::varchar, 'N\A')) || '|' || TRIM(COALESCE(НаемныйРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(НесколькоКлючевыхРесурсов::varchar, 'N\A')) || '|' || TRIM(COALESCE(ЖУФВР::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючДокументаРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_norm_workload,
	Период::timestamptz,
	РассчетныйОбъем::numeric,
	ТрудоемкостьНормативная::numeric,
	ТрудоемкостьФактическая::numeric,
	НаемныйРесурс::bool,
	КлючевойРесурс_value::uuid,
	КлючевойРесурс_codе::varchar,
	КлючевойРесурс_name::varchar,
	НесколькоКлючевыхРесурсов::bool,
	ЖУФВР::uuid,
	КлючДокументаРесурс::uuid,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	РесурсSpider_value::uuid,
	РесурсSpider_codе::varchar,
	РесурсSpider_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar
    FROM 
        src_norm_workload
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name)
  );
[0m10:11:08.560201 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:11:08.560949 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */

  create view "postgres"."public"."stg_1c_pikets__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(КлючСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетС::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеС::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(Объем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_pikets,
	КлючСтроки::uuid,
	ПикетС::numeric,
	ПикетПо::numeric,
	СмещениеС::numeric,
	СмещениеПо::numeric,
	Объем::numeric,
	ВидПикета_value::uuid,
	ВидПикета_codе::varchar,
	ВидПикета_name::varchar,
	ТипПикета_value::uuid,
	ТипПикета_codе::varchar,
	ТипПикета_name::varchar,
	ГруппаПикетовSpider_value::uuid,
	ГруппаПикетовSpider_codе::varchar,
	ГруппаПикетовSpider_name::varchar
    FROM 
        src_pikets
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name)
  );
[0m10:11:08.569170 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:11:08.570361 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m10:11:08.571350 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:11:08.572147 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials" rename to "stg_1c_materials__dbt_backup"
[0m10:11:08.577819 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:11:08.578463 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:11:08.579017 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:11:08.579707 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload" rename to "stg_1c_norm_workload__dbt_backup"
[0m10:11:08.583600 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:11:08.584143 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:11:08.588032 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:11:08.588803 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m10:11:08.589381 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:11:08.593981 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:11:08.594642 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets" rename to "stg_1c_pikets__dbt_backup"
[0m10:11:08.598417 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:11:08.599062 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:11:08.599635 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials__dbt_tmp" rename to "stg_1c_materials"
[0m10:11:08.600449 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload__dbt_tmp" rename to "stg_1c_norm_workload"
[0m10:11:08.604568 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:11:08.605084 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:11:08.605858 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m10:11:08.609713 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:11:08.610520 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:11:08.611430 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:11:08.612104 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets__dbt_tmp" rename to "stg_1c_pikets"
[0m10:11:08.628646 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m10:11:08.635796 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m10:11:08.637153 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m10:11:08.639586 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m10:11:08.640085 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:11:08.640741 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:11:08.641397 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:11:08.642045 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:11:08.644141 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m10:11:08.644794 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m10:11:08.645373 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m10:11:08.646315 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m10:11:08.647364 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:11:08.648740 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m10:11:08.655226 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m10:11:08.667210 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_norm_workload__dbt_backup"
[0m10:11:08.674227 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:11:08.674895 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
drop view if exists "postgres"."public"."stg_1c_norm_workload__dbt_backup" cascade
[0m10:11:08.685123 [debug] [Thread-4 (]: SQL status: COMMIT in 0.035 seconds
[0m10:11:08.688208 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."stg_1c_pikets__dbt_backup"
[0m10:11:08.689375 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:11:08.689874 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
drop view if exists "postgres"."public"."stg_1c_pikets__dbt_backup" cascade
[0m10:11:08.690467 [debug] [Thread-1 (]: SQL status: COMMIT in 0.042 seconds
[0m10:11:08.691047 [debug] [Thread-2 (]: SQL status: COMMIT in 0.043 seconds
[0m10:11:08.694535 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m10:11:08.695297 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.020 seconds
[0m10:11:08.697965 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_materials__dbt_backup"
[0m10:11:08.699203 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:11:08.702165 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: Close
[0m10:11:08.703480 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:11:08.704180 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m10:11:08.705060 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
drop view if exists "postgres"."public"."stg_1c_materials__dbt_backup" cascade
[0m10:11:08.707901 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7203f53bc0>]}
[0m10:11:08.709427 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public.stg_1c_norm_workload .................. [[32mCREATE VIEW[0m in 0.31s]
[0m10:11:08.710388 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.019 seconds
[0m10:11:08.711373 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_norm_workload
[0m10:11:08.713072 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: Close
[0m10:11:08.713790 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m10:11:08.715280 [info ] [Thread-3 (]: 5 of 17 START sql view model public.stg_1c_tech ................................ [RUN]
[0m10:11:08.716825 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71fc211190>]}
[0m10:11:08.717955 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_norm_workload, now model.tsm_dwh.stg_1c_tech)
[0m10:11:08.718933 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.011 seconds
[0m10:11:08.720325 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.011 seconds
[0m10:11:08.723384 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m10:11:08.722160 [info ] [Thread-4 (]: 4 of 17 OK created sql view model public.stg_1c_pikets ......................... [[32mCREATE VIEW[0m in 0.30s]
[0m10:11:08.725605 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m10:11:08.727951 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: Close
[0m10:11:08.736518 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7202ad80e0>]}
[0m10:11:08.732346 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m10:11:08.734961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7200d99760>]}
[0m10:11:08.733441 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_pikets
[0m10:11:08.738027 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m10:11:08.739497 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public.stg_1c_materials ...................... [[32mCREATE VIEW[0m in 0.34s]
[0m10:11:08.741082 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_works
[0m10:11:08.742362 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public.stg_1c_journal ........................ [[32mCREATE VIEW[0m in 0.34s]
[0m10:11:08.749533 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m10:11:08.750582 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_materials
[0m10:11:08.751597 [info ] [Thread-4 (]: 6 of 17 START sql view model public.stg_1c_works ............................... [RUN]
[0m10:11:08.753296 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m10:11:08.754460 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_msat_norm_workload
[0m10:11:08.755671 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_pikets, now model.tsm_dwh.stg_1c_works)
[0m10:11:08.756535 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:11:08.757335 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_msat_fact_pikets
[0m10:11:08.758156 [info ] [Thread-2 (]: 7 of 17 START sql incremental model public.dv_msat_norm_workload ............... [RUN]
[0m10:11:08.759674 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m10:11:08.760890 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m10:11:08.762119 [info ] [Thread-1 (]: 8 of 17 START sql incremental model public.dv_msat_fact_pikets ................. [RUN]
[0m10:11:08.763419 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_materials, now model.tsm_dwh.dv_msat_norm_workload)
[0m10:11:08.769973 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:11:08.772916 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m10:11:08.773828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_journal, now model.tsm_dwh.dv_msat_fact_pikets)
[0m10:11:08.774851 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_msat_norm_workload
[0m10:11:08.776109 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m10:11:08.777080 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_msat_fact_pikets
[0m10:11:08.792961 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m10:11:08.802080 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_norm_workload"
[0m10:11:08.808363 [debug] [Thread-3 (]: SQL status: BEGIN in 0.038 seconds
[0m10:11:08.809364 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:11:08.810344 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:11:08.811297 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:11:08.812437 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m10:11:08.813996 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m10:11:08.815209 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_msat_norm_workload
[0m10:11:08.816268 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_msat_fact_pikets
[0m10:11:08.817120 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:11:08.861758 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.045 seconds
[0m10:11:08.871500 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:11:08.893386 [debug] [Thread-4 (]: SQL status: BEGIN in 0.076 seconds
[0m10:11:08.900588 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_norm_workload"
[0m10:11:08.901415 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech" rename to "stg_1c_tech__dbt_backup"
[0m10:11:08.907078 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:11:08.907870 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:11:08.909134 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m10:11:08.910166 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:11:08.915325 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:11:08.915955 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech__dbt_tmp" rename to "stg_1c_tech"
[0m10:11:08.916591 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:11:08.917313 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:11:08.922071 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:11:08.922883 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:11:08.923531 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m10:11:08.926976 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m10:11:08.927695 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works" rename to "stg_1c_works__dbt_backup"
[0m10:11:08.928331 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_pikets: BEGIN
[0m10:11:08.928824 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: BEGIN
[0m10:11:08.929446 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:11:08.930092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:11:08.930721 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:11:08.931229 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:11:08.931899 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m10:11:08.936872 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:11:08.938008 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works__dbt_tmp" rename to "stg_1c_works"
[0m10:11:08.939697 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:11:08.943229 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m10:11:08.944012 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:11:08.944712 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m10:11:08.945684 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m10:11:08.946542 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m10:11:08.947075 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:11:08.950651 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_tech__dbt_backup"
[0m10:11:08.951367 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m10:11:08.952046 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */

      
  
    

  create  table "postgres"."public"."dv_msat_fact_pikets__dbt_tmp"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_pikets,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
                FROM "postgres"."public"."stg_1c_pikets" s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            
            OR stg_lag_hdiff IS null

    )

    SELECT DISTINCT 
        stg_id as hk_dv_hub_fact_work,
        stg_recsource as recsource,
        stg_loadts as loadts,
        stg_hdiff as hdiff_dv_msat_fact_pikets,
        stg_sub_seq as sub_seq,
        ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m10:11:08.953422 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:11:08.954012 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m10:11:08.954707 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
drop view if exists "postgres"."public"."stg_1c_tech__dbt_backup" cascade
[0m10:11:08.955647 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */

      
  
    

  create  table "postgres"."public"."dv_msat_norm_workload__dbt_tmp"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_norm_workload,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
                FROM "postgres"."public"."stg_1c_norm_workload" s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            
            OR stg_lag_hdiff IS null

    )

    SELECT DISTINCT 
        stg_id as hk_dv_hub_fact_work,
        stg_recsource as recsource,
        stg_loadts as loadts,
        stg_hdiff as hdiff_dv_msat_norm_workload,
        stg_sub_seq as sub_seq,
        период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m10:11:08.956838 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m10:11:08.962734 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."stg_1c_works__dbt_backup"
[0m10:11:08.964888 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:11:08.965913 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
drop view if exists "postgres"."public"."stg_1c_works__dbt_backup" cascade
[0m10:11:08.966526 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.009 seconds
[0m10:11:08.968418 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m10:11:08.969326 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71fc28d5b0>]}
[0m10:11:08.970324 [info ] [Thread-3 (]: 5 of 17 OK created sql view model public.stg_1c_tech ........................... [[32mCREATE VIEW[0m in 0.25s]
[0m10:11:08.971423 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m10:11:08.972105 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_msat_fact_materials
[0m10:11:08.973407 [info ] [Thread-3 (]: 9 of 17 START sql incremental model public.dv_msat_fact_materials .............. [RUN]
[0m10:11:08.974575 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_msat_fact_materials)
[0m10:11:08.975317 [debug] [Thread-1 (]: SQL status: SELECT 22 in 0.021 seconds
[0m10:11:08.975841 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_msat_fact_materials
[0m10:11:08.980299 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:11:08.980965 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.014 seconds
[0m10:11:08.990292 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_materials"
[0m10:11:08.990918 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.033 seconds
[0m10:11:08.991442 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */
alter table "postgres"."public"."dv_msat_fact_pikets" rename to "dv_msat_fact_pikets__dbt_backup"
[0m10:11:08.993392 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_works: Close
[0m10:11:08.997413 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m10:11:08.998463 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_msat_fact_materials
[0m10:11:08.999944 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71fc2775f0>]}
[0m10:11:09.001596 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:11:09.002478 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */
alter table "postgres"."public"."dv_msat_norm_workload" rename to "dv_msat_norm_workload__dbt_backup"
[0m10:11:09.008594 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_materials"
[0m10:11:09.009495 [info ] [Thread-4 (]: 6 of 17 OK created sql view model public.stg_1c_works .......................... [[32mCREATE VIEW[0m in 0.24s]
[0m10:11:09.013406 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:11:09.014657 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m10:11:09.015494 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */
alter table "postgres"."public"."dv_msat_fact_pikets__dbt_tmp" rename to "dv_msat_fact_pikets"
[0m10:11:09.016454 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:11:09.017317 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m10:11:09.018558 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m10:11:09.023962 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m10:11:09.024809 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:11:09.025791 [info ] [Thread-4 (]: 10 of 17 START sql incremental model public.dv_hub_fact_journal ................ [RUN]
[0m10:11:09.026611 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_materials: BEGIN
[0m10:11:09.027789 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */
alter table "postgres"."public"."dv_msat_norm_workload__dbt_tmp" rename to "dv_msat_norm_workload"
[0m10:11:09.034448 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_works, now model.tsm_dwh.dv_hub_fact_journal)
[0m10:11:09.037318 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_pikets: COMMIT
[0m10:11:09.038177 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:11:09.039038 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m10:11:09.039966 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:11:09.040610 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:11:09.046741 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_pikets: COMMIT
[0m10:11:09.049815 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m10:11:09.053986 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: COMMIT
[0m10:11:09.055310 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m10:11:09.055934 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m10:11:09.056488 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m10:11:09.067456 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: COMMIT
[0m10:11:09.068159 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m10:11:09.066222 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_journal"
[0m10:11:09.069037 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m10:11:09.123904 [debug] [Thread-2 (]: SQL status: COMMIT in 0.054 seconds
[0m10:11:09.125795 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."dv_msat_fact_pikets__dbt_backup"
[0m10:11:09.126552 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */

      
  
    

  create  table "postgres"."public"."dv_msat_fact_materials__dbt_tmp"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_materials,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
                FROM "postgres"."public"."stg_1c_materials" s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            
            OR stg_lag_hdiff IS null

    )

    SELECT DISTINCT 
        stg_id as hk_dv_hub_fact_work,
        stg_recsource as recsource,
        stg_loadts as loadts,
        stg_hdiff as hdiff_dv_msat_fact_materials,
        stg_sub_seq as sub_seq,
        номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m10:11:09.129535 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."dv_msat_norm_workload__dbt_backup"
[0m10:11:09.133521 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:11:09.134046 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:11:09.135917 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m10:11:09.136881 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */
drop table if exists "postgres"."public"."dv_msat_fact_pikets__dbt_backup" cascade
[0m10:11:09.137545 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: BEGIN
[0m10:11:09.138438 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */
drop table if exists "postgres"."public"."dv_msat_norm_workload__dbt_backup" cascade
[0m10:11:09.139288 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:11:09.148546 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m10:11:09.149166 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:11:09.149746 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      
  
    

  create  table "postgres"."public"."dv_hub_fact_journal__dbt_tmp"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal" stg


  );
  
  
[0m10:11:09.151715 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m10:11:09.153518 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_pikets: Close
[0m10:11:09.154494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71fc1ad1f0>]}
[0m10:11:09.155399 [info ] [Thread-1 (]: 8 of 17 OK created sql incremental model public.dv_msat_fact_pikets ............ [[32mSELECT 22[0m in 0.38s]
[0m10:11:09.156238 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_msat_fact_pikets
[0m10:11:09.156888 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_sat_fact_journal
[0m10:11:09.157596 [info ] [Thread-1 (]: 11 of 17 START sql incremental model public.dv_sat_fact_journal ................ [RUN]
[0m10:11:09.158585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_pikets, now model.tsm_dwh.dv_sat_fact_journal)
[0m10:11:09.159598 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_sat_fact_journal
[0m10:11:09.160245 [debug] [Thread-3 (]: SQL status: SELECT 15 in 0.025 seconds
[0m10:11:09.173432 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_journal"
[0m10:11:09.174040 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m10:11:09.174886 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.035 seconds
[0m10:11:09.175738 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.025 seconds
[0m10:11:09.176361 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */
alter table "postgres"."public"."dv_msat_fact_materials" rename to "dv_msat_fact_materials__dbt_backup"
[0m10:11:09.178167 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: Close
[0m10:11:09.178762 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_sat_fact_journal
[0m10:11:09.182891 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:11:09.189630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ff924ef0>]}
[0m10:11:09.190607 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m10:11:09.191150 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */
alter table "postgres"."public"."dv_hub_fact_journal" rename to "dv_hub_fact_journal__dbt_backup"
[0m10:11:09.193797 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_journal"
[0m10:11:09.194647 [info ] [Thread-2 (]: 7 of 17 OK created sql incremental model public.dv_msat_norm_workload .......... [[32mSELECT 20[0m in 0.42s]
[0m10:11:09.199514 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m10:11:09.200971 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_msat_norm_workload
[0m10:11:09.201869 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:11:09.202879 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */
alter table "postgres"."public"."dv_msat_fact_materials__dbt_tmp" rename to "dv_msat_fact_materials"
[0m10:11:09.204139 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:11:09.205422 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m10:11:09.210912 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:11:09.212068 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: BEGIN
[0m10:11:09.213093 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:11:09.214524 [info ] [Thread-2 (]: 12 of 17 START sql incremental model public.dv_hub_tech ........................ [RUN]
[0m10:11:09.215615 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */
alter table "postgres"."public"."dv_hub_fact_journal__dbt_tmp" rename to "dv_hub_fact_journal"
[0m10:11:09.216344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:11:09.219816 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_materials: COMMIT
[0m10:11:09.220636 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_norm_workload, now model.tsm_dwh.dv_hub_tech)
[0m10:11:09.221710 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m10:11:09.222596 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:11:09.223780 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m10:11:09.224747 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_materials: COMMIT
[0m10:11:09.229714 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m10:11:09.235186 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m10:11:09.236467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m10:11:09.237626 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:11:09.238420 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:11:09.239059 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m10:11:09.239809 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m10:11:09.240763 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_journal__dbt_tmp"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_hub_fact_journal,
        s.hdiff_dv_sat_fact_journal,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_journal) over(PARTITION BY s.hk_dv_hub_fact_journal ORDER BY s.loadts) AS lag_hdiff,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_journal,
            s.hdiff_dv_sat_fact_journal,
            s.loadts,
            s.recsource,
            rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
        FROM "postgres"."public"."stg_1c_journal" s
        ) s
    )

    SELECT DISTINCT
        hk_dv_hub_fact_journal,
        recsource,
        loadts,
        hdiff_dv_sat_fact_journal,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_journal <> lag_hdiff 
        OR lag_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m10:11:09.246885 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m10:11:09.254166 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m10:11:09.257988 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."dv_hub_fact_journal__dbt_backup"
[0m10:11:09.259393 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:11:09.260111 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */
drop table if exists "postgres"."public"."dv_hub_fact_journal__dbt_backup" cascade
[0m10:11:09.260941 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."dv_msat_fact_materials__dbt_backup"
[0m10:11:09.263053 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_tech"
[0m10:11:09.264943 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m10:11:09.265612 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m10:11:09.266908 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */
drop table if exists "postgres"."public"."dv_msat_fact_materials__dbt_backup" cascade
[0m10:11:09.271398 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:11:09.271963 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:11:09.272674 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */
alter table "postgres"."public"."dv_sat_fact_journal" rename to "dv_sat_fact_journal__dbt_backup"
[0m10:11:09.273247 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.012 seconds
[0m10:11:09.274285 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: BEGIN
[0m10:11:09.276114 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m10:11:09.276746 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:11:09.277336 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:11:09.281767 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:11:09.282504 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7201bdff80>]}
[0m10:11:09.283185 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.010 seconds
[0m10:11:09.284067 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */
alter table "postgres"."public"."dv_sat_fact_journal__dbt_tmp" rename to "dv_sat_fact_journal"
[0m10:11:09.285528 [info ] [Thread-4 (]: 10 of 17 OK created sql incremental model public.dv_hub_fact_journal ........... [[32mSELECT 1[0m in 0.25s]
[0m10:11:09.289524 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m10:11:09.288364 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_materials: Close
[0m10:11:09.290329 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:11:09.291298 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m10:11:09.298112 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71fc200b30>]}
[0m10:11:09.297317 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m10:11:09.300418 [info ] [Thread-4 (]: 13 of 17 START sql incremental model public.dv_lnk_fact_work_tech .............. [RUN]
[0m10:11:09.301381 [debug] [Thread-2 (]: SQL status: BEGIN in 0.024 seconds
[0m10:11:09.302364 [info ] [Thread-3 (]: 9 of 17 OK created sql incremental model public.dv_msat_fact_materials ......... [[32mSELECT 15[0m in 0.32s]
[0m10:11:09.303693 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:11:09.304598 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_fact_journal, now model.tsm_dwh.dv_lnk_fact_work_tech)
[0m10:11:09.305373 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:11:09.306455 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_msat_fact_materials
[0m10:11:09.307452 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m10:11:09.308154 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_work_tech
[0m10:11:09.308928 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      
  
    

  create  table "postgres"."public"."dv_hub_tech__dbt_tmp"
  
  
    as
  
  (
    

SELECT distinct on (bk_ресурс_uuid)
        hk_dv_hub_tech,
        hkcode,
        recsource,
        loadts,
        bk_ресурс_uuid
FROM "postgres"."public"."stg_1c_tech" stg


  );
  
  
[0m10:11:09.309740 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_sat_fact_tech
[0m10:11:09.316624 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:11:09.319312 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m10:11:09.318159 [info ] [Thread-3 (]: 14 of 17 START sql incremental model public.dv_sat_fact_tech ................... [RUN]
[0m10:11:09.324494 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."dv_sat_fact_journal__dbt_backup"
[0m10:11:09.325730 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_materials, now model.tsm_dwh.dv_sat_fact_tech)
[0m10:11:09.326454 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_lnk_fact_work_tech
[0m10:11:09.327551 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:11:09.328299 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_sat_fact_tech
[0m10:11:09.334188 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.017 seconds
[0m10:11:09.337928 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:11:09.338751 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */
drop table if exists "postgres"."public"."dv_sat_fact_journal__dbt_backup" cascade
[0m10:11:09.348997 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:11:09.343891 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_tech"
[0m10:11:09.350136 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */
alter table "postgres"."public"."dv_hub_tech" rename to "dv_hub_tech__dbt_backup"
[0m10:11:09.351163 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:11:09.351825 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: BEGIN
[0m10:11:09.352522 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:11:09.353581 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:11:09.358950 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:11:09.359745 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m10:11:09.360343 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_sat_fact_tech
[0m10:11:09.361100 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */
alter table "postgres"."public"."dv_hub_tech__dbt_tmp" rename to "dv_hub_tech"
[0m10:11:09.364395 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_journal: Close
[0m10:11:09.372217 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_tech"
[0m10:11:09.373352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71fc105fd0>]}
[0m10:11:09.374200 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m10:11:09.375400 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:11:09.376466 [info ] [Thread-1 (]: 11 of 17 OK created sql incremental model public.dv_sat_fact_journal ........... [[32mSELECT 1[0m in 0.21s]
[0m10:11:09.377318 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:11:09.381019 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m10:11:09.382335 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_sat_fact_journal
[0m10:11:09.383430 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      
  
    

  create  table "postgres"."public"."dv_lnk_fact_work_tech__dbt_tmp"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_work,
	hk_dv_hub_tech)
        hk_dv_lnk_fact_work_tech,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_work,
	hk_dv_hub_tech
FROM "postgres"."public"."stg_1c_tech" stg


  );
  
  
[0m10:11:09.384128 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:11:09.384816 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:11:09.385451 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m10:11:09.386328 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_tech: BEGIN
[0m10:11:09.386992 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m10:11:09.388010 [info ] [Thread-1 (]: 15 of 17 START sql incremental model public.dv_hub_fact_work ................... [RUN]
[0m10:11:09.388932 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:11:09.390073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_journal, now model.tsm_dwh.dv_hub_fact_work)
[0m10:11:09.391469 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m10:11:09.400920 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m10:11:09.401810 [debug] [Thread-2 (]: SQL status: COMMIT in 0.012 seconds
[0m10:11:09.406591 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."dv_hub_tech__dbt_backup"
[0m10:11:09.408084 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:11:09.408937 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m10:11:09.409673 [debug] [Thread-4 (]: SQL status: SELECT 63 in 0.023 seconds
[0m10:11:09.410442 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */
drop table if exists "postgres"."public"."dv_hub_tech__dbt_backup" cascade
[0m10:11:09.411129 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m10:11:09.411724 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:11:09.417425 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:11:09.423834 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_tech__dbt_tmp"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_lnk_fact_work_tech,
        s.hdiff_dv_sat_fact_tech,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_tech) over(PARTITION BY s.hk_dv_lnk_fact_work_tech ORDER BY s.loadts) AS lag_hdiff,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name

    FROM
        (SELECT
            s.hk_dv_lnk_fact_work_tech,
            s.hdiff_dv_sat_fact_tech,
            s.loadts,
            s.recsource,
            примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
        FROM "postgres"."public"."stg_1c_tech" s
        ) s
    )

    SELECT DISTINCT
        hk_dv_lnk_fact_work_tech,
        recsource,
        loadts,
        hdiff_dv_sat_fact_tech,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_tech <> lag_hdiff 
        OR lag_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m10:11:09.425332 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_work"
[0m10:11:09.426299 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */
alter table "postgres"."public"."dv_lnk_fact_work_tech" rename to "dv_lnk_fact_work_tech__dbt_backup"
[0m10:11:09.427037 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.009 seconds
[0m10:11:09.428296 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:11:09.431244 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: Close
[0m10:11:09.432263 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:11:09.432876 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: BEGIN
[0m10:11:09.437149 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:11:09.438052 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71fc2e7710>]}
[0m10:11:09.438768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:11:09.439522 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */
alter table "postgres"."public"."dv_lnk_fact_work_tech__dbt_tmp" rename to "dv_lnk_fact_work_tech"
[0m10:11:09.440639 [info ] [Thread-2 (]: 12 of 17 OK created sql incremental model public.dv_hub_tech ................... [[32mSELECT 17[0m in 0.22s]
[0m10:11:09.442381 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:11:09.443597 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m10:11:09.444387 [debug] [Thread-3 (]: SQL status: SELECT 63 in 0.017 seconds
[0m10:11:09.448666 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m10:11:09.449759 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m10:11:09.454997 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:11:09.455821 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:11:09.456529 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m10:11:09.457158 [info ] [Thread-2 (]: 16 of 17 START sql incremental model public.dv_lnk_fact_journal_fact_work ...... [RUN]
[0m10:11:09.457997 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */
alter table "postgres"."public"."dv_sat_fact_tech" rename to "dv_sat_fact_tech__dbt_backup"
[0m10:11:09.458607 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m10:11:09.459213 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:11:09.459988 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_tech, now model.tsm_dwh.dv_lnk_fact_journal_fact_work)
[0m10:11:09.460964 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_hub_fact_work__dbt_tmp"
  
  
    as
  
  (
    

SELECT distinct on (bk_работа_uuid)
        hk_dv_hub_fact_work,
        hkcode,
        recsource,
        loadts,
        bk_работа_uuid
FROM "postgres"."public"."stg_1c_works" stg


  );
  
  
[0m10:11:09.461903 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:11:09.462924 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m10:11:09.468770 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:11:09.470113 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m10:11:09.475674 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:11:09.476453 [debug] [Thread-1 (]: SQL status: SELECT 22 in 0.013 seconds
[0m10:11:09.477148 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */
alter table "postgres"."public"."dv_sat_fact_tech__dbt_tmp" rename to "dv_sat_fact_tech"
[0m10:11:09.480104 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."dv_lnk_fact_work_tech__dbt_backup"
[0m10:11:09.485054 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:11:09.486218 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m10:11:09.487658 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:11:09.488282 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:11:09.488895 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */
alter table "postgres"."public"."dv_hub_fact_work" rename to "dv_hub_fact_work__dbt_backup"
[0m10:11:09.494812 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:11:09.495468 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */
drop table if exists "postgres"."public"."dv_lnk_fact_work_tech__dbt_backup" cascade
[0m10:11:09.498286 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m10:11:09.499301 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:11:09.499846 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:11:09.500661 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:11:09.501574 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: BEGIN
[0m10:11:09.508694 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:11:09.509335 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m10:11:09.509919 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m10:11:09.510535 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:11:09.511218 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */
alter table "postgres"."public"."dv_hub_fact_work__dbt_tmp" rename to "dv_hub_fact_work"
[0m10:11:09.513397 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: Close
[0m10:11:09.514766 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71fc2b9b20>]}
[0m10:11:09.516062 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:11:09.517087 [info ] [Thread-4 (]: 13 of 17 OK created sql incremental model public.dv_lnk_fact_work_tech ......... [[32mSELECT 63[0m in 0.21s]
[0m10:11:09.520993 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m10:11:09.522060 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m10:11:09.522657 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:11:09.523740 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_sat_fact_work
[0m10:11:09.525030 [debug] [Thread-3 (]: SQL status: COMMIT in 0.013 seconds
[0m10:11:09.525999 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m10:11:09.528097 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m10:11:09.527319 [info ] [Thread-4 (]: 17 of 17 START sql incremental model public.dv_sat_fact_work ................... [RUN]
[0m10:11:09.532593 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."dv_sat_fact_tech__dbt_backup"
[0m10:11:09.533533 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:11:09.534752 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_lnk_fact_work_tech, now model.tsm_dwh.dv_sat_fact_work)
[0m10:11:09.536516 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:11:09.537626 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_lnk_fact_journal_fact_work__dbt_tmp"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work)
        hk_dv_lnk_fact_journal_fact_work,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work
FROM "postgres"."public"."stg_1c_works" stg


  );
  
  
[0m10:11:09.538331 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_sat_fact_work
[0m10:11:09.539173 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */
drop table if exists "postgres"."public"."dv_sat_fact_tech__dbt_backup" cascade
[0m10:11:09.548323 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_work"
[0m10:11:09.549112 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m10:11:09.552543 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."dv_hub_fact_work__dbt_backup"
[0m10:11:09.554290 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:11:09.555355 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */
drop table if exists "postgres"."public"."dv_hub_fact_work__dbt_backup" cascade
[0m10:11:09.556336 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_sat_fact_work
[0m10:11:09.557198 [debug] [Thread-2 (]: SQL status: SELECT 22 in 0.017 seconds
[0m10:11:09.563345 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.018 seconds
[0m10:11:09.567451 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:11:09.569521 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_work"
[0m10:11:09.572138 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_tech: Close
[0m10:11:09.572794 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */
alter table "postgres"."public"."dv_lnk_fact_journal_fact_work" rename to "dv_lnk_fact_journal_fact_work__dbt_backup"
[0m10:11:09.573922 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:11:09.574659 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71feb40b60>]}
[0m10:11:09.575402 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.019 seconds
[0m10:11:09.576830 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: BEGIN
[0m10:11:09.577674 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:11:09.578510 [info ] [Thread-3 (]: 14 of 17 OK created sql incremental model public.dv_sat_fact_tech .............. [[32mSELECT 63[0m in 0.25s]
[0m10:11:09.580674 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_work: Close
[0m10:11:09.581394 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:11:09.585293 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:11:09.586542 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_sat_fact_tech
[0m10:11:09.588586 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */
alter table "postgres"."public"."dv_lnk_fact_journal_fact_work__dbt_tmp" rename to "dv_lnk_fact_journal_fact_work"
[0m10:11:09.590917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71feb3da90>]}
[0m10:11:09.592425 [info ] [Thread-1 (]: 15 of 17 OK created sql incremental model public.dv_hub_fact_work .............. [[32mSELECT 22[0m in 0.20s]
[0m10:11:09.593279 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:11:09.593972 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m10:11:09.597836 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m10:11:09.599986 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:11:09.600901 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m10:11:09.601607 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m10:11:09.602382 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:11:09.603475 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_work__dbt_tmp"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_hub_fact_work,
        s.hdiff_dv_sat_fact_work,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_work) over(PARTITION BY s.hk_dv_hub_fact_work ORDER BY s.loadts) AS lag_hdiff,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_work,
            s.hdiff_dv_sat_fact_work,
            s.loadts,
            s.recsource,
            идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
        FROM "postgres"."public"."stg_1c_works" s
        ) s
    )

    SELECT DISTINCT
        hk_dv_hub_fact_work,
        recsource,
        loadts,
        hdiff_dv_sat_fact_work,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_work <> lag_hdiff 
        OR lag_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m10:11:09.611777 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m10:11:09.617054 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."dv_lnk_fact_journal_fact_work__dbt_backup"
[0m10:11:09.618900 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:11:09.619993 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */
drop table if exists "postgres"."public"."dv_lnk_fact_journal_fact_work__dbt_backup" cascade
[0m10:11:09.624333 [debug] [Thread-4 (]: SQL status: SELECT 22 in 0.020 seconds
[0m10:11:09.628514 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:11:09.629432 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */
alter table "postgres"."public"."dv_sat_fact_work" rename to "dv_sat_fact_work__dbt_backup"
[0m10:11:09.631321 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:11:09.637155 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:11:09.637927 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.017 seconds
[0m10:11:09.638646 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */
alter table "postgres"."public"."dv_sat_fact_work__dbt_tmp" rename to "dv_sat_fact_work"
[0m10:11:09.640575 [debug] [Thread-2 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: Close
[0m10:11:09.641526 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71feb422a0>]}
[0m10:11:09.642277 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:11:09.643718 [info ] [Thread-2 (]: 16 of 17 OK created sql incremental model public.dv_lnk_fact_journal_fact_work . [[32mSELECT 22[0m in 0.18s]
[0m10:11:09.647773 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m10:11:09.648982 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m10:11:09.649948 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:11:09.651348 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m10:11:09.675057 [debug] [Thread-4 (]: SQL status: COMMIT in 0.023 seconds
[0m10:11:09.678092 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."dv_sat_fact_work__dbt_backup"
[0m10:11:09.679498 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:11:09.680081 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */
drop table if exists "postgres"."public"."dv_sat_fact_work__dbt_backup" cascade
[0m10:11:09.691058 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m10:11:09.692790 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: Close
[0m10:11:09.693677 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eec63dce-e147-4a7d-bb11-bc23ba01611e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7201a50bf0>]}
[0m10:11:09.695249 [info ] [Thread-4 (]: 17 of 17 OK created sql incremental model public.dv_sat_fact_work .............. [[32mSELECT 22[0m in 0.16s]
[0m10:11:09.696823 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_sat_fact_work
[0m10:11:09.698902 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:09.699664 [debug] [MainThread]: On master: BEGIN
[0m10:11:09.700194 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:11:09.708978 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:11:09.709570 [debug] [MainThread]: On master: COMMIT
[0m10:11:09.710025 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:09.710521 [debug] [MainThread]: On master: COMMIT
[0m10:11:09.711089 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:11:09.711649 [debug] [MainThread]: On master: Close
[0m10:11:09.712347 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:11:09.713130 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_work' was properly closed.
[0m10:11:09.714195 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work' was properly closed.
[0m10:11:09.715277 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_tech' was properly closed.
[0m10:11:09.716106 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_work' was properly closed.
[0m10:11:09.716926 [info ] [MainThread]: 
[0m10:11:09.717978 [info ] [MainThread]: Finished running 11 incremental models, 6 view models in 0 hours 0 minutes and 1.47 seconds (1.47s).
[0m10:11:09.722432 [debug] [MainThread]: Command end result
[0m10:11:09.767197 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m10:11:09.769218 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m10:11:09.778433 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m10:11:09.778982 [info ] [MainThread]: 
[0m10:11:09.779702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:11:09.780393 [info ] [MainThread]: 
[0m10:11:09.781451 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m10:11:09.782798 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.1957672, "process_in_blocks": "0", "process_kernel_time": 0.277905, "process_mem_max_rss": "123556", "process_out_blocks": "3528", "process_user_time": 3.473298}
[0m10:11:09.783402 [debug] [MainThread]: Command `dbt build` succeeded at 10:11:09.783269 after 2.20 seconds
[0m10:11:09.783885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7205bbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7201568e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71feb1c470>]}
[0m10:11:09.784395 [debug] [MainThread]: Flushing usage events
[0m10:11:10.794188 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:13:26.057062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d8ab6900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d8ab6630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d8ab7ce0>]}


============================== 10:13:26.060971 | ed032ca0-ba5a-4d65-979f-ea2c8632b6af ==============================
[0m10:13:26.060971 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:13:26.061972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:13:26.242719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d8ebc500>]}
[0m10:13:26.308171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d8ab6630>]}
[0m10:13:26.309165 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:13:26.428509 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:13:26.519422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:13:26.519904 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:13:26.548598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d7f6b260>]}
[0m10:13:26.618131 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m10:13:26.621270 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m10:13:26.649305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d7ffaea0>]}
[0m10:13:26.649991 [info ] [MainThread]: Found 17 models, 433 macros
[0m10:13:26.653214 [info ] [MainThread]: 
[0m10:13:26.653921 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:13:26.654455 [info ] [MainThread]: 
[0m10:13:26.655347 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:13:26.665871 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:13:26.715614 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:13:26.716183 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:13:26.716710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:26.728048 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.011 seconds
[0m10:13:26.729804 [debug] [ThreadPool]: On list_postgres: Close
[0m10:13:26.732429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m10:13:26.739523 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:13:26.740052 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m10:13:26.740600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:13:26.749048 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:13:26.749624 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:13:26.750153 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:13:26.753416 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.003 seconds
[0m10:13:26.755397 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m10:13:26.755960 [debug] [ThreadPool]: On list_postgres_public: Close
[0m10:13:26.764743 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:26.765232 [debug] [MainThread]: On master: BEGIN
[0m10:13:26.765682 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:13:26.774311 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:13:26.774876 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:26.775423 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:13:26.781756 [debug] [MainThread]: SQL status: SELECT 7 in 0.006 seconds
[0m10:13:26.784857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d82f4260>]}
[0m10:13:26.785465 [debug] [MainThread]: On master: ROLLBACK
[0m10:13:26.786086 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:26.786639 [debug] [MainThread]: On master: BEGIN
[0m10:13:26.787305 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:13:26.787753 [debug] [MainThread]: On master: COMMIT
[0m10:13:26.788187 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:26.788633 [debug] [MainThread]: On master: COMMIT
[0m10:13:26.789206 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:13:26.789702 [debug] [MainThread]: On master: Close
[0m10:13:26.793976 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m10:13:26.794631 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_materials
[0m10:13:26.795261 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_norm_workload
[0m10:13:26.795979 [info ] [Thread-1 (]: 1 of 17 START sql view model public.stg_1c_journal ............................. [RUN]
[0m10:13:26.796923 [info ] [Thread-2 (]: 2 of 17 START sql view model public.stg_1c_materials ........................... [RUN]
[0m10:13:26.797869 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_pikets
[0m10:13:26.798498 [info ] [Thread-3 (]: 3 of 17 START sql view model public.stg_1c_norm_workload ....................... [RUN]
[0m10:13:26.799411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m10:13:26.800248 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_materials'
[0m10:13:26.801186 [info ] [Thread-4 (]: 4 of 17 START sql view model public.stg_1c_pikets .............................. [RUN]
[0m10:13:26.802271 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_norm_workload'
[0m10:13:26.803141 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m10:13:26.804183 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_materials
[0m10:13:26.805143 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_pikets'
[0m10:13:26.805867 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_norm_workload
[0m10:13:26.812390 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_pikets
[0m10:13:26.819162 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m10:13:26.822726 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_materials"
[0m10:13:26.828797 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_norm_workload"
[0m10:13:26.832977 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_pikets"
[0m10:13:26.834563 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m10:13:26.835474 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_materials
[0m10:13:26.841656 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_norm_workload
[0m10:13:26.868163 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_pikets
[0m10:13:26.903987 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_pikets"
[0m10:13:26.906213 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_norm_workload"
[0m10:13:26.912018 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_materials"
[0m10:13:26.916957 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m10:13:26.918524 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:13:26.919611 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:13:26.920494 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:13:26.921504 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: BEGIN
[0m10:13:26.922499 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: BEGIN
[0m10:13:26.923227 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:13:26.923820 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: BEGIN
[0m10:13:26.924404 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:13:26.924913 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:13:26.925437 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m10:13:26.926140 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:13:26.927312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:13:26.939618 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m10:13:26.940995 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:13:26.941616 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m10:13:26.942134 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m10:13:26.942695 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m10:13:26.943359 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */

  create view "postgres"."public"."stg_1c_pikets__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(КлючСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетС::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеС::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(Объем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_pikets,
	КлючСтроки::uuid,
	ПикетС::numeric,
	ПикетПо::numeric,
	СмещениеС::numeric,
	СмещениеПо::numeric,
	Объем::numeric,
	ВидПикета_value::uuid,
	ВидПикета_codе::varchar,
	ВидПикета_name::varchar,
	ТипПикета_value::uuid,
	ТипПикета_codе::varchar,
	ТипПикета_name::varchar,
	ГруппаПикетовSpider_value::uuid,
	ГруппаПикетовSpider_codе::varchar,
	ГруппаПикетовSpider_name::varchar
    FROM 
        src_pikets
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name)
  );
[0m10:13:26.944132 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:13:26.944707 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:13:26.945352 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:13:26.946213 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */

  create view "postgres"."public"."stg_1c_norm_workload__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(Период::varchar, 'N\A')) || '|' || TRIM(COALESCE(РассчетныйОбъем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьНормативная::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьФактическая::varchar, 'N\A')) || '|' || TRIM(COALESCE(НаемныйРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(НесколькоКлючевыхРесурсов::varchar, 'N\A')) || '|' || TRIM(COALESCE(ЖУФВР::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючДокументаРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_norm_workload,
	Период::timestamptz,
	РассчетныйОбъем::numeric,
	ТрудоемкостьНормативная::numeric,
	ТрудоемкостьФактическая::numeric,
	НаемныйРесурс::bool,
	КлючевойРесурс_value::uuid,
	КлючевойРесурс_codе::varchar,
	КлючевойРесурс_name::varchar,
	НесколькоКлючевыхРесурсов::bool,
	ЖУФВР::uuid,
	КлючДокументаРесурс::uuid,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	РесурсSpider_value::uuid,
	РесурсSpider_codе::varchar,
	РесурсSpider_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar
    FROM 
        src_norm_workload
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name)
  );
[0m10:13:26.947002 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */

  create view "postgres"."public"."stg_1c_materials__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(НомерСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемМатериала::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_materials,
	НомерСтроки::int,
	Примечание::varchar,
	ОбъемМатериала::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar
    FROM 
        src_materials
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name)
  );
[0m10:13:26.948132 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m10:13:26.949533 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:13:26.958176 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m10:13:26.959894 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:13:26.960465 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m10:13:26.964243 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:13:26.964794 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m10:13:26.965357 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets" rename to "stg_1c_pikets__dbt_backup"
[0m10:13:26.969259 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:13:26.969972 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials" rename to "stg_1c_materials__dbt_backup"
[0m10:13:26.973749 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:13:26.974421 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m10:13:26.975098 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:13:26.975758 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload" rename to "stg_1c_norm_workload__dbt_backup"
[0m10:13:26.976411 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:13:26.977196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:13:26.980783 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:13:26.985535 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:13:26.986177 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:13:26.989713 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:13:26.990267 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets__dbt_tmp" rename to "stg_1c_pikets"
[0m10:13:26.990909 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials__dbt_tmp" rename to "stg_1c_materials"
[0m10:13:26.994218 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:13:26.994790 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m10:13:26.995564 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload__dbt_tmp" rename to "stg_1c_norm_workload"
[0m10:13:26.996369 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:13:26.996852 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:13:27.008072 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:13:27.013176 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m10:13:27.036470 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m10:13:27.037175 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m10:13:27.035724 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m10:13:27.038342 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m10:13:27.038854 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:13:27.039423 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:13:27.039972 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:13:27.040501 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:13:27.041128 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m10:13:27.041777 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m10:13:27.042353 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m10:13:27.042873 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m10:13:27.054391 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m10:13:27.063953 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."stg_1c_pikets__dbt_backup"
[0m10:13:27.074934 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:13:27.075807 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
drop view if exists "postgres"."public"."stg_1c_pikets__dbt_backup" cascade
[0m10:13:27.078373 [debug] [Thread-2 (]: SQL status: COMMIT in 0.035 seconds
[0m10:13:27.079017 [debug] [Thread-3 (]: SQL status: COMMIT in 0.035 seconds
[0m10:13:27.081899 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_materials__dbt_backup"
[0m10:13:27.082430 [debug] [Thread-1 (]: SQL status: COMMIT in 0.039 seconds
[0m10:13:27.085192 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_norm_workload__dbt_backup"
[0m10:13:27.086345 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:13:27.089217 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m10:13:27.090485 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:13:27.090993 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
drop view if exists "postgres"."public"."stg_1c_materials__dbt_backup" cascade
[0m10:13:27.092181 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:13:27.092870 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
drop view if exists "postgres"."public"."stg_1c_norm_workload__dbt_backup" cascade
[0m10:13:27.093498 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m10:13:27.102436 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.026 seconds
[0m10:13:27.105510 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: Close
[0m10:13:27.107595 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35da8ebaa0>]}
[0m10:13:27.108674 [info ] [Thread-4 (]: 4 of 17 OK created sql view model public.stg_1c_pikets ......................... [[32mCREATE VIEW[0m in 0.30s]
[0m10:13:27.109747 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_pikets
[0m10:13:27.110379 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m10:13:27.111100 [info ] [Thread-4 (]: 5 of 17 START sql view model public.stg_1c_tech ................................ [RUN]
[0m10:13:27.111973 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_pikets, now model.tsm_dwh.stg_1c_tech)
[0m10:13:27.112681 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m10:13:27.117295 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m10:13:27.118084 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.024 seconds
[0m10:13:27.118931 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.026 seconds
[0m10:13:27.119514 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.025 seconds
[0m10:13:27.122541 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: Close
[0m10:13:27.126413 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: Close
[0m10:13:27.127396 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m10:13:27.130387 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m10:13:27.132559 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d52b93d0>]}
[0m10:13:27.134065 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d5237cb0>]}
[0m10:13:27.141792 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m10:13:27.142812 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public.stg_1c_materials ...................... [[32mCREATE VIEW[0m in 0.33s]
[0m10:13:27.144106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d52d8890>]}
[0m10:13:27.145855 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public.stg_1c_norm_workload .................. [[32mCREATE VIEW[0m in 0.33s]
[0m10:13:27.147499 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_materials
[0m10:13:27.150327 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_norm_workload
[0m10:13:27.149230 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public.stg_1c_journal ........................ [[32mCREATE VIEW[0m in 0.34s]
[0m10:13:27.151417 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:13:27.152506 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_works
[0m10:13:27.153555 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_msat_fact_pikets
[0m10:13:27.154935 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m10:13:27.156138 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m10:13:27.157676 [info ] [Thread-2 (]: 6 of 17 START sql view model public.stg_1c_works ............................... [RUN]
[0m10:13:27.159516 [info ] [Thread-3 (]: 7 of 17 START sql incremental model public.dv_msat_fact_pikets ................. [RUN]
[0m10:13:27.160497 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_msat_fact_materials
[0m10:13:27.161409 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:13:27.162722 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_materials, now model.tsm_dwh.stg_1c_works)
[0m10:13:27.163505 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_norm_workload, now model.tsm_dwh.dv_msat_fact_pikets)
[0m10:13:27.166457 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m10:13:27.164995 [info ] [Thread-1 (]: 8 of 17 START sql incremental model public.dv_msat_fact_materials .............. [RUN]
[0m10:13:27.168119 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_msat_fact_pikets
[0m10:13:27.174696 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m10:13:27.175621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_journal, now model.tsm_dwh.dv_msat_fact_materials)
[0m10:13:27.187157 [debug] [Thread-4 (]: SQL status: BEGIN in 0.026 seconds
[0m10:13:27.191957 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:13:27.192917 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_msat_fact_materials
[0m10:13:27.193561 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:13:27.194481 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m10:13:27.200381 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_msat_fact_pikets
[0m10:13:27.203377 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_materials"
[0m10:13:27.204445 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m10:13:27.209443 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m10:13:27.231402 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:13:27.236757 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:13:27.237762 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech" rename to "stg_1c_tech__dbt_backup"
[0m10:13:27.238395 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_msat_fact_materials
[0m10:13:27.265818 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m10:13:27.269539 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:13:27.275350 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech__dbt_tmp" rename to "stg_1c_tech"
[0m10:13:27.288461 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:13:27.289118 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:13:27.300065 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_materials"
[0m10:13:27.300805 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:13:27.301583 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m10:13:27.302547 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:13:27.304856 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m10:13:27.305442 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m10:13:27.306129 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:13:27.306813 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_pikets: BEGIN
[0m10:13:27.307369 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:13:27.308028 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: BEGIN
[0m10:13:27.308962 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:13:27.310049 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m10:13:27.311185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:13:27.318533 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m10:13:27.319348 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:13:27.320384 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m10:13:27.321950 [debug] [Thread-4 (]: SQL status: COMMIT in 0.010 seconds
[0m10:13:27.326741 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."stg_1c_tech__dbt_backup"
[0m10:13:27.327466 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:13:27.328770 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:13:27.329608 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m10:13:27.334198 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:13:27.335031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m10:13:27.335726 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
drop view if exists "postgres"."public"."stg_1c_tech__dbt_backup" cascade
[0m10:13:27.336347 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:13:27.336955 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works" rename to "stg_1c_works__dbt_backup"
[0m10:13:27.337551 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m10:13:27.338518 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */

      
  
    

  create  table "postgres"."public"."dv_msat_fact_pikets"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_pikets,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
                FROM "postgres"."public"."stg_1c_pikets" s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            
            OR stg_lag_hdiff IS null

    )

    SELECT DISTINCT 
        stg_id as hk_dv_hub_fact_work,
        stg_recsource as recsource,
        stg_loadts as loadts,
        stg_hdiff as hdiff_dv_msat_fact_pikets,
        stg_sub_seq as sub_seq,
        ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m10:13:27.340088 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */

      
  
    

  create  table "postgres"."public"."dv_msat_fact_materials"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_materials,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
                FROM "postgres"."public"."stg_1c_materials" s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            
            OR stg_lag_hdiff IS null

    )

    SELECT DISTINCT 
        stg_id as hk_dv_hub_fact_work,
        stg_recsource as recsource,
        stg_loadts as loadts,
        stg_hdiff as hdiff_dv_msat_fact_materials,
        stg_sub_seq as sub_seq,
        номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m10:13:27.341012 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:13:27.346223 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:13:27.346919 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.009 seconds
[0m10:13:27.347436 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works__dbt_tmp" rename to "stg_1c_works"
[0m10:13:27.349192 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m10:13:27.350187 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d5371ca0>]}
[0m10:13:27.351348 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:13:27.353063 [info ] [Thread-4 (]: 5 of 17 OK created sql view model public.stg_1c_tech ........................... [[32mCREATE VIEW[0m in 0.24s]
[0m10:13:27.355808 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m10:13:27.356680 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m10:13:27.357338 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:13:27.357991 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_msat_norm_workload
[0m10:13:27.358792 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m10:13:27.360088 [info ] [Thread-4 (]: 9 of 17 START sql incremental model public.dv_msat_norm_workload ............... [RUN]
[0m10:13:27.361528 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_msat_norm_workload)
[0m10:13:27.362703 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_msat_norm_workload
[0m10:13:27.370446 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.028 seconds
[0m10:13:27.375622 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_norm_workload"
[0m10:13:27.381918 [debug] [Thread-2 (]: SQL status: COMMIT in 0.021 seconds
[0m10:13:27.382563 [debug] [Thread-3 (]: SQL status: SELECT 22 in 0.041 seconds
[0m10:13:27.384370 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: COMMIT
[0m10:13:27.388387 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_works__dbt_backup"
[0m10:13:27.393120 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_pikets: COMMIT
[0m10:13:27.394078 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_msat_norm_workload
[0m10:13:27.394777 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m10:13:27.395874 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:13:27.396397 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:13:27.401788 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_norm_workload"
[0m10:13:27.402571 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: COMMIT
[0m10:13:27.403539 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
drop view if exists "postgres"."public"."stg_1c_works__dbt_backup" cascade
[0m10:13:27.404235 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_pikets: COMMIT
[0m10:13:27.406375 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m10:13:27.407350 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_norm_workload: BEGIN
[0m10:13:27.407871 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:13:27.412937 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m10:13:27.413970 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: Close
[0m10:13:27.414805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d41adc40>]}
[0m10:13:27.416488 [info ] [Thread-1 (]: 8 of 17 OK created sql incremental model public.dv_msat_fact_materials ......... [[32mSELECT 15[0m in 0.24s]
[0m10:13:27.418435 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_msat_fact_materials
[0m10:13:27.419666 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m10:13:27.421683 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m10:13:27.420836 [info ] [Thread-1 (]: 10 of 17 START sql incremental model public.dv_hub_fact_journal ................ [RUN]
[0m10:13:27.422729 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m10:13:27.423907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_materials, now model.tsm_dwh.dv_hub_fact_journal)
[0m10:13:27.425462 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */

      
  
    

  create  table "postgres"."public"."dv_msat_norm_workload"
  
  
    as
  
  (
    


    WITH stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS stg_lag_hdiff
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_norm_workload,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
                FROM "postgres"."public"."stg_1c_norm_workload" s
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            
            OR stg_lag_hdiff IS null

    )

    SELECT DISTINCT 
        stg_id as hk_dv_hub_fact_work,
        stg_recsource as recsource,
        stg_loadts as loadts,
        stg_hdiff as hdiff_dv_msat_norm_workload,
        stg_sub_seq as sub_seq,
        период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq

  );
  
  
[0m10:13:27.426895 [debug] [Thread-3 (]: SQL status: COMMIT in 0.021 seconds
[0m10:13:27.428205 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.022 seconds
[0m10:13:27.429228 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m10:13:27.431302 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_pikets: Close
[0m10:13:27.433870 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: Close
[0m10:13:27.439771 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m10:13:27.441639 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d4122db0>]}
[0m10:13:27.443426 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d53720c0>]}
[0m10:13:27.445437 [info ] [Thread-3 (]: 7 of 17 OK created sql incremental model public.dv_msat_fact_pikets ............ [[32mSELECT 22[0m in 0.28s]
[0m10:13:27.447772 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_msat_fact_pikets
[0m10:13:27.448869 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_sat_fact_journal
[0m10:13:27.449952 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m10:13:27.450723 [debug] [Thread-4 (]: SQL status: SELECT 20 in 0.020 seconds
[0m10:13:27.446746 [info ] [Thread-2 (]: 6 of 17 OK created sql view model public.stg_1c_works .......................... [[32mCREATE VIEW[0m in 0.28s]
[0m10:13:27.451475 [info ] [Thread-3 (]: 11 of 17 START sql incremental model public.dv_sat_fact_journal ................ [RUN]
[0m10:13:27.461805 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_norm_workload: COMMIT
[0m10:13:27.465376 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_journal"
[0m10:13:27.466468 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m10:13:27.467058 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_pikets, now model.tsm_dwh.dv_sat_fact_journal)
[0m10:13:27.467770 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m10:13:27.468534 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m10:13:27.469793 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_sat_fact_journal
[0m10:13:27.470763 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:13:27.471380 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_norm_workload: COMMIT
[0m10:13:27.472457 [info ] [Thread-2 (]: 12 of 17 START sql incremental model public.dv_hub_tech ........................ [RUN]
[0m10:13:27.481539 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_journal"
[0m10:13:27.482273 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: BEGIN
[0m10:13:27.483263 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_works, now model.tsm_dwh.dv_hub_tech)
[0m10:13:27.484578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:13:27.485600 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m10:13:27.486182 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_sat_fact_journal
[0m10:13:27.492395 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m10:13:27.493838 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m10:13:27.501958 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_journal"
[0m10:13:27.503187 [debug] [Thread-4 (]: On model.tsm_dwh.dv_msat_norm_workload: Close
[0m10:13:27.503928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m10:13:27.505014 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c5f2ffe0>]}
[0m10:13:27.505897 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:13:27.508733 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      
  
    

  create  table "postgres"."public"."dv_hub_fact_journal"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal" stg


  );
  
  
[0m10:13:27.509889 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m10:13:27.507624 [info ] [Thread-4 (]: 9 of 17 OK created sql incremental model public.dv_msat_norm_workload .......... [[32mSELECT 20[0m in 0.14s]
[0m10:13:27.511612 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:13:27.517905 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_msat_norm_workload
[0m10:13:27.522775 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_tech"
[0m10:13:27.523597 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_journal: BEGIN
[0m10:13:27.524607 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m10:13:27.525735 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m10:13:27.527181 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:13:27.530803 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m10:13:27.531596 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:13:27.532334 [info ] [Thread-4 (]: 13 of 17 START sql incremental model public.dv_lnk_fact_work_tech .............. [RUN]
[0m10:13:27.533422 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:13:27.534205 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: BEGIN
[0m10:13:27.535127 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_norm_workload, now model.tsm_dwh.dv_lnk_fact_work_tech)
[0m10:13:27.536032 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m10:13:27.536834 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:13:27.537454 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_work_tech
[0m10:13:27.598962 [debug] [Thread-1 (]: SQL status: COMMIT in 0.061 seconds
[0m10:13:27.600418 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m10:13:27.604100 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:13:27.604743 [debug] [Thread-2 (]: SQL status: BEGIN in 0.068 seconds
[0m10:13:27.605367 [debug] [Thread-3 (]: SQL status: BEGIN in 0.078 seconds
[0m10:13:27.606149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c5f39ac0>]}
[0m10:13:27.606970 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:13:27.607710 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:13:27.609213 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_lnk_fact_work_tech
[0m10:13:27.609927 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      
  
    

  create  table "postgres"."public"."dv_hub_tech"
  
  
    as
  
  (
    

SELECT distinct on (bk_ресурс_uuid)
        hk_dv_hub_tech,
        hkcode,
        recsource,
        loadts,
        bk_ресурс_uuid
FROM "postgres"."public"."stg_1c_tech" stg


  );
  
  
[0m10:13:27.608686 [info ] [Thread-1 (]: 10 of 17 OK created sql incremental model public.dv_hub_fact_journal ........... [[32mSELECT 1[0m in 0.18s]
[0m10:13:27.610797 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_journal"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_hub_fact_journal,
        s.hdiff_dv_sat_fact_journal,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_journal) over(PARTITION BY s.hk_dv_hub_fact_journal ORDER BY s.loadts) AS lag_hdiff,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_journal,
            s.hdiff_dv_sat_fact_journal,
            s.loadts,
            s.recsource,
            rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
        FROM "postgres"."public"."stg_1c_journal" s
        ) s
    )

    SELECT DISTINCT
        hk_dv_hub_fact_journal,
        recsource,
        loadts,
        hdiff_dv_sat_fact_journal,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_journal <> lag_hdiff 
        OR lag_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m10:13:27.617482 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:13:27.619236 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m10:13:27.621107 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_sat_fact_tech
[0m10:13:27.622727 [info ] [Thread-1 (]: 14 of 17 START sql incremental model public.dv_sat_fact_tech ................... [RUN]
[0m10:13:27.624191 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:13:27.625312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_fact_journal, now model.tsm_dwh.dv_sat_fact_tech)
[0m10:13:27.626543 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: BEGIN
[0m10:13:27.627861 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_sat_fact_tech
[0m10:13:27.629102 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:13:27.636086 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_tech"
[0m10:13:27.637488 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.019 seconds
[0m10:13:27.640852 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m10:13:27.641824 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:13:27.642725 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m10:13:27.643954 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_sat_fact_tech
[0m10:13:27.645423 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.025 seconds
[0m10:13:27.653570 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_tech"
[0m10:13:27.654139 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m10:13:27.657498 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m10:13:27.659412 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_tech: Close
[0m10:13:27.660407 [debug] [Thread-4 (]: SQL status: BEGIN in 0.031 seconds
[0m10:13:27.661195 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:13:27.662081 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:13:27.662864 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:13:27.664095 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d52e4440>]}
[0m10:13:27.664844 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m10:13:27.665712 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_tech: BEGIN
[0m10:13:27.666441 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      
  
    

  create  table "postgres"."public"."dv_lnk_fact_work_tech"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_work,
	hk_dv_hub_tech)
        hk_dv_lnk_fact_work_tech,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_work,
	hk_dv_hub_tech
FROM "postgres"."public"."stg_1c_tech" stg


  );
  
  
[0m10:13:27.667709 [info ] [Thread-2 (]: 12 of 17 OK created sql incremental model public.dv_hub_tech ................... [[32mSELECT 17[0m in 0.18s]
[0m10:13:27.668995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:13:27.670602 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m10:13:27.672229 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m10:13:27.674776 [info ] [Thread-2 (]: 15 of 17 START sql incremental model public.dv_hub_fact_work ................... [RUN]
[0m10:13:27.676596 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_tech, now model.tsm_dwh.dv_hub_fact_work)
[0m10:13:27.677632 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m10:13:27.685515 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m10:13:27.686383 [debug] [Thread-3 (]: SQL status: COMMIT in 0.017 seconds
[0m10:13:27.687134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m10:13:27.688733 [debug] [Thread-3 (]: On model.tsm_dwh.dv_sat_fact_journal: Close
[0m10:13:27.689582 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m10:13:27.690565 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:13:27.696905 [debug] [Thread-4 (]: SQL status: SELECT 63 in 0.027 seconds
[0m10:13:27.700184 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_work"
[0m10:13:27.700780 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d83b2b10>]}
[0m10:13:27.701504 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_tech"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_lnk_fact_work_tech,
        s.hdiff_dv_sat_fact_tech,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_tech) over(PARTITION BY s.hk_dv_lnk_fact_work_tech ORDER BY s.loadts) AS lag_hdiff,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name

    FROM
        (SELECT
            s.hk_dv_lnk_fact_work_tech,
            s.hdiff_dv_sat_fact_tech,
            s.loadts,
            s.recsource,
            примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
        FROM "postgres"."public"."stg_1c_tech" s
        ) s
    )

    SELECT DISTINCT
        hk_dv_lnk_fact_work_tech,
        recsource,
        loadts,
        hdiff_dv_sat_fact_tech,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_tech <> lag_hdiff 
        OR lag_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m10:13:27.704395 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m10:13:27.705814 [info ] [Thread-3 (]: 11 of 17 OK created sql incremental model public.dv_sat_fact_journal ........... [[32mSELECT 1[0m in 0.23s]
[0m10:13:27.707425 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:13:27.709339 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_sat_fact_journal
[0m10:13:27.710468 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:13:27.711838 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m10:13:27.713316 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m10:13:27.714410 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: BEGIN
[0m10:13:27.715433 [info ] [Thread-3 (]: 16 of 17 START sql incremental model public.dv_lnk_fact_journal_fact_work ...... [RUN]
[0m10:13:27.716316 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:13:27.717043 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_journal, now model.tsm_dwh.dv_lnk_fact_journal_fact_work)
[0m10:13:27.718105 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m10:13:27.725694 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:13:27.726928 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m10:13:27.734649 [debug] [Thread-1 (]: SQL status: SELECT 63 in 0.028 seconds
[0m10:13:27.736862 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m10:13:27.737534 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:13:27.739976 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:13:27.741169 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m10:13:27.742280 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m10:13:27.743183 [debug] [Thread-4 (]: SQL status: COMMIT in 0.028 seconds
[0m10:13:27.744348 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:13:27.745092 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:13:27.746659 [debug] [Thread-4 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: Close
[0m10:13:27.747280 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_hub_fact_work"
  
  
    as
  
  (
    

SELECT distinct on (bk_работа_uuid)
        hk_dv_hub_fact_work,
        hkcode,
        recsource,
        loadts,
        bk_работа_uuid
FROM "postgres"."public"."stg_1c_works" stg


  );
  
  
[0m10:13:27.747933 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: BEGIN
[0m10:13:27.748942 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d82f4c80>]}
[0m10:13:27.749897 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:13:27.751485 [info ] [Thread-4 (]: 13 of 17 OK created sql incremental model public.dv_lnk_fact_work_tech ......... [[32mSELECT 63[0m in 0.21s]
[0m10:13:27.753365 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m10:13:27.754159 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_sat_fact_work
[0m10:13:27.755304 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m10:13:27.758434 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_tech: Close
[0m10:13:27.759843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d52db440>]}
[0m10:13:27.756585 [info ] [Thread-4 (]: 17 of 17 START sql incremental model public.dv_sat_fact_work ................... [RUN]
[0m10:13:27.762102 [info ] [Thread-1 (]: 14 of 17 OK created sql incremental model public.dv_sat_fact_tech .............. [[32mSELECT 63[0m in 0.13s]
[0m10:13:27.763709 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_lnk_fact_work_tech, now model.tsm_dwh.dv_sat_fact_work)
[0m10:13:27.765522 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_sat_fact_tech
[0m10:13:27.766293 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_sat_fact_work
[0m10:13:27.766952 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m10:13:27.773317 [debug] [Thread-2 (]: SQL status: SELECT 22 in 0.025 seconds
[0m10:13:27.777336 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_work"
[0m10:13:27.778058 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:13:27.780893 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m10:13:27.781782 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_lnk_fact_journal_fact_work"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work)
        hk_dv_lnk_fact_journal_fact_work,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work
FROM "postgres"."public"."stg_1c_works" stg


  );
  
  
[0m10:13:27.782472 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:13:27.782989 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_sat_fact_work
[0m10:13:27.783780 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m10:13:27.793542 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_work"
[0m10:13:27.795238 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:13:27.795889 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: BEGIN
[0m10:13:27.796474 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:13:27.804347 [debug] [Thread-3 (]: SQL status: SELECT 22 in 0.021 seconds
[0m10:13:27.808046 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m10:13:27.808798 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:13:27.809820 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m10:13:27.810438 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m10:13:27.811344 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:13:27.811966 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_sat_fact_work"
  
  
    as
  
  (
    



    WITH stage_cte AS (
        SELECT
        s.hk_dv_hub_fact_work,
        s.hdiff_dv_sat_fact_work,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_work) over(PARTITION BY s.hk_dv_hub_fact_work ORDER BY s.loadts) AS lag_hdiff,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_work,
            s.hdiff_dv_sat_fact_work,
            s.loadts,
            s.recsource,
            идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
        FROM "postgres"."public"."stg_1c_works" s
        ) s
    )

    SELECT DISTINCT
        hk_dv_hub_fact_work,
        recsource,
        loadts,
        hdiff_dv_sat_fact_work,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_work <> lag_hdiff 
        OR lag_hdiff IS NULL
    ORDER BY loadts

  );
  
  
[0m10:13:27.813161 [debug] [Thread-2 (]: SQL status: COMMIT in 0.018 seconds
[0m10:13:27.814773 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: Close
[0m10:13:27.816137 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d82f4050>]}
[0m10:13:27.817677 [info ] [Thread-2 (]: 15 of 17 OK created sql incremental model public.dv_hub_fact_work .............. [[32mSELECT 22[0m in 0.14s]
[0m10:13:27.819240 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m10:13:27.823998 [debug] [Thread-3 (]: SQL status: COMMIT in 0.013 seconds
[0m10:13:27.825656 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: Close
[0m10:13:27.826630 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d52c4a10>]}
[0m10:13:27.827505 [info ] [Thread-3 (]: 16 of 17 OK created sql incremental model public.dv_lnk_fact_journal_fact_work . [[32mSELECT 22[0m in 0.11s]
[0m10:13:27.828493 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m10:13:27.840432 [debug] [Thread-4 (]: SQL status: SELECT 22 in 0.028 seconds
[0m10:13:27.843689 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m10:13:27.844406 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:13:27.844989 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m10:13:27.855005 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m10:13:27.856281 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_work: Close
[0m10:13:27.857662 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed032ca0-ba5a-4d65-979f-ea2c8632b6af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d52c6870>]}
[0m10:13:27.859077 [info ] [Thread-4 (]: 17 of 17 OK created sql incremental model public.dv_sat_fact_work .............. [[32mSELECT 22[0m in 0.09s]
[0m10:13:27.860457 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_sat_fact_work
[0m10:13:27.862862 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:27.863799 [debug] [MainThread]: On master: BEGIN
[0m10:13:27.864757 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:13:27.875310 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m10:13:27.875986 [debug] [MainThread]: On master: COMMIT
[0m10:13:27.877087 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:27.877779 [debug] [MainThread]: On master: COMMIT
[0m10:13:27.879057 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:13:27.879742 [debug] [MainThread]: On master: Close
[0m10:13:27.880517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:13:27.880964 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_tech' was properly closed.
[0m10:13:27.881456 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_work' was properly closed.
[0m10:13:27.881872 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work' was properly closed.
[0m10:13:27.882605 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_work' was properly closed.
[0m10:13:27.883574 [info ] [MainThread]: 
[0m10:13:27.884304 [info ] [MainThread]: Finished running 11 incremental models, 6 view models in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m10:13:27.890363 [debug] [MainThread]: Command end result
[0m10:13:27.927701 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m10:13:27.930292 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m10:13:27.940302 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m10:13:27.940921 [info ] [MainThread]: 
[0m10:13:27.941592 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:13:27.942155 [info ] [MainThread]: 
[0m10:13:27.942833 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m10:13:27.944021 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.9470104, "process_in_blocks": "0", "process_kernel_time": 0.279443, "process_mem_max_rss": "123100", "process_out_blocks": "3712", "process_user_time": 3.208484}
[0m10:13:27.944674 [debug] [MainThread]: Command `dbt build` succeeded at 10:13:27.944534 after 1.95 seconds
[0m10:13:27.945236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d84ac860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d851b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d8e675c0>]}
[0m10:13:27.945774 [debug] [MainThread]: Flushing usage events
[0m10:13:29.034645 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:14:02.735468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7bfbf4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7b3abc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7a01d130>]}


============================== 10:14:02.739247 | ce723eee-8c1b-469c-a593-26c33db62140 ==============================
[0m10:14:02.739247 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:14:02.740658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:14:02.919668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7a5fc500>]}
[0m10:14:02.986065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7a12adb0>]}
[0m10:14:02.987058 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:14:03.109674 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:14:03.201733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:14:03.202217 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:14:03.230858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb78f1b020>]}
[0m10:14:03.302949 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m10:14:03.305589 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m10:14:03.333751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb77f09850>]}
[0m10:14:03.334483 [info ] [MainThread]: Found 17 models, 433 macros
[0m10:14:03.337526 [info ] [MainThread]: 
[0m10:14:03.338111 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:14:03.338701 [info ] [MainThread]: 
[0m10:14:03.339486 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:14:03.345940 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:14:03.397726 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:14:03.398280 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:14:03.398746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:03.412377 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.014 seconds
[0m10:14:03.414114 [debug] [ThreadPool]: On list_postgres: Close
[0m10:14:03.416863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m10:14:03.423588 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:14:03.424081 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m10:14:03.424571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:14:03.432950 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:14:03.433509 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:14:03.434053 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:14:03.437500 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.003 seconds
[0m10:14:03.439646 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m10:14:03.440262 [debug] [ThreadPool]: On list_postgres_public: Close
[0m10:14:03.450741 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:03.451235 [debug] [MainThread]: On master: BEGIN
[0m10:14:03.451726 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:14:03.460284 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:14:03.460855 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:03.461424 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:14:03.469371 [debug] [MainThread]: SQL status: SELECT 7 in 0.007 seconds
[0m10:14:03.472902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb793385c0>]}
[0m10:14:03.473717 [debug] [MainThread]: On master: ROLLBACK
[0m10:14:03.474557 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:03.475356 [debug] [MainThread]: On master: BEGIN
[0m10:14:03.476617 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:14:03.477371 [debug] [MainThread]: On master: COMMIT
[0m10:14:03.478067 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:03.478763 [debug] [MainThread]: On master: COMMIT
[0m10:14:03.479582 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:14:03.480381 [debug] [MainThread]: On master: Close
[0m10:14:03.485197 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m10:14:03.488612 [info ] [Thread-1 (]: 1 of 17 START sql view model public.stg_1c_journal ............................. [RUN]
[0m10:14:03.486821 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_norm_workload
[0m10:14:03.485922 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_materials
[0m10:14:03.489787 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_pikets
[0m10:14:03.490978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m10:14:03.492341 [info ] [Thread-3 (]: 3 of 17 START sql view model public.stg_1c_norm_workload ....................... [RUN]
[0m10:14:03.493197 [info ] [Thread-2 (]: 2 of 17 START sql view model public.stg_1c_materials ........................... [RUN]
[0m10:14:03.494244 [info ] [Thread-4 (]: 4 of 17 START sql view model public.stg_1c_pikets .............................. [RUN]
[0m10:14:03.495126 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m10:14:03.496323 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_norm_workload'
[0m10:14:03.497694 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_materials'
[0m10:14:03.498898 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_pikets'
[0m10:14:03.510035 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_norm_workload
[0m10:14:03.512927 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m10:14:03.513725 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_materials
[0m10:14:03.514354 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_pikets
[0m10:14:03.518348 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_norm_workload"
[0m10:14:03.521896 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_materials"
[0m10:14:03.526084 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_pikets"
[0m10:14:03.527041 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m10:14:03.528371 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_norm_workload
[0m10:14:03.529235 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_materials
[0m10:14:03.545514 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_pikets
[0m10:14:03.603738 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m10:14:03.605008 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_norm_workload"
[0m10:14:03.605725 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_materials"
[0m10:14:03.610346 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_pikets"
[0m10:14:03.612056 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:14:03.613008 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:14:03.613775 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m10:14:03.614493 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:14:03.615061 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: BEGIN
[0m10:14:03.615684 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:14:03.616343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:14:03.616946 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: BEGIN
[0m10:14:03.617572 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:14:03.618199 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: BEGIN
[0m10:14:03.619277 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:14:03.620400 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:14:03.631218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m10:14:03.632406 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:14:03.633922 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m10:14:03.635161 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m10:14:03.635765 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m10:14:03.636359 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:14:03.637024 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m10:14:03.637853 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:14:03.638472 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */

  create view "postgres"."public"."stg_1c_materials__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(НомерСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемМатериала::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_materials,
	НомерСтроки::int,
	Примечание::varchar,
	ОбъемМатериала::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar
    FROM 
        src_materials
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_materials,
	номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name)
  );
[0m10:14:03.639106 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:14:03.639894 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */

  create view "postgres"."public"."stg_1c_pikets__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(КлючСтроки::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетС::varchar, 'N\A')) || '|' || TRIM(COALESCE(ПикетПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеС::varchar, 'N\A')) || '|' || TRIM(COALESCE(СмещениеПо::varchar, 'N\A')) || '|' || TRIM(COALESCE(Объем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТипПикета_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГруппаПикетовSpider_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_fact_pikets,
	КлючСтроки::uuid,
	ПикетС::numeric,
	ПикетПо::numeric,
	СмещениеС::numeric,
	СмещениеПо::numeric,
	Объем::numeric,
	ВидПикета_value::uuid,
	ВидПикета_codе::varchar,
	ВидПикета_name::varchar,
	ТипПикета_value::uuid,
	ТипПикета_codе::varchar,
	ТипПикета_name::varchar,
	ГруппаПикетовSpider_value::uuid,
	ГруппаПикетовSpider_codе::varchar,
	ГруппаПикетовSpider_name::varchar
    FROM 
        src_pikets
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_fact_pikets,
	ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name)
  );
[0m10:14:03.640580 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:14:03.641303 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */

  create view "postgres"."public"."stg_1c_norm_workload__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(Регистратор::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(Период::varchar, 'N\A')) || '|' || TRIM(COALESCE(РассчетныйОбъем::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьНормативная::varchar, 'N\A')) || '|' || TRIM(COALESCE(ТрудоемкостьФактическая::varchar, 'N\A')) || '|' || TRIM(COALESCE(НаемныйРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючевойРесурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(НесколькоКлючевыхРесурсов::varchar, 'N\A')) || '|' || TRIM(COALESCE(ЖУФВР::varchar, 'N\A')) || '|' || TRIM(COALESCE(КлючДокументаРесурс::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(РесурсSpider_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')), 'sha1') as hdiff_dv_msat_norm_workload,
	Период::timestamptz,
	РассчетныйОбъем::numeric,
	ТрудоемкостьНормативная::numeric,
	ТрудоемкостьФактическая::numeric,
	НаемныйРесурс::bool,
	КлючевойРесурс_value::uuid,
	КлючевойРесурс_codе::varchar,
	КлючевойРесурс_name::varchar,
	НесколькоКлючевыхРесурсов::bool,
	ЖУФВР::uuid,
	КлючДокументаРесурс::uuid,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	РесурсSpider_value::uuid,
	РесурсSpider_codе::varchar,
	РесурсSpider_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar
    FROM 
        src_norm_workload
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hdiff_dv_msat_norm_workload,
	период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name)
  );
[0m10:14:03.650108 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:14:03.650931 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m10:14:03.651543 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m10:14:03.652130 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m10:14:03.656157 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:14:03.656856 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:14:03.660557 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:14:03.661490 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets" rename to "stg_1c_pikets__dbt_backup"
[0m10:14:03.662351 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:14:03.666428 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:14:03.667101 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials" rename to "stg_1c_materials__dbt_backup"
[0m10:14:03.670836 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:14:03.671405 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:14:03.671952 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload" rename to "stg_1c_norm_workload__dbt_backup"
[0m10:14:03.672704 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m10:14:03.673353 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:14:03.678012 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:14:03.681834 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:14:03.682374 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:14:03.682867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:14:03.683434 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
alter table "postgres"."public"."stg_1c_pikets__dbt_tmp" rename to "stg_1c_pikets"
[0m10:14:03.684065 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
alter table "postgres"."public"."stg_1c_materials__dbt_tmp" rename to "stg_1c_materials"
[0m10:14:03.687626 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:14:03.707211 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m10:14:03.708003 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:14:03.708865 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
alter table "postgres"."public"."stg_1c_norm_workload__dbt_tmp" rename to "stg_1c_norm_workload"
[0m10:14:03.709671 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:14:03.710198 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:14:03.712437 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m10:14:03.713078 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m10:14:03.715456 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m10:14:03.715986 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:14:03.716671 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:14:03.717545 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:14:03.719852 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m10:14:03.720469 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: COMMIT
[0m10:14:03.721503 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: COMMIT
[0m10:14:03.722211 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:14:03.723156 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: COMMIT
[0m10:14:03.734543 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m10:14:03.742718 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m10:14:03.749834 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m10:14:03.750546 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m10:14:03.762297 [debug] [Thread-4 (]: SQL status: COMMIT in 0.039 seconds
[0m10:14:03.763155 [debug] [Thread-2 (]: SQL status: COMMIT in 0.040 seconds
[0m10:14:03.763772 [debug] [Thread-3 (]: SQL status: COMMIT in 0.040 seconds
[0m10:14:03.766958 [debug] [Thread-4 (]: Applying DROP to: "postgres"."public"."stg_1c_pikets__dbt_backup"
[0m10:14:03.769685 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_materials__dbt_backup"
[0m10:14:03.772406 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_norm_workload__dbt_backup"
[0m10:14:03.773879 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.stg_1c_pikets"
[0m10:14:03.774909 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_materials"
[0m10:14:03.776033 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_norm_workload"
[0m10:14:03.776653 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_pikets"} */
drop view if exists "postgres"."public"."stg_1c_pikets__dbt_backup" cascade
[0m10:14:03.777396 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_materials"} */
drop view if exists "postgres"."public"."stg_1c_materials__dbt_backup" cascade
[0m10:14:03.778299 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_norm_workload"} */
drop view if exists "postgres"."public"."stg_1c_norm_workload__dbt_backup" cascade
[0m10:14:03.794313 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.043 seconds
[0m10:14:03.797344 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m10:14:03.799398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7be63b60>]}
[0m10:14:03.800416 [info ] [Thread-1 (]: 1 of 17 OK created sql view model public.stg_1c_journal ........................ [[32mCREATE VIEW[0m in 0.31s]
[0m10:14:03.801470 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m10:14:03.802081 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m10:14:03.802890 [info ] [Thread-1 (]: 5 of 17 START sql view model public.stg_1c_tech ................................ [RUN]
[0m10:14:03.803786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_journal, now model.tsm_dwh.stg_1c_tech)
[0m10:14:03.804357 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m10:14:03.810262 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m10:14:03.811660 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m10:14:03.819582 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.041 seconds
[0m10:14:03.821153 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m10:14:03.821807 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.043 seconds
[0m10:14:03.823461 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_materials: Close
[0m10:14:03.823942 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.045 seconds
[0m10:14:03.825769 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_norm_workload: Close
[0m10:14:03.826654 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb79a116d0>]}
[0m10:14:03.829237 [debug] [Thread-4 (]: On model.tsm_dwh.stg_1c_pikets: Close
[0m10:14:03.830561 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:14:03.832196 [info ] [Thread-2 (]: 2 of 17 OK created sql view model public.stg_1c_materials ...................... [[32mCREATE VIEW[0m in 0.33s]
[0m10:14:03.833429 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb769fa6f0>]}
[0m10:14:03.834856 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m10:14:03.835445 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb5f746720>]}
[0m10:14:03.837056 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_materials
[0m10:14:03.838733 [info ] [Thread-3 (]: 3 of 17 OK created sql view model public.stg_1c_norm_workload .................. [[32mCREATE VIEW[0m in 0.34s]
[0m10:14:03.839961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:14:03.841165 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_works
[0m10:14:03.842922 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_norm_workload
[0m10:14:03.842266 [info ] [Thread-4 (]: 4 of 17 OK created sql view model public.stg_1c_pikets ......................... [[32mCREATE VIEW[0m in 0.34s]
[0m10:14:03.844468 [info ] [Thread-2 (]: 6 of 17 START sql view model public.stg_1c_works ............................... [RUN]
[0m10:14:03.846213 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m10:14:03.847988 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_pikets
[0m10:14:03.849035 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_materials, now model.tsm_dwh.stg_1c_works)
[0m10:14:03.852163 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m10:14:03.851050 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_sat_fact_journal
[0m10:14:03.849987 [info ] [Thread-3 (]: 7 of 17 START sql incremental model public.dv_hub_fact_journal ................. [RUN]
[0m10:14:03.859399 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m10:14:03.860495 [info ] [Thread-4 (]: 8 of 17 START sql incremental model public.dv_sat_fact_journal ................. [RUN]
[0m10:14:03.862026 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m10:14:03.863111 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_norm_workload, now model.tsm_dwh.dv_hub_fact_journal)
[0m10:14:03.864603 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_pikets, now model.tsm_dwh.dv_sat_fact_journal)
[0m10:14:03.865886 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:14:03.867038 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m10:14:03.867829 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m10:14:03.868505 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_sat_fact_journal
[0m10:14:03.869279 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m10:14:03.884497 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m10:14:03.890425 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m10:14:03.898228 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_journal"
[0m10:14:03.899372 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:14:03.900025 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m10:14:03.900741 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:14:03.901610 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:14:03.908323 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m10:14:03.909241 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:14:03.915196 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_sat_fact_journal
[0m10:14:03.921347 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech" rename to "stg_1c_tech__dbt_backup"
[0m10:14:03.936889 [debug] [Thread-2 (]: SQL status: BEGIN in 0.036 seconds
[0m10:14:03.987363 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:14:03.989758 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:14:03.986945 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:14:03.990593 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:14:03.994338 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:14:03.995024 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

    
  
    

  create temporary table "dv_hub_fact_journal__dbt_tmp101403952867"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_journal" target
    where 
        target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_journal 
)

  );
  
  
[0m10:14:03.995776 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

    
  
    

  create temporary table "dv_sat_fact_journal__dbt_tmp101403982431"
  
  
    as
  
  (
    



    WITH active_sat AS (
    SELECT DISTINCT ON (hk_dv_hub_fact_journal) hk_dv_hub_fact_journal, hdiff_dv_sat_fact_journal, loadts
    FROM "postgres"."public"."dv_sat_fact_journal"
    ORDER BY hk_dv_hub_fact_journal, loadts DESC)

    , max_load AS (
    SELECT max(loadts) AS max_loadts
    FROM "postgres"."public"."dv_sat_fact_journal"
    )
    , stage_cte AS (

        SELECT
        s.hk_dv_hub_fact_journal,
        s.hdiff_dv_sat_fact_journal,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_journal) over(PARTITION BY s.hk_dv_hub_fact_journal ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_journal AS sat_hdiff,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_journal,
            s.hdiff_dv_sat_fact_journal,
            s.loadts,
            s.recsource,
            rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
        FROM "postgres"."public"."stg_1c_journal" s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts
        ) s
    LEFT JOIN active_sat a ON a.hk_dv_hub_fact_journal = s.hk_dv_hub_fact_journal)

    SELECT DISTINCT
        hk_dv_hub_fact_journal,
        recsource,
        loadts,
        hdiff_dv_sat_fact_journal,
        rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_journal <> lag_hdiff 
            OR (hdiff_dv_sat_fact_journal <> sat_hdiff AND lag_hdiff IS NULL) 
            OR sat_hdiff IS NULL
    ORDER BY loadts


  );
  
  
[0m10:14:03.996552 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    

SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m10:14:03.997367 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech__dbt_tmp" rename to "stg_1c_tech"
[0m10:14:03.997971 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:14:03.998553 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:14:04.000063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:14:04.004374 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m10:14:04.005113 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:14:04.005959 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:14:04.010001 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:14:04.011064 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m10:14:04.012122 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works" rename to "stg_1c_works__dbt_backup"
[0m10:14:04.014077 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:14:04.020918 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:14:04.021879 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.024 seconds
[0m10:14:04.022640 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works__dbt_tmp" rename to "stg_1c_works"
[0m10:14:04.023152 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.025 seconds
[0m10:14:04.029065 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m10:14:04.040149 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:14:04.040875 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m10:14:04.044412 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:14:04.047500 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_tech__dbt_backup"
[0m10:14:04.048199 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: BEGIN
[0m10:14:04.050446 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m10:14:04.051077 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: BEGIN
[0m10:14:04.052300 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m10:14:04.053141 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:14:04.053880 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m10:14:04.054538 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
drop view if exists "postgres"."public"."stg_1c_tech__dbt_backup" cascade
[0m10:14:04.055092 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m10:14:04.055687 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m10:14:04.056346 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:14:04.057020 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:14:04.057737 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal__dbt_tmp101403952867'
        
      order by ordinal_position

  
[0m10:14:04.058659 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_journal__dbt_tmp101403982431'
        
      order by ordinal_position

  
[0m10:14:04.067542 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.008 seconds
[0m10:14:04.068368 [debug] [Thread-4 (]: SQL status: SELECT 33 in 0.009 seconds
[0m10:14:04.074030 [debug] [Thread-2 (]: SQL status: COMMIT in 0.016 seconds
[0m10:14:04.074938 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:14:04.078976 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:14:04.081906 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_works__dbt_backup"
[0m10:14:04.082568 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.083123 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.084385 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m10:14:04.085293 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
drop view if exists "postgres"."public"."stg_1c_works__dbt_backup" cascade
[0m10:14:04.089123 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.004 seconds
[0m10:14:04.095730 [debug] [Thread-4 (]: SQL status: SELECT 33 in 0.011 seconds
[0m10:14:04.098567 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:14:04.102893 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:14:04.103577 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.104138 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.047 seconds
[0m10:14:04.104795 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.106580 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m10:14:04.107742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb76957710>]}
[0m10:14:04.108915 [debug] [Thread-3 (]: SQL status: SELECT 5 in 0.003 seconds
[0m10:14:04.110310 [info ] [Thread-1 (]: 5 of 17 OK created sql view model public.stg_1c_tech ........................... [[32mCREATE VIEW[0m in 0.30s]
[0m10:14:04.117143 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m10:14:04.118382 [debug] [Thread-4 (]: SQL status: SELECT 33 in 0.011 seconds
[0m10:14:04.119597 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_msat_fact_materials
[0m10:14:04.128567 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_journal"
[0m10:14:04.129505 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.043 seconds
[0m10:14:04.133386 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_journal"
[0m10:14:04.134782 [info ] [Thread-1 (]: 9 of 17 START sql incremental model public.dv_msat_fact_materials .............. [RUN]
[0m10:14:04.137731 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_works: Close
[0m10:14:04.138787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_msat_fact_materials)
[0m10:14:04.139517 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:14:04.140407 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:14:04.141101 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_msat_fact_materials
[0m10:14:04.142169 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb5f690ad0>]}
[0m10:14:04.143697 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      insert into "postgres"."public"."dv_hub_fact_journal" ("hk_dv_hub_fact_journal", "hkcode", "recsource", "loadts", "bk_жуфвр_uuid")
    (
        select "hk_dv_hub_fact_journal", "hkcode", "recsource", "loadts", "bk_жуфвр_uuid"
        from "dv_hub_fact_journal__dbt_tmp101403952867"
    )


  
[0m10:14:04.144740 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_journal"} */

      insert into "postgres"."public"."dv_sat_fact_journal" ("hk_dv_hub_fact_journal", "recsource", "loadts", "hdiff_dv_sat_fact_journal", "rabbit_uuid", "rabbit_дата", "проведен", "uuid_жуфвр", "пометка_удаления", "дата", "номер", "территория_value", "территория_codе", "территория_name", "подразделение_value", "подразделение_codе", "подразделение_name", "смена_value", "смена_codе", "смена_name", "прораб_value", "прораб_codе", "прораб_name", "комментарий", "ответственный_value", "ответственный_codе", "ответственный_name", "версия_жуфвр_value", "версия_жуфвр_codе", "версия_жуфвр_name", "направление_деятельности_value", "направление_деятельности_codе", "направление_деятельности_name")
    (
        select "hk_dv_hub_fact_journal", "recsource", "loadts", "hdiff_dv_sat_fact_journal", "rabbit_uuid", "rabbit_дата", "проведен", "uuid_жуфвр", "пометка_удаления", "дата", "номер", "территория_value", "территория_codе", "территория_name", "подразделение_value", "подразделение_codе", "подразделение_name", "смена_value", "смена_codе", "смена_name", "прораб_value", "прораб_codе", "прораб_name", "комментарий", "ответственный_value", "ответственный_codе", "ответственный_name", "версия_жуфвр_value", "версия_жуфвр_codе", "версия_жуфвр_name", "направление_деятельности_value", "направление_деятельности_codе", "направление_деятельности_name"
        from "dv_sat_fact_journal__dbt_tmp101403982431"
    )


  
[0m10:14:04.152105 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_materials"
[0m10:14:04.153395 [info ] [Thread-2 (]: 6 of 17 OK created sql view model public.stg_1c_works .......................... [[32mCREATE VIEW[0m in 0.29s]
[0m10:14:04.154684 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m10:14:04.155506 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m10:14:04.156291 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_msat_fact_materials
[0m10:14:04.156822 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m10:14:04.159165 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m10:14:04.160483 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_msat_norm_workload
[0m10:14:04.168572 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m10:14:04.171647 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m10:14:04.173834 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m10:14:04.174835 [info ] [Thread-2 (]: 10 of 17 START sql incremental model public.dv_msat_norm_workload .............. [RUN]
[0m10:14:04.175819 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_journal"
[0m10:14:04.176818 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */

    
  
    

  create temporary table "dv_msat_fact_materials__dbt_tmp101404166426"
  
  
    as
  
  (
    


    WITH active_sat AS (
    SELECT *
    FROM (
        SELECT 
            hk_dv_hub_fact_work,
            hdiff_dv_msat_fact_materials,
            loadts,
            sub_seq,
            COUNT(*) OVER (PARTITION BY hk_dv_hub_fact_work, loadts) AS cnt,
            rank() OVER (
                PARTITION BY hk_dv_hub_fact_work
                ORDER BY loadts DESC
            ) AS rnk
        FROM "postgres"."public"."dv_msat_fact_materials"
        ) a (
            sat_id,
            sat_hdiff,
            sat_loadts,
            sat_sub_seq,
            sat_count,
            sat_rnk
        )
    WHERE sat_rnk = 1
    ),
    stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS 
                stg_lag_hdiff,
                sat_hdiff,
                sat_count,
                sat_sub_seq,
                sat_rnk
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_materials,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
                FROM "postgres"."public"."stg_1c_materials" s
                    CROSS JOIN (
                        SELECT max(loadts) AS max_loadts
                        FROM "postgres"."public"."dv_msat_fact_materials"
                    ) ml
                WHERE s.loadts > ml.max_loadts
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
        LEFT JOIN active_sat a ON sat_id = stg_id
        AND sat_sub_seq = stg_sub_seq
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count,
                    sat_hdiff,
                    sat_count,
                    sat_sub_seq,
                    sat_rnk
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            OR (
                (
                    stg_hdiff <> sat_hdiff
                    AND stg_lag_hdiff IS NULL
                )
                OR (
                    stg_count <> sat_count
                    AND stg_lag_count IS NULL
                )
            )
    )

    SELECT DISTINCT 
        stg_id as hk_dv_hub_fact_work,
        stg_recsource as recsource,
        stg_loadts as loadts,
        stg_hdiff as hdiff_dv_msat_fact_materials,
        stg_sub_seq as sub_seq,
        номер_строки,
	примечание,
	объем_материала,
	ресурс_value,
	ресурс_codе,
	ресурс_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq


  );
  
  
[0m10:14:04.177531 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m10:14:04.178281 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_works, now model.tsm_dwh.dv_msat_norm_workload)
[0m10:14:04.179332 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: COMMIT
[0m10:14:04.180406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:14:04.181816 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_msat_norm_workload
[0m10:14:04.193408 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_norm_workload"
[0m10:14:04.194330 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_msat_norm_workload
[0m10:14:04.254094 [debug] [Thread-3 (]: SQL status: COMMIT in 0.072 seconds
[0m10:14:04.255030 [debug] [Thread-4 (]: SQL status: COMMIT in 0.072 seconds
[0m10:14:04.260630 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m10:14:04.261182 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.081 seconds
[0m10:14:04.262162 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m10:14:04.263204 [debug] [Thread-4 (]: On model.tsm_dwh.dv_sat_fact_journal: Close
[0m10:14:04.264057 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */

    
  
    

  create temporary table "dv_msat_norm_workload__dbt_tmp101404257801"
  
  
    as
  
  (
    


    WITH active_sat AS (
    SELECT *
    FROM (
        SELECT 
            hk_dv_hub_fact_work,
            hdiff_dv_msat_norm_workload,
            loadts,
            sub_seq,
            COUNT(*) OVER (PARTITION BY hk_dv_hub_fact_work, loadts) AS cnt,
            rank() OVER (
                PARTITION BY hk_dv_hub_fact_work
                ORDER BY loadts DESC
            ) AS rnk
        FROM "postgres"."public"."dv_msat_norm_workload"
        ) a (
            sat_id,
            sat_hdiff,
            sat_loadts,
            sat_sub_seq,
            sat_count,
            sat_rnk
        )
    WHERE sat_rnk = 1
    ),
    stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS 
                stg_lag_hdiff,
                sat_hdiff,
                sat_count,
                sat_sub_seq,
                sat_rnk
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_norm_workload,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
                FROM "postgres"."public"."stg_1c_norm_workload" s
                    CROSS JOIN (
                        SELECT max(loadts) AS max_loadts
                        FROM "postgres"."public"."dv_msat_norm_workload"
                    ) ml
                WHERE s.loadts > ml.max_loadts
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
        LEFT JOIN active_sat a ON sat_id = stg_id
        AND sat_sub_seq = stg_sub_seq
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count,
                    sat_hdiff,
                    sat_count,
                    sat_sub_seq,
                    sat_rnk
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            OR (
                (
                    stg_hdiff <> sat_hdiff
                    AND stg_lag_hdiff IS NULL
                )
                OR (
                    stg_count <> sat_count
                    AND stg_lag_count IS NULL
                )
            )
    )

    SELECT DISTINCT 
        stg_id as hk_dv_hub_fact_work,
        stg_recsource as recsource,
        stg_loadts as loadts,
        stg_hdiff as hdiff_dv_msat_norm_workload,
        stg_sub_seq as sub_seq,
        период,
	рассчетный_объем,
	трудоемкость_нормативная,
	трудоемкость_фактическая,
	наемный_ресурс,
	ключевой_ресурс_value,
	ключевой_ресурс_code,
	ключевой_ресурс_name,
	несколько_ключевых_ресурсов,
	жуфвр,
	ключ_документа_ресурс,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	ресурс_spider_value,
	ресурс_spider_codе,
	ресурс_spider_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq


  );
  
  
[0m10:14:04.267949 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m10:14:04.269007 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb5f6b36e0>]}
[0m10:14:04.270152 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb5f7f5dc0>]}
[0m10:14:04.270735 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:14:04.271281 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: BEGIN
[0m10:14:04.272182 [info ] [Thread-3 (]: 7 of 17 OK created sql incremental model public.dv_hub_fact_journal ............ [[32mINSERT 0 0[0m in 0.41s]
[0m10:14:04.273337 [info ] [Thread-4 (]: 8 of 17 OK created sql incremental model public.dv_sat_fact_journal ............ [[32mINSERT 0 0[0m in 0.41s]
[0m10:14:04.274827 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m10:14:04.275429 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m10:14:04.276347 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_sat_fact_journal
[0m10:14:04.276934 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_msat_fact_pikets
[0m10:14:04.277621 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m10:14:04.278610 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m10:14:04.280479 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_msat_fact_materials__dbt_tmp101404166426'
        
      order by ordinal_position

  
[0m10:14:04.279824 [info ] [Thread-3 (]: 11 of 17 START sql incremental model public.dv_msat_fact_pikets ................ [RUN]
[0m10:14:04.283798 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_fact_journal, now model.tsm_dwh.dv_msat_fact_pikets)
[0m10:14:04.281718 [info ] [Thread-4 (]: 12 of 17 START sql incremental model public.dv_hub_tech ........................ [RUN]
[0m10:14:04.289121 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_journal, now model.tsm_dwh.dv_hub_tech)
[0m10:14:04.286677 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_msat_fact_pikets
[0m10:14:04.290415 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m10:14:04.297425 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.027 seconds
[0m10:14:04.300233 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:14:04.300955 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.018 seconds
[0m10:14:04.307573 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m10:14:04.311336 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m10:14:04.316595 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m10:14:04.318680 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m10:14:04.319940 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: BEGIN
[0m10:14:04.320784 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_msat_fact_pikets
[0m10:14:04.321916 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_msat_fact_materials'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.329593 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:14:04.335483 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m10:14:04.336967 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:14:04.337911 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

    
  
    

  create temporary table "dv_hub_tech__dbt_tmp101404326523"
  
  
    as
  
  (
    

SELECT distinct on (bk_ресурс_uuid)
        hk_dv_hub_tech,
        hkcode,
        recsource,
        loadts,
        bk_ресурс_uuid
FROM "postgres"."public"."stg_1c_tech" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_tech" target
    where 
        target.hk_dv_hub_tech = stg.hk_dv_hub_tech 
)

  );
  
  
[0m10:14:04.338824 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m10:14:04.339904 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */

    
  
    

  create temporary table "dv_msat_fact_pikets__dbt_tmp101404333564"
  
  
    as
  
  (
    


    WITH active_sat AS (
    SELECT *
    FROM (
        SELECT 
            hk_dv_hub_fact_work,
            hdiff_dv_msat_fact_pikets,
            loadts,
            sub_seq,
            COUNT(*) OVER (PARTITION BY hk_dv_hub_fact_work, loadts) AS cnt,
            rank() OVER (
                PARTITION BY hk_dv_hub_fact_work
                ORDER BY loadts DESC
            ) AS rnk
        FROM "postgres"."public"."dv_msat_fact_pikets"
        ) a (
            sat_id,
            sat_hdiff,
            sat_loadts,
            sat_sub_seq,
            sat_count,
            sat_rnk
        )
    WHERE sat_rnk = 1
    ),
    stage_cte AS (
        SELECT 
            stg_id,
            stg_hdiff,
            stg_loadts,
            stg_recsource,
            stg_sub_seq,
            ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name,
            COUNT(*) OVER (PARTITION BY stg_id, stg_loadts) AS stg_count,
            lag(stg_hdiff) over(
                PARTITION BY stg_id, stg_sub_seq
                ORDER BY stg_loadts
            ) AS 
                stg_lag_hdiff,
                sat_hdiff,
                sat_count,
                sat_sub_seq,
                sat_rnk
        FROM (
                SELECT 
                    s.hk_dv_hub_fact_work,
                    s.hdiff_dv_msat_fact_pikets,
                    s.loadts,
                    s.recsource,
                    row_number() OVER(PARTITION BY s.hk_dv_hub_fact_work, s.loadts) AS sub_seq,
                    ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
                FROM "postgres"."public"."stg_1c_pikets" s
                    CROSS JOIN (
                        SELECT max(loadts) AS max_loadts
                        FROM "postgres"."public"."dv_msat_fact_pikets"
                    ) ml
                WHERE s.loadts > ml.max_loadts
            ) s (stg_id, stg_hdiff, stg_loadts, stg_recsource, stg_sub_seq)
        LEFT JOIN active_sat a ON sat_id = stg_id
        AND sat_sub_seq = stg_sub_seq
    ),
    stage_for_insert AS (
        SELECT DISTINCT 
            stg_id,
            stg_loadts
        FROM (
                SELECT stg_id,
                    stg_loadts,
                    stg_hdiff,
                    stg_lag_hdiff,
                    stg_count,
                    lag(stg_count) over(
                        PARTITION BY stg_id,
                        stg_sub_seq
                        ORDER BY stg_loadts
                    ) AS stg_lag_count,
                    sat_hdiff,
                    sat_count,
                    sat_sub_seq,
                    sat_rnk
                FROM stage_cte
            ) t
        WHERE (
                stg_hdiff <> stg_lag_hdiff
                OR stg_count <> stg_lag_count
            )
            OR (
                (
                    stg_hdiff <> sat_hdiff
                    AND stg_lag_hdiff IS NULL
                )
                OR (
                    stg_count <> sat_count
                    AND stg_lag_count IS NULL
                )
            )
    )

    SELECT DISTINCT 
        stg_id as hk_dv_hub_fact_work,
        stg_recsource as recsource,
        stg_loadts as loadts,
        stg_hdiff as hdiff_dv_msat_fact_pikets,
        stg_sub_seq as sub_seq,
        ключстроки,
	пикет_с,
	пикет_по,
	смещение_с,
	смещение_по,
	объем_работы,
	вид_пикета_value,
	вид_пикета_codе,
	вид_пикета_name,
	тип_пикета_value,
	тип_пикета_codе,
	тип_пикета_name,
	группа_пикетов_spider_value,
	группа_пикетов_spider_codе,
	группа_пикетов_spider_name
    FROM stage_cte s
    WHERE EXISTS(
            SELECT 1
            FROM stage_for_insert si
            WHERE si.stg_id = s.stg_id
                AND si.stg_loadts = s.stg_loadts
        )
    ORDER BY stg_loadts,
        stg_id,
        stg_sub_seq


  );
  
  
[0m10:14:04.340870 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:14:04.341811 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.004 seconds
[0m10:14:04.342890 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_msat_norm_workload__dbt_tmp101404257801'
        
      order by ordinal_position

  
[0m10:14:04.343579 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:14:04.350153 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m10:14:04.351341 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_msat_fact_materials'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.356733 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.004 seconds
[0m10:14:04.361853 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_materials"
[0m10:14:04.362682 [debug] [Thread-2 (]: SQL status: SELECT 25 in 0.013 seconds
[0m10:14:04.363516 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.023 seconds
[0m10:14:04.370338 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m10:14:04.371069 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.028 seconds
[0m10:14:04.374561 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:14:04.375107 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m10:14:04.375781 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_msat_norm_workload'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.379055 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:14:04.379790 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: BEGIN
[0m10:14:04.380402 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_materials"} */

      insert into "postgres"."public"."dv_msat_fact_materials" ("hk_dv_hub_fact_work", "recsource", "loadts", "hdiff_dv_msat_fact_materials", "sub_seq", "номер_строки", "примечание", "объем_материала", "ресурс_value", "ресурс_codе", "ресурс_name")
    (
        select "hk_dv_hub_fact_work", "recsource", "loadts", "hdiff_dv_msat_fact_materials", "sub_seq", "номер_строки", "примечание", "объем_материала", "ресурс_value", "ресурс_codе", "ресурс_name"
        from "dv_msat_fact_materials__dbt_tmp101404166426"
    )


  
[0m10:14:04.381077 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_pikets: BEGIN
[0m10:14:04.382531 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m10:14:04.383479 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:14:04.384351 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m10:14:04.384851 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m10:14:04.385391 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_msat_fact_pikets__dbt_tmp101404333564'
        
      order by ordinal_position

  
[0m10:14:04.385972 [debug] [Thread-2 (]: SQL status: SELECT 25 in 0.005 seconds
[0m10:14:04.386578 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:14:04.388711 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: COMMIT
[0m10:14:04.396003 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m10:14:04.397021 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech__dbt_tmp101404326523'
        
      order by ordinal_position

  
[0m10:14:04.397806 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_materials"
[0m10:14:04.398482 [debug] [Thread-3 (]: SQL status: SELECT 20 in 0.009 seconds
[0m10:14:04.399052 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_msat_norm_workload'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.399890 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: COMMIT
[0m10:14:04.404370 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:14:04.405444 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_msat_fact_pikets'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.406449 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.007 seconds
[0m10:14:04.411886 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:14:04.412545 [debug] [Thread-2 (]: SQL status: SELECT 25 in 0.007 seconds
[0m10:14:04.413101 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.413730 [debug] [Thread-3 (]: SQL status: SELECT 20 in 0.008 seconds
[0m10:14:04.416641 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_norm_workload"
[0m10:14:04.422830 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:14:04.423620 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.006 seconds
[0m10:14:04.424349 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m10:14:04.424962 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_msat_fact_pikets'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.429245 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:14:04.429894 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m10:14:04.430943 [debug] [Thread-1 (]: On model.tsm_dwh.dv_msat_fact_materials: Close
[0m10:14:04.431848 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.432754 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_norm_workload"} */

      insert into "postgres"."public"."dv_msat_norm_workload" ("hk_dv_hub_fact_work", "recsource", "loadts", "hdiff_dv_msat_norm_workload", "sub_seq", "период", "рассчетный_объем", "трудоемкость_нормативная", "трудоемкость_фактическая", "наемный_ресурс", "ключевой_ресурс_value", "ключевой_ресурс_code", "ключевой_ресурс_name", "несколько_ключевых_ресурсов", "жуфвр", "ключ_документа_ресурс", "структура_работ_value", "структура_работ_codе", "структура_работ_name", "ресурс_spider_value", "ресурс_spider_codе", "ресурс_spider_name", "аналитика_value", "аналитика_codе", "аналитика_name")
    (
        select "hk_dv_hub_fact_work", "recsource", "loadts", "hdiff_dv_msat_norm_workload", "sub_seq", "период", "рассчетный_объем", "трудоемкость_нормативная", "трудоемкость_фактическая", "наемный_ресурс", "ключевой_ресурс_value", "ключевой_ресурс_code", "ключевой_ресурс_name", "несколько_ключевых_ресурсов", "жуфвр", "ключ_документа_ресурс", "структура_работ_value", "структура_работ_codе", "структура_работ_name", "ресурс_spider_value", "ресурс_spider_codе", "ресурс_spider_name", "аналитика_value", "аналитика_codе", "аналитика_name"
        from "dv_msat_norm_workload__dbt_tmp101404257801"
    )


  
[0m10:14:04.434408 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m10:14:04.437624 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: COMMIT
[0m10:14:04.438348 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.005 seconds
[0m10:14:04.438819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb5f7d6f00>]}
[0m10:14:04.439361 [debug] [Thread-3 (]: SQL status: SELECT 20 in 0.008 seconds
[0m10:14:04.439898 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_msat_norm_workload"
[0m10:14:04.442061 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_tech"
[0m10:14:04.442906 [info ] [Thread-1 (]: 9 of 17 OK created sql incremental model public.dv_msat_fact_materials ......... [[32mINSERT 0 0[0m in 0.30s]
[0m10:14:04.445938 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:14:04.446820 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: COMMIT
[0m10:14:04.447789 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_msat_fact_materials
[0m10:14:04.449041 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:14:04.450348 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:14:04.451501 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m10:14:04.452785 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_pikets: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_msat_fact_pikets"} */

      insert into "postgres"."public"."dv_msat_fact_pikets" ("hk_dv_hub_fact_work", "recsource", "loadts", "hdiff_dv_msat_fact_pikets", "sub_seq", "ключстроки", "пикет_с", "пикет_по", "смещение_с", "смещение_по", "объем_работы", "вид_пикета_value", "вид_пикета_codе", "вид_пикета_name", "тип_пикета_value", "тип_пикета_codе", "тип_пикета_name", "группа_пикетов_spider_value", "группа_пикетов_spider_codе", "группа_пикетов_spider_name")
    (
        select "hk_dv_hub_fact_work", "recsource", "loadts", "hdiff_dv_msat_fact_pikets", "sub_seq", "ключстроки", "пикет_с", "пикет_по", "смещение_с", "смещение_по", "объем_работы", "вид_пикета_value", "вид_пикета_codе", "вид_пикета_name", "тип_пикета_value", "тип_пикета_codе", "тип_пикета_name", "группа_пикетов_spider_value", "группа_пикетов_spider_codе", "группа_пикетов_spider_name"
        from "dv_msat_fact_pikets__dbt_tmp101404333564"
    )


  
[0m10:14:04.454174 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      insert into "postgres"."public"."dv_hub_tech" ("hk_dv_hub_tech", "hkcode", "recsource", "loadts", "bk_ресурс_uuid")
    (
        select "hk_dv_hub_tech", "hkcode", "recsource", "loadts", "bk_ресурс_uuid"
        from "dv_hub_tech__dbt_tmp101404326523"
    )


  
[0m10:14:04.455763 [info ] [Thread-1 (]: 13 of 17 START sql incremental model public.dv_lnk_fact_work_tech .............. [RUN]
[0m10:14:04.457108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_materials, now model.tsm_dwh.dv_lnk_fact_work_tech)
[0m10:14:04.458011 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m10:14:04.458684 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_work_tech
[0m10:14:04.459360 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m10:14:04.461990 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_pikets: COMMIT
[0m10:14:04.471517 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m10:14:04.472515 [debug] [Thread-2 (]: SQL status: COMMIT in 0.024 seconds
[0m10:14:04.473427 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:14:04.474026 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_msat_fact_pikets"
[0m10:14:04.474736 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m10:14:04.475787 [debug] [Thread-2 (]: On model.tsm_dwh.dv_msat_norm_workload: Close
[0m10:14:04.476541 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_pikets: COMMIT
[0m10:14:04.477118 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m10:14:04.478403 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb5f7f4d70>]}
[0m10:14:04.479569 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_lnk_fact_work_tech
[0m10:14:04.480862 [info ] [Thread-2 (]: 10 of 17 OK created sql incremental model public.dv_msat_norm_workload ......... [[32mINSERT 0 0[0m in 0.30s]
[0m10:14:04.489513 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:14:04.490593 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_msat_norm_workload
[0m10:14:04.491529 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

    
  
    

  create temporary table "dv_lnk_fact_work_tech__dbt_tmp101404485562"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_work,
	hk_dv_hub_tech)
        hk_dv_lnk_fact_work_tech,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_work,
	hk_dv_hub_tech
FROM "postgres"."public"."stg_1c_tech" stg


where not exists (
    select 1
    from "postgres"."public"."dv_lnk_fact_work_tech" target
    where 
        target.hk_dv_lnk_fact_work_tech = stg.hk_dv_lnk_fact_work_tech 
)

  );
  
  
[0m10:14:04.492248 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_sat_fact_tech
[0m10:14:04.493313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:14:04.494524 [info ] [Thread-2 (]: 14 of 17 START sql incremental model public.dv_sat_fact_tech ................... [RUN]
[0m10:14:04.495679 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_norm_workload, now model.tsm_dwh.dv_sat_fact_tech)
[0m10:14:04.496871 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_sat_fact_tech
[0m10:14:04.506349 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_tech"
[0m10:14:04.507388 [debug] [Thread-4 (]: SQL status: COMMIT in 0.027 seconds
[0m10:14:04.508313 [debug] [Thread-3 (]: SQL status: COMMIT in 0.028 seconds
[0m10:14:04.509528 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: Close
[0m10:14:04.510708 [debug] [Thread-3 (]: On model.tsm_dwh.dv_msat_fact_pikets: Close
[0m10:14:04.511375 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_sat_fact_tech
[0m10:14:04.512687 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb5f614f20>]}
[0m10:14:04.514222 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb5f6d3260>]}
[0m10:14:04.515405 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.022 seconds
[0m10:14:04.525136 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:14:04.526287 [info ] [Thread-4 (]: 12 of 17 OK created sql incremental model public.dv_hub_tech ................... [[32mINSERT 0 0[0m in 0.22s]
[0m10:14:04.527916 [info ] [Thread-3 (]: 11 of 17 OK created sql incremental model public.dv_msat_fact_pikets ........... [[32mINSERT 0 0[0m in 0.23s]
[0m10:14:04.533726 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:14:04.534945 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

    
  
    

  create temporary table "dv_sat_fact_tech__dbt_tmp101404522144"
  
  
    as
  
  (
    



    WITH active_sat AS (
    SELECT DISTINCT ON (hk_dv_lnk_fact_work_tech) hk_dv_lnk_fact_work_tech, hdiff_dv_sat_fact_tech, loadts
    FROM "postgres"."public"."dv_sat_fact_tech"
    ORDER BY hk_dv_lnk_fact_work_tech, loadts DESC)

    , max_load AS (
    SELECT max(loadts) AS max_loadts
    FROM "postgres"."public"."dv_sat_fact_tech"
    )
    , stage_cte AS (

        SELECT
        s.hk_dv_lnk_fact_work_tech,
        s.hdiff_dv_sat_fact_tech,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_tech) over(PARTITION BY s.hk_dv_lnk_fact_work_tech ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_tech AS sat_hdiff,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name

    FROM
        (SELECT
            s.hk_dv_lnk_fact_work_tech,
            s.hdiff_dv_sat_fact_tech,
            s.loadts,
            s.recsource,
            примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
        FROM "postgres"."public"."stg_1c_tech" s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts
        ) s
    LEFT JOIN active_sat a ON a.hk_dv_lnk_fact_work_tech = s.hk_dv_lnk_fact_work_tech)

    SELECT DISTINCT
        hk_dv_lnk_fact_work_tech,
        recsource,
        loadts,
        hdiff_dv_sat_fact_tech,
        примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_tech <> lag_hdiff 
            OR (hdiff_dv_sat_fact_tech <> sat_hdiff AND lag_hdiff IS NULL) 
            OR sat_hdiff IS NULL
    ORDER BY loadts


  );
  
  
[0m10:14:04.536577 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m10:14:04.537806 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_msat_fact_pikets
[0m10:14:04.538546 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: BEGIN
[0m10:14:04.539626 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:14:04.540551 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m10:14:04.541888 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m10:14:04.543035 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m10:14:04.544267 [info ] [Thread-4 (]: 15 of 17 START sql incremental model public.dv_hub_fact_work ................... [RUN]
[0m10:14:04.545748 [info ] [Thread-3 (]: 16 of 17 START sql incremental model public.dv_lnk_fact_journal_fact_work ...... [RUN]
[0m10:14:04.546756 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:14:04.547722 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_tech, now model.tsm_dwh.dv_hub_fact_work)
[0m10:14:04.548462 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_pikets, now model.tsm_dwh.dv_lnk_fact_journal_fact_work)
[0m10:14:04.549533 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech__dbt_tmp101404485562'
        
      order by ordinal_position

  
[0m10:14:04.550474 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m10:14:04.552489 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m10:14:04.562222 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m10:14:04.568266 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.029 seconds
[0m10:14:04.570941 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:14:04.571929 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.018 seconds
[0m10:14:04.577012 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:14:04.577995 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m10:14:04.583958 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:14:04.584878 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: BEGIN
[0m10:14:04.590810 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m10:14:04.591833 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:14:04.592494 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.598636 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m10:14:04.599574 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:14:04.600200 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

    
  
    

  create temporary table "dv_hub_fact_work__dbt_tmp101404588488"
  
  
    as
  
  (
    

SELECT distinct on (bk_работа_uuid)
        hk_dv_hub_fact_work,
        hkcode,
        recsource,
        loadts,
        bk_работа_uuid
FROM "postgres"."public"."stg_1c_works" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_work" target
    where 
        target.hk_dv_hub_fact_work = stg.hk_dv_hub_fact_work 
)

  );
  
  
[0m10:14:04.601153 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:14:04.602043 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

    
  
    

  create temporary table "dv_lnk_fact_journal_fact_work__dbt_tmp101404595560"
  
  
    as
  
  (
    

SELECT distinct on (hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work)
        hk_dv_lnk_fact_journal_fact_work,
        hkcode,
        recsource,
        loadts,
        hk_dv_hub_fact_journal,
	hk_dv_hub_fact_work
FROM "postgres"."public"."stg_1c_works" stg


where not exists (
    select 1
    from "postgres"."public"."dv_lnk_fact_journal_fact_work" target
    where 
        target.hk_dv_lnk_fact_journal_fact_work = stg.hk_dv_lnk_fact_journal_fact_work 
)

  );
  
  
[0m10:14:04.602794 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:14:04.603841 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_tech__dbt_tmp101404522144'
        
      order by ordinal_position

  
[0m10:14:04.604966 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m10:14:04.605701 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:14:04.611472 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:14:04.612701 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_work_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.614800 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.008 seconds
[0m10:14:04.621358 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:14:04.622611 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.623386 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.009 seconds
[0m10:14:04.627928 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:14:04.628624 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.026 seconds
[0m10:14:04.629465 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.005 seconds
[0m10:14:04.634553 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:14:04.635319 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.029 seconds
[0m10:14:04.636298 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:14:04.640088 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:14:04.640801 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_work: BEGIN
[0m10:14:04.644157 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:14:04.644951 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_work_tech"} */

      insert into "postgres"."public"."dv_lnk_fact_work_tech" ("hk_dv_lnk_fact_work_tech", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_work", "hk_dv_hub_tech")
    (
        select "hk_dv_lnk_fact_work_tech", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_work", "hk_dv_hub_tech"
        from "dv_lnk_fact_work_tech__dbt_tmp101404485562"
    )


  
[0m10:14:04.645667 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.646468 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: BEGIN
[0m10:14:04.647519 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m10:14:04.648449 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:14:04.649487 [debug] [Thread-4 (]: SQL status: BEGIN in 0.003 seconds
[0m10:14:04.650646 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work__dbt_tmp101404595560'
        
      order by ordinal_position

  
[0m10:14:04.651425 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m10:14:04.652091 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:14:04.652718 [debug] [Thread-2 (]: SQL status: SELECT 16 in 0.006 seconds
[0m10:14:04.655840 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m10:14:04.656934 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work__dbt_tmp101404588488'
        
      order by ordinal_position

  
[0m10:14:04.661879 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_tech"
[0m10:14:04.662852 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.009 seconds
[0m10:14:04.663862 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m10:14:04.668912 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:14:04.669717 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: COMMIT
[0m10:14:04.670452 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:14:04.671514 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.672375 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.008 seconds
[0m10:14:04.673036 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_tech"} */

      insert into "postgres"."public"."dv_sat_fact_tech" ("hk_dv_lnk_fact_work_tech", "recsource", "loadts", "hdiff_dv_sat_fact_tech", "примечание", "госномер_техника_не_найдена", "количество", "часы", "ресурс_value", "ресурс_codе", "ресурс_name", "аналитика_codе", "аналитика_name", "контрагент_value", "контрагент_codе", "контрагент_name")
    (
        select "hk_dv_lnk_fact_work_tech", "recsource", "loadts", "hdiff_dv_sat_fact_tech", "примечание", "госномер_техника_не_найдена", "количество", "часы", "ресурс_value", "ресурс_codе", "ресурс_name", "аналитика_codе", "аналитика_name", "контрагент_value", "контрагент_codе", "контрагент_name"
        from "dv_sat_fact_tech__dbt_tmp101404522144"
    )


  
[0m10:14:04.677232 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:14:04.677995 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.004 seconds
[0m10:14:04.678735 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.679361 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m10:14:04.683082 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:14:04.685296 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m10:14:04.685927 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_lnk_fact_journal_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.686522 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_tech"
[0m10:14:04.687179 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.003 seconds
[0m10:14:04.687931 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: COMMIT
[0m10:14:04.688572 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m10:14:04.693057 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:14:04.693841 [debug] [Thread-3 (]: SQL status: SELECT 6 in 0.006 seconds
[0m10:14:04.694872 [debug] [Thread-1 (]: On model.tsm_dwh.dv_lnk_fact_work_tech: Close
[0m10:14:04.695446 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.697872 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:14:04.698900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb5f77d910>]}
[0m10:14:04.700677 [info ] [Thread-1 (]: 13 of 17 OK created sql incremental model public.dv_lnk_fact_work_tech ......... [[32mINSERT 0 0[0m in 0.24s]
[0m10:14:04.701922 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m10:14:04.702603 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_sat_fact_work
[0m10:14:04.703441 [info ] [Thread-1 (]: 17 of 17 START sql incremental model public.dv_sat_fact_work ................... [RUN]
[0m10:14:04.704142 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:14:04.705149 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.005 seconds
[0m10:14:04.705818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_lnk_fact_work_tech, now model.tsm_dwh.dv_sat_fact_work)
[0m10:14:04.706466 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_lnk_fact_journal_fact_work"} */

      insert into "postgres"."public"."dv_lnk_fact_journal_fact_work" ("hk_dv_lnk_fact_journal_fact_work", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_journal", "hk_dv_hub_fact_work")
    (
        select "hk_dv_lnk_fact_journal_fact_work", "hkcode", "recsource", "loadts", "hk_dv_hub_fact_journal", "hk_dv_hub_fact_work"
        from "dv_lnk_fact_journal_fact_work__dbt_tmp101404595560"
    )


  
[0m10:14:04.710448 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_work"
[0m10:14:04.711333 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_sat_fact_work
[0m10:14:04.721646 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_work"
[0m10:14:04.722436 [debug] [Thread-2 (]: SQL status: COMMIT in 0.028 seconds
[0m10:14:04.723147 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.011 seconds
[0m10:14:04.723819 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:14:04.724833 [debug] [Thread-2 (]: On model.tsm_dwh.dv_sat_fact_tech: Close
[0m10:14:04.727597 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m10:14:04.728375 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      insert into "postgres"."public"."dv_hub_fact_work" ("hk_dv_hub_fact_work", "hkcode", "recsource", "loadts", "bk_работа_uuid")
    (
        select "hk_dv_hub_fact_work", "hkcode", "recsource", "loadts", "bk_работа_uuid"
        from "dv_hub_fact_work__dbt_tmp101404588488"
    )


  
[0m10:14:04.728980 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_sat_fact_work
[0m10:14:04.729888 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m10:14:04.730886 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb76957470>]}
[0m10:14:04.737735 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:14:04.738362 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.007 seconds
[0m10:14:04.738993 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: COMMIT
[0m10:14:04.739931 [info ] [Thread-2 (]: 14 of 17 OK created sql incremental model public.dv_sat_fact_tech .............. [[32mINSERT 0 0[0m in 0.24s]
[0m10:14:04.740855 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

    
  
    

  create temporary table "dv_sat_fact_work__dbt_tmp101404734461"
  
  
    as
  
  (
    



    WITH active_sat AS (
    SELECT DISTINCT ON (hk_dv_hub_fact_work) hk_dv_hub_fact_work, hdiff_dv_sat_fact_work, loadts
    FROM "postgres"."public"."dv_sat_fact_work"
    ORDER BY hk_dv_hub_fact_work, loadts DESC)

    , max_load AS (
    SELECT max(loadts) AS max_loadts
    FROM "postgres"."public"."dv_sat_fact_work"
    )
    , stage_cte AS (

        SELECT
        s.hk_dv_hub_fact_work,
        s.hdiff_dv_sat_fact_work,
        s.loadts,
        s.recsource,
        lag(s.hdiff_dv_sat_fact_work) over(PARTITION BY s.hk_dv_hub_fact_work ORDER BY s.loadts) AS lag_hdiff,
        a.loadts AS sat_loadts,
        a.hdiff_dv_sat_fact_work AS sat_hdiff,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name

    FROM
        (SELECT
            s.hk_dv_hub_fact_work,
            s.hdiff_dv_sat_fact_work,
            s.loadts,
            s.recsource,
            идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
        FROM "postgres"."public"."stg_1c_works" s
        CROSS JOIN max_load ml
        WHERE s.loadts > ml.max_loadts
        ) s
    LEFT JOIN active_sat a ON a.hk_dv_hub_fact_work = s.hk_dv_hub_fact_work)

    SELECT DISTINCT
        hk_dv_hub_fact_work,
        recsource,
        loadts,
        hdiff_dv_sat_fact_work,
        идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
    FROM stage_cte
    WHERE 
        hdiff_dv_sat_fact_work <> lag_hdiff 
            OR (hdiff_dv_sat_fact_work <> sat_hdiff AND lag_hdiff IS NULL) 
            OR sat_hdiff IS NULL
    ORDER BY loadts


  );
  
  
[0m10:14:04.743054 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m10:14:04.744393 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_sat_fact_tech
[0m10:14:04.745094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:14:04.746141 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m10:14:04.747772 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m10:14:04.764829 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.020 seconds
[0m10:14:04.769008 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:14:04.769781 [debug] [Thread-4 (]: SQL status: COMMIT in 0.021 seconds
[0m10:14:04.770706 [debug] [Thread-3 (]: SQL status: COMMIT in 0.027 seconds
[0m10:14:04.771464 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: BEGIN
[0m10:14:04.773328 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_work: Close
[0m10:14:04.774787 [debug] [Thread-3 (]: On model.tsm_dwh.dv_lnk_fact_journal_fact_work: Close
[0m10:14:04.775780 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb769585c0>]}
[0m10:14:04.776602 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m10:14:04.777574 [info ] [Thread-4 (]: 15 of 17 OK created sql incremental model public.dv_hub_fact_work .............. [[32mINSERT 0 0[0m in 0.23s]
[0m10:14:04.778861 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb5f7443e0>]}
[0m10:14:04.779439 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:14:04.780422 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m10:14:04.782428 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_work__dbt_tmp101404734461'
        
      order by ordinal_position

  
[0m10:14:04.781622 [info ] [Thread-3 (]: 16 of 17 OK created sql incremental model public.dv_lnk_fact_journal_fact_work . [[32mINSERT 0 0[0m in 0.23s]
[0m10:14:04.783979 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m10:14:04.793379 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.010 seconds
[0m10:14:04.799071 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:14:04.800290 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.806350 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.005 seconds
[0m10:14:04.812388 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:14:04.813085 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_sat_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m10:14:04.817419 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.003 seconds
[0m10:14:04.820302 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_sat_fact_work"
[0m10:14:04.821230 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:14:04.822321 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_sat_fact_work"} */

      insert into "postgres"."public"."dv_sat_fact_work" ("hk_dv_hub_fact_work", "recsource", "loadts", "hdiff_dv_sat_fact_work", "идентификатор", "объем_работы", "примечание", "кв", "пометка_удаления", "тип_spider", "структура_работ_value", "структура_работ_codе", "структура_работ_name", "видработ_value", "видработ_codе", "видработ_name")
    (
        select "hk_dv_hub_fact_work", "recsource", "loadts", "hdiff_dv_sat_fact_work", "идентификатор", "объем_работы", "примечание", "кв", "пометка_удаления", "тип_spider", "структура_работ_value", "структура_работ_codе", "структура_работ_name", "видработ_value", "видработ_codе", "видработ_name"
        from "dv_sat_fact_work__dbt_tmp101404734461"
    )


  
[0m10:14:04.823789 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m10:14:04.825890 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m10:14:04.826475 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_sat_fact_work"
[0m10:14:04.826980 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: COMMIT
[0m10:14:04.838028 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m10:14:04.839165 [debug] [Thread-1 (]: On model.tsm_dwh.dv_sat_fact_work: Close
[0m10:14:04.839971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce723eee-8c1b-469c-a593-26c33db62140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb5f671be0>]}
[0m10:14:04.841006 [info ] [Thread-1 (]: 17 of 17 OK created sql incremental model public.dv_sat_fact_work .............. [[32mINSERT 0 0[0m in 0.13s]
[0m10:14:04.841944 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_sat_fact_work
[0m10:14:04.843963 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:04.844844 [debug] [MainThread]: On master: BEGIN
[0m10:14:04.845515 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:14:04.856052 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m10:14:04.856678 [debug] [MainThread]: On master: COMMIT
[0m10:14:04.857121 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:04.857736 [debug] [MainThread]: On master: COMMIT
[0m10:14:04.858730 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:14:04.859237 [debug] [MainThread]: On master: Close
[0m10:14:04.859962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:14:04.860905 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_work' was properly closed.
[0m10:14:04.861910 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work' was properly closed.
[0m10:14:04.862644 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_sat_fact_tech' was properly closed.
[0m10:14:04.863087 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_work' was properly closed.
[0m10:14:04.863736 [info ] [MainThread]: 
[0m10:14:04.864463 [info ] [MainThread]: Finished running 11 incremental models, 6 view models in 0 hours 0 minutes and 1.52 seconds (1.52s).
[0m10:14:04.870060 [debug] [MainThread]: Command end result
[0m10:14:04.910112 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m10:14:04.912083 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m10:14:04.921350 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m10:14:04.921876 [info ] [MainThread]: 
[0m10:14:04.922561 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:14:04.923142 [info ] [MainThread]: 
[0m10:14:04.923814 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m10:14:04.925358 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.2460227, "process_in_blocks": "1472", "process_kernel_time": 0.289382, "process_mem_max_rss": "123560", "process_out_blocks": "3608", "process_user_time": 3.485994}
[0m10:14:04.925977 [debug] [MainThread]: Command `dbt build` succeeded at 10:14:04.925840 after 2.25 seconds
[0m10:14:04.926531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7a151a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7a1e78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb79b1eb10>]}
[0m10:14:04.927017 [debug] [MainThread]: Flushing usage events
[0m10:14:05.847612 [debug] [MainThread]: An error was encountered while trying to flush usage events
