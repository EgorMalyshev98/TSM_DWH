[0m10:24:54.296006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1781a8cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1787c7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe179cd2480>]}


============================== 10:24:54.300734 | 929bee7b-9c22-48e1-938e-f64273376575 ==============================
[0m10:24:54.300734 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:24:54.301591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt init', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:25:20.607156 [debug] [MainThread]: Starter project path: /home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/include/starter_project
[0m10:25:20.610192 [info ] [MainThread]: 
Your new dbt project "postgres_dwh" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m10:25:20.610835 [info ] [MainThread]: Setting up your profile.
[0m10:26:10.352338 [info ] [MainThread]: Profile postgres_dwh written to /home/egor/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m10:26:10.356871 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 76.12335, "process_in_blocks": "144", "process_kernel_time": 0.150322, "process_mem_max_rss": "98448", "process_out_blocks": "344", "process_user_time": 1.678132}
[0m10:26:10.357692 [debug] [MainThread]: Command `dbt init` succeeded at 10:26:10.357463 after 76.12 seconds
[0m10:26:10.358769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1781a8cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe177dc9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe177796570>]}
[0m10:26:10.359504 [debug] [MainThread]: Flushing usage events
[0m10:26:11.388542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:26:23.267290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e124201d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e129f7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e12420050>]}


============================== 10:26:23.270974 | 9721d7b2-42a6-4fe0-ae17-ef0329affeac ==============================
[0m10:26:23.270974 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:26:23.271946 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:26:23.287010 [info ] [MainThread]: dbt version: 1.9.3
[0m10:26:23.287620 [info ] [MainThread]: python version: 3.12.9
[0m10:26:23.288222 [info ] [MainThread]: python path: /home/egor/projects/TSM_DWH/venv/bin/python
[0m10:26:23.288754 [info ] [MainThread]: os info: Linux-6.13.7-100.fc40.x86_64-x86_64-with-glibc2.39
[0m10:26:23.298267 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.snowflake'
[0m10:26:23.366669 [info ] [MainThread]: Using profiles dir at /home/egor/.dbt
[0m10:26:23.367360 [info ] [MainThread]: Using profiles.yml file at /home/egor/.dbt/profiles.yml
[0m10:26:23.368009 [info ] [MainThread]: Using dbt_project.yml file at /home/egor/projects/TSM_DWH/dbt_project.yml
[0m10:26:23.368676 [info ] [MainThread]: Configuration:
[0m10:26:23.369308 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m10:26:23.370011 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m10:26:23.370577 [info ] [MainThread]: Required dependencies:
[0m10:26:23.371169 [debug] [MainThread]: Executing "git --help"
[0m10:26:23.378758 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:26:23.379987 [debug] [MainThread]: STDERR: "b''"
[0m10:26:23.380521 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:26:23.381373 [info ] [MainThread]: Connection test skipped since no profile was found
[0m10:26:23.382337 [info ] [MainThread]: [31m2 checks failed:[0m
[0m10:26:23.383155 [info ] [MainThread]: Could not load dbt_project.yml
Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "dbtvault_snowflake_demo", target "dev" invalid: Runtime Error
    Could not find adapter type snowflake!


[0m10:26:23.383725 [info ] [MainThread]: Project loading failed for the following reason:
 project path </home/egor/projects/TSM_DWH/dbt_project.yml> not found

[0m10:26:23.385589 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.1740575, "process_in_blocks": "0", "process_kernel_time": 0.141005, "process_mem_max_rss": "99148", "process_out_blocks": "16", "process_user_time": 1.736959}
[0m10:26:23.386813 [debug] [MainThread]: Command `dbt debug` failed at 10:26:23.386529 after 0.18 seconds
[0m10:26:23.388081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e129f7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e12d5b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e121d6c00>]}
[0m10:26:23.389408 [debug] [MainThread]: Flushing usage events
[0m10:26:24.188588 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:29:59.865031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd24da600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd369e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd369f440>]}


============================== 10:29:59.871119 | fc59b86f-a3cd-4d81-bb39-2ce308cf08c3 ==============================
[0m10:29:59.871119 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:29:59.872313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m10:29:59.891300 [info ] [MainThread]: dbt version: 1.9.3
[0m10:29:59.892261 [info ] [MainThread]: python version: 3.12.9
[0m10:29:59.893389 [info ] [MainThread]: python path: /home/egor/projects/TSM_DWH/venv/bin/python
[0m10:29:59.894372 [info ] [MainThread]: os info: Linux-6.13.7-100.fc40.x86_64-x86_64-with-glibc2.39
[0m10:29:59.966767 [info ] [MainThread]: Using profiles dir at /home/egor/.dbt
[0m10:29:59.967442 [info ] [MainThread]: Using profiles.yml file at /home/egor/.dbt/profiles.yml
[0m10:29:59.968085 [info ] [MainThread]: Using dbt_project.yml file at /home/egor/projects/TSM_DWH/dbt_project.yml
[0m10:29:59.968865 [info ] [MainThread]: adapter type: postgres
[0m10:29:59.969465 [info ] [MainThread]: adapter version: 1.9.0
[0m10:30:00.085065 [info ] [MainThread]: Configuration:
[0m10:30:00.085774 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:30:00.086400 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:30:00.087006 [info ] [MainThread]: Required dependencies:
[0m10:30:00.087608 [debug] [MainThread]: Executing "git --help"
[0m10:30:00.090240 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:30:00.090921 [debug] [MainThread]: STDERR: "b''"
[0m10:30:00.091788 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:30:00.092802 [info ] [MainThread]: Connection:
[0m10:30:00.093731 [info ] [MainThread]:   host: localhost
[0m10:30:00.094651 [info ] [MainThread]:   port: 5432
[0m10:30:00.095465 [info ] [MainThread]:   user: postgres
[0m10:30:00.096429 [info ] [MainThread]:   database: postgres
[0m10:30:00.097606 [info ] [MainThread]:   schema: public
[0m10:30:00.098858 [info ] [MainThread]:   connect_timeout: 10
[0m10:30:00.099889 [info ] [MainThread]:   role: None
[0m10:30:00.100595 [info ] [MainThread]:   search_path: None
[0m10:30:00.101405 [info ] [MainThread]:   keepalives_idle: 0
[0m10:30:00.102004 [info ] [MainThread]:   sslmode: None
[0m10:30:00.102669 [info ] [MainThread]:   sslcert: None
[0m10:30:00.103624 [info ] [MainThread]:   sslkey: None
[0m10:30:00.104517 [info ] [MainThread]:   sslrootcert: None
[0m10:30:00.105394 [info ] [MainThread]:   application_name: dbt
[0m10:30:00.106295 [info ] [MainThread]:   retries: 1
[0m10:30:00.107413 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:30:00.223194 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:30:00.257335 [debug] [MainThread]: Using postgres connection "debug"
[0m10:30:00.257919 [debug] [MainThread]: On debug: select 1 as id
[0m10:30:00.258417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:30:00.277735 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  Ident authentication failed for user "postgres"

[0m10:30:00.281379 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m10:30:00.281937 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m10:30:00.282413 [debug] [MainThread]: On debug: No close available on handle
[0m10:30:00.282928 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:30:00.283458 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:30:00.284286 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  Ident authentication failed for user "postgres"
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:30:00.286172 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.48416987, "process_in_blocks": "824", "process_kernel_time": 0.205105, "process_mem_max_rss": "108108", "process_out_blocks": "24", "process_user_time": 1.786354}
[0m10:30:00.287200 [debug] [MainThread]: Command `dbt debug` failed at 10:30:00.287059 after 0.49 seconds
[0m10:30:00.287994 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:30:00.289090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd43901a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd35f8800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fd05040e0>]}
[0m10:30:00.290162 [debug] [MainThread]: Flushing usage events
[0m10:30:01.193578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:32:01.259815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019d4912b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019cc19850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019ece4920>]}


============================== 10:32:01.263698 | b127e064-c87a-4136-9c7e-1c8a28019142 ==============================
[0m10:32:01.263698 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:32:01.264628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:32:01.279267 [info ] [MainThread]: dbt version: 1.9.3
[0m10:32:01.280690 [info ] [MainThread]: python version: 3.12.9
[0m10:32:01.281553 [info ] [MainThread]: python path: /home/egor/projects/TSM_DWH/venv/bin/python
[0m10:32:01.282533 [info ] [MainThread]: os info: Linux-6.13.7-100.fc40.x86_64-x86_64-with-glibc2.39
[0m10:32:01.343975 [info ] [MainThread]: Using profiles dir at /home/egor/.dbt
[0m10:32:01.344692 [info ] [MainThread]: Using profiles.yml file at /home/egor/.dbt/profiles.yml
[0m10:32:01.345380 [info ] [MainThread]: Using dbt_project.yml file at /home/egor/projects/TSM_DWH/dbt_project.yml
[0m10:32:01.459299 [info ] [MainThread]: Configuration:
[0m10:32:01.460056 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m10:32:01.460640 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:32:01.461286 [info ] [MainThread]: Required dependencies:
[0m10:32:01.461855 [debug] [MainThread]: Executing "git --help"
[0m10:32:01.464447 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:32:01.465080 [debug] [MainThread]: STDERR: "b''"
[0m10:32:01.465570 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:32:01.466104 [info ] [MainThread]: Connection test skipped since no profile was found
[0m10:32:01.466871 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:32:01.467778 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "postgres_dwh", target "dev" invalid: 1234 is not of type 'string'


[0m10:32:01.469663 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.2662074, "process_in_blocks": "0", "process_kernel_time": 0.138355, "process_mem_max_rss": "101612", "process_out_blocks": "16", "process_user_time": 1.661417}
[0m10:32:01.470753 [debug] [MainThread]: Command `dbt debug` failed at 10:32:01.470565 after 0.27 seconds
[0m10:32:01.471635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019cc19850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019c1b9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f019c1b9160>]}
[0m10:32:01.472644 [debug] [MainThread]: Flushing usage events
[0m10:32:02.316080 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:32:21.898469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db9d64920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dbb40ef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db9610500>]}


============================== 10:32:21.902307 | 8c80f243-82df-4723-ba87-652161b2d982 ==============================
[0m10:32:21.902307 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:32:21.903094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:32:21.917166 [info ] [MainThread]: dbt version: 1.9.3
[0m10:32:21.917860 [info ] [MainThread]: python version: 3.12.9
[0m10:32:21.918563 [info ] [MainThread]: python path: /home/egor/projects/TSM_DWH/venv/bin/python
[0m10:32:21.919156 [info ] [MainThread]: os info: Linux-6.13.7-100.fc40.x86_64-x86_64-with-glibc2.39
[0m10:32:21.987558 [info ] [MainThread]: Using profiles dir at /home/egor/.dbt
[0m10:32:21.988198 [info ] [MainThread]: Using profiles.yml file at /home/egor/.dbt/profiles.yml
[0m10:32:21.988895 [info ] [MainThread]: Using dbt_project.yml file at /home/egor/projects/TSM_DWH/dbt_project.yml
[0m10:32:21.989840 [info ] [MainThread]: adapter type: postgres
[0m10:32:21.990366 [info ] [MainThread]: adapter version: 1.9.0
[0m10:32:22.106228 [info ] [MainThread]: Configuration:
[0m10:32:22.106872 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:32:22.107416 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:32:22.108019 [info ] [MainThread]: Required dependencies:
[0m10:32:22.108578 [debug] [MainThread]: Executing "git --help"
[0m10:32:22.111039 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:32:22.111608 [debug] [MainThread]: STDERR: "b''"
[0m10:32:22.112419 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:32:22.113423 [info ] [MainThread]: Connection:
[0m10:32:22.114333 [info ] [MainThread]:   host: localhost
[0m10:32:22.115240 [info ] [MainThread]:   port: 5432
[0m10:32:22.116114 [info ] [MainThread]:   user: postgres
[0m10:32:22.117331 [info ] [MainThread]:   database: postgres
[0m10:32:22.118224 [info ] [MainThread]:   schema: public
[0m10:32:22.119321 [info ] [MainThread]:   connect_timeout: 10
[0m10:32:22.120418 [info ] [MainThread]:   role: None
[0m10:32:22.121367 [info ] [MainThread]:   search_path: None
[0m10:32:22.122005 [info ] [MainThread]:   keepalives_idle: 0
[0m10:32:22.122576 [info ] [MainThread]:   sslmode: None
[0m10:32:22.123140 [info ] [MainThread]:   sslcert: None
[0m10:32:22.123906 [info ] [MainThread]:   sslkey: None
[0m10:32:22.124760 [info ] [MainThread]:   sslrootcert: None
[0m10:32:22.125636 [info ] [MainThread]:   application_name: dbt
[0m10:32:22.126627 [info ] [MainThread]:   retries: 1
[0m10:32:22.127843 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:32:22.240432 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:32:22.269845 [debug] [MainThread]: Using postgres connection "debug"
[0m10:32:22.270457 [debug] [MainThread]: On debug: select 1 as id
[0m10:32:22.270921 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:32:22.275566 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  Ident authentication failed for user "postgres"

[0m10:32:22.279076 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m10:32:22.280140 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m10:32:22.281147 [debug] [MainThread]: On debug: No close available on handle
[0m10:32:22.281609 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:32:22.282286 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:32:22.283137 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  Ident authentication failed for user "postgres"
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:32:22.284766 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.44919735, "process_in_blocks": "0", "process_kernel_time": 0.19105, "process_mem_max_rss": "108192", "process_out_blocks": "24", "process_user_time": 1.784941}
[0m10:32:22.285479 [debug] [MainThread]: Command `dbt debug` failed at 10:32:22.285307 after 0.45 seconds
[0m10:32:22.286160 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:32:22.286681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db9d64920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db94c9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8db8e50350>]}
[0m10:32:22.287337 [debug] [MainThread]: Flushing usage events
[0m10:32:23.104487 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:34:17.063767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60797d6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60797d4f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60797d7f50>]}


============================== 10:34:17.067656 | 3683a995-e259-4f36-9626-051d51b449d3 ==============================
[0m10:34:17.067656 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:34:17.068502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m10:34:17.083457 [info ] [MainThread]: dbt version: 1.9.3
[0m10:34:17.084432 [info ] [MainThread]: python version: 3.12.9
[0m10:34:17.085583 [info ] [MainThread]: python path: /home/egor/projects/TSM_DWH/venv/bin/python
[0m10:34:17.086679 [info ] [MainThread]: os info: Linux-6.13.7-100.fc40.x86_64-x86_64-with-glibc2.39
[0m10:34:17.153332 [info ] [MainThread]: Using profiles dir at /home/egor/.dbt
[0m10:34:17.154045 [info ] [MainThread]: Using profiles.yml file at /home/egor/.dbt/profiles.yml
[0m10:34:17.154602 [info ] [MainThread]: Using dbt_project.yml file at /home/egor/projects/TSM_DWH/dbt_project.yml
[0m10:34:17.155518 [info ] [MainThread]: adapter type: postgres
[0m10:34:17.156103 [info ] [MainThread]: adapter version: 1.9.0
[0m10:34:17.273306 [info ] [MainThread]: Configuration:
[0m10:34:17.274069 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:34:17.274664 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:34:17.275297 [info ] [MainThread]: Required dependencies:
[0m10:34:17.275985 [debug] [MainThread]: Executing "git --help"
[0m10:34:17.278291 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:34:17.278865 [debug] [MainThread]: STDERR: "b''"
[0m10:34:17.279328 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:34:17.279902 [info ] [MainThread]: Connection:
[0m10:34:17.280889 [info ] [MainThread]:   host: localhost
[0m10:34:17.281856 [info ] [MainThread]:   port: 5432
[0m10:34:17.282792 [info ] [MainThread]:   user: postgres
[0m10:34:17.283427 [info ] [MainThread]:   database: postgres
[0m10:34:17.284379 [info ] [MainThread]:   schema: public
[0m10:34:17.285363 [info ] [MainThread]:   connect_timeout: 10
[0m10:34:17.286452 [info ] [MainThread]:   role: None
[0m10:34:17.287511 [info ] [MainThread]:   search_path: None
[0m10:34:17.288601 [info ] [MainThread]:   keepalives_idle: 0
[0m10:34:17.289498 [info ] [MainThread]:   sslmode: None
[0m10:34:17.290129 [info ] [MainThread]:   sslcert: None
[0m10:34:17.291197 [info ] [MainThread]:   sslkey: None
[0m10:34:17.292043 [info ] [MainThread]:   sslrootcert: None
[0m10:34:17.292812 [info ] [MainThread]:   application_name: dbt
[0m10:34:17.293422 [info ] [MainThread]:   retries: 1
[0m10:34:17.294544 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:34:17.428453 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:34:17.460393 [debug] [MainThread]: Using postgres connection "debug"
[0m10:34:17.460955 [debug] [MainThread]: On debug: select 1 as id
[0m10:34:17.461407 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:34:17.466045 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  Ident authentication failed for user "postgres"

[0m10:34:17.469457 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m10:34:17.470522 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m10:34:17.471604 [debug] [MainThread]: On debug: No close available on handle
[0m10:34:17.472228 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:34:17.472868 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:34:17.473627 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  Ident authentication failed for user "postgres"
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:34:17.475183 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.46748513, "process_in_blocks": "592", "process_kernel_time": 0.191653, "process_mem_max_rss": "108308", "process_out_blocks": "24", "process_user_time": 1.805094}
[0m10:34:17.475799 [debug] [MainThread]: Command `dbt debug` failed at 10:34:17.475628 after 0.47 seconds
[0m10:34:17.476307 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:34:17.476846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60797608f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f607a1ebe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f607d6b78c0>]}
[0m10:34:17.477399 [debug] [MainThread]: Flushing usage events
[0m10:34:18.367835 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:34:37.089542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20786deba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20777d4a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2076038f80>]}


============================== 10:34:37.093396 | 4f675124-89b5-4782-b467-4055ea63de97 ==============================
[0m10:34:37.093396 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:34:37.094323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:34:37.110560 [info ] [MainThread]: dbt version: 1.9.3
[0m10:34:37.111846 [info ] [MainThread]: python version: 3.12.9
[0m10:34:37.113016 [info ] [MainThread]: python path: /home/egor/projects/TSM_DWH/venv/bin/python
[0m10:34:37.113922 [info ] [MainThread]: os info: Linux-6.13.7-100.fc40.x86_64-x86_64-with-glibc2.39
[0m10:34:37.181426 [info ] [MainThread]: Using profiles dir at /home/egor/.dbt
[0m10:34:37.182249 [info ] [MainThread]: Using profiles.yml file at /home/egor/.dbt/profiles.yml
[0m10:34:37.183003 [info ] [MainThread]: Using dbt_project.yml file at /home/egor/projects/TSM_DWH/dbt_project.yml
[0m10:34:37.183949 [info ] [MainThread]: adapter type: postgres
[0m10:34:37.184568 [info ] [MainThread]: adapter version: 1.9.0
[0m10:34:37.304051 [info ] [MainThread]: Configuration:
[0m10:34:37.304743 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:34:37.305415 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:34:37.306143 [info ] [MainThread]: Required dependencies:
[0m10:34:37.307078 [debug] [MainThread]: Executing "git --help"
[0m10:34:37.309758 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:34:37.310620 [debug] [MainThread]: STDERR: "b''"
[0m10:34:37.311516 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:34:37.312459 [info ] [MainThread]: Connection:
[0m10:34:37.313416 [info ] [MainThread]:   host: 127.0.0.1
[0m10:34:37.314336 [info ] [MainThread]:   port: 5432
[0m10:34:37.315081 [info ] [MainThread]:   user: postgres
[0m10:34:37.316184 [info ] [MainThread]:   database: postgres
[0m10:34:37.317143 [info ] [MainThread]:   schema: public
[0m10:34:37.318309 [info ] [MainThread]:   connect_timeout: 10
[0m10:34:37.319414 [info ] [MainThread]:   role: None
[0m10:34:37.320431 [info ] [MainThread]:   search_path: None
[0m10:34:37.321418 [info ] [MainThread]:   keepalives_idle: 0
[0m10:34:37.322101 [info ] [MainThread]:   sslmode: None
[0m10:34:37.323105 [info ] [MainThread]:   sslcert: None
[0m10:34:37.324154 [info ] [MainThread]:   sslkey: None
[0m10:34:37.325086 [info ] [MainThread]:   sslrootcert: None
[0m10:34:37.325738 [info ] [MainThread]:   application_name: dbt
[0m10:34:37.326427 [info ] [MainThread]:   retries: 1
[0m10:34:37.327194 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:34:37.455611 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:34:37.483711 [debug] [MainThread]: Using postgres connection "debug"
[0m10:34:37.484380 [debug] [MainThread]: On debug: select 1 as id
[0m10:34:37.484885 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:34:37.499865 [debug] [MainThread]: SQL status: SELECT 1 in 0.015 seconds
[0m10:34:37.501397 [debug] [MainThread]: On debug: Close
[0m10:34:37.502217 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:34:37.502932 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:34:37.504620 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.47340927, "process_in_blocks": "0", "process_kernel_time": 0.188408, "process_mem_max_rss": "109372", "process_out_blocks": "16", "process_user_time": 1.824241}
[0m10:34:37.505356 [debug] [MainThread]: Command `dbt debug` succeeded at 10:34:37.505199 after 0.47 seconds
[0m10:34:37.505833 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:34:37.506331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20757d7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2075752c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2075750230>]}
[0m10:34:37.506899 [debug] [MainThread]: Flushing usage events
[0m10:34:38.272807 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:18.630658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29f89b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29fa65670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29f89bd70>]}


============================== 14:20:18.635275 | 9435c007-9837-407a-a60a-1c96326b37aa ==============================
[0m14:20:18.635275 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:20:18.636289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:20:18.651254 [info ] [MainThread]: dbt version: 1.9.3
[0m14:20:18.652055 [info ] [MainThread]: python version: 3.12.9
[0m14:20:18.652708 [info ] [MainThread]: python path: /home/egor/projects/TSM_DWH/venv/bin/python
[0m14:20:18.653353 [info ] [MainThread]: os info: Linux-6.13.7-100.fc40.x86_64-x86_64-with-glibc2.39
[0m14:20:18.721582 [info ] [MainThread]: Using profiles dir at /home/egor/.dbt
[0m14:20:18.722453 [info ] [MainThread]: Using profiles.yml file at /home/egor/.dbt/profiles.yml
[0m14:20:18.723238 [info ] [MainThread]: Using dbt_project.yml file at /home/egor/projects/TSM_DWH/dbt_project.yml
[0m14:20:18.724603 [info ] [MainThread]: adapter type: postgres
[0m14:20:18.725269 [info ] [MainThread]: adapter version: 1.9.0
[0m14:20:18.859311 [info ] [MainThread]: Configuration:
[0m14:20:18.860102 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:20:18.860815 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:20:18.861783 [info ] [MainThread]: Required dependencies:
[0m14:20:18.862468 [debug] [MainThread]: Executing "git --help"
[0m14:20:18.864945 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:20:18.865549 [debug] [MainThread]: STDERR: "b''"
[0m14:20:18.866364 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:20:18.867253 [info ] [MainThread]: Connection:
[0m14:20:18.867995 [info ] [MainThread]:   host: 127.0.0.1
[0m14:20:18.868620 [info ] [MainThread]:   port: 5432
[0m14:20:18.869230 [info ] [MainThread]:   user: postgres
[0m14:20:18.869829 [info ] [MainThread]:   database: postgres
[0m14:20:18.870536 [info ] [MainThread]:   schema: public
[0m14:20:18.871465 [info ] [MainThread]:   connect_timeout: 10
[0m14:20:18.872409 [info ] [MainThread]:   role: None
[0m14:20:18.873343 [info ] [MainThread]:   search_path: None
[0m14:20:18.874368 [info ] [MainThread]:   keepalives_idle: 0
[0m14:20:18.875442 [info ] [MainThread]:   sslmode: None
[0m14:20:18.876498 [info ] [MainThread]:   sslcert: None
[0m14:20:18.877394 [info ] [MainThread]:   sslkey: None
[0m14:20:18.878291 [info ] [MainThread]:   sslrootcert: None
[0m14:20:18.879441 [info ] [MainThread]:   application_name: dbt
[0m14:20:18.880328 [info ] [MainThread]:   retries: 1
[0m14:20:18.881182 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:20:19.017984 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:20:19.053143 [debug] [MainThread]: Using postgres connection "debug"
[0m14:20:19.054075 [debug] [MainThread]: On debug: select 1 as id
[0m14:20:19.054709 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:20:19.070441 [debug] [MainThread]: SQL status: SELECT 1 in 0.016 seconds
[0m14:20:19.072304 [debug] [MainThread]: On debug: Close
[0m14:20:19.073066 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:20:19.073830 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:20:19.075940 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.50706464, "process_in_blocks": "272", "process_kernel_time": 0.237743, "process_mem_max_rss": "109160", "process_out_blocks": "24", "process_user_time": 1.891519}
[0m14:20:19.076827 [debug] [MainThread]: Command `dbt debug` succeeded at 14:20:19.076626 after 0.51 seconds
[0m14:20:19.077494 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:20:19.078265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29fb4bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29f173f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc29eff86b0>]}
[0m14:20:19.079013 [debug] [MainThread]: Flushing usage events
[0m14:20:19.988176 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:26.044810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff281acb3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28358c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2810b0b60>]}


============================== 14:20:26.048687 | c8d61401-d463-461c-9e35-7aa9f07030e6 ==============================
[0m14:20:26.048687 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:20:26.049603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m14:20:26.231134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8d61401-d463-461c-9e35-7aa9f07030e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff281aca330>]}
[0m14:20:26.299373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8d61401-d463-461c-9e35-7aa9f07030e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2809718e0>]}
[0m14:20:26.300370 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:20:26.430515 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:20:26.494034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:20:26.494571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:20:26.495397 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dwh.example
[0m14:20:26.501168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8d61401-d463-461c-9e35-7aa9f07030e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28090a150>]}
[0m14:20:26.563094 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m14:20:26.565599 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m14:20:26.597280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8d61401-d463-461c-9e35-7aa9f07030e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff27f9c2930>]}
[0m14:20:26.597973 [info ] [MainThread]: Found 433 macros
[0m14:20:26.600682 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:20:26.603309 [debug] [MainThread]: Command end result
[0m14:20:26.644303 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m14:20:26.647013 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m14:20:26.653004 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m14:20:26.654749 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.66780007, "process_in_blocks": "848", "process_kernel_time": 0.200079, "process_mem_max_rss": "108192", "process_out_blocks": "1728", "process_user_time": 2.002761}
[0m14:20:26.655786 [debug] [MainThread]: Command `dbt build` succeeded at 14:20:26.655589 after 0.67 seconds
[0m14:20:26.656657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28120b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2813cfe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28019ac30>]}
[0m14:20:26.657585 [debug] [MainThread]: Flushing usage events
[0m14:20:27.463187 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:59.750659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f517934f920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f517934f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f517931c800>]}


============================== 14:20:59.754658 | c2e6b2c0-e61b-4783-998d-95714040a408 ==============================
[0m14:20:59.754658 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:20:59.755712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:20:59.946810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2e6b2c0-e61b-4783-998d-95714040a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5178ff39b0>]}
[0m14:21:00.014798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2e6b2c0-e61b-4783-998d-95714040a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51791889e0>]}
[0m14:21:00.015759 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:21:00.144994 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m14:21:00.188155 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:21:00.188887 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m14:21:00.189674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c2e6b2c0-e61b-4783-998d-95714040a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5177f49910>]}
[0m14:21:00.970382 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dwh.example
[0m14:21:00.976461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2e6b2c0-e61b-4783-998d-95714040a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5179e0ab70>]}
[0m14:21:01.034118 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m14:21:01.036565 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m14:21:01.049983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2e6b2c0-e61b-4783-998d-95714040a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5177f68ef0>]}
[0m14:21:01.050616 [info ] [MainThread]: Found 433 macros
[0m14:21:01.051228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2e6b2c0-e61b-4783-998d-95714040a408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51783b39b0>]}
[0m14:21:01.052223 [warn ] [MainThread]: The selection criterion 'stg' does not match any enabled nodes
[0m14:21:01.053938 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:21:01.054989 [debug] [MainThread]: Command end result
[0m14:21:01.090415 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m14:21:01.092891 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m14:21:01.096802 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m14:21:01.098111 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4047768, "process_in_blocks": "0", "process_kernel_time": 0.259464, "process_mem_max_rss": "106256", "process_out_blocks": "2496", "process_user_time": 2.811057}
[0m14:21:01.098738 [debug] [MainThread]: Command `cli run` succeeded at 14:21:01.098568 after 1.41 seconds
[0m14:21:01.099362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5179add0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5179561730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5178bb7230>]}
[0m14:21:01.099872 [debug] [MainThread]: Flushing usage events
[0m14:21:01.972454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:35:58.945936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013f106e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013ebd8f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013d1e9400>]}


============================== 14:35:58.951303 | 4ad44510-724c-4927-9ef6-eb078bb6ee78 ==============================
[0m14:35:58.951303 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:35:58.952332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:35:59.162761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ad44510-724c-4927-9ef6-eb078bb6ee78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013d7bc170>]}
[0m14:35:59.231434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ad44510-724c-4927-9ef6-eb078bb6ee78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013cfe7530>]}
[0m14:35:59.232466 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:35:59.428437 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:35:59.530072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:35:59.530685 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:35:59.531691 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dwh.example
[0m14:35:59.538620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ad44510-724c-4927-9ef6-eb078bb6ee78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013cbfbe60>]}
[0m14:35:59.601266 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m14:35:59.603830 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m14:35:59.646209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ad44510-724c-4927-9ef6-eb078bb6ee78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013b57ed20>]}
[0m14:35:59.646885 [info ] [MainThread]: Found 433 macros
[0m14:35:59.649087 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:35:59.651320 [debug] [MainThread]: Command end result
[0m14:35:59.681150 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m14:35:59.682875 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m14:35:59.688045 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m14:35:59.689909 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.8075227, "process_in_blocks": "50808", "process_kernel_time": 0.377926, "process_mem_max_rss": "107492", "process_out_blocks": "1704", "process_user_time": 2.203792}
[0m14:35:59.690598 [debug] [MainThread]: Command `dbt build` succeeded at 14:35:59.690392 after 0.81 seconds
[0m14:35:59.691241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013f106e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013cccc2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f013bd46bd0>]}
[0m14:35:59.691761 [debug] [MainThread]: Flushing usage events
[0m14:36:00.640111 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:50.666944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c763da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c763cce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c72f8260>]}


============================== 14:37:50.672602 | 66c75e48-2de2-48e0-aee6-b5e7a0b7728c ==============================
[0m14:37:50.672602 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:37:50.673651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:37:50.898645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66c75e48-2de2-48e0-aee6-b5e7a0b7728c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c6498320>]}
[0m14:37:50.966990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66c75e48-2de2-48e0-aee6-b5e7a0b7728c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c6acb050>]}
[0m14:37:50.968026 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:37:51.095735 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:37:51.155623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:37:51.156171 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:37:51.162058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66c75e48-2de2-48e0-aee6-b5e7a0b7728c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c650c6e0>]}
[0m14:37:51.216998 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m14:37:51.219370 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m14:37:51.259494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66c75e48-2de2-48e0-aee6-b5e7a0b7728c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c610a060>]}
[0m14:37:51.260409 [info ] [MainThread]: Found 433 macros
[0m14:37:51.262624 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:37:51.265101 [debug] [MainThread]: Command end result
[0m14:37:51.298858 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m14:37:51.300572 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m14:37:51.304164 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m14:37:51.305926 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.7007353, "process_in_blocks": "46352", "process_kernel_time": 0.281581, "process_mem_max_rss": "107400", "process_out_blocks": "1800", "process_user_time": 2.167548}
[0m14:37:51.306565 [debug] [MainThread]: Command `dbt build` succeeded at 14:37:51.306432 after 0.70 seconds
[0m14:37:51.307132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c6c43410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c64e8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0c6da3440>]}
[0m14:37:51.307625 [debug] [MainThread]: Flushing usage events
[0m14:37:52.153313 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:26.186612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83039ff500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8305a50200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8303f1eff0>]}


============================== 15:00:26.191633 | 2f8dc286-bf6c-4ebe-b8db-234b7977ed18 ==============================
[0m15:00:26.191633 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:00:26.192564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:00:26.400818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f8dc286-bf6c-4ebe-b8db-234b7977ed18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8303fcc0b0>]}
[0m15:00:26.468234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f8dc286-bf6c-4ebe-b8db-234b7977ed18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f830365f530>]}
[0m15:00:26.469298 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:00:26.596034 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:00:26.657154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:00:26.657671 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:00:26.658522 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models
[0m15:00:26.665356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f8dc286-bf6c-4ebe-b8db-234b7977ed18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8303304500>]}
[0m15:00:26.736022 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:00:26.738903 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:00:26.780862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f8dc286-bf6c-4ebe-b8db-234b7977ed18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8301d9dc10>]}
[0m15:00:26.781548 [info ] [MainThread]: Found 433 macros
[0m15:00:26.784055 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:00:26.786744 [debug] [MainThread]: Command end result
[0m15:00:26.818329 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:00:26.820216 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:00:26.825051 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m15:00:26.826865 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.7227416, "process_in_blocks": "42448", "process_kernel_time": 0.285072, "process_mem_max_rss": "107832", "process_out_blocks": "1736", "process_user_time": 2.212713}
[0m15:00:26.827688 [debug] [MainThread]: Command `dbt build` succeeded at 15:00:26.827519 after 0.72 seconds
[0m15:00:26.828218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8303bab0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8302d30440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8302dc6570>]}
[0m15:00:26.828834 [debug] [MainThread]: Flushing usage events
[0m15:00:27.765238 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:37.172889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec533a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec533b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec5a3edb0>]}


============================== 15:01:37.178512 | 603f7497-ae25-48c8-b54c-3089712c8e72 ==============================
[0m15:01:37.178512 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:01:37.179398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:01:37.369296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '603f7497-ae25-48c8-b54c-3089712c8e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec5acacc0>]}
[0m15:01:37.438576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '603f7497-ae25-48c8-b54c-3089712c8e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec5bb91f0>]}
[0m15:01:37.439524 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:01:37.564962 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:01:37.625271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:01:37.625843 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:01:37.626682 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models
[0m15:01:37.632459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '603f7497-ae25-48c8-b54c-3089712c8e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec48bc860>]}
[0m15:01:37.694668 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:01:37.697062 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:01:37.722886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '603f7497-ae25-48c8-b54c-3089712c8e72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec35c38f0>]}
[0m15:01:37.723565 [info ] [MainThread]: Found 433 macros
[0m15:01:37.725843 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:01:37.728339 [debug] [MainThread]: Command end result
[0m15:01:37.761349 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:01:37.763006 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:01:37.767089 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m15:01:37.768367 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.6649259, "process_in_blocks": "5216", "process_kernel_time": 0.227331, "process_mem_max_rss": "107692", "process_out_blocks": "1736", "process_user_time": 2.000981}
[0m15:01:37.768968 [debug] [MainThread]: Command `dbt build` succeeded at 15:01:37.768807 after 0.67 seconds
[0m15:01:37.769525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec5a3edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec491a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ec5a930b0>]}
[0m15:01:37.770075 [debug] [MainThread]: Flushing usage events
[0m15:01:38.799439 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:42.500082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabe961e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabf1cfda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabe963ec0>]}


============================== 13:21:42.505467 | f4eaceaf-f301-4d4a-8f64-bf1a454d66d4 ==============================
[0m13:21:42.505467 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:21:42.506305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m13:21:42.718443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4eaceaf-f301-4d4a-8f64-bf1a454d66d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabede6300>]}
[0m13:21:42.800167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4eaceaf-f301-4d4a-8f64-bf1a454d66d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabe58c680>]}
[0m13:21:42.801243 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:21:42.954561 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:21:43.024821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:43.025344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:43.031208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4eaceaf-f301-4d4a-8f64-bf1a454d66d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabdb4b7d0>]}
[0m13:21:43.110313 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:21:43.113393 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:21:43.158138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4eaceaf-f301-4d4a-8f64-bf1a454d66d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabd7004d0>]}
[0m13:21:43.159258 [info ] [MainThread]: Found 433 macros
[0m13:21:43.161423 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:21:43.163690 [debug] [MainThread]: Command end result
[0m13:21:43.196826 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:21:43.198521 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:21:43.202209 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m13:21:43.204338 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.7656624, "process_in_blocks": "65992", "process_kernel_time": 0.333371, "process_mem_max_rss": "107352", "process_out_blocks": "1736", "process_user_time": 2.193067}
[0m13:21:43.204945 [debug] [MainThread]: Command `dbt build` succeeded at 13:21:43.204819 after 0.77 seconds
[0m13:21:43.205490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabeed3b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabdb99eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbabc7b55b0>]}
[0m13:21:43.205989 [debug] [MainThread]: Flushing usage events
[0m13:21:43.907307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:23:45.261861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f78e03440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f7b0506e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f78b50b60>]}


============================== 13:23:45.266106 | 91723730-b387-49e7-ad96-2143b8b39464 ==============================
[0m13:23:45.266106 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:23:45.267268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:23:45.399106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91723730-b387-49e7-ad96-2143b8b39464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f7c9bbc50>]}
[0m13:23:45.419988 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2196086, "process_in_blocks": "21544", "process_kernel_time": 0.223245, "process_mem_max_rss": "97164", "process_out_blocks": "144", "process_user_time": 1.703779}
[0m13:23:45.420663 [debug] [MainThread]: Command `dbt clean` succeeded at 13:23:45.420536 after 0.22 seconds
[0m13:23:45.421221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f78ee2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f7c9bbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f78b70ad0>]}
[0m13:23:45.421773 [debug] [MainThread]: Flushing usage events
[0m13:23:46.477983 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:23:52.160381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a7008b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4e1a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a50f9e80>]}


============================== 13:23:52.164096 | 1868b1c3-b584-4d89-9c3c-2cbb3f835a57 ==============================
[0m13:23:52.164096 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:23:52.165009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:23:52.186024 [info ] [MainThread]: dbt version: 1.9.3
[0m13:23:52.186759 [info ] [MainThread]: python version: 3.12.9
[0m13:23:52.187507 [info ] [MainThread]: python path: /home/egor/projects/TSM_DWH/venv/bin/python
[0m13:23:52.188245 [info ] [MainThread]: os info: Linux-6.13.7-100.fc40.x86_64-x86_64-with-glibc2.39
[0m13:23:52.269160 [info ] [MainThread]: Using profiles dir at /home/egor/.dbt
[0m13:23:52.269881 [info ] [MainThread]: Using profiles.yml file at /home/egor/.dbt/profiles.yml
[0m13:23:52.270514 [info ] [MainThread]: Using dbt_project.yml file at /home/egor/projects/TSM_DWH/dbt_project.yml
[0m13:23:52.271368 [info ] [MainThread]: adapter type: postgres
[0m13:23:52.271889 [info ] [MainThread]: adapter version: 1.9.0
[0m13:23:52.387787 [info ] [MainThread]: Configuration:
[0m13:23:52.388514 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:23:52.389131 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:23:52.389724 [info ] [MainThread]: Required dependencies:
[0m13:23:52.390426 [debug] [MainThread]: Executing "git --help"
[0m13:23:52.392947 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:23:52.393714 [debug] [MainThread]: STDERR: "b''"
[0m13:23:52.394525 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:23:52.395394 [info ] [MainThread]: Connection:
[0m13:23:52.396367 [info ] [MainThread]:   host: 127.0.0.1
[0m13:23:52.397200 [info ] [MainThread]:   port: 5432
[0m13:23:52.397953 [info ] [MainThread]:   user: postgres
[0m13:23:52.398710 [info ] [MainThread]:   database: postgres
[0m13:23:52.399589 [info ] [MainThread]:   schema: public
[0m13:23:52.400536 [info ] [MainThread]:   connect_timeout: 10
[0m13:23:52.401641 [info ] [MainThread]:   role: None
[0m13:23:52.402666 [info ] [MainThread]:   search_path: None
[0m13:23:52.403774 [info ] [MainThread]:   keepalives_idle: 0
[0m13:23:52.404953 [info ] [MainThread]:   sslmode: None
[0m13:23:52.406038 [info ] [MainThread]:   sslcert: None
[0m13:23:52.407215 [info ] [MainThread]:   sslkey: None
[0m13:23:52.408132 [info ] [MainThread]:   sslrootcert: None
[0m13:23:52.409059 [info ] [MainThread]:   application_name: dbt
[0m13:23:52.410007 [info ] [MainThread]:   retries: 1
[0m13:23:52.411135 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:23:52.540525 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:23:52.570959 [debug] [MainThread]: Using postgres connection "debug"
[0m13:23:52.571540 [debug] [MainThread]: On debug: select 1 as id
[0m13:23:52.572015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:23:52.587533 [debug] [MainThread]: SQL status: SELECT 1 in 0.015 seconds
[0m13:23:52.589190 [debug] [MainThread]: On debug: Close
[0m13:23:52.589760 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:23:52.590944 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:23:52.592286 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4910602, "process_in_blocks": "1576", "process_kernel_time": 0.229584, "process_mem_max_rss": "109340", "process_out_blocks": "16", "process_user_time": 1.77595}
[0m13:23:52.592967 [debug] [MainThread]: Command `dbt debug` succeeded at 13:23:52.592783 after 0.49 seconds
[0m13:23:52.593537 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:23:52.594084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4d395e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a4cc48f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42a35f8ad0>]}
[0m13:23:52.594682 [debug] [MainThread]: Flushing usage events
[0m13:23:53.440356 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:24:00.607956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f604540b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6074f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6074f830>]}


============================== 13:24:00.611810 | 7b91b304-cec1-4663-a6d9-282455bbc9b6 ==============================
[0m13:24:00.611810 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:24:00.613118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/egor/.dbt', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt list', 'send_anonymous_usage_stats': 'True'}
[0m13:24:00.797615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b91b304-cec1-4663-a6d9-282455bbc9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f60edff50>]}
[0m13:24:00.866444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b91b304-cec1-4663-a6d9-282455bbc9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f609ba780>]}
[0m13:24:00.867481 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:24:00.995218 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:24:00.996118 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:24:00.996775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7b91b304-cec1-4663-a6d9-282455bbc9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f6077d790>]}
[0m13:24:01.803083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b91b304-cec1-4663-a6d9-282455bbc9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f603fa2a0>]}
[0m13:24:01.843913 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:24:01.846395 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:24:01.859659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b91b304-cec1-4663-a6d9-282455bbc9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f5f3677d0>]}
[0m13:24:01.860543 [warn ] [MainThread]: No nodes selected!
[0m13:24:01.861759 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.3104166, "process_in_blocks": "360", "process_kernel_time": 0.226335, "process_mem_max_rss": "105504", "process_out_blocks": "1656", "process_user_time": 2.628581}
[0m13:24:01.862405 [debug] [MainThread]: Command `dbt list` succeeded at 13:24:01.862243 after 1.31 seconds
[0m13:24:01.862903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f604540b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f61cfd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f60d3ed50>]}
[0m13:24:01.863471 [debug] [MainThread]: Flushing usage events
[0m13:24:02.759734 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:24:15.655469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc354ab1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc356cbbb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3546913a0>]}


============================== 13:24:15.659338 | 3b8ec4b6-72a2-4a8b-a570-e5062f7028e9 ==============================
[0m13:24:15.659338 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:24:15.660309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m13:24:15.858397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b8ec4b6-72a2-4a8b-a570-e5062f7028e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc354f9ff80>]}
[0m13:24:15.927125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b8ec4b6-72a2-4a8b-a570-e5062f7028e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3569624b0>]}
[0m13:24:15.928102 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:24:16.047691 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:24:16.108544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:24:16.109072 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:24:16.114947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b8ec4b6-72a2-4a8b-a570-e5062f7028e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc353dbaa80>]}
[0m13:24:16.166288 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:24:16.168696 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:24:16.181284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b8ec4b6-72a2-4a8b-a570-e5062f7028e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc355d3b320>]}
[0m13:24:16.181946 [info ] [MainThread]: Found 433 macros
[0m13:24:16.182537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b8ec4b6-72a2-4a8b-a570-e5062f7028e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc353520e90>]}
[0m13:24:16.184290 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:24:16.186498 [debug] [MainThread]: Command end result
[0m13:24:16.219579 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:24:16.221409 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:24:16.225020 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m13:24:16.226192 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.628353, "process_in_blocks": "24", "process_kernel_time": 0.20496, "process_mem_max_rss": "105712", "process_out_blocks": "1648", "process_user_time": 1.968162}
[0m13:24:16.226790 [debug] [MainThread]: Command `dbt compile` succeeded at 13:24:16.226662 after 0.63 seconds
[0m13:24:16.227292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3547bb440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc354ffae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc354ffb380>]}
[0m13:24:16.227803 [debug] [MainThread]: Flushing usage events
[0m13:24:16.953102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:24:22.800341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6ae4a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6ae49340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6a7a57f0>]}


============================== 13:24:22.804589 | 4fca89c0-69f4-48ed-9f7a-3cea7dbda313 ==============================
[0m13:24:22.804589 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:24:22.805401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/egor/.dbt', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt list', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:24:22.988733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fca89c0-69f4-48ed-9f7a-3cea7dbda313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6aed8140>]}
[0m13:24:23.055639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fca89c0-69f4-48ed-9f7a-3cea7dbda313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6acdbad0>]}
[0m13:24:23.056650 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:24:23.175886 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:24:23.235077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:24:23.235594 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:24:23.241975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fca89c0-69f4-48ed-9f7a-3cea7dbda313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd69f85e80>]}
[0m13:24:23.293079 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:24:23.295659 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:24:23.307103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fca89c0-69f4-48ed-9f7a-3cea7dbda313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6973f2f0>]}
[0m13:24:23.307988 [warn ] [MainThread]: No nodes selected!
[0m13:24:23.309317 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.5662237, "process_in_blocks": "0", "process_kernel_time": 0.188126, "process_mem_max_rss": "105420", "process_out_blocks": "840", "process_user_time": 1.913242}
[0m13:24:23.309894 [debug] [MainThread]: Command `dbt list` succeeded at 13:24:23.309756 after 0.57 seconds
[0m13:24:23.310426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6a8a4cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6a471040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd6a472cf0>]}
[0m13:24:23.310914 [debug] [MainThread]: Flushing usage events
[0m13:24:24.160536 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:08.065353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4340b2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4349d9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4349dae10>]}


============================== 13:26:08.069130 | c24d46c7-5815-481c-8779-6d9f674337aa ==============================
[0m13:26:08.069130 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:26:08.070007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt list', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:26:08.252901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c24d46c7-5815-481c-8779-6d9f674337aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4349dbf80>]}
[0m13:26:08.319962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c24d46c7-5815-481c-8779-6d9f674337aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4342918e0>]}
[0m13:26:08.320982 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:26:08.455724 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:26:08.518105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:26:08.518622 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:26:08.519458 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dwh.stg
[0m13:26:08.525403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c24d46c7-5815-481c-8779-6d9f674337aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa434dbeea0>]}
[0m13:26:08.588289 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:26:08.590987 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:26:08.601539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c24d46c7-5815-481c-8779-6d9f674337aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa432f6d1c0>]}
[0m13:26:08.602755 [warn ] [MainThread]: No nodes selected!
[0m13:26:08.604243 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.59719795, "process_in_blocks": "1384", "process_kernel_time": 0.203827, "process_mem_max_rss": "105240", "process_out_blocks": "848", "process_user_time": 1.994807}
[0m13:26:08.604991 [debug] [MainThread]: Command `dbt list` succeeded at 13:26:08.604846 after 0.60 seconds
[0m13:26:08.605559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa434975dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4343883e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4343896a0>]}
[0m13:26:08.606172 [debug] [MainThread]: Flushing usage events
[0m13:26:09.429036 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:25.938562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b3089a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b53fffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b373aff0>]}


============================== 13:26:25.943048 | 19d3992f-0627-4e05-9daa-d8ea0578f562 ==============================
[0m13:26:25.943048 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:26:25.944267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt list', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:26:26.127448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19d3992f-0627-4e05-9daa-d8ea0578f562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b38d9a90>]}
[0m13:26:26.198928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19d3992f-0627-4e05-9daa-d8ea0578f562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b52798b0>]}
[0m13:26:26.199998 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:26:26.321803 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:26:26.381028 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:26:26.381550 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:26:26.382417 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stg
[0m13:26:26.388488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19d3992f-0627-4e05-9daa-d8ea0578f562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b27d4620>]}
[0m13:26:26.450489 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:26:26.452971 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:26:26.463640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19d3992f-0627-4e05-9daa-d8ea0578f562', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b26f87d0>]}
[0m13:26:26.464601 [warn ] [MainThread]: No nodes selected!
[0m13:26:26.465735 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.5887456, "process_in_blocks": "0", "process_kernel_time": 0.21783, "process_mem_max_rss": "105208", "process_out_blocks": "840", "process_user_time": 2.082377}
[0m13:26:26.466346 [debug] [MainThread]: Command `dbt list` succeeded at 13:26:26.466219 after 0.59 seconds
[0m13:26:26.466853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b1f50440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b2df4ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b31492b0>]}
[0m13:26:26.467401 [debug] [MainThread]: Flushing usage events
[0m13:26:27.247013 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:40.838266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d41f3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d3830b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d5cd8410>]}


============================== 13:27:40.842142 | af3969a9-3f44-4598-827a-6d5b83c18591 ==============================
[0m13:27:40.842142 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:27:40.843221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m13:27:41.032776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af3969a9-3f44-4598-827a-6d5b83c18591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d2f30320>]}
[0m13:27:41.099938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af3969a9-3f44-4598-827a-6d5b83c18591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d2f578c0>]}
[0m13:27:41.100969 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:27:41.264818 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:27:41.344833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:27:41.345329 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:27:41.346134 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dwh
[0m13:27:41.352355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af3969a9-3f44-4598-827a-6d5b83c18591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d2f301a0>]}
[0m13:27:41.415095 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:27:41.417576 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:27:41.429582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af3969a9-3f44-4598-827a-6d5b83c18591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d2b298e0>]}
[0m13:27:41.430213 [info ] [MainThread]: Found 433 macros
[0m13:27:41.430888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af3969a9-3f44-4598-827a-6d5b83c18591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d27728d0>]}
[0m13:27:41.432696 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:27:41.434882 [debug] [MainThread]: Command end result
[0m13:27:41.469468 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:27:41.471569 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:27:41.475250 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m13:27:41.476375 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.6955867, "process_in_blocks": "0", "process_kernel_time": 0.214587, "process_mem_max_rss": "105724", "process_out_blocks": "1672", "process_user_time": 2.052575}
[0m13:27:41.476968 [debug] [MainThread]: Command `dbt compile` succeeded at 13:27:41.476839 after 0.70 seconds
[0m13:27:41.477528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d390b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d2f560c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86d2f766c0>]}
[0m13:27:41.478064 [debug] [MainThread]: Flushing usage events
[0m13:27:42.203449 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:12.506530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a3e00cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a37bc0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a3e02270>]}


============================== 13:34:12.512243 | c24b9e2b-355b-41c7-b7ad-ba162d31195a ==============================
[0m13:34:12.512243 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:34:12.513312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:34:12.712487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c24b9e2b-355b-41c7-b7ad-ba162d31195a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a38436b0>]}
[0m13:34:12.733729 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.28819168, "process_in_blocks": "51928", "process_kernel_time": 0.277124, "process_mem_max_rss": "96960", "process_out_blocks": "112", "process_user_time": 1.854209}
[0m13:34:12.734391 [debug] [MainThread]: Command `dbt clean` succeeded at 13:34:12.734245 after 0.29 seconds
[0m13:34:12.734908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a3777a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a5ac83e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91a345b7a0>]}
[0m13:34:12.735422 [debug] [MainThread]: Flushing usage events
[0m13:34:13.782712 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:26.173388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7bcaa600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7bf7fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7bf7d220>]}


============================== 13:34:26.177045 | f92a6545-7ab6-4c79-950d-f35fe76c56b5 ==============================
[0m13:34:26.177045 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:34:26.177992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt list', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:34:26.383062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f92a6545-7ab6-4c79-950d-f35fe76c56b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7bfd3e00>]}
[0m13:34:26.451581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f92a6545-7ab6-4c79-950d-f35fe76c56b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7bbe5670>]}
[0m13:34:26.452589 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:34:26.607315 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:34:26.608145 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:34:26.608764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f92a6545-7ab6-4c79-950d-f35fe76c56b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7adf0ef0>]}
[0m13:34:27.396922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f92a6545-7ab6-4c79-950d-f35fe76c56b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc79d2f560>]}
[0m13:34:27.439190 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:34:27.441609 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:34:27.457684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f92a6545-7ab6-4c79-950d-f35fe76c56b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7a588530>]}
[0m13:34:27.458577 [warn ] [MainThread]: No nodes selected!
[0m13:34:27.459752 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.3455738, "process_in_blocks": "9160", "process_kernel_time": 0.213884, "process_mem_max_rss": "105480", "process_out_blocks": "1704", "process_user_time": 2.664903}
[0m13:34:27.460400 [debug] [MainThread]: Command `dbt list` succeeded at 13:34:27.460233 after 1.35 seconds
[0m13:34:27.460959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7bfd0b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7a5f6960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc7f5bbc50>]}
[0m13:34:27.461687 [debug] [MainThread]: Flushing usage events
[0m13:34:28.324446 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:35.759831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3399e5b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3399d68f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3399e5b6e0>]}


============================== 13:34:35.763686 | 8a227833-36a8-4be5-a2dd-4afd2f40a43e ==============================
[0m13:34:35.763686 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:34:35.764609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:34:35.955460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a227833-36a8-4be5-a2dd-4afd2f40a43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3399328320>]}
[0m13:34:36.024304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a227833-36a8-4be5-a2dd-4afd2f40a43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f339a18b830>]}
[0m13:34:36.025354 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:34:36.157033 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:34:36.216233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:34:36.216745 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:34:36.222428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a227833-36a8-4be5-a2dd-4afd2f40a43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f339939de80>]}
[0m13:34:36.274990 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:34:36.277800 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:34:36.291102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a227833-36a8-4be5-a2dd-4afd2f40a43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33983d4b00>]}
[0m13:34:36.291815 [info ] [MainThread]: Found 433 macros
[0m13:34:36.292496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a227833-36a8-4be5-a2dd-4afd2f40a43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f339939e7e0>]}
[0m13:34:36.294348 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:34:36.296669 [debug] [MainThread]: Command end result
[0m13:34:36.332387 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:34:36.334827 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:34:36.338499 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m13:34:36.340398 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.63800305, "process_in_blocks": "7824", "process_kernel_time": 0.228434, "process_mem_max_rss": "105480", "process_out_blocks": "1736", "process_user_time": 1.984186}
[0m13:34:36.341020 [debug] [MainThread]: Command `dbt compile` succeeded at 13:34:36.340873 after 0.64 seconds
[0m13:34:36.341583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3399e5b6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33993f8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3398b69100>]}
[0m13:34:36.342089 [debug] [MainThread]: Flushing usage events
[0m13:34:37.038700 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:25.264618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e58025910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e59b4c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e58026060>]}


============================== 13:36:25.268452 | f6d55630-f7c7-4da9-886f-d83e7d42e940 ==============================
[0m13:36:25.268452 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:36:25.269385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m13:36:25.451431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6d55630-f7c7-4da9-886f-d83e7d42e940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e580b3f50>]}
[0m13:36:25.518351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6d55630-f7c7-4da9-886f-d83e7d42e940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e57126510>]}
[0m13:36:25.519599 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:36:25.642590 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:36:25.706330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:36:25.706841 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:36:25.712671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6d55630-f7c7-4da9-886f-d83e7d42e940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e571e11c0>]}
[0m13:36:25.761784 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:36:25.764349 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:36:25.800708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6d55630-f7c7-4da9-886f-d83e7d42e940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e5659c0e0>]}
[0m13:36:25.801349 [info ] [MainThread]: Found 433 macros
[0m13:36:25.803453 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:36:25.805678 [debug] [MainThread]: Command end result
[0m13:36:25.837490 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:36:25.839386 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:36:25.843277 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m13:36:25.844471 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.6412807, "process_in_blocks": "9152", "process_kernel_time": 0.223425, "process_mem_max_rss": "107440", "process_out_blocks": "1672", "process_user_time": 1.988765}
[0m13:36:25.845178 [debug] [MainThread]: Command `dbt build` succeeded at 13:36:25.845001 after 0.64 seconds
[0m13:36:25.845708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e59b4c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e580b2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e580b0e90>]}
[0m13:36:25.846249 [debug] [MainThread]: Flushing usage events
[0m13:36:26.801607 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:47.318145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3be93c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3bc8c4da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3bcac33b0>]}


============================== 13:36:47.322420 | cf651dca-cef7-4cfd-b5c9-286f053df877 ==============================
[0m13:36:47.322420 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:36:47.323364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:36:47.345503 [info ] [MainThread]: dbt version: 1.9.3
[0m13:36:47.346413 [info ] [MainThread]: python version: 3.12.9
[0m13:36:47.347227 [info ] [MainThread]: python path: /home/egor/projects/TSM_DWH/venv/bin/python
[0m13:36:47.348330 [info ] [MainThread]: os info: Linux-6.13.7-100.fc40.x86_64-x86_64-with-glibc2.39
[0m13:36:47.416000 [info ] [MainThread]: Using profiles dir at /home/egor/.dbt
[0m13:36:47.416645 [info ] [MainThread]: Using profiles.yml file at /home/egor/.dbt/profiles.yml
[0m13:36:47.417165 [info ] [MainThread]: Using dbt_project.yml file at /home/egor/projects/TSM_DWH/dbt_project.yml
[0m13:36:47.417887 [info ] [MainThread]: adapter type: postgres
[0m13:36:47.418371 [info ] [MainThread]: adapter version: 1.9.0
[0m13:36:47.537547 [info ] [MainThread]: Configuration:
[0m13:36:47.538280 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:36:47.538950 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:36:47.539623 [info ] [MainThread]: Required dependencies:
[0m13:36:47.540350 [debug] [MainThread]: Executing "git --help"
[0m13:36:47.542879 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:36:47.543686 [debug] [MainThread]: STDERR: "b''"
[0m13:36:47.544673 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:36:47.545700 [info ] [MainThread]: Connection:
[0m13:36:47.546738 [info ] [MainThread]:   host: 127.0.0.1
[0m13:36:47.547694 [info ] [MainThread]:   port: 5432
[0m13:36:47.548627 [info ] [MainThread]:   user: postgres
[0m13:36:47.549502 [info ] [MainThread]:   database: postgres
[0m13:36:47.550361 [info ] [MainThread]:   schema: public
[0m13:36:47.551368 [info ] [MainThread]:   connect_timeout: 10
[0m13:36:47.552403 [info ] [MainThread]:   role: None
[0m13:36:47.553578 [info ] [MainThread]:   search_path: None
[0m13:36:47.554848 [info ] [MainThread]:   keepalives_idle: 0
[0m13:36:47.555641 [info ] [MainThread]:   sslmode: None
[0m13:36:47.556296 [info ] [MainThread]:   sslcert: None
[0m13:36:47.556829 [info ] [MainThread]:   sslkey: None
[0m13:36:47.557605 [info ] [MainThread]:   sslrootcert: None
[0m13:36:47.558524 [info ] [MainThread]:   application_name: dbt
[0m13:36:47.559390 [info ] [MainThread]:   retries: 1
[0m13:36:47.560444 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:36:47.678408 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:36:47.739009 [debug] [MainThread]: Using postgres connection "debug"
[0m13:36:47.739620 [debug] [MainThread]: On debug: select 1 as id
[0m13:36:47.740086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:36:47.770875 [debug] [MainThread]: SQL status: SELECT 1 in 0.031 seconds
[0m13:36:47.772097 [debug] [MainThread]: On debug: Close
[0m13:36:47.772657 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:36:47.773296 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:36:47.774491 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.515724, "process_in_blocks": "2912", "process_kernel_time": 0.206429, "process_mem_max_rss": "109292", "process_out_blocks": "24", "process_user_time": 1.827276}
[0m13:36:47.775215 [debug] [MainThread]: Command `dbt debug` succeeded at 13:36:47.775014 after 0.52 seconds
[0m13:36:47.775680 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:36:47.776193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3bcf95250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3bc2efd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3bcea0aa0>]}
[0m13:36:47.776755 [debug] [MainThread]: Flushing usage events
[0m13:36:48.569010 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:03.748425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc6d4b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc8f8c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc6d4b800>]}


============================== 13:39:03.752181 | 9a1a493c-570c-4854-9a9e-ace6b4b256c1 ==============================
[0m13:39:03.752181 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:39:03.753323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:39:03.941894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a1a493c-570c-4854-9a9e-ace6b4b256c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc74f8200>]}
[0m13:39:04.011713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a1a493c-570c-4854-9a9e-ace6b4b256c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc6a17380>]}
[0m13:39:04.012745 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:39:04.140726 [debug] [MainThread]: checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, vars: {}, profile: , target: dev, version: 1.9.3
[0m13:39:04.185363 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:39:04.186066 [debug] [MainThread]: previous checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23, current checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f
[0m13:39:04.186789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9a1a493c-570c-4854-9a9e-ace6b4b256c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc59414f0>]}
[0m13:39:05.009769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a1a493c-570c-4854-9a9e-ace6b4b256c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc5942390>]}
[0m13:39:05.058990 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:39:05.062335 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:39:05.075340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a1a493c-570c-4854-9a9e-ace6b4b256c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc5d845c0>]}
[0m13:39:05.075974 [info ] [MainThread]: Found 433 macros
[0m13:39:05.076854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a1a493c-570c-4854-9a9e-ace6b4b256c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc5980b00>]}
[0m13:39:05.078048 [warn ] [MainThread]: The selection criterion 'stg' does not match any enabled nodes
[0m13:39:05.080311 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:39:05.081345 [debug] [MainThread]: Command end result
[0m13:39:05.118443 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:39:05.120262 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:39:05.123829 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m13:39:05.124951 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4347928, "process_in_blocks": "72", "process_kernel_time": 0.240631, "process_mem_max_rss": "106028", "process_out_blocks": "2528", "process_user_time": 2.99393}
[0m13:39:05.125586 [debug] [MainThread]: Command `cli run` succeeded at 13:39:05.125454 after 1.44 seconds
[0m13:39:05.126092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc6c7c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc6ff9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc59b37a0>]}
[0m13:39:05.126723 [debug] [MainThread]: Flushing usage events
[0m13:39:06.137188 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:41.918530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62e1205dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62e11940e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62df10eb70>]}


============================== 13:39:41.922224 | 5ed9fc8f-53ba-4e8b-8c23-9e183a4bfd17 ==============================
[0m13:39:41.922224 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:39:41.923233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt parse', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:39:42.104363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ed9fc8f-53ba-4e8b-8c23-9e183a4bfd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62df6f60f0>]}
[0m13:39:42.170468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ed9fc8f-53ba-4e8b-8c23-9e183a4bfd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62deae0860>]}
[0m13:39:42.171529 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:39:42.299214 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:39:42.344931 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:39:42.345649 [debug] [MainThread]: previous checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, current checksum: 832ccc19e5146dd41eb231211d90ac7a4e1ff8e4c869b5af4f43785a9ac82e23
[0m13:39:42.346196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ed9fc8f-53ba-4e8b-8c23-9e183a4bfd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62def3ecc0>]}
[0m13:39:43.135273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ed9fc8f-53ba-4e8b-8c23-9e183a4bfd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ddd87d70>]}
[0m13:39:43.139965 [info ] [MainThread]: Performance info: /home/egor/projects/TSM_DWH/target/perf_info.json
[0m13:39:43.201470 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:39:43.204709 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:39:43.206078 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 1.3475802, "process_in_blocks": "0", "process_kernel_time": 0.183959, "process_mem_max_rss": "105280", "process_out_blocks": "1656", "process_user_time": 2.706665}
[0m13:39:43.206723 [debug] [MainThread]: Command `dbt parse` succeeded at 13:39:43.206594 after 1.35 seconds
[0m13:39:43.207310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62e2bbbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62dec999d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ddda2210>]}
[0m13:39:43.207846 [debug] [MainThread]: Flushing usage events
[0m13:39:43.844600 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:08.877401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29c0bd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29bd787a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29bb27cb0>]}


============================== 13:41:08.881135 | e322ed2e-9f5f-4aa8-a2cc-e1fc0a92572c ==============================
[0m13:41:08.881135 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:41:08.882090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:41:17.485419 [debug] [MainThread]: Starter project path: /home/egor/projects/TSM_DWH/venv/lib64/python3.12/site-packages/dbt/include/starter_project
[0m13:41:17.488818 [info ] [MainThread]: 
Your new dbt project "tsm_dwh" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m13:41:17.489437 [info ] [MainThread]: Setting up your profile.
[0m13:42:02.874915 [info ] [MainThread]: Profile tsm_dwh written to /home/egor/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m13:42:02.876472 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 54.05607, "process_in_blocks": "152", "process_kernel_time": 0.147331, "process_mem_max_rss": "98528", "process_out_blocks": "280", "process_user_time": 1.579614}
[0m13:42:02.877446 [debug] [MainThread]: Command `dbt init` succeeded at 13:42:02.877206 after 54.06 seconds
[0m13:42:02.878511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29bbc3440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29b74acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb29c3e4dd0>]}
[0m13:42:02.879588 [debug] [MainThread]: Flushing usage events
[0m13:42:03.700119 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:42:55.177100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff94e34140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff95261550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff95263b00>]}


============================== 13:42:55.180878 | 2e390459-48e6-4b7a-9f71-9a5d577d2eed ==============================
[0m13:42:55.180878 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:42:55.181718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'version_check': 'True', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt list', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:42:55.182434 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /home/egor/projects/TSM_DWH/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m13:42:55.183638 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": false, "command_wall_clock_time": 0.06828066, "process_in_blocks": "0", "process_kernel_time": 0.140197, "process_mem_max_rss": "93384", "process_out_blocks": "16", "process_user_time": 1.500763}
[0m13:42:55.184258 [debug] [MainThread]: Command `dbt list` failed at 13:42:55.184089 after 0.07 seconds
[0m13:42:55.184781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff94f68140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff95ae3c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff98a4f0b0>]}
[0m13:42:55.185323 [debug] [MainThread]: Flushing usage events
[0m13:42:56.129765 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:48.459061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066f430bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066db26de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066d7a2600>]}


============================== 13:49:48.466039 | 0d38de5d-5b1f-433d-b023-adfb293547c3 ==============================
[0m13:49:48.466039 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:49:48.467045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:49:48.467879 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /home/egor/projects/TSM_DWH/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m13:49:48.469131 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": false, "command_wall_clock_time": 0.068632185, "process_in_blocks": "72", "process_kernel_time": 0.123364, "process_mem_max_rss": "93656", "process_out_blocks": "8", "process_user_time": 1.52341}
[0m13:49:48.469798 [debug] [MainThread]: Command `dbt clean` failed at 13:49:48.469663 after 0.07 seconds
[0m13:49:48.470331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066d0b6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066db26de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f066dac8f80>]}
[0m13:49:48.470855 [debug] [MainThread]: Flushing usage events
[0m13:49:49.435549 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:49.114288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11f092690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11edf9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11e7998b0>]}


============================== 13:50:49.118858 | 5a22682b-e288-487e-ba5d-a7206b13edbe ==============================
[0m13:50:49.118858 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:50:49.119971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:50:49.251130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a22682b-e288-487e-ba5d-a7206b13edbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11e286de0>]}
[0m13:50:49.272373 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:50:49.273524 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:50:49.275322 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.22705263, "process_in_blocks": "128", "process_kernel_time": 0.167645, "process_mem_max_rss": "97400", "process_out_blocks": "8", "process_user_time": 1.713328}
[0m13:50:49.275931 [debug] [MainThread]: Command `cli deps` succeeded at 13:50:49.275809 after 0.23 seconds
[0m13:50:49.276395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1223ff380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11e1018b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11e101340>]}
[0m13:50:49.276875 [debug] [MainThread]: Flushing usage events
[0m13:50:50.244100 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:50.662248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613de698e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613f4210a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613fa0f170>]}


============================== 13:50:50.666563 | f8f7b3bc-0296-4959-b307-43e20776dcfa ==============================
[0m13:50:50.666563 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:50:50.667631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt list', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:50:50.865423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8f7b3bc-0296-4959-b307-43e20776dcfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613dfded80>]}
[0m13:50:50.943922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8f7b3bc-0296-4959-b307-43e20776dcfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613de3f050>]}
[0m13:50:50.944893 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:50:51.066592 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:50:51.157566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:51.158047 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:51.186965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8f7b3bc-0296-4959-b307-43e20776dcfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613c91a9c0>]}
[0m13:50:51.261682 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:50:51.264446 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:50:51.277743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8f7b3bc-0296-4959-b307-43e20776dcfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613df7a630>]}
[0m13:50:51.279029 [info ] [MainThread]: tsm_dwh.dv.dv_hub_fact_journal
[0m13:50:51.279642 [info ] [MainThread]: tsm_dwh.dv.dv_hub_fact_work
[0m13:50:51.280289 [info ] [MainThread]: tsm_dwh.dv.dv_hub_tech
[0m13:50:51.280854 [info ] [MainThread]: tsm_dwh.dv.dv_lnk_fact_journal_fact_work
[0m13:50:51.281347 [info ] [MainThread]: tsm_dwh.dv.dv_lnk_fact_work_tech
[0m13:50:51.281813 [info ] [MainThread]: tsm_dwh.dv.dv_msat_fact_materials
[0m13:50:51.282284 [info ] [MainThread]: tsm_dwh.dv.dv_msat_fact_pikets
[0m13:50:51.282769 [info ] [MainThread]: tsm_dwh.dv.dv_msat_norm_workload
[0m13:50:51.283275 [info ] [MainThread]: tsm_dwh.dv.dv_sat_fact_journal
[0m13:50:51.283759 [info ] [MainThread]: tsm_dwh.dv.dv_sat_fact_tech
[0m13:50:51.284243 [info ] [MainThread]: tsm_dwh.dv.dv_sat_fact_work
[0m13:50:51.284747 [info ] [MainThread]: tsm_dwh.stage.stg_1c_journal
[0m13:50:51.285512 [info ] [MainThread]: tsm_dwh.stage.stg_1c_materials
[0m13:50:51.286507 [info ] [MainThread]: tsm_dwh.stage.stg_1c_norm_workload
[0m13:50:51.287332 [info ] [MainThread]: tsm_dwh.stage.stg_1c_pikets
[0m13:50:51.288249 [info ] [MainThread]: tsm_dwh.stage.stg_1c_tech
[0m13:50:51.289075 [info ] [MainThread]: tsm_dwh.stage.stg_1c_works
[0m13:50:51.290809 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.69434863, "process_in_blocks": "0", "process_kernel_time": 0.204793, "process_mem_max_rss": "105904", "process_out_blocks": "1160", "process_user_time": 2.166456}
[0m13:50:51.291982 [debug] [MainThread]: Command `dbt list` succeeded at 13:50:51.291730 after 0.70 seconds
[0m13:50:51.293044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613d84f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613c9197f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f613c91a7b0>]}
[0m13:50:51.293735 [debug] [MainThread]: Flushing usage events
[0m13:50:52.087521 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:58.683068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65e9fef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65d78dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65ce5a600>]}


============================== 13:50:58.686946 | 06ea169f-0c05-479c-b02a-559fbd4fb60e ==============================
[0m13:50:58.686946 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:50:58.687921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/egor/.dbt', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:50:59.011297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06ea169f-0c05-479c-b02a-559fbd4fb60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65d0c3e30>]}
[0m13:50:59.088954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06ea169f-0c05-479c-b02a-559fbd4fb60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65c155520>]}
[0m13:50:59.090143 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:50:59.228875 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:50:59.317465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:59.318052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:59.348341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06ea169f-0c05-479c-b02a-559fbd4fb60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65c1b09b0>]}
[0m13:50:59.424746 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:50:59.427424 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:50:59.441557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06ea169f-0c05-479c-b02a-559fbd4fb60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65b5f3fb0>]}
[0m13:50:59.442450 [info ] [MainThread]: Found 17 models, 433 macros
[0m13:50:59.443013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06ea169f-0c05-479c-b02a-559fbd4fb60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65bd014f0>]}
[0m13:50:59.445638 [info ] [MainThread]: 
[0m13:50:59.446198 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:50:59.446784 [info ] [MainThread]: 
[0m13:50:59.447682 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:50:59.460542 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_public'
[0m13:50:59.581130 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m13:50:59.582277 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m13:50:59.583212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:59.617626 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m13:50:59.618229 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m13:50:59.619189 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:50:59.622560 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m13:50:59.624221 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m13:50:59.624820 [debug] [ThreadPool]: On list_postgres_public: Close
[0m13:50:59.631302 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:59.631816 [debug] [MainThread]: On master: BEGIN
[0m13:50:59.632353 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:59.640963 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:50:59.641534 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:59.642264 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:50:59.646327 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m13:50:59.647825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06ea169f-0c05-479c-b02a-559fbd4fb60e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65c1b22a0>]}
[0m13:50:59.648455 [debug] [MainThread]: On master: ROLLBACK
[0m13:50:59.649073 [debug] [MainThread]: On master: Close
[0m13:50:59.652800 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m13:50:59.653727 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m13:50:59.654713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.dv_hub_fact_journal)
[0m13:50:59.655565 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m13:50:59.656351 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m13:50:59.657082 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_hub_fact_work'
[0m13:50:59.658036 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m13:50:59.658860 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_hub_tech'
[0m13:50:59.659639 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_lnk_fact_journal_fact_work'
[0m13:50:59.660244 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m13:50:59.666051 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m13:50:59.671762 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m13:50:59.671301 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m13:50:59.673924 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m13:50:59.675951 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m13:50:59.678020 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_journal_fact_work"
[0m13:50:59.679925 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m13:50:59.681029 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m13:50:59.682007 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m13:50:59.683072 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m13:50:59.683609 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m13:50:59.684586 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m13:50:59.685496 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m13:50:59.686059 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m13:50:59.687226 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_lnk_fact_journal_fact_work
[0m13:50:59.687878 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_msat_fact_materials
[0m13:50:59.688501 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_msat_fact_pikets
[0m13:50:59.689293 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_fact_work, now model.tsm_dwh.dv_lnk_fact_work_tech)
[0m13:50:59.690124 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_msat_norm_workload
[0m13:50:59.690876 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_tech, now model.tsm_dwh.dv_msat_fact_materials)
[0m13:50:59.691581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_hub_fact_journal, now model.tsm_dwh.dv_msat_fact_pikets)
[0m13:50:59.692229 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_lnk_fact_work_tech
[0m13:50:59.692904 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_lnk_fact_journal_fact_work, now model.tsm_dwh.dv_msat_norm_workload)
[0m13:50:59.693622 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_msat_fact_materials
[0m13:50:59.694243 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_msat_fact_pikets
[0m13:50:59.696401 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_lnk_fact_work_tech"
[0m13:50:59.696919 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_msat_norm_workload
[0m13:50:59.699191 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_materials"
[0m13:50:59.701362 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_fact_pikets"
[0m13:50:59.703610 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_msat_norm_workload"
[0m13:50:59.705090 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_msat_fact_materials
[0m13:50:59.705761 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_lnk_fact_work_tech
[0m13:50:59.707301 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_msat_fact_materials
[0m13:50:59.707812 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_msat_norm_workload
[0m13:50:59.708364 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_msat_fact_pikets
[0m13:50:59.709600 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_lnk_fact_work_tech
[0m13:50:59.710244 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_sat_fact_journal
[0m13:50:59.711560 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_msat_norm_workload
[0m13:50:59.712949 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_msat_fact_pikets
[0m13:50:59.713649 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_sat_fact_tech
[0m13:50:59.714295 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_materials, now model.tsm_dwh.dv_sat_fact_journal)
[0m13:50:59.714996 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_sat_fact_work
[0m13:50:59.715719 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m13:50:59.716420 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_lnk_fact_work_tech, now model.tsm_dwh.dv_sat_fact_tech)
[0m13:50:59.717050 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_sat_fact_journal
[0m13:50:59.717696 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_norm_workload, now model.tsm_dwh.dv_sat_fact_work)
[0m13:50:59.718425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_msat_fact_pikets, now model.tsm_dwh.stg_1c_journal)
[0m13:50:59.719731 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_sat_fact_tech
[0m13:50:59.722324 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_journal"
[0m13:50:59.722921 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_sat_fact_work
[0m13:50:59.723653 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m13:50:59.725760 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_tech"
[0m13:50:59.727886 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_sat_fact_work"
[0m13:50:59.730204 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m13:50:59.731069 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_sat_fact_journal
[0m13:50:59.732306 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_sat_fact_tech
[0m13:50:59.732973 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_sat_fact_work
[0m13:50:59.734328 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_sat_fact_journal
[0m13:50:59.735369 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_sat_fact_tech
[0m13:50:59.736043 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m13:50:59.736833 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_sat_fact_work
[0m13:50:59.737395 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_materials
[0m13:50:59.738101 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_norm_workload
[0m13:50:59.739032 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m13:50:59.739627 [debug] [Thread-4 (]: Began running node model.tsm_dwh.stg_1c_pikets
[0m13:50:59.740333 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_journal, now model.tsm_dwh.stg_1c_materials)
[0m13:50:59.740969 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_tech, now model.tsm_dwh.stg_1c_norm_workload)
[0m13:50:59.741668 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m13:50:59.742327 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.dv_sat_fact_work, now model.tsm_dwh.stg_1c_pikets)
[0m13:50:59.742879 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_materials
[0m13:50:59.743504 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_norm_workload
[0m13:50:59.744239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_journal, now model.tsm_dwh.stg_1c_tech)
[0m13:50:59.745230 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.stg_1c_pikets
[0m13:50:59.747698 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_materials"
[0m13:50:59.749766 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_norm_workload"
[0m13:50:59.750452 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m13:50:59.754015 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_pikets"
[0m13:50:59.758460 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m13:50:59.759697 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_norm_workload
[0m13:50:59.760436 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_materials
[0m13:50:59.761544 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_norm_workload
[0m13:50:59.762314 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m13:50:59.763518 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_materials
[0m13:50:59.764191 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_works
[0m13:50:59.764769 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.stg_1c_pikets
[0m13:50:59.765704 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m13:50:59.766522 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_norm_workload, now model.tsm_dwh.stg_1c_works)
[0m13:50:59.767495 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.stg_1c_pikets
[0m13:50:59.768378 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m13:50:59.771316 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m13:50:59.771968 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m13:50:59.772838 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m13:50:59.774382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:59.774833 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_tech' was properly closed.
[0m13:50:59.775404 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_works' was properly closed.
[0m13:50:59.775824 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_materials' was properly closed.
[0m13:50:59.776404 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_pikets' was properly closed.
[0m13:50:59.779785 [debug] [MainThread]: Command end result
[0m13:50:59.810935 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m13:50:59.812809 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m13:50:59.822008 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m13:50:59.823702 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.1980419, "process_in_blocks": "2376", "process_kernel_time": 0.217958, "process_mem_max_rss": "115300", "process_out_blocks": "2784", "process_user_time": 2.411731}
[0m13:50:59.824327 [debug] [MainThread]: Command `dbt compile` succeeded at 13:50:59.824199 after 1.20 seconds
[0m13:50:59.824891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65eb5c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65cc44980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb65a59f890>]}
[0m13:50:59.825513 [debug] [MainThread]: Flushing usage events
[0m13:51:00.587680 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:47:59.600742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ab8c50800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ab8f0a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ab89474a0>]}


============================== 16:47:59.608295 | 9e7389ad-fe52-42f7-b0ee-b46c0d50c65e ==============================
[0m16:47:59.608295 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:47:59.609720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:47:59.883386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e7389ad-fe52-42f7-b0ee-b46c0d50c65e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ab85ec5c0>]}
[0m16:47:59.934395 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:47:59.936112 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:47:59.948062 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43814826, "process_in_blocks": "144", "process_kernel_time": 0.233961, "process_mem_max_rss": "97396", "process_out_blocks": "40", "process_user_time": 3.132691}
[0m16:47:59.949256 [debug] [MainThread]: Command `cli deps` succeeded at 16:47:59.949010 after 0.44 seconds
[0m16:47:59.950156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ab8c50800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ab86c3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abc5ff380>]}
[0m16:47:59.953422 [debug] [MainThread]: Flushing usage events
[0m16:48:00.974306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:09:40.040047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9da0439b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d9db81d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9da180d70>]}


============================== 10:09:40.047344 | 7e265022-c842-4953-8b6b-ab97375e0758 ==============================
[0m10:09:40.047344 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:09:40.048752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:09:40.291160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e265022-c842-4953-8b6b-ab97375e0758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d9e7c3b0>]}
[0m10:09:40.328581 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:09:40.330891 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:09:40.333466 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41911298, "process_in_blocks": "152", "process_kernel_time": 0.219238, "process_mem_max_rss": "97384", "process_out_blocks": "48", "process_user_time": 2.88133}
[0m10:09:40.334632 [debug] [MainThread]: Command `cli deps` succeeded at 10:09:40.334382 after 0.42 seconds
[0m10:09:40.335545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9da4aa150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9da4a8500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d9b577d0>]}
[0m10:09:40.336474 [debug] [MainThread]: Flushing usage events
[0m10:09:41.110284 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:17:29.689933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0285ba6030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0287afcef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02855c5310>]}


============================== 12:17:29.696015 | a2fc91d9-5594-4201-8d60-a0b10dfb168f ==============================
[0m12:17:29.696015 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:17:29.697663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:17:29.923659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2fc91d9-5594-4201-8d60-a0b10dfb168f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0285510410>]}
[0m12:17:29.963228 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:17:29.967528 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:17:29.973082 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.40066558, "process_in_blocks": "3360", "process_kernel_time": 0.259755, "process_mem_max_rss": "97240", "process_out_blocks": "72", "process_user_time": 2.78487}
[0m12:17:29.974266 [debug] [MainThread]: Command `cli deps` succeeded at 12:17:29.974009 after 0.40 seconds
[0m12:17:29.976261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0285852b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f028524ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0285510320>]}
[0m12:17:29.977577 [debug] [MainThread]: Flushing usage events
[0m12:17:30.816898 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:06.787133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772174f500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772398c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f772174f7d0>]}


============================== 12:50:06.792556 | 28a935fa-19e7-459e-b736-215a66760d72 ==============================
[0m12:50:06.792556 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:50:06.793577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:50:06.816343 [info ] [MainThread]: dbt version: 1.9.3
[0m12:50:06.817191 [info ] [MainThread]: python version: 3.12.9
[0m12:50:06.817842 [info ] [MainThread]: python path: /home/egor/projects/TSM_DWH/venv/bin/python
[0m12:50:06.818437 [info ] [MainThread]: os info: Linux-6.13.7-100.fc40.x86_64-x86_64-with-glibc2.39
[0m12:50:06.891858 [info ] [MainThread]: Using profiles dir at /home/egor/.dbt
[0m12:50:06.892586 [info ] [MainThread]: Using profiles.yml file at /home/egor/.dbt/profiles.yml
[0m12:50:06.893292 [info ] [MainThread]: Using dbt_project.yml file at /home/egor/projects/TSM_DWH/dbt_project.yml
[0m12:50:06.894298 [info ] [MainThread]: adapter type: postgres
[0m12:50:06.895154 [info ] [MainThread]: adapter version: 1.9.0
[0m12:50:07.010090 [info ] [MainThread]: Configuration:
[0m12:50:07.010833 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:50:07.011672 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:50:07.012423 [info ] [MainThread]: Required dependencies:
[0m12:50:07.013324 [debug] [MainThread]: Executing "git --help"
[0m12:50:07.015952 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:50:07.017104 [debug] [MainThread]: STDERR: "b''"
[0m12:50:07.017744 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:50:07.018704 [info ] [MainThread]: Connection:
[0m12:50:07.019471 [info ] [MainThread]:   host: 127.0.0.1
[0m12:50:07.020135 [info ] [MainThread]:   port: 5432
[0m12:50:07.020834 [info ] [MainThread]:   user: postgres
[0m12:50:07.021785 [info ] [MainThread]:   database: postgres
[0m12:50:07.022766 [info ] [MainThread]:   schema: public
[0m12:50:07.023753 [info ] [MainThread]:   connect_timeout: 10
[0m12:50:07.024707 [info ] [MainThread]:   role: None
[0m12:50:07.025599 [info ] [MainThread]:   search_path: None
[0m12:50:07.026498 [info ] [MainThread]:   keepalives_idle: 60
[0m12:50:07.027375 [info ] [MainThread]:   sslmode: None
[0m12:50:07.028289 [info ] [MainThread]:   sslcert: None
[0m12:50:07.029318 [info ] [MainThread]:   sslkey: None
[0m12:50:07.030342 [info ] [MainThread]:   sslrootcert: None
[0m12:50:07.031383 [info ] [MainThread]:   application_name: dbt
[0m12:50:07.032512 [info ] [MainThread]:   retries: 1
[0m12:50:07.033977 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:50:07.175764 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:50:07.225457 [debug] [MainThread]: Using postgres connection "debug"
[0m12:50:07.225977 [debug] [MainThread]: On debug: select 1 as id
[0m12:50:07.226443 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:50:07.246244 [debug] [MainThread]: SQL status: SELECT 1 in 0.020 seconds
[0m12:50:07.247573 [debug] [MainThread]: On debug: Close
[0m12:50:07.248137 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:50:07.248694 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:50:07.250300 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.524759, "process_in_blocks": "2880", "process_kernel_time": 0.228564, "process_mem_max_rss": "109204", "process_out_blocks": "24", "process_user_time": 1.770667}
[0m12:50:07.250951 [debug] [MainThread]: Command `dbt debug` succeeded at 12:50:07.250779 after 0.53 seconds
[0m12:50:07.251394 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:50:07.251913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7721fcd940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77214aa3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7721b52db0>]}
[0m12:50:07.252461 [debug] [MainThread]: Flushing usage events
[0m12:50:08.206072 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:34.939655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ece24b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ecdf534a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ed0534650>]}


============================== 12:50:34.943508 | e7a21bce-6888-410d-a373-b036c5c238a4 ==============================
[0m12:50:34.943508 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:50:34.944656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_1c_journal', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:50:35.136955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7a21bce-6888-410d-a373-b036c5c238a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ece9da300>]}
[0m12:50:35.208076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7a21bce-6888-410d-a373-b036c5c238a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ed0c4ba40>]}
[0m12:50:35.209066 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:50:35.337136 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:50:35.425518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m12:50:35.426267 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_tech.sql
[0m12:50:35.426814 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dev_incremental.sql
[0m12:50:35.427393 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_fact_journal.sql
[0m12:50:35.427950 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_fact_work.sql
[0m12:50:35.641656 [error] [MainThread]: Encountered an error:
Parsing Error
  at path ['tags']: ['dev', 'hub', Undefined] is not valid under any of the given schemas
[0m12:50:35.643223 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.76017135, "process_in_blocks": "272", "process_kernel_time": 0.191795, "process_mem_max_rss": "107380", "process_out_blocks": "8", "process_user_time": 2.115654}
[0m12:50:35.643819 [debug] [MainThread]: Command `dbt run` failed at 12:50:35.643683 after 0.76 seconds
[0m12:50:35.644375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ece9d9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ecc382030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ece41a4b0>]}
[0m12:50:35.644973 [debug] [MainThread]: Flushing usage events
[0m12:50:36.468109 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:03.564066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a63efcf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a6390d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a658bc740>]}


============================== 12:54:03.567859 | bdf77f78-7033-4444-932f-ec0edcf3e31d ==============================
[0m12:54:03.567859 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:54:03.568777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_1c_journal', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:54:03.748877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdf77f78-7033-4444-932f-ec0edcf3e31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a63e0c170>]}
[0m12:54:03.814538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdf77f78-7033-4444-932f-ec0edcf3e31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a63b63740>]}
[0m12:54:03.815511 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:54:03.953270 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:54:04.043110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m12:54:04.043851 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_fact_journal.sql
[0m12:54:04.044471 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dev_incremental.sql
[0m12:54:04.045072 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_fact_work.sql
[0m12:54:04.045607 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_tech.sql
[0m12:54:04.282099 [error] [MainThread]: Encountered an error:
Compilation Error in model dev_incremental (tsm_dwh/models/dev_incremental.sql)
  expected token ':', got '}'
    line 5
      tags=['dev', 'hub', {source}]
[0m12:54:04.283423 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7763957, "process_in_blocks": "112", "process_kernel_time": 0.212546, "process_mem_max_rss": "107588", "process_out_blocks": "8", "process_user_time": 2.104844}
[0m12:54:04.284035 [debug] [MainThread]: Command `dbt run` failed at 12:54:04.283893 after 0.78 seconds
[0m12:54:04.284550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a63301100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a61b1fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a64b93c50>]}
[0m12:54:04.285091 [debug] [MainThread]: Flushing usage events
[0m12:54:05.128498 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:30.905612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffe5db620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffe1006e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffe018c50>]}


============================== 12:54:30.909950 | 3b28e9d2-a862-44be-9b9e-390a324d2e9a ==============================
[0m12:54:30.909950 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:54:30.910974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_1c_journal', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:54:31.094969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b28e9d2-a862-44be-9b9e-390a324d2e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffe5da330>]}
[0m12:54:31.161529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b28e9d2-a862-44be-9b9e-390a324d2e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffe31daf0>]}
[0m12:54:31.162505 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:54:31.284479 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:54:31.372063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m12:54:31.372803 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_tech.sql
[0m12:54:31.373404 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_fact_journal.sql
[0m12:54:31.373960 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dev_incremental.sql
[0m12:54:31.374499 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_fact_work.sql
[0m12:54:31.611772 [error] [MainThread]: Encountered an error:
Compilation Error in model dev_incremental (tsm_dwh/models/dev_incremental.sql)
  invalid syntax for function call expression
    line 2
      config(
[0m12:54:31.613161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.76654994, "process_in_blocks": "0", "process_kernel_time": 0.216689, "process_mem_max_rss": "107648", "process_out_blocks": "8", "process_user_time": 2.134613}
[0m12:54:31.613823 [debug] [MainThread]: Command `dbt run` failed at 12:54:31.613680 after 0.77 seconds
[0m12:54:31.614373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffdaf44d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffda10e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffc323110>]}
[0m12:54:31.614888 [debug] [MainThread]: Flushing usage events
[0m12:54:32.501000 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:46.769442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f493ebe5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f493ebe4bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f493ebe4c50>]}


============================== 12:54:46.773719 | f5f96df0-2303-4432-a437-731effbe1b71 ==============================
[0m12:54:46.773719 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:54:46.774916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_1c_journal', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:54:46.953692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5f96df0-2303-4432-a437-731effbe1b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f493ebe6b10>]}
[0m12:54:47.020225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5f96df0-2303-4432-a437-731effbe1b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f493e296960>]}
[0m12:54:47.021288 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:54:47.138959 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:54:47.230393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m12:54:47.231176 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dev_incremental.sql
[0m12:54:47.231740 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_fact_journal.sql
[0m12:54:47.232326 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_fact_work.sql
[0m12:54:47.232901 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_tech.sql
[0m12:54:47.438758 [error] [MainThread]: Encountered an error:
Compilation Error in model dev_incremental (tsm_dwh/models/dev_incremental.sql)
  expected token ':', got '}'
    line 15
      FROM {{{{ ref('{stg_table}') }}}}
[0m12:54:47.440190 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.72893137, "process_in_blocks": "0", "process_kernel_time": 0.192048, "process_mem_max_rss": "107592", "process_out_blocks": "16", "process_user_time": 2.10796}
[0m12:54:47.440792 [debug] [MainThread]: Command `dbt run` failed at 12:54:47.440651 after 0.73 seconds
[0m12:54:47.441311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f493eb5ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f494053d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f493c919d90>]}
[0m12:54:47.441802 [debug] [MainThread]: Flushing usage events
[0m12:54:48.271528 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:56.074643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ea3baa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ec534620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ea6fad20>]}


============================== 12:54:56.078584 | 136cb314-a074-41c0-8b1d-07e2942580cc ==============================
[0m12:54:56.078584 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:54:56.079550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_1c_journal', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:54:56.261304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '136cb314-a074-41c0-8b1d-07e2942580cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ea9da2d0>]}
[0m12:54:56.331851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '136cb314-a074-41c0-8b1d-07e2942580cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e9db81a0>]}
[0m12:54:56.332848 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:54:56.453278 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:54:56.542014 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 3 files changed.
[0m12:54:56.542618 [debug] [MainThread]: Partial parsing: deleted file: tsm_dwh://tsm_dwh/models/dev_incremental.sql
[0m12:54:56.543379 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_fact_journal.sql
[0m12:54:56.543951 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_fact_work.sql
[0m12:54:56.544558 [debug] [MainThread]: Partial parsing: updated file: tsm_dwh://tsm_dwh/models/dv/dv_hub_tech.sql
[0m12:54:56.830409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '136cb314-a074-41c0-8b1d-07e2942580cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e83ea5a0>]}
[0m12:54:56.897423 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m12:54:56.900052 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m12:54:56.918919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '136cb314-a074-41c0-8b1d-07e2942580cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e7f381a0>]}
[0m12:54:56.919601 [info ] [MainThread]: Found 17 models, 433 macros
[0m12:54:56.920239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '136cb314-a074-41c0-8b1d-07e2942580cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e839de50>]}
[0m12:54:56.922138 [info ] [MainThread]: 
[0m12:54:56.922723 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:54:56.923358 [info ] [MainThread]: 
[0m12:54:56.924314 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:54:56.925786 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:54:56.972671 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:54:56.973272 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:54:56.973810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:56.985318 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m12:54:56.986925 [debug] [ThreadPool]: On list_postgres: Close
[0m12:54:56.994970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m12:54:57.001581 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:54:57.002087 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m12:54:57.002537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:57.011025 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:54:57.011536 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:54:57.012018 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:54:57.020099 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m12:54:57.022010 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m12:54:57.022670 [debug] [ThreadPool]: On list_postgres_public: Close
[0m12:54:57.029436 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:57.029941 [debug] [MainThread]: On master: BEGIN
[0m12:54:57.030388 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:57.038948 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:54:57.039458 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:57.040034 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:54:57.045026 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m12:54:57.046993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '136cb314-a074-41c0-8b1d-07e2942580cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e9e09070>]}
[0m12:54:57.047558 [debug] [MainThread]: On master: ROLLBACK
[0m12:54:57.048139 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:57.048564 [debug] [MainThread]: On master: BEGIN
[0m12:54:57.049280 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:54:57.049710 [debug] [MainThread]: On master: COMMIT
[0m12:54:57.050245 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:57.050689 [debug] [MainThread]: On master: COMMIT
[0m12:54:57.051327 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:54:57.051769 [debug] [MainThread]: On master: Close
[0m12:54:57.056248 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m12:54:57.056995 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_1c_journal .............................. [RUN]
[0m12:54:57.057763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m12:54:57.058439 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m12:54:57.069459 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m12:54:57.070715 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m12:54:57.115835 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m12:54:57.117002 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m12:54:57.117588 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m12:54:57.118139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:57.126354 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m12:54:57.126971 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m12:54:57.127665 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name);
  );
[0m12:54:57.129176 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 112:  направление_деятельности_name);
                                         ^

[0m12:54:57.129724 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: ROLLBACK
[0m12:54:57.130601 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m12:54:57.141604 [debug] [Thread-1 (]: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  syntax error at or near ";"
  LINE 112:  направление_деятельности_name);
                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m12:54:57.143625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '136cb314-a074-41c0-8b1d-07e2942580cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e83ea5a0>]}
[0m12:54:57.144505 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_1c_journal ..................... [[31mERROR[0m in 0.08s]
[0m12:54:57.145419 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m12:54:57.146187 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_journal' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  syntax error at or near ";"
  LINE 112:  направление_деятельности_name);
                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql.
[0m12:54:57.148751 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:57.149319 [debug] [MainThread]: On master: BEGIN
[0m12:54:57.149753 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:57.161483 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:54:57.162282 [debug] [MainThread]: On master: COMMIT
[0m12:54:57.162790 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:57.163295 [debug] [MainThread]: On master: COMMIT
[0m12:54:57.164102 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:54:57.164714 [debug] [MainThread]: On master: Close
[0m12:54:57.165675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:57.166726 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m12:54:57.167925 [info ] [MainThread]: 
[0m12:54:57.168824 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m12:54:57.170184 [debug] [MainThread]: Command end result
[0m12:54:57.214604 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m12:54:57.216613 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m12:54:57.223298 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m12:54:57.224091 [info ] [MainThread]: 
[0m12:54:57.224894 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:54:57.225770 [info ] [MainThread]: 
[0m12:54:57.226583 [error] [MainThread]:   Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  syntax error at or near ";"
  LINE 112:  направление_деятельности_name);
                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m12:54:57.227277 [info ] [MainThread]: 
[0m12:54:57.227988 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:54:57.229263 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2123255, "process_in_blocks": "312", "process_kernel_time": 0.220439, "process_mem_max_rss": "118988", "process_out_blocks": "3400", "process_user_time": 2.520653}
[0m12:54:57.229940 [debug] [MainThread]: Command `dbt run` failed at 12:54:57.229730 after 1.21 seconds
[0m12:54:57.230987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ea83aea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e8327f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43e8324bf0>]}
[0m12:54:57.231717 [debug] [MainThread]: Flushing usage events
[0m12:54:58.101621 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:25.236975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cef4b740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cf51b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cefeb3e0>]}


============================== 12:56:25.240723 | 862c36ae-b251-40f1-a023-37e88536b09a ==============================
[0m12:56:25.240723 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:56:25.241830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_1c_journal', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:56:25.423788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '862c36ae-b251-40f1-a023-37e88536b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cebf4860>]}
[0m12:56:25.490237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '862c36ae-b251-40f1-a023-37e88536b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cec236e0>]}
[0m12:56:25.491218 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:56:25.611470 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:56:25.702845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:56:25.703332 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:56:25.732259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '862c36ae-b251-40f1-a023-37e88536b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ce11e5a0>]}
[0m12:56:25.803767 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m12:56:25.806441 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m12:56:25.820799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '862c36ae-b251-40f1-a023-37e88536b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cd501040>]}
[0m12:56:25.821504 [info ] [MainThread]: Found 17 models, 433 macros
[0m12:56:25.822112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '862c36ae-b251-40f1-a023-37e88536b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cd5c4dd0>]}
[0m12:56:25.824042 [info ] [MainThread]: 
[0m12:56:25.824598 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:56:25.825273 [info ] [MainThread]: 
[0m12:56:25.826270 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:56:25.827541 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:56:25.879673 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:56:25.880566 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:56:25.881147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:25.893037 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.012 seconds
[0m12:56:25.894652 [debug] [ThreadPool]: On list_postgres: Close
[0m12:56:25.901646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m12:56:25.909599 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:56:25.910194 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m12:56:25.910662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:25.919058 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:56:25.919588 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:56:25.920254 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:56:25.923573 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m12:56:25.925273 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m12:56:25.925885 [debug] [ThreadPool]: On list_postgres_public: Close
[0m12:56:25.932370 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:25.932897 [debug] [MainThread]: On master: BEGIN
[0m12:56:25.933353 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:56:25.941289 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:56:25.941824 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:25.942433 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:56:25.946658 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m12:56:25.948533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '862c36ae-b251-40f1-a023-37e88536b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ceb12c90>]}
[0m12:56:25.949160 [debug] [MainThread]: On master: ROLLBACK
[0m12:56:25.949821 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:25.950340 [debug] [MainThread]: On master: BEGIN
[0m12:56:25.950994 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:56:25.951436 [debug] [MainThread]: On master: COMMIT
[0m12:56:25.951922 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:25.952362 [debug] [MainThread]: On master: COMMIT
[0m12:56:25.952946 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:56:25.953593 [debug] [MainThread]: On master: Close
[0m12:56:25.957732 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m12:56:25.958701 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_1c_journal .............................. [RUN]
[0m12:56:25.959574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m12:56:25.960267 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m12:56:25.974361 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m12:56:25.975964 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m12:56:26.019512 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m12:56:26.020673 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m12:56:26.021295 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m12:56:26.021750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:26.030330 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m12:56:26.030963 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m12:56:26.031655 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name);
  );
[0m12:56:26.033166 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 112:  направление_деятельности_name);
                                         ^

[0m12:56:26.033680 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: ROLLBACK
[0m12:56:26.034499 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m12:56:26.038733 [debug] [Thread-1 (]: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  syntax error at or near ";"
  LINE 112:  направление_деятельности_name);
                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m12:56:26.040864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '862c36ae-b251-40f1-a023-37e88536b09a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cbc070e0>]}
[0m12:56:26.041758 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_1c_journal ..................... [[31mERROR[0m in 0.08s]
[0m12:56:26.042723 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m12:56:26.043576 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_journal' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  syntax error at or near ";"
  LINE 112:  направление_деятельности_name);
                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql.
[0m12:56:26.046125 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:26.046599 [debug] [MainThread]: On master: BEGIN
[0m12:56:26.047208 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:56:26.057448 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:56:26.058320 [debug] [MainThread]: On master: COMMIT
[0m12:56:26.059221 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:26.060118 [debug] [MainThread]: On master: COMMIT
[0m12:56:26.061299 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:56:26.062332 [debug] [MainThread]: On master: Close
[0m12:56:26.063156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:26.063668 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m12:56:26.064437 [info ] [MainThread]: 
[0m12:56:26.065248 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m12:56:26.066973 [debug] [MainThread]: Command end result
[0m12:56:26.105394 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m12:56:26.107169 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m12:56:26.114904 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m12:56:26.115655 [info ] [MainThread]: 
[0m12:56:26.116343 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:56:26.116933 [info ] [MainThread]: 
[0m12:56:26.117521 [error] [MainThread]:   Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  syntax error at or near ";"
  LINE 112:  направление_деятельности_name);
                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m12:56:26.118063 [info ] [MainThread]: 
[0m12:56:26.118628 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:56:26.119789 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9392941, "process_in_blocks": "0", "process_kernel_time": 0.187811, "process_mem_max_rss": "115832", "process_out_blocks": "2432", "process_user_time": 2.275751}
[0m12:56:26.120420 [debug] [MainThread]: Command `dbt run` failed at 12:56:26.120293 after 0.94 seconds
[0m12:56:26.120966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cf51b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cdd89790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24cdd89160>]}
[0m12:56:26.121525 [debug] [MainThread]: Flushing usage events
[0m12:56:27.087804 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:47.037061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc70cd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc696c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc8dd1bb0>]}


============================== 12:56:47.040852 | ec34c04a-ae2e-4099-b6c6-0b85e9d5c6d5 ==============================
[0m12:56:47.040852 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:56:47.041996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_1c_journal', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:56:47.221960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec34c04a-ae2e-4099-b6c6-0b85e9d5c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc6741ca0>]}
[0m12:56:47.288023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec34c04a-ae2e-4099-b6c6-0b85e9d5c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc6780470>]}
[0m12:56:47.288970 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:56:47.409684 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:56:47.502379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:56:47.502851 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:56:47.531490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec34c04a-ae2e-4099-b6c6-0b85e9d5c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc69df560>]}
[0m12:56:47.602698 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m12:56:47.605403 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m12:56:47.620609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec34c04a-ae2e-4099-b6c6-0b85e9d5c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc4d31340>]}
[0m12:56:47.621763 [info ] [MainThread]: Found 17 models, 433 macros
[0m12:56:47.622753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec34c04a-ae2e-4099-b6c6-0b85e9d5c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc5d34740>]}
[0m12:56:47.626047 [info ] [MainThread]: 
[0m12:56:47.627041 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:56:47.628010 [info ] [MainThread]: 
[0m12:56:47.629418 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:56:47.631424 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:56:47.697315 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:56:47.697893 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:56:47.698502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:47.713357 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.015 seconds
[0m12:56:47.716439 [debug] [ThreadPool]: On list_postgres: Close
[0m12:56:47.722902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m12:56:47.731150 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:56:47.731663 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m12:56:47.732241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:47.740777 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:56:47.741421 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m12:56:47.741988 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:56:47.745249 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m12:56:47.746939 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m12:56:47.747610 [debug] [ThreadPool]: On list_postgres_public: Close
[0m12:56:47.754159 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:47.754664 [debug] [MainThread]: On master: BEGIN
[0m12:56:47.755224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:56:47.764638 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:56:47.765500 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:47.766485 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:56:47.772706 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m12:56:47.776191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec34c04a-ae2e-4099-b6c6-0b85e9d5c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc68296a0>]}
[0m12:56:47.777323 [debug] [MainThread]: On master: ROLLBACK
[0m12:56:47.778072 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:47.778527 [debug] [MainThread]: On master: BEGIN
[0m12:56:47.779423 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:56:47.779905 [debug] [MainThread]: On master: COMMIT
[0m12:56:47.780373 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:47.780822 [debug] [MainThread]: On master: COMMIT
[0m12:56:47.781442 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:56:47.781909 [debug] [MainThread]: On master: Close
[0m12:56:47.785080 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m12:56:47.786294 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_1c_journal .............................. [RUN]
[0m12:56:47.787315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m12:56:47.788088 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m12:56:47.798790 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m12:56:47.800510 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m12:56:47.847528 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m12:56:47.848724 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m12:56:47.849333 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m12:56:47.849838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:47.859912 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m12:56:47.860680 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m12:56:47.861526 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m12:56:47.863165 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "journal" does not exist
LINE 80:         journal
                 ^

[0m12:56:47.863738 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: ROLLBACK
[0m12:56:47.864738 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m12:56:47.869323 [debug] [Thread-1 (]: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  relation "journal" does not exist
  LINE 80:         journal
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m12:56:47.872069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec34c04a-ae2e-4099-b6c6-0b85e9d5c6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc5d069f0>]}
[0m12:56:47.873970 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_1c_journal ..................... [[31mERROR[0m in 0.08s]
[0m12:56:47.875264 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m12:56:47.876103 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_journal' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  relation "journal" does not exist
  LINE 80:         journal
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql.
[0m12:56:47.879101 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:47.879585 [debug] [MainThread]: On master: BEGIN
[0m12:56:47.880242 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:56:47.889698 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:56:47.890303 [debug] [MainThread]: On master: COMMIT
[0m12:56:47.890773 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:47.891238 [debug] [MainThread]: On master: COMMIT
[0m12:56:47.891882 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:56:47.892374 [debug] [MainThread]: On master: Close
[0m12:56:47.892996 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:47.893448 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m12:56:47.894329 [info ] [MainThread]: 
[0m12:56:47.895344 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m12:56:47.897173 [debug] [MainThread]: Command end result
[0m12:56:47.937786 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m12:56:47.940192 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m12:56:47.948359 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m12:56:47.949325 [info ] [MainThread]: 
[0m12:56:47.950376 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:56:47.951353 [info ] [MainThread]: 
[0m12:56:47.952176 [error] [MainThread]:   Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  relation "journal" does not exist
  LINE 80:         journal
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m12:56:47.952802 [info ] [MainThread]: 
[0m12:56:47.953543 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:56:47.955016 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.97472453, "process_in_blocks": "0", "process_kernel_time": 0.235775, "process_mem_max_rss": "115960", "process_out_blocks": "2328", "process_user_time": 2.240445}
[0m12:56:47.955885 [debug] [MainThread]: Command `dbt run` failed at 12:56:47.955640 after 0.98 seconds
[0m12:56:47.956496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc71b0080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc73c2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc73c3050>]}
[0m12:56:47.957213 [debug] [MainThread]: Flushing usage events
[0m12:56:48.749836 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:29:11.512265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2904a43860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2904cc9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29052bd250>]}


============================== 13:29:11.519072 | 3f6b04bf-baec-44e4-9a62-79d30f57030c ==============================
[0m13:29:11.519072 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:29:11.520329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:29:11.700463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f6b04bf-baec-44e4-9a62-79d30f57030c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29045b9c40>]}
[0m13:29:11.723806 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:29:11.725367 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:29:11.727213 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.38502085, "process_in_blocks": "96", "process_kernel_time": 0.196006, "process_mem_max_rss": "97496", "process_out_blocks": "104", "process_user_time": 2.060309}
[0m13:29:11.728435 [debug] [MainThread]: Command `cli deps` succeeded at 13:29:11.728196 after 0.39 seconds
[0m13:29:11.729006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29046e0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f290483ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f290483f500>]}
[0m13:29:11.729509 [debug] [MainThread]: Flushing usage events
[0m13:29:12.675052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:06:42.866524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb80238c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb7f8c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb630b830>]}


============================== 15:06:42.873597 | c3fd3562-c47d-4145-ba88-ffaa4e5c45b8 ==============================
[0m15:06:42.873597 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:06:42.875036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:06:43.135925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3fd3562-c47d-4145-ba88-ffaa4e5c45b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb5d3b320>]}
[0m15:06:43.162145 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:06:43.163679 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:06:43.166159 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41962722, "process_in_blocks": "152", "process_kernel_time": 0.201692, "process_mem_max_rss": "97480", "process_out_blocks": "72", "process_user_time": 2.076889}
[0m15:06:43.167036 [debug] [MainThread]: Command `cli deps` succeeded at 15:06:43.166858 after 0.42 seconds
[0m15:06:43.167941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb5ca3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb5c4bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb5d3b4d0>]}
[0m15:06:43.168782 [debug] [MainThread]: Flushing usage events
[0m15:06:44.049926 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:21:15.601779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1444c15850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144433f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1444acf320>]}


============================== 15:21:15.605830 | 9a5786d5-5463-4707-8bcb-356fb8b1a36a ==============================
[0m15:21:15.605830 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:21:15.606801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_1c_journal', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:21:15.786891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a5786d5-5463-4707-8bcb-356fb8b1a36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1444acd010>]}
[0m15:21:15.854725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a5786d5-5463-4707-8bcb-356fb8b1a36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1445fbb5c0>]}
[0m15:21:15.855740 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:21:15.981311 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:21:16.071928 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:21:16.072431 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:21:16.100873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a5786d5-5463-4707-8bcb-356fb8b1a36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144420fce0>]}
[0m15:21:16.175736 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:21:16.178450 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:21:16.195741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a5786d5-5463-4707-8bcb-356fb8b1a36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1442505670>]}
[0m15:21:16.196422 [info ] [MainThread]: Found 17 models, 433 macros
[0m15:21:16.197061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a5786d5-5463-4707-8bcb-356fb8b1a36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1442917cb0>]}
[0m15:21:16.198908 [info ] [MainThread]: 
[0m15:21:16.199587 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:21:16.200171 [info ] [MainThread]: 
[0m15:21:16.201133 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:21:16.202584 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:21:16.260721 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:21:16.261254 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:21:16.261806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:16.278162 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.016 seconds
[0m15:21:16.279964 [debug] [ThreadPool]: On list_postgres: Close
[0m15:21:16.285946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:21:16.293916 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:21:16.294439 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:21:16.294875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:16.304027 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:21:16.305164 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:21:16.305708 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:21:16.310548 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m15:21:16.312273 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:21:16.312965 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:21:16.320670 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:16.321161 [debug] [MainThread]: On master: BEGIN
[0m15:21:16.321728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:21:16.330057 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:21:16.330863 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:16.331739 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:21:16.340399 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m15:21:16.343164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a5786d5-5463-4707-8bcb-356fb8b1a36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1443f056d0>]}
[0m15:21:16.344394 [debug] [MainThread]: On master: ROLLBACK
[0m15:21:16.345734 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:16.346727 [debug] [MainThread]: On master: BEGIN
[0m15:21:16.348025 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:21:16.348576 [debug] [MainThread]: On master: COMMIT
[0m15:21:16.349041 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:16.349526 [debug] [MainThread]: On master: COMMIT
[0m15:21:16.350149 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:21:16.350654 [debug] [MainThread]: On master: Close
[0m15:21:16.354104 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m15:21:16.355416 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_1c_journal .............................. [RUN]
[0m15:21:16.356268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m15:21:16.356982 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m15:21:16.365613 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m15:21:16.366650 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m15:21:16.411727 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m15:21:16.413008 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m15:21:16.413653 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m15:21:16.414168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:16.422512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:21:16.423121 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m15:21:16.423858 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m15:21:16.426040 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "journal" does not exist
LINE 80:         journal
                 ^

[0m15:21:16.426638 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: ROLLBACK
[0m15:21:16.427447 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m15:21:16.436561 [debug] [Thread-1 (]: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  relation "journal" does not exist
  LINE 80:         journal
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m15:21:16.438577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a5786d5-5463-4707-8bcb-356fb8b1a36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1443feba10>]}
[0m15:21:16.439433 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_1c_journal ..................... [[31mERROR[0m in 0.08s]
[0m15:21:16.440266 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m15:21:16.441035 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_journal' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  relation "journal" does not exist
  LINE 80:         journal
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql.
[0m15:21:16.443623 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:16.444145 [debug] [MainThread]: On master: BEGIN
[0m15:21:16.444718 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:21:16.456979 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m15:21:16.457924 [debug] [MainThread]: On master: COMMIT
[0m15:21:16.458920 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:16.459779 [debug] [MainThread]: On master: COMMIT
[0m15:21:16.460902 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:21:16.461772 [debug] [MainThread]: On master: Close
[0m15:21:16.462698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:16.463272 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m15:21:16.463895 [info ] [MainThread]: 
[0m15:21:16.464630 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m15:21:16.465715 [debug] [MainThread]: Command end result
[0m15:21:16.508168 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:21:16.510066 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:21:16.517597 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m15:21:16.518097 [info ] [MainThread]: 
[0m15:21:16.518760 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:21:16.519291 [info ] [MainThread]: 
[0m15:21:16.519962 [error] [MainThread]:   Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  relation "journal" does not exist
  LINE 80:         journal
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m15:21:16.520461 [info ] [MainThread]: 
[0m15:21:16.521213 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:21:16.523068 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9794058, "process_in_blocks": "1688", "process_kernel_time": 0.206682, "process_mem_max_rss": "115876", "process_out_blocks": "2464", "process_user_time": 2.253855}
[0m15:21:16.524298 [debug] [MainThread]: Command `dbt run` failed at 15:21:16.524089 after 0.98 seconds
[0m15:21:16.525011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f144450dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1444a960c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1444a96ff0>]}
[0m15:21:16.525597 [debug] [MainThread]: Flushing usage events
[0m15:21:17.633609 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:27:53.793148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc7ec9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc7901e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc7819910>]}


============================== 15:27:53.797211 | d2d826c5-504c-4f63-9042-1fcfc4656afa ==============================
[0m15:27:53.797211 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:27:53.798239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_1c_journal', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:27:53.982791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2d826c5-504c-4f63-9042-1fcfc4656afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc7dda240>]}
[0m15:27:54.048572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2d826c5-504c-4f63-9042-1fcfc4656afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc713f9e0>]}
[0m15:27:54.049659 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:27:54.168884 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:27:54.262284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:27:54.262779 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:27:54.292120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2d826c5-504c-4f63-9042-1fcfc4656afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc6b18380>]}
[0m15:27:54.363296 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:27:54.365953 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:27:54.380614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2d826c5-504c-4f63-9042-1fcfc4656afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc6b62b10>]}
[0m15:27:54.381323 [info ] [MainThread]: Found 17 models, 433 macros
[0m15:27:54.382025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2d826c5-504c-4f63-9042-1fcfc4656afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc635b650>]}
[0m15:27:54.384013 [info ] [MainThread]: 
[0m15:27:54.384697 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:27:54.385356 [info ] [MainThread]: 
[0m15:27:54.386427 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:27:54.387799 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:27:54.437842 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:27:54.438380 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:27:54.439095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:54.455564 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.016 seconds
[0m15:27:54.457438 [debug] [ThreadPool]: On list_postgres: Close
[0m15:27:54.463279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:27:54.471236 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:27:54.471811 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:27:54.472228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:54.480788 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:27:54.481318 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:27:54.481784 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:27:54.485237 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m15:27:54.486999 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:27:54.487723 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:27:54.496250 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:54.496803 [debug] [MainThread]: On master: BEGIN
[0m15:27:54.497250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:27:54.505505 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:27:54.506019 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:54.506564 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:27:54.511426 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m15:27:54.513210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2d826c5-504c-4f63-9042-1fcfc4656afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc720f8c0>]}
[0m15:27:54.513816 [debug] [MainThread]: On master: ROLLBACK
[0m15:27:54.514437 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:54.514881 [debug] [MainThread]: On master: BEGIN
[0m15:27:54.515575 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:27:54.516059 [debug] [MainThread]: On master: COMMIT
[0m15:27:54.516541 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:54.516962 [debug] [MainThread]: On master: COMMIT
[0m15:27:54.517504 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:27:54.517942 [debug] [MainThread]: On master: Close
[0m15:27:54.522030 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m15:27:54.522795 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_1c_journal .............................. [RUN]
[0m15:27:54.523591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m15:27:54.524093 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m15:27:54.532570 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m15:27:54.533483 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m15:27:54.579200 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m15:27:54.580407 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m15:27:54.580999 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m15:27:54.581475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:54.589629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:27:54.590189 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m15:27:54.590952 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m15:27:54.592552 [debug] [Thread-1 (]: Postgres adapter: Postgres error: invalid input syntax for type uuid: "-1"
LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                              ^

[0m15:27:54.593100 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: ROLLBACK
[0m15:27:54.593858 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m15:27:54.599765 [debug] [Thread-1 (]: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  invalid input syntax for type uuid: "-1"
  LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m15:27:54.601746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2d826c5-504c-4f63-9042-1fcfc4656afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc6bf5070>]}
[0m15:27:54.602631 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_1c_journal ..................... [[31mERROR[0m in 0.08s]
[0m15:27:54.603633 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m15:27:54.604419 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_journal' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  invalid input syntax for type uuid: "-1"
  LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql.
[0m15:27:54.606998 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:54.607544 [debug] [MainThread]: On master: BEGIN
[0m15:27:54.607978 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:27:54.618598 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m15:27:54.619166 [debug] [MainThread]: On master: COMMIT
[0m15:27:54.619679 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:54.620126 [debug] [MainThread]: On master: COMMIT
[0m15:27:54.620842 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:27:54.621308 [debug] [MainThread]: On master: Close
[0m15:27:54.622019 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:54.622436 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m15:27:54.622879 [info ] [MainThread]: 
[0m15:27:54.623685 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m15:27:54.625134 [debug] [MainThread]: Command end result
[0m15:27:54.665568 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:27:54.667427 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:27:54.675963 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m15:27:54.676482 [info ] [MainThread]: 
[0m15:27:54.677133 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:27:54.677800 [info ] [MainThread]: 
[0m15:27:54.678502 [error] [MainThread]:   Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  invalid input syntax for type uuid: "-1"
  LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m15:27:54.679050 [info ] [MainThread]: 
[0m15:27:54.679635 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:27:54.680736 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9453865, "process_in_blocks": "1184", "process_kernel_time": 0.210011, "process_mem_max_rss": "116028", "process_out_blocks": "2464", "process_user_time": 2.236499}
[0m15:27:54.681420 [debug] [MainThread]: Command `dbt run` failed at 15:27:54.681220 after 0.95 seconds
[0m15:27:54.682024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc7ec9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc5b23200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc713ea80>]}
[0m15:27:54.682933 [debug] [MainThread]: Flushing usage events
[0m15:27:55.666578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:54.130558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8868937080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8868844e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f886ab8c410>]}


============================== 15:33:54.134416 | 85b402bf-2691-4752-b011-7dbfd0299c18 ==============================
[0m15:33:54.134416 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:33:54.135604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_1c_journal', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:33:54.315693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85b402bf-2691-4752-b011-7dbfd0299c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88690c60f0>]}
[0m15:33:54.388957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85b402bf-2691-4752-b011-7dbfd0299c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8869039e80>]}
[0m15:33:54.389986 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:33:54.512545 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:33:54.600525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:33:54.601016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:33:54.631588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85b402bf-2691-4752-b011-7dbfd0299c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88681d5e50>]}
[0m15:33:54.705233 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:33:54.708021 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:33:54.725434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85b402bf-2691-4752-b011-7dbfd0299c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8866d01a00>]}
[0m15:33:54.726137 [info ] [MainThread]: Found 17 models, 433 macros
[0m15:33:54.726787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85b402bf-2691-4752-b011-7dbfd0299c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8867d09610>]}
[0m15:33:54.728701 [info ] [MainThread]: 
[0m15:33:54.729295 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:33:54.729864 [info ] [MainThread]: 
[0m15:33:54.730726 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:33:54.731966 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:33:54.785164 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:33:54.786024 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:33:54.786583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:54.801110 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.014 seconds
[0m15:33:54.802833 [debug] [ThreadPool]: On list_postgres: Close
[0m15:33:54.808877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:33:54.816792 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:33:54.817303 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:33:54.817763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:54.826578 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:33:54.827154 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:33:54.827782 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:33:54.831106 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m15:33:54.832898 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:33:54.833577 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:33:54.840965 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:54.841472 [debug] [MainThread]: On master: BEGIN
[0m15:33:54.841914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:33:54.850392 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:33:54.850909 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:54.851493 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:33:54.856418 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m15:33:54.858348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85b402bf-2691-4752-b011-7dbfd0299c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88684fcd10>]}
[0m15:33:54.859167 [debug] [MainThread]: On master: ROLLBACK
[0m15:33:54.860082 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:54.860992 [debug] [MainThread]: On master: BEGIN
[0m15:33:54.862144 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:33:54.862752 [debug] [MainThread]: On master: COMMIT
[0m15:33:54.863203 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:54.863653 [debug] [MainThread]: On master: COMMIT
[0m15:33:54.864296 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:33:54.864815 [debug] [MainThread]: On master: Close
[0m15:33:54.868998 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m15:33:54.870512 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_1c_journal .............................. [RUN]
[0m15:33:54.871733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m15:33:54.872877 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m15:33:54.884540 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m15:33:54.885709 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m15:33:54.928820 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m15:33:54.929973 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m15:33:54.930515 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m15:33:54.931010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:54.939574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:33:54.940180 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m15:33:54.940917 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m15:33:54.942538 [debug] [Thread-1 (]: Postgres adapter: Postgres error: invalid input syntax for type uuid: "-1"
LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                              ^

[0m15:33:54.943126 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: ROLLBACK
[0m15:33:54.943970 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m15:33:54.948798 [debug] [Thread-1 (]: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  invalid input syntax for type uuid: "-1"
  LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m15:33:54.950689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85b402bf-2691-4752-b011-7dbfd0299c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8867d09340>]}
[0m15:33:54.951611 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_1c_journal ..................... [[31mERROR[0m in 0.08s]
[0m15:33:54.952608 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m15:33:54.953471 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_journal' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  invalid input syntax for type uuid: "-1"
  LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql.
[0m15:33:54.956143 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:54.957057 [debug] [MainThread]: On master: BEGIN
[0m15:33:54.957861 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:33:54.968336 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:33:54.968965 [debug] [MainThread]: On master: COMMIT
[0m15:33:54.969709 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:54.970474 [debug] [MainThread]: On master: COMMIT
[0m15:33:54.971254 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:33:54.972273 [debug] [MainThread]: On master: Close
[0m15:33:54.973301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:54.974331 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m15:33:54.975431 [info ] [MainThread]: 
[0m15:33:54.976331 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m15:33:54.977782 [debug] [MainThread]: Command end result
[0m15:33:55.017728 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:33:55.020500 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:33:55.028663 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m15:33:55.029203 [info ] [MainThread]: 
[0m15:33:55.030071 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:33:55.030975 [info ] [MainThread]: 
[0m15:33:55.032096 [error] [MainThread]:   Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  invalid input syntax for type uuid: "-1"
  LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m15:33:55.032983 [info ] [MainThread]: 
[0m15:33:55.033923 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:33:55.035738 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9643775, "process_in_blocks": "88", "process_kernel_time": 0.212452, "process_mem_max_rss": "116140", "process_out_blocks": "2464", "process_user_time": 2.314694}
[0m15:33:55.037137 [debug] [MainThread]: Command `dbt run` failed at 15:33:55.036877 after 0.97 seconds
[0m15:33:55.038239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f886863c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88691b5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8869092000>]}
[0m15:33:55.039286 [debug] [MainThread]: Flushing usage events
[0m15:33:56.215903 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:35:43.072512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a055c920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a07202c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179e5e41a0>]}


============================== 15:35:43.076610 | d54cb8a3-ae82-41d4-afee-f643b7e89fed ==============================
[0m15:35:43.076610 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:35:43.077565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_1c_journal', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:35:43.259361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd54cb8a3-ae82-41d4-afee-f643b7e89fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179eabe270>]}
[0m15:35:43.325404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd54cb8a3-ae82-41d4-afee-f643b7e89fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179ec29b20>]}
[0m15:35:43.326379 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:35:43.449132 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:35:43.540170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:35:43.540672 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:35:43.570653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd54cb8a3-ae82-41d4-afee-f643b7e89fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179dbade50>]}
[0m15:35:43.642992 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:35:43.645666 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:35:43.659820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd54cb8a3-ae82-41d4-afee-f643b7e89fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179cff9760>]}
[0m15:35:43.660525 [info ] [MainThread]: Found 17 models, 433 macros
[0m15:35:43.661089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd54cb8a3-ae82-41d4-afee-f643b7e89fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179dc2dcd0>]}
[0m15:35:43.663033 [info ] [MainThread]: 
[0m15:35:43.663690 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:35:43.664321 [info ] [MainThread]: 
[0m15:35:43.665116 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:35:43.666596 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:35:43.719096 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:35:43.719687 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:35:43.720143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:43.731895 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.012 seconds
[0m15:35:43.733604 [debug] [ThreadPool]: On list_postgres: Close
[0m15:35:43.739842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m15:35:43.747950 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:35:43.748469 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m15:35:43.748889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:43.757278 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:35:43.757845 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m15:35:43.758418 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:35:43.761727 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m15:35:43.763530 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m15:35:43.764208 [debug] [ThreadPool]: On list_postgres_public: Close
[0m15:35:43.773571 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:43.774077 [debug] [MainThread]: On master: BEGIN
[0m15:35:43.774551 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:35:43.782587 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:35:43.783097 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:43.783676 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:35:43.788640 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m15:35:43.790404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd54cb8a3-ae82-41d4-afee-f643b7e89fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179defabd0>]}
[0m15:35:43.790965 [debug] [MainThread]: On master: ROLLBACK
[0m15:35:43.791558 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:43.791980 [debug] [MainThread]: On master: BEGIN
[0m15:35:43.792660 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:35:43.793111 [debug] [MainThread]: On master: COMMIT
[0m15:35:43.793798 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:43.794345 [debug] [MainThread]: On master: COMMIT
[0m15:35:43.795364 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:35:43.796610 [debug] [MainThread]: On master: Close
[0m15:35:43.800499 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m15:35:43.801656 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_1c_journal .............................. [RUN]
[0m15:35:43.803270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m15:35:43.804225 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m15:35:43.819014 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m15:35:43.820444 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m15:35:43.866075 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m15:35:43.867414 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m15:35:43.867963 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m15:35:43.868464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:43.876981 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:35:43.877622 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m15:35:43.878329 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m15:35:43.879992 [debug] [Thread-1 (]: Postgres adapter: Postgres error: invalid input syntax for type uuid: "-1"
LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                              ^

[0m15:35:43.880609 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: ROLLBACK
[0m15:35:43.881567 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m15:35:43.886193 [debug] [Thread-1 (]: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  invalid input syntax for type uuid: "-1"
  LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m15:35:43.888197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd54cb8a3-ae82-41d4-afee-f643b7e89fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179bbee900>]}
[0m15:35:43.889071 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_1c_journal ..................... [[31mERROR[0m in 0.08s]
[0m15:35:43.889984 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m15:35:43.890725 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_journal' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  invalid input syntax for type uuid: "-1"
  LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql.
[0m15:35:43.893127 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:43.893648 [debug] [MainThread]: On master: BEGIN
[0m15:35:43.894116 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:35:43.904459 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:35:43.905090 [debug] [MainThread]: On master: COMMIT
[0m15:35:43.905943 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:43.906450 [debug] [MainThread]: On master: COMMIT
[0m15:35:43.907135 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:35:43.907771 [debug] [MainThread]: On master: Close
[0m15:35:43.908458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:43.908885 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m15:35:43.909512 [info ] [MainThread]: 
[0m15:35:43.910414 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m15:35:43.912009 [debug] [MainThread]: Command end result
[0m15:35:43.950886 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m15:35:43.953124 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m15:35:43.960760 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m15:35:43.961652 [info ] [MainThread]: 
[0m15:35:43.962508 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:35:43.963251 [info ] [MainThread]: 
[0m15:35:43.964233 [error] [MainThread]:   Database Error in model stg_1c_journal (tsm_dwh/models/stage/stg_1c_journal.sql)
  invalid input syntax for type uuid: "-1"
  LINE 47: ...ault' || '|' || LOWER(TRIM(COALESCE(value_Ссылка, '-1')::var...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_journal.sql
[0m15:35:43.965020 [info ] [MainThread]: 
[0m15:35:43.965996 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:35:43.967785 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.95163095, "process_in_blocks": "0", "process_kernel_time": 0.231432, "process_mem_max_rss": "116284", "process_out_blocks": "2464", "process_user_time": 2.253719}
[0m15:35:43.968954 [debug] [MainThread]: Command `dbt run` failed at 15:35:43.968691 after 0.95 seconds
[0m15:35:43.970005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a1fb7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179df2b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179ea8a150>]}
[0m15:35:43.971052 [debug] [MainThread]: Flushing usage events
[0m15:35:44.860007 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:12:21.738270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535591be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5356650b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5354152b70>]}


============================== 16:12:21.744603 | 7022c5df-377e-4bd9-9b09-ee0886358126 ==============================
[0m16:12:21.744603 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:12:21.745543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/egor/.dbt', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s tag:hub', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:12:21.965741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7022c5df-377e-4bd9-9b09-ee0886358126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5354bd4620>]}
[0m16:12:22.033114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7022c5df-377e-4bd9-9b09-ee0886358126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5355a542f0>]}
[0m16:12:22.034265 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:12:22.176093 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:12:22.264850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:12:22.265330 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:12:22.294479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7022c5df-377e-4bd9-9b09-ee0886358126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53539eab10>]}
[0m16:12:22.367566 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:12:22.370206 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:12:22.395519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7022c5df-377e-4bd9-9b09-ee0886358126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53529c5670>]}
[0m16:12:22.396238 [info ] [MainThread]: Found 17 models, 433 macros
[0m16:12:22.396847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7022c5df-377e-4bd9-9b09-ee0886358126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5353fe4740>]}
[0m16:12:22.399063 [info ] [MainThread]: 
[0m16:12:22.399788 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:12:22.400615 [info ] [MainThread]: 
[0m16:12:22.401708 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:12:22.408199 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:12:22.487291 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:12:22.488201 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:12:22.488727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:22.509175 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.020 seconds
[0m16:12:22.511059 [debug] [ThreadPool]: On list_postgres: Close
[0m16:12:22.515092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:12:22.522985 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:12:22.523511 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:12:22.523965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:12:22.532506 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m16:12:22.533044 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:12:22.533590 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:12:22.540786 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m16:12:22.543189 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:12:22.544270 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:12:22.558519 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:22.559481 [debug] [MainThread]: On master: BEGIN
[0m16:12:22.560366 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:12:22.573270 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m16:12:22.574433 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:22.575605 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:12:22.588066 [debug] [MainThread]: SQL status: SELECT 1 in 0.011 seconds
[0m16:12:22.591538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7022c5df-377e-4bd9-9b09-ee0886358126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5353fe45c0>]}
[0m16:12:22.592580 [debug] [MainThread]: On master: ROLLBACK
[0m16:12:22.593580 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:22.594387 [debug] [MainThread]: On master: BEGIN
[0m16:12:22.595523 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:12:22.596435 [debug] [MainThread]: On master: COMMIT
[0m16:12:22.597277 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:22.598116 [debug] [MainThread]: On master: COMMIT
[0m16:12:22.599099 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:12:22.599918 [debug] [MainThread]: On master: Close
[0m16:12:22.611447 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m16:12:22.612545 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m16:12:22.616294 [info ] [Thread-2 (]: 2 of 3 START sql incremental model public.dv_hub_fact_work ..................... [RUN]
[0m16:12:22.615096 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m16:12:22.613835 [info ] [Thread-1 (]: 1 of 3 START sql incremental model public.dv_hub_fact_journal .................. [RUN]
[0m16:12:22.620146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.dv_hub_fact_journal)
[0m16:12:22.617549 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_hub_fact_work'
[0m16:12:22.622472 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m16:12:22.619291 [info ] [Thread-3 (]: 3 of 3 START sql incremental model public.dv_hub_tech .......................... [RUN]
[0m16:12:22.621132 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m16:12:22.630093 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_hub_tech'
[0m16:12:22.631144 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m16:12:22.674676 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:12:22.687581 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m16:12:22.688711 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m16:12:22.689565 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m16:12:22.696619 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m16:12:22.697925 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m16:12:22.863662 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:12:22.862873 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_tech"
[0m16:12:22.864755 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_work"
[0m16:12:22.891005 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:12:22.891640 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: BEGIN
[0m16:12:22.892205 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:12:22.892728 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:12:22.893187 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:12:22.893783 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: BEGIN
[0m16:12:22.894435 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: BEGIN
[0m16:12:22.895350 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:12:22.896284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:22.905731 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m16:12:22.906435 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m16:12:22.907906 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:12:22.906941 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:12:22.908816 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      
  
    

  create  table "postgres"."public"."dv_hub_tech"
  
  
    as
  
  (
    

SELECT distinct on (bk_гар_номер)
        hk_dv_hub_tech,
        hkcode,
        recsource,
        loadts,
        bk_гар_номер
FROM "postgres"."public"."stg_1c_tech"


  );
  
  
[0m16:12:22.909620 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_hub_fact_work"
  
  
    as
  
  (
    

SELECT distinct on (bk_работа_uuid)
        hk_dv_hub_fact_work,
        hkcode,
        recsource,
        loadts,
        bk_работа_uuid
FROM "postgres"."public"."stg_1c_works"


  );
  
  
[0m16:12:22.910655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m16:12:22.911480 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:12:22.912134 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.stg_1c_tech" does not exist
LINE 21: FROM "postgres"."public"."stg_1c_tech"
              ^

[0m16:12:22.912740 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.stg_1c_works" does not exist
LINE 21: FROM "postgres"."public"."stg_1c_works"
              ^

[0m16:12:22.913256 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      
  
    

  create  table "postgres"."public"."dv_hub_fact_journal"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal"


  );
  
  
[0m16:12:22.913983 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: ROLLBACK
[0m16:12:22.914541 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: ROLLBACK
[0m16:12:22.915587 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: Close
[0m16:12:22.916164 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.stg_1c_journal" does not exist
LINE 21: FROM "postgres"."public"."stg_1c_journal"
              ^

[0m16:12:22.916907 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: Close
[0m16:12:22.919706 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: ROLLBACK
[0m16:12:22.922556 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m16:12:22.951040 [debug] [Thread-2 (]: Database Error in model dv_hub_fact_work (tsm_dwh/models/dv/dv_hub_fact_work.sql)
  relation "public.stg_1c_works" does not exist
  LINE 21: FROM "postgres"."public"."stg_1c_works"
                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_fact_work.sql
[0m16:12:22.954222 [debug] [Thread-1 (]: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  relation "public.stg_1c_journal" does not exist
  LINE 21: FROM "postgres"."public"."stg_1c_journal"
                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_fact_journal.sql
[0m16:12:22.955806 [debug] [Thread-3 (]: Database Error in model dv_hub_tech (tsm_dwh/models/dv/dv_hub_tech.sql)
  relation "public.stg_1c_tech" does not exist
  LINE 21: FROM "postgres"."public"."stg_1c_tech"
                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_tech.sql
[0m16:12:22.956808 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7022c5df-377e-4bd9-9b09-ee0886358126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5354b78830>]}
[0m16:12:22.957709 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7022c5df-377e-4bd9-9b09-ee0886358126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5341f29d60>]}
[0m16:12:22.958192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7022c5df-377e-4bd9-9b09-ee0886358126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5341f2b380>]}
[0m16:12:22.959139 [error] [Thread-2 (]: 2 of 3 ERROR creating sql incremental model public.dv_hub_fact_work ............ [[31mERROR[0m in 0.33s]
[0m16:12:22.960061 [error] [Thread-3 (]: 3 of 3 ERROR creating sql incremental model public.dv_hub_tech ................. [[31mERROR[0m in 0.33s]
[0m16:12:22.961082 [error] [Thread-1 (]: 1 of 3 ERROR creating sql incremental model public.dv_hub_fact_journal ......... [[31mERROR[0m in 0.34s]
[0m16:12:22.962170 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m16:12:22.963006 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m16:12:22.963709 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m16:12:22.964678 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_hub_fact_work' to be skipped because of status 'error'.  Reason: Database Error in model dv_hub_fact_work (tsm_dwh/models/dv/dv_hub_fact_work.sql)
  relation "public.stg_1c_works" does not exist
  LINE 21: FROM "postgres"."public"."stg_1c_works"
                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_fact_work.sql.
[0m16:12:22.967466 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_hub_tech' to be skipped because of status 'error'.  Reason: Database Error in model dv_hub_tech (tsm_dwh/models/dv/dv_hub_tech.sql)
  relation "public.stg_1c_tech" does not exist
  LINE 21: FROM "postgres"."public"."stg_1c_tech"
                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_tech.sql.
[0m16:12:22.968937 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_hub_fact_journal' to be skipped because of status 'error'.  Reason: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  relation "public.stg_1c_journal" does not exist
  LINE 21: FROM "postgres"."public"."stg_1c_journal"
                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_fact_journal.sql.
[0m16:12:22.971206 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:22.972029 [debug] [MainThread]: On master: BEGIN
[0m16:12:22.972764 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:12:22.983274 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m16:12:22.983917 [debug] [MainThread]: On master: COMMIT
[0m16:12:22.984423 [debug] [MainThread]: Using postgres connection "master"
[0m16:12:22.984884 [debug] [MainThread]: On master: COMMIT
[0m16:12:22.985488 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:12:22.986008 [debug] [MainThread]: On master: Close
[0m16:12:22.986756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:22.987184 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_journal' was properly closed.
[0m16:12:22.987703 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_work' was properly closed.
[0m16:12:22.988115 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_tech' was properly closed.
[0m16:12:22.988821 [info ] [MainThread]: 
[0m16:12:22.989337 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m16:12:22.991360 [debug] [MainThread]: Command end result
[0m16:12:23.029114 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:12:23.031018 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:12:23.041478 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m16:12:23.042017 [info ] [MainThread]: 
[0m16:12:23.042830 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m16:12:23.043721 [info ] [MainThread]: 
[0m16:12:23.044671 [error] [MainThread]:   Database Error in model dv_hub_fact_work (tsm_dwh/models/dv/dv_hub_fact_work.sql)
  relation "public.stg_1c_works" does not exist
  LINE 21: FROM "postgres"."public"."stg_1c_works"
                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_fact_work.sql
[0m16:12:23.045418 [info ] [MainThread]: 
[0m16:12:23.046244 [error] [MainThread]:   Database Error in model dv_hub_tech (tsm_dwh/models/dv/dv_hub_tech.sql)
  relation "public.stg_1c_tech" does not exist
  LINE 21: FROM "postgres"."public"."stg_1c_tech"
                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_tech.sql
[0m16:12:23.047030 [info ] [MainThread]: 
[0m16:12:23.048009 [error] [MainThread]:   Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  relation "public.stg_1c_journal" does not exist
  LINE 21: FROM "postgres"."public"."stg_1c_journal"
                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_fact_journal.sql
[0m16:12:23.048960 [info ] [MainThread]: 
[0m16:12:23.049994 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m16:12:23.052405 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3734176, "process_in_blocks": "54416", "process_kernel_time": 0.32951, "process_mem_max_rss": "120508", "process_out_blocks": "2624", "process_user_time": 2.584626}
[0m16:12:23.053543 [debug] [MainThread]: Command `dbt run` failed at 16:12:23.053316 after 1.37 seconds
[0m16:12:23.054491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535591be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535409d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5354231a60>]}
[0m16:12:23.055456 [debug] [MainThread]: Flushing usage events
[0m16:12:23.912624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:13:15.194153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7cc33c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7a48cbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7ad565d0>]}


============================== 16:13:15.198273 | c8be1fff-63ba-4a34-a895-5780d8bed6a1 ==============================
[0m16:13:15.198273 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:13:15.199205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s +tag:hub', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:13:15.380738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8be1fff-63ba-4a34-a895-5780d8bed6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7ae0c620>]}
[0m16:13:15.447361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8be1fff-63ba-4a34-a895-5780d8bed6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7a133f80>]}
[0m16:13:15.448386 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:13:15.587793 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:13:15.715670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:13:15.716167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:13:15.746685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8be1fff-63ba-4a34-a895-5780d8bed6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b79726300>]}
[0m16:13:15.854041 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:13:15.864823 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:13:15.894772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8be1fff-63ba-4a34-a895-5780d8bed6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7936a510>]}
[0m16:13:15.895867 [info ] [MainThread]: Found 17 models, 433 macros
[0m16:13:15.896707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8be1fff-63ba-4a34-a895-5780d8bed6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b79380da0>]}
[0m16:13:15.901120 [info ] [MainThread]: 
[0m16:13:15.902061 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:13:15.902867 [info ] [MainThread]: 
[0m16:13:15.903999 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:13:15.911815 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:13:15.962075 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:13:15.962692 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:13:15.963329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:15.974624 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m16:13:15.976282 [debug] [ThreadPool]: On list_postgres: Close
[0m16:13:15.980180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:13:15.986870 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:13:15.987472 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:13:15.987948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:15.996543 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:13:15.997052 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:13:15.997589 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:13:16.000833 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m16:13:16.002570 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:13:16.003191 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:13:16.010585 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:16.011079 [debug] [MainThread]: On master: BEGIN
[0m16:13:16.011690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:13:16.020095 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:13:16.020662 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:16.021221 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:13:16.026299 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m16:13:16.028124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8be1fff-63ba-4a34-a895-5780d8bed6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b79b20620>]}
[0m16:13:16.028734 [debug] [MainThread]: On master: ROLLBACK
[0m16:13:16.029349 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:16.029824 [debug] [MainThread]: On master: BEGIN
[0m16:13:16.030523 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:13:16.030966 [debug] [MainThread]: On master: COMMIT
[0m16:13:16.031427 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:16.031855 [debug] [MainThread]: On master: COMMIT
[0m16:13:16.032440 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:13:16.032896 [debug] [MainThread]: On master: Close
[0m16:13:16.036507 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m16:13:16.037539 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m16:13:16.039493 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_works
[0m16:13:16.038615 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_1c_journal .............................. [RUN]
[0m16:13:16.040632 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_1c_tech ................................. [RUN]
[0m16:13:16.042069 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_1c_works ................................ [RUN]
[0m16:13:16.043014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m16:13:16.043893 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_tech'
[0m16:13:16.044997 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_works'
[0m16:13:16.046557 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m16:13:16.048737 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m16:13:16.050086 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m16:13:16.064084 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m16:13:16.065759 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m16:13:16.067811 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m16:13:16.069172 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m16:13:16.075057 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m16:13:16.109906 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m16:13:16.148930 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m16:13:16.156027 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m16:13:16.154224 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m16:13:16.160459 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:13:16.161244 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:13:16.161859 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:13:16.162458 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m16:13:16.162981 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m16:13:16.163639 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m16:13:16.164222 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:13:16.164760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:16.165360 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:13:16.175146 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m16:13:16.175799 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:13:16.176586 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m16:13:16.177841 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m16:13:16.178784 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "КлючСвязи" does not exist
LINE 33: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                              ^

[0m16:13:16.179694 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:13:16.180479 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: ROLLBACK
[0m16:13:16.181040 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:13:16.182131 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_гар_номер,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_гар_номер,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m16:13:16.183085 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:13:16.183810 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: Close
[0m16:13:16.184683 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m16:13:16.185630 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "КлючСвязи" does not exist
LINE 34: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                              ^

[0m16:13:16.188317 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: ROLLBACK
[0m16:13:16.189472 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m16:13:16.197233 [debug] [Thread-3 (]: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "КлючСвязи" does not exist
  LINE 33: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:13:16.198031 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m16:13:16.206916 [debug] [Thread-2 (]: Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "КлючСвязи" does not exist
  LINE 34: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql
[0m16:13:16.209862 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:13:16.211031 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m16:13:16.211954 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8be1fff-63ba-4a34-a895-5780d8bed6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7adb4d10>]}
[0m16:13:16.212781 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:13:16.213639 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_1c_works ....................... [[31mERROR[0m in 0.15s]
[0m16:13:16.214365 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8be1fff-63ba-4a34-a895-5780d8bed6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b77257920>]}
[0m16:13:16.225951 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m16:13:16.238025 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:13:16.239261 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_works' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "КлючСвязи" does not exist
  LINE 33: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql.
[0m16:13:16.240060 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_1c_tech ........................ [[31mERROR[0m in 0.17s]
[0m16:13:16.240997 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:13:16.242643 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m16:13:16.243394 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m16:13:16.244092 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:13:16.244845 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.dv_hub_fact_work ................................... [[33mSKIP[0m]
[0m16:13:16.246436 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_tech' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "КлючСвязи" does not exist
  LINE 34: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql.
[0m16:13:16.247654 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m16:13:16.249059 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m16:13:16.250268 [info ] [Thread-3 (]: 5 of 6 SKIP relation public.dv_hub_tech ........................................ [[33mSKIP[0m]
[0m16:13:16.251533 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m16:13:16.264107 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m16:13:16.274444 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m16:13:16.281707 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:13:16.282272 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m16:13:16.283150 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:13:16.286128 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m16:13:16.287166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8be1fff-63ba-4a34-a895-5780d8bed6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7c64b8f0>]}
[0m16:13:16.289044 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_1c_journal ......................... [[32mCREATE VIEW[0m in 0.24s]
[0m16:13:16.290611 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m16:13:16.292167 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m16:13:16.293020 [info ] [Thread-4 (]: 6 of 6 START sql incremental model public.dv_hub_fact_journal .................. [RUN]
[0m16:13:16.294086 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_hub_fact_journal'
[0m16:13:16.294848 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m16:13:16.308995 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:13:16.309958 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m16:13:16.357495 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:13:16.358355 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:13:16.358902 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: BEGIN
[0m16:13:16.359367 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:13:16.367727 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m16:13:16.368288 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:13:16.368851 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      
  
    

  create  table "postgres"."public"."dv_hub_fact_journal"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal"


  );
  
  
[0m16:13:16.370197 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "hkcode" does not exist
LINE 17:         hkcode,
                 ^

[0m16:13:16.370782 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: ROLLBACK
[0m16:13:16.371629 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m16:13:16.374556 [debug] [Thread-4 (]: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  column "hkcode" does not exist
  LINE 17:         hkcode,
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_fact_journal.sql
[0m16:13:16.375283 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8be1fff-63ba-4a34-a895-5780d8bed6a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7411ec00>]}
[0m16:13:16.376156 [error] [Thread-4 (]: 6 of 6 ERROR creating sql incremental model public.dv_hub_fact_journal ......... [[31mERROR[0m in 0.08s]
[0m16:13:16.377335 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m16:13:16.378143 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_hub_fact_journal' to be skipped because of status 'error'.  Reason: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  column "hkcode" does not exist
  LINE 17:         hkcode,
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_fact_journal.sql.
[0m16:13:16.380018 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:16.380712 [debug] [MainThread]: On master: BEGIN
[0m16:13:16.381215 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:13:16.392802 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:13:16.393621 [debug] [MainThread]: On master: COMMIT
[0m16:13:16.394313 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:16.394876 [debug] [MainThread]: On master: COMMIT
[0m16:13:16.395650 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:13:16.396152 [debug] [MainThread]: On master: Close
[0m16:13:16.397221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:16.398075 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m16:13:16.399059 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_tech' was properly closed.
[0m16:13:16.399665 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_works' was properly closed.
[0m16:13:16.400085 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_journal' was properly closed.
[0m16:13:16.400699 [info ] [MainThread]: 
[0m16:13:16.401435 [info ] [MainThread]: Finished running 3 incremental models, 3 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m16:13:16.403132 [debug] [MainThread]: Command end result
[0m16:13:16.440367 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:13:16.442327 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:13:16.449922 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m16:13:16.450771 [info ] [MainThread]: 
[0m16:13:16.451353 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m16:13:16.451890 [info ] [MainThread]: 
[0m16:13:16.452529 [error] [MainThread]:   Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "КлючСвязи" does not exist
  LINE 33: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:13:16.452996 [info ] [MainThread]: 
[0m16:13:16.453799 [error] [MainThread]:   Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "КлючСвязи" does not exist
  LINE 34: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql
[0m16:13:16.454622 [info ] [MainThread]: 
[0m16:13:16.455618 [error] [MainThread]:   Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  column "hkcode" does not exist
  LINE 17:         hkcode,
                   ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/dv/dv_hub_fact_journal.sql
[0m16:13:16.456160 [info ] [MainThread]: 
[0m16:13:16.456871 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=2 TOTAL=6
[0m16:13:16.458241 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3213898, "process_in_blocks": "64", "process_kernel_time": 0.238068, "process_mem_max_rss": "119700", "process_out_blocks": "2616", "process_user_time": 2.57505}
[0m16:13:16.459399 [debug] [MainThread]: Command `dbt run` failed at 16:13:16.459119 after 1.32 seconds
[0m16:13:16.460236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7a5bf530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7a6f8800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7416ed20>]}
[0m16:13:16.461420 [debug] [MainThread]: Flushing usage events
[0m16:13:17.468193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:16:04.798608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff2781a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff274fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff2781e50>]}


============================== 16:16:04.802470 | b6a9e139-c5f6-4973-b332-614afc6ca8b0 ==============================
[0m16:16:04.802470 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:16:04.803670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s +tag:hub', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:16:04.986970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6a9e139-c5f6-4973-b332-614afc6ca8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff2efc5c0>]}
[0m16:16:05.053725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6a9e139-c5f6-4973-b332-614afc6ca8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff2237a70>]}
[0m16:16:05.054747 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:16:05.174752 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:16:05.269962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:16:05.270467 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:16:05.300004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6a9e139-c5f6-4973-b332-614afc6ca8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff1b164e0>]}
[0m16:16:05.374655 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:16:05.377512 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:16:05.391646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6a9e139-c5f6-4973-b332-614afc6ca8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff175b890>]}
[0m16:16:05.392320 [info ] [MainThread]: Found 17 models, 433 macros
[0m16:16:05.392947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6a9e139-c5f6-4973-b332-614afc6ca8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff2031a30>]}
[0m16:16:05.395640 [info ] [MainThread]: 
[0m16:16:05.396210 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:16:05.396799 [info ] [MainThread]: 
[0m16:16:05.397606 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:16:05.403313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:16:05.454752 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:16:05.455349 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:16:05.455840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:05.467146 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m16:16:05.468902 [debug] [ThreadPool]: On list_postgres: Close
[0m16:16:05.471678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:16:05.478227 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:16:05.478771 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:16:05.479547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:16:05.487789 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m16:16:05.488316 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:16:05.488834 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:16:05.491994 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m16:16:05.493809 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:16:05.494436 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:16:05.503657 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:05.504186 [debug] [MainThread]: On master: BEGIN
[0m16:16:05.504650 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:16:05.512717 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:16:05.513229 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:05.513842 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:16:05.518896 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m16:16:05.520906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6a9e139-c5f6-4973-b332-614afc6ca8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff230d6a0>]}
[0m16:16:05.521490 [debug] [MainThread]: On master: ROLLBACK
[0m16:16:05.522076 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:05.522537 [debug] [MainThread]: On master: BEGIN
[0m16:16:05.523293 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:16:05.523802 [debug] [MainThread]: On master: COMMIT
[0m16:16:05.524261 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:05.524772 [debug] [MainThread]: On master: COMMIT
[0m16:16:05.525333 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:16:05.525841 [debug] [MainThread]: On master: Close
[0m16:16:05.530200 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m16:16:05.531425 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m16:16:05.532933 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_works
[0m16:16:05.534432 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_1c_journal .............................. [RUN]
[0m16:16:05.535439 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_1c_tech ................................. [RUN]
[0m16:16:05.536503 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_1c_works ................................ [RUN]
[0m16:16:05.537596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m16:16:05.538996 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_tech'
[0m16:16:05.542410 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m16:16:05.541275 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m16:16:05.540226 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_works'
[0m16:16:05.549684 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m16:16:05.558855 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m16:16:05.561889 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m16:16:05.564459 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m16:16:05.566294 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m16:16:05.567188 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m16:16:05.635649 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m16:16:05.645723 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m16:16:05.646745 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m16:16:05.647975 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m16:16:05.649155 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:16:05.649785 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m16:16:05.650407 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:16:05.651142 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:16:05.652001 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:16:05.652892 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m16:16:05.653506 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m16:16:05.654261 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:16:05.654986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:16:05.661428 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m16:16:05.662096 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:16:05.662897 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m16:16:05.664357 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "КлючСвязи" does not exist
LINE 34: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                              ^

[0m16:16:05.665014 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: ROLLBACK
[0m16:16:05.665829 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: Close
[0m16:16:05.670094 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m16:16:05.670734 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:16:05.671369 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:16:05.672368 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_гар_номер,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_гар_номер,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m16:16:05.673258 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:16:05.674746 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m16:16:05.675719 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "КлючСвязи" does not exist
LINE 35: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                              ^

[0m16:16:05.676516 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: ROLLBACK
[0m16:16:05.678155 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m16:16:05.683610 [debug] [Thread-3 (]: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "КлючСвязи" does not exist
  LINE 34: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:16:05.686198 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m16:16:05.693102 [debug] [Thread-2 (]: Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "КлючСвязи" does not exist
  LINE 35: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql
[0m16:16:05.696276 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:16:05.696951 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a9e139-c5f6-4973-b332-614afc6ca8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fef32dd30>]}
[0m16:16:05.697687 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m16:16:05.698166 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a9e139-c5f6-4973-b332-614afc6ca8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff2e9c8c0>]}
[0m16:16:05.699186 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_1c_works ....................... [[31mERROR[0m in 0.14s]
[0m16:16:05.700872 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_1c_tech ........................ [[31mERROR[0m in 0.16s]
[0m16:16:05.701807 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:16:05.702927 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m16:16:05.703690 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m16:16:05.708435 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:16:05.709334 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_works' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "КлючСвязи" does not exist
  LINE 34: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql.
[0m16:16:05.710061 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m16:16:05.711827 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_tech' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "КлючСвязи" does not exist
  LINE 35: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql.
[0m16:16:05.713272 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m16:16:05.715943 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m16:16:05.715129 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.dv_hub_fact_work ................................... [[33mSKIP[0m]
[0m16:16:05.717205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:16:05.718214 [info ] [Thread-2 (]: 5 of 6 SKIP relation public.dv_hub_tech ........................................ [[33mSKIP[0m]
[0m16:16:05.719098 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m16:16:05.725215 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m16:16:05.744688 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:16:05.745452 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:16:05.745966 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:16:05.758642 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m16:16:05.765924 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m16:16:05.773674 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:16:05.774504 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m16:16:05.785113 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m16:16:05.789156 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m16:16:05.790643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a9e139-c5f6-4973-b332-614afc6ca8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff48e79b0>]}
[0m16:16:05.791626 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_1c_journal ......................... [[32mCREATE VIEW[0m in 0.25s]
[0m16:16:05.792699 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m16:16:05.793798 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m16:16:05.794874 [info ] [Thread-3 (]: 6 of 6 START sql incremental model public.dv_hub_fact_journal .................. [RUN]
[0m16:16:05.795974 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_works, now model.tsm_dwh.dv_hub_fact_journal)
[0m16:16:05.796569 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m16:16:05.806790 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:16:05.807626 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m16:16:05.862693 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:16:05.863700 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:16:05.864243 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: BEGIN
[0m16:16:05.864779 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:16:05.873277 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m16:16:05.873915 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:16:05.874485 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      
  
    

  create  table "postgres"."public"."dv_hub_fact_journal"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal"


  );
  
  
[0m16:16:05.915329 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.040 seconds
[0m16:16:05.921657 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m16:16:05.922230 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:16:05.922846 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m16:16:05.935123 [debug] [Thread-3 (]: SQL status: COMMIT in 0.012 seconds
[0m16:16:05.936362 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m16:16:05.937220 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a9e139-c5f6-4973-b332-614afc6ca8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fef3fb0b0>]}
[0m16:16:05.938041 [info ] [Thread-3 (]: 6 of 6 OK created sql incremental model public.dv_hub_fact_journal ............. [[32mSELECT 0[0m in 0.14s]
[0m16:16:05.938902 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m16:16:05.940692 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:05.941163 [debug] [MainThread]: On master: BEGIN
[0m16:16:05.941713 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:16:05.953254 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:16:05.954203 [debug] [MainThread]: On master: COMMIT
[0m16:16:05.954925 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:05.955800 [debug] [MainThread]: On master: COMMIT
[0m16:16:05.956997 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:16:05.957879 [debug] [MainThread]: On master: Close
[0m16:16:05.958966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:05.959895 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m16:16:05.960776 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_tech' was properly closed.
[0m16:16:05.961601 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_journal' was properly closed.
[0m16:16:05.962217 [info ] [MainThread]: 
[0m16:16:05.962864 [info ] [MainThread]: Finished running 3 incremental models, 3 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m16:16:05.965028 [debug] [MainThread]: Command end result
[0m16:16:06.001785 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:16:06.003735 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:16:06.012142 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m16:16:06.012806 [info ] [MainThread]: 
[0m16:16:06.013470 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:16:06.014109 [info ] [MainThread]: 
[0m16:16:06.014894 [error] [MainThread]:   Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "КлючСвязи" does not exist
  LINE 34: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:16:06.015526 [info ] [MainThread]: 
[0m16:16:06.016325 [error] [MainThread]:   Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "КлючСвязи" does not exist
  LINE 35: ...   digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи:...
                                                                ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql
[0m16:16:06.017041 [info ] [MainThread]: 
[0m16:16:06.017722 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=2 TOTAL=6
[0m16:16:06.019700 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2783166, "process_in_blocks": "0", "process_kernel_time": 0.230601, "process_mem_max_rss": "119448", "process_out_blocks": "2608", "process_user_time": 2.519424}
[0m16:16:06.020824 [debug] [MainThread]: Command `dbt run` failed at 16:16:06.020595 after 1.28 seconds
[0m16:16:06.021908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff2ed7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ff2f1f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7fec26bd70>]}
[0m16:16:06.022905 [debug] [MainThread]: Flushing usage events
[0m16:16:07.248681 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:39:19.484592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224c604560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224c2dea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224c6055b0>]}


============================== 16:39:19.490317 | f1b4c2bf-39a1-42f7-9156-8cac874d3362 ==============================
[0m16:39:19.490317 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:39:19.491510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s +tag:hub', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:39:19.684180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1b4c2bf-39a1-42f7-9156-8cac874d3362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224ca046e0>]}
[0m16:39:19.750953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1b4c2bf-39a1-42f7-9156-8cac874d3362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224c76f080>]}
[0m16:39:19.752013 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:39:19.883901 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:39:19.984827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:19.985311 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:20.016426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1b4c2bf-39a1-42f7-9156-8cac874d3362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224b31f620>]}
[0m16:39:20.092150 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:39:20.094873 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:39:20.112594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1b4c2bf-39a1-42f7-9156-8cac874d3362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224c257890>]}
[0m16:39:20.113301 [info ] [MainThread]: Found 17 models, 433 macros
[0m16:39:20.113953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1b4c2bf-39a1-42f7-9156-8cac874d3362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224b714740>]}
[0m16:39:20.116672 [info ] [MainThread]: 
[0m16:39:20.117299 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:39:20.117913 [info ] [MainThread]: 
[0m16:39:20.118775 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:20.126777 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:39:20.184291 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:39:20.184862 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:39:20.185355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:20.199483 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.014 seconds
[0m16:39:20.201144 [debug] [ThreadPool]: On list_postgres: Close
[0m16:39:20.203996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:39:20.211189 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:39:20.211739 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:39:20.212192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:20.220978 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:39:20.221583 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:39:20.222181 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:39:20.225784 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m16:39:20.227589 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:39:20.228247 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:39:20.237348 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:20.237898 [debug] [MainThread]: On master: BEGIN
[0m16:39:20.238333 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:20.246581 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:39:20.247122 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:20.247762 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:39:20.253243 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m16:39:20.256335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1b4c2bf-39a1-42f7-9156-8cac874d3362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224b31cd70>]}
[0m16:39:20.256965 [debug] [MainThread]: On master: ROLLBACK
[0m16:39:20.257599 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:20.258046 [debug] [MainThread]: On master: BEGIN
[0m16:39:20.258851 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:39:20.259588 [debug] [MainThread]: On master: COMMIT
[0m16:39:20.260105 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:20.260690 [debug] [MainThread]: On master: COMMIT
[0m16:39:20.261629 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:39:20.262240 [debug] [MainThread]: On master: Close
[0m16:39:20.267679 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m16:39:20.269970 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m16:39:20.268987 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_1c_journal .............................. [RUN]
[0m16:39:20.271845 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_works
[0m16:39:20.272888 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_1c_tech ................................. [RUN]
[0m16:39:20.273910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m16:39:20.274770 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_1c_works ................................ [RUN]
[0m16:39:20.276166 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_tech'
[0m16:39:20.277068 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m16:39:20.278173 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_works'
[0m16:39:20.278979 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m16:39:20.289927 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m16:39:20.291177 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m16:39:20.293476 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m16:39:20.295606 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m16:39:20.296977 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m16:39:20.303030 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m16:39:20.325971 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m16:39:20.384186 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m16:39:20.386088 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m16:39:20.389027 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m16:39:20.390417 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:39:20.391023 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m16:39:20.391766 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:39:20.392680 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:39:20.393704 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m16:39:20.394533 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:20.395199 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:39:20.396180 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m16:39:20.397197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:20.402410 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m16:39:20.403025 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:39:20.403659 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_гар_номер,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_гар_номер,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m16:39:20.405939 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "гар_номер" does not exist
LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                         ^

[0m16:39:20.406528 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: ROLLBACK
[0m16:39:20.407409 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m16:39:20.410354 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m16:39:20.411285 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:39:20.412140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:39:20.412973 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m16:39:20.414041 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:20.415890 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m16:39:20.417294 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "value_Ссылка" does not exist
LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                         ^

[0m16:39:20.418288 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: ROLLBACK
[0m16:39:20.420760 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: Close
[0m16:39:20.427146 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m16:39:20.436068 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:20.436818 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m16:39:20.438998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:39:20.446723 [debug] [Thread-2 (]: Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "гар_номер" does not exist
  LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql
[0m16:39:20.456258 [debug] [Thread-3 (]: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:39:20.465673 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:39:20.466957 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:20.467525 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:39:20.468176 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1b4c2bf-39a1-42f7-9156-8cac874d3362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2248e44410>]}
[0m16:39:20.468867 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1b4c2bf-39a1-42f7-9156-8cac874d3362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224e1cb320>]}
[0m16:39:20.470046 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_1c_tech ........................ [[31mERROR[0m in 0.18s]
[0m16:39:20.471254 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_1c_works ....................... [[31mERROR[0m in 0.19s]
[0m16:39:20.472523 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m16:39:20.473289 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m16:39:20.474096 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_tech' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "гар_номер" does not exist
  LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql.
[0m16:39:20.475618 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_works' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql.
[0m16:39:20.476505 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m16:39:20.478424 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m16:39:20.477607 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.dv_hub_tech ........................................ [[33mSKIP[0m]
[0m16:39:20.479972 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m16:39:20.491495 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m16:39:20.494129 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m16:39:20.494913 [info ] [Thread-3 (]: 5 of 6 SKIP relation public.dv_hub_fact_work ................................... [[33mSKIP[0m]
[0m16:39:20.504822 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:20.506078 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m16:39:20.507496 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m16:39:20.509040 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:39:20.512845 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m16:39:20.513705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1b4c2bf-39a1-42f7-9156-8cac874d3362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2248e3b140>]}
[0m16:39:20.514581 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_1c_journal ......................... [[32mCREATE VIEW[0m in 0.24s]
[0m16:39:20.515657 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m16:39:20.516848 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m16:39:20.517813 [info ] [Thread-2 (]: 6 of 6 START sql incremental model public.dv_hub_fact_journal .................. [RUN]
[0m16:39:20.518614 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_hub_fact_journal)
[0m16:39:20.519765 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m16:39:20.533442 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:39:20.534491 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m16:39:20.585799 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:39:20.586473 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

    
  
    

  create temporary table "dv_hub_fact_journal__dbt_tmp163920567492"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal"


where not exists (
    select 1
    from {this} target
    where 
        target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_journal 
)

  );
  
  
[0m16:39:20.587016 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:39:20.596577 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 26:     from {this} target
                  ^

[0m16:39:20.597430 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m16:39:20.602132 [debug] [Thread-2 (]: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  syntax error at or near "{"
  LINE 26:     from {this} target
                    ^
[0m16:39:20.602856 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1b4c2bf-39a1-42f7-9156-8cac874d3362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2248526180>]}
[0m16:39:20.603646 [error] [Thread-2 (]: 6 of 6 ERROR creating sql incremental model public.dv_hub_fact_journal ......... [[31mERROR[0m in 0.08s]
[0m16:39:20.604621 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m16:39:20.605326 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_hub_fact_journal' to be skipped because of status 'error'.  Reason: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  syntax error at or near "{"
  LINE 26:     from {this} target
                    ^.
[0m16:39:20.607303 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:20.607821 [debug] [MainThread]: On master: BEGIN
[0m16:39:20.608264 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:39:20.619294 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:39:20.620253 [debug] [MainThread]: On master: COMMIT
[0m16:39:20.620831 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:20.621402 [debug] [MainThread]: On master: COMMIT
[0m16:39:20.622087 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:39:20.622613 [debug] [MainThread]: On master: Close
[0m16:39:20.623279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:20.623765 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m16:39:20.624270 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_journal' was properly closed.
[0m16:39:20.624854 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_works' was properly closed.
[0m16:39:20.625804 [info ] [MainThread]: 
[0m16:39:20.626960 [info ] [MainThread]: Finished running 3 incremental models, 3 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m16:39:20.629947 [debug] [MainThread]: Command end result
[0m16:39:20.674921 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:39:20.677829 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:39:20.685161 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m16:39:20.685730 [info ] [MainThread]: 
[0m16:39:20.686399 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m16:39:20.686918 [info ] [MainThread]: 
[0m16:39:20.687498 [error] [MainThread]:   Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "гар_номер" does not exist
  LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql
[0m16:39:20.688157 [info ] [MainThread]: 
[0m16:39:20.688871 [error] [MainThread]:   Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:39:20.689421 [info ] [MainThread]: 
[0m16:39:20.689992 [error] [MainThread]:   Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  syntax error at or near "{"
  LINE 26:     from {this} target
                    ^
[0m16:39:20.690507 [info ] [MainThread]: 
[0m16:39:20.691475 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=2 TOTAL=6
[0m16:39:20.693649 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2740699, "process_in_blocks": "8680", "process_kernel_time": 0.285731, "process_mem_max_rss": "118988", "process_out_blocks": "2640", "process_user_time": 2.582512}
[0m16:39:20.694657 [debug] [MainThread]: Command `dbt run` failed at 16:39:20.694417 after 1.28 seconds
[0m16:39:20.695762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224c9af6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2248573fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2248573c20>]}
[0m16:39:20.696932 [debug] [MainThread]: Flushing usage events
[0m16:39:21.844633 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:39:44.185303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ccbbce930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cca237e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc9afe4b0>]}


============================== 16:39:44.189138 | 82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6 ==============================
[0m16:39:44.189138 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:39:44.190092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s +tag:hub', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:39:44.380797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc9ffc650>]}
[0m16:39:44.446686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc9c666f0>]}
[0m16:39:44.447746 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:39:44.576745 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:39:44.664967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:44.665448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:44.694332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc8919e80>]}
[0m16:39:44.766702 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:39:44.769349 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:39:44.783274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc7d20e90>]}
[0m16:39:44.784019 [info ] [MainThread]: Found 17 models, 433 macros
[0m16:39:44.784561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc8df4740>]}
[0m16:39:44.787257 [info ] [MainThread]: 
[0m16:39:44.787934 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:39:44.788517 [info ] [MainThread]: 
[0m16:39:44.789297 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:44.797047 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:39:44.846925 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:39:44.847478 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:39:44.847931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:44.859427 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m16:39:44.861043 [debug] [ThreadPool]: On list_postgres: Close
[0m16:39:44.863854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:39:44.870733 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:39:44.871333 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:39:44.871827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:44.880307 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m16:39:44.880866 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:39:44.881406 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:39:44.884763 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m16:39:44.887020 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:39:44.887779 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:39:44.897276 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:44.897849 [debug] [MainThread]: On master: BEGIN
[0m16:39:44.898287 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:44.906397 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:39:44.906939 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:44.907523 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:39:44.912861 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m16:39:44.914867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc85add60>]}
[0m16:39:44.915488 [debug] [MainThread]: On master: ROLLBACK
[0m16:39:44.916175 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:44.916691 [debug] [MainThread]: On master: BEGIN
[0m16:39:44.917458 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:39:44.917930 [debug] [MainThread]: On master: COMMIT
[0m16:39:44.918544 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:44.919114 [debug] [MainThread]: On master: COMMIT
[0m16:39:44.919791 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:39:44.920255 [debug] [MainThread]: On master: Close
[0m16:39:44.923429 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m16:39:44.924481 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m16:39:44.925327 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_works
[0m16:39:44.926035 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_1c_journal .............................. [RUN]
[0m16:39:44.926987 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_1c_tech ................................. [RUN]
[0m16:39:44.927869 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_1c_works ................................ [RUN]
[0m16:39:44.928743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m16:39:44.929540 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_tech'
[0m16:39:44.930356 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_works'
[0m16:39:44.930966 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m16:39:44.931628 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m16:39:44.932305 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m16:39:44.945138 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m16:39:44.945831 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m16:39:44.947910 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m16:39:44.949181 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m16:39:44.955129 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m16:39:44.955931 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m16:39:45.049603 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m16:39:45.051594 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m16:39:45.052878 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m16:39:45.054083 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:45.054896 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:39:45.055812 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m16:39:45.056859 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:39:45.057459 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m16:39:45.057978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:45.058575 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m16:39:45.059172 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:39:45.060227 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:39:45.069417 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m16:39:45.070085 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:39:45.070872 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_гар_номер,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_гар_номер,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m16:39:45.072339 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m16:39:45.073203 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "гар_номер" does not exist
LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                         ^

[0m16:39:45.073902 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:45.074834 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: ROLLBACK
[0m16:39:45.075550 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m16:39:45.076629 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m16:39:45.077481 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:39:45.078350 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m16:39:45.079224 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m16:39:45.082634 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "value_Ссылка" does not exist
LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                         ^

[0m16:39:45.083453 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m16:39:45.084019 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: ROLLBACK
[0m16:39:45.091497 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:45.093070 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: Close
[0m16:39:45.093983 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m16:39:45.097882 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:39:45.102946 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:45.104539 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m16:39:45.109259 [debug] [Thread-2 (]: Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "гар_номер" does not exist
  LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql
[0m16:39:45.111907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m16:39:45.115868 [debug] [Thread-3 (]: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:39:45.128943 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc9853bf0>]}
[0m16:39:45.129616 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc8d68170>]}
[0m16:39:45.140060 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_1c_tech ........................ [[31mERROR[0m in 0.18s]
[0m16:39:45.139463 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:39:45.141629 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_1c_works ....................... [[31mERROR[0m in 0.20s]
[0m16:39:45.142843 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m16:39:45.143602 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:45.144508 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m16:39:45.145281 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:39:45.146239 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_tech' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "гар_номер" does not exist
  LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql.
[0m16:39:45.148261 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_works' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql.
[0m16:39:45.149454 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m16:39:45.150643 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m16:39:45.151727 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.dv_hub_tech ........................................ [[33mSKIP[0m]
[0m16:39:45.153065 [info ] [Thread-3 (]: 5 of 6 SKIP relation public.dv_hub_fact_work ................................... [[33mSKIP[0m]
[0m16:39:45.154189 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m16:39:45.155328 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m16:39:45.158681 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m16:39:45.170691 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m16:39:45.179105 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:39:45.179704 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m16:39:45.190084 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m16:39:45.192947 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m16:39:45.193974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ccbae7bc0>]}
[0m16:39:45.195680 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_1c_journal ......................... [[32mCREATE VIEW[0m in 0.27s]
[0m16:39:45.197138 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m16:39:45.198566 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m16:39:45.199350 [info ] [Thread-2 (]: 6 of 6 START sql incremental model public.dv_hub_fact_journal .................. [RUN]
[0m16:39:45.200200 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_hub_fact_journal)
[0m16:39:45.200987 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m16:39:45.217334 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:39:45.218267 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m16:39:45.265050 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:39:45.265703 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

    
  
    

  create temporary table "dv_hub_fact_journal__dbt_tmp163945249083"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal"


where not exists (
    select 1
    from {this} target
    where 
        target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_journal 
)

  );
  
  
[0m16:39:45.266224 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:39:45.275038 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 26:     from {this} target
                  ^

[0m16:39:45.275859 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m16:39:45.279245 [debug] [Thread-2 (]: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  syntax error at or near "{"
  LINE 26:     from {this} target
                    ^
[0m16:39:45.279956 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a8a64a-cf16-4de7-8d2c-fb5c4f29bdd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc4329610>]}
[0m16:39:45.280719 [error] [Thread-2 (]: 6 of 6 ERROR creating sql incremental model public.dv_hub_fact_journal ......... [[31mERROR[0m in 0.08s]
[0m16:39:45.281603 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m16:39:45.282320 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_hub_fact_journal' to be skipped because of status 'error'.  Reason: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  syntax error at or near "{"
  LINE 26:     from {this} target
                    ^.
[0m16:39:45.284082 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:45.284595 [debug] [MainThread]: On master: BEGIN
[0m16:39:45.285025 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:39:45.295518 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m16:39:45.296078 [debug] [MainThread]: On master: COMMIT
[0m16:39:45.296583 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:45.297433 [debug] [MainThread]: On master: COMMIT
[0m16:39:45.298656 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:39:45.299431 [debug] [MainThread]: On master: Close
[0m16:39:45.300505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:45.301032 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m16:39:45.301538 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_journal' was properly closed.
[0m16:39:45.302033 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_works' was properly closed.
[0m16:39:45.302825 [info ] [MainThread]: 
[0m16:39:45.303519 [info ] [MainThread]: Finished running 3 incremental models, 3 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m16:39:45.305984 [debug] [MainThread]: Command end result
[0m16:39:45.342715 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:39:45.344553 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:39:45.356011 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m16:39:45.356759 [info ] [MainThread]: 
[0m16:39:45.357412 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m16:39:45.357970 [info ] [MainThread]: 
[0m16:39:45.358643 [error] [MainThread]:   Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "гар_номер" does not exist
  LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql
[0m16:39:45.359131 [info ] [MainThread]: 
[0m16:39:45.359876 [error] [MainThread]:   Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:39:45.360544 [info ] [MainThread]: 
[0m16:39:45.361228 [error] [MainThread]:   Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  syntax error at or near "{"
  LINE 26:     from {this} target
                    ^
[0m16:39:45.361759 [info ] [MainThread]: 
[0m16:39:45.362713 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=2 TOTAL=6
[0m16:39:45.364732 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2353785, "process_in_blocks": "336", "process_kernel_time": 0.22744, "process_mem_max_rss": "119512", "process_out_blocks": "2592", "process_user_time": 2.569213}
[0m16:39:45.365953 [debug] [MainThread]: Command `dbt run` failed at 16:39:45.365678 after 1.24 seconds
[0m16:39:45.367038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc9a1f6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ccd5b7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc8ded9a0>]}
[0m16:39:45.368317 [debug] [MainThread]: Flushing usage events
[0m16:39:46.428910 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:04.942556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5f5da9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5f3422a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5f5d9010>]}


============================== 16:40:04.946309 | 514b091d-a809-458e-bf84-7f0df1b72a79 ==============================
[0m16:40:04.946309 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:40:04.947201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s +tag:hub', 'send_anonymous_usage_stats': 'True'}
[0m16:40:05.130744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '514b091d-a809-458e-bf84-7f0df1b72a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5fa0c530>]}
[0m16:40:05.195765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '514b091d-a809-458e-bf84-7f0df1b72a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5ed33e90>]}
[0m16:40:05.196769 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:40:05.315484 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:40:05.407405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:05.407915 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:05.436538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '514b091d-a809-458e-bf84-7f0df1b72a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5e302660>]}
[0m16:40:05.509779 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:40:05.512304 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:40:05.526484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '514b091d-a809-458e-bf84-7f0df1b72a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5d31eb10>]}
[0m16:40:05.527106 [info ] [MainThread]: Found 17 models, 433 macros
[0m16:40:05.527694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '514b091d-a809-458e-bf84-7f0df1b72a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5e32a060>]}
[0m16:40:05.530270 [info ] [MainThread]: 
[0m16:40:05.530913 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:40:05.531525 [info ] [MainThread]: 
[0m16:40:05.532301 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:40:05.539524 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:40:05.589237 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:40:05.589787 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:40:05.590242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:05.601248 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m16:40:05.603010 [debug] [ThreadPool]: On list_postgres: Close
[0m16:40:05.605762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:40:05.612361 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:40:05.613086 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:40:05.613572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:05.621905 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m16:40:05.622435 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:40:05.622892 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:40:05.626204 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m16:40:05.628120 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:40:05.628768 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:40:05.636692 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:05.637222 [debug] [MainThread]: On master: BEGIN
[0m16:40:05.637775 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:05.646938 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m16:40:05.647543 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:05.648105 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:40:05.653662 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m16:40:05.655933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '514b091d-a809-458e-bf84-7f0df1b72a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5ef00d70>]}
[0m16:40:05.656578 [debug] [MainThread]: On master: ROLLBACK
[0m16:40:05.657683 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:05.658589 [debug] [MainThread]: On master: BEGIN
[0m16:40:05.659717 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:40:05.660182 [debug] [MainThread]: On master: COMMIT
[0m16:40:05.660679 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:05.661100 [debug] [MainThread]: On master: COMMIT
[0m16:40:05.661683 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:40:05.662149 [debug] [MainThread]: On master: Close
[0m16:40:05.665524 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m16:40:05.666541 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m16:40:05.667419 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_works
[0m16:40:05.668079 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_1c_journal .............................. [RUN]
[0m16:40:05.669046 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_1c_tech ................................. [RUN]
[0m16:40:05.669945 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_1c_works ................................ [RUN]
[0m16:40:05.670768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m16:40:05.671534 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_tech'
[0m16:40:05.672231 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_works'
[0m16:40:05.672805 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m16:40:05.673459 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m16:40:05.674127 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m16:40:05.687006 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m16:40:05.689543 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m16:40:05.692169 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m16:40:05.693692 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m16:40:05.694347 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m16:40:05.695269 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m16:40:05.779343 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m16:40:05.781331 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m16:40:05.784786 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m16:40:05.785638 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:40:05.786407 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:40:05.787030 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m16:40:05.787660 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m16:40:05.788298 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:40:05.788964 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:40:05.789485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:05.790132 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m16:40:05.791347 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:40:05.799895 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m16:40:05.800514 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:40:05.801147 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m16:40:05.803574 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "value_Ссылка" does not exist
LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                         ^

[0m16:40:05.804580 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:40:05.805197 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: ROLLBACK
[0m16:40:05.805740 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m16:40:05.806325 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:40:05.807018 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:40:05.807821 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m16:40:05.808663 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: Close
[0m16:40:05.809299 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_гар_номер,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(гар_номер::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_value::uuid,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_гар_номер,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_value,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m16:40:05.813919 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "гар_номер" does not exist
LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                         ^

[0m16:40:05.814920 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: ROLLBACK
[0m16:40:05.816147 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m16:40:05.821683 [debug] [Thread-2 (]: Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "гар_номер" does not exist
  LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql
[0m16:40:05.825043 [debug] [Thread-3 (]: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:40:05.825955 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '514b091d-a809-458e-bf84-7f0df1b72a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5f9b4800>]}
[0m16:40:05.826471 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '514b091d-a809-458e-bf84-7f0df1b72a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5be3ef90>]}
[0m16:40:05.827589 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_1c_tech ........................ [[31mERROR[0m in 0.15s]
[0m16:40:05.828466 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m16:40:05.829425 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_1c_works ....................... [[31mERROR[0m in 0.15s]
[0m16:40:05.830635 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m16:40:05.841847 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m16:40:05.845251 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:40:05.846971 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_tech' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "гар_номер" does not exist
  LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql.
[0m16:40:05.847797 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m16:40:05.849262 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_works' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql.
[0m16:40:05.850232 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m16:40:05.852513 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:40:05.853424 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.dv_hub_tech ........................................ [[33mSKIP[0m]
[0m16:40:05.854982 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m16:40:05.861254 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m16:40:05.864515 [info ] [Thread-3 (]: 5 of 6 SKIP relation public.dv_hub_fact_work ................................... [[33mSKIP[0m]
[0m16:40:05.863393 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:40:05.866260 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m16:40:05.867701 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m16:40:05.869545 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:40:05.894787 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:40:05.895670 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:40:05.896574 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:40:05.910318 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m16:40:05.918924 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m16:40:05.925193 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:40:05.925765 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m16:40:05.943704 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.017 seconds
[0m16:40:05.946646 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m16:40:05.947597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '514b091d-a809-458e-bf84-7f0df1b72a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a612739e0>]}
[0m16:40:05.949230 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_1c_journal ......................... [[32mCREATE VIEW[0m in 0.28s]
[0m16:40:05.950603 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m16:40:05.951749 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m16:40:05.952469 [info ] [Thread-2 (]: 6 of 6 START sql incremental model public.dv_hub_fact_journal .................. [RUN]
[0m16:40:05.953145 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_hub_fact_journal)
[0m16:40:05.953711 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m16:40:05.968338 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:40:05.969431 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m16:40:06.017084 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:40:06.017740 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

    
  
    

  create temporary table "dv_hub_fact_journal__dbt_tmp164005998709"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal"


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_journal" target
    where 
        target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_journal 
)

  );
  
  
[0m16:40:06.018252 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:06.027146 [debug] [Thread-2 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "stg"
LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                 ^

[0m16:40:06.027968 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m16:40:06.032693 [debug] [Thread-2 (]: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                   ^
[0m16:40:06.033355 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '514b091d-a809-458e-bf84-7f0df1b72a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a58d37860>]}
[0m16:40:06.034138 [error] [Thread-2 (]: 6 of 6 ERROR creating sql incremental model public.dv_hub_fact_journal ......... [[31mERROR[0m in 0.08s]
[0m16:40:06.035150 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m16:40:06.035987 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_hub_fact_journal' to be skipped because of status 'error'.  Reason: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                   ^.
[0m16:40:06.037781 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:06.038263 [debug] [MainThread]: On master: BEGIN
[0m16:40:06.038720 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:06.050454 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:40:06.051114 [debug] [MainThread]: On master: COMMIT
[0m16:40:06.052054 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:06.052950 [debug] [MainThread]: On master: COMMIT
[0m16:40:06.054057 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:40:06.055122 [debug] [MainThread]: On master: Close
[0m16:40:06.056231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:06.057362 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m16:40:06.058353 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_journal' was properly closed.
[0m16:40:06.059002 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_works' was properly closed.
[0m16:40:06.059636 [info ] [MainThread]: 
[0m16:40:06.060298 [info ] [MainThread]: Finished running 3 incremental models, 3 view models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m16:40:06.062088 [debug] [MainThread]: Command end result
[0m16:40:06.105459 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:40:06.107356 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:40:06.115337 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m16:40:06.116316 [info ] [MainThread]: 
[0m16:40:06.117291 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m16:40:06.117904 [info ] [MainThread]: 
[0m16:40:06.118985 [error] [MainThread]:   Database Error in model stg_1c_tech (tsm_dwh/models/stage/stg_1c_tech.sql)
  column "гар_номер" does not exist
  LINE 37:  digest('default' || '|' || LOWER(TRIM(COALESCE(гар_номер::v...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_tech.sql
[0m16:40:06.119794 [info ] [MainThread]: 
[0m16:40:06.120467 [error] [MainThread]:   Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:40:06.121007 [info ] [MainThread]: 
[0m16:40:06.121685 [error] [MainThread]:   Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                   ^
[0m16:40:06.122460 [info ] [MainThread]: 
[0m16:40:06.123102 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=2 TOTAL=6
[0m16:40:06.124264 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2384214, "process_in_blocks": "304", "process_kernel_time": 0.219014, "process_mem_max_rss": "118952", "process_out_blocks": "2696", "process_user_time": 2.52395}
[0m16:40:06.124934 [debug] [MainThread]: Command `dbt run` failed at 16:40:06.124800 after 1.24 seconds
[0m16:40:06.125461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5f3422a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5f9eb410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a58d87d70>]}
[0m16:40:06.125983 [debug] [MainThread]: Flushing usage events
[0m16:40:07.208801 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:54.452421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f951fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f8f6e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f951ffe0>]}


============================== 16:48:54.457592 | d3b7bd44-f439-4f98-bc4b-e3791c0c1d94 ==============================
[0m16:48:54.457592 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:48:54.458526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'version_check': 'True', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s +tag:hub', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:48:54.659817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f8b8d340>]}
[0m16:48:54.727562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f8ea5730>]}
[0m16:48:54.728609 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:48:54.860678 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:48:54.952150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:48:54.952661 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:48:54.981718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f8388620>]}
[0m16:48:55.057466 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:48:55.060102 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:48:55.085207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f846e780>]}
[0m16:48:55.085932 [info ] [MainThread]: Found 17 models, 433 macros
[0m16:48:55.086604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f9f64740>]}
[0m16:48:55.089415 [info ] [MainThread]: 
[0m16:48:55.090061 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:48:55.090855 [info ] [MainThread]: 
[0m16:48:55.091639 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:48:55.097607 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:48:55.159265 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:48:55.159846 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:48:55.160331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:55.181855 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.021 seconds
[0m16:48:55.183482 [debug] [ThreadPool]: On list_postgres: Close
[0m16:48:55.186046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:48:55.193690 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:48:55.194178 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:48:55.194744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:55.203153 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m16:48:55.203721 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:48:55.204191 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:48:55.207440 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m16:48:55.209486 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:48:55.210121 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:48:55.218092 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:55.218654 [debug] [MainThread]: On master: BEGIN
[0m16:48:55.219100 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:48:55.229191 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m16:48:55.229722 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:55.230432 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:48:55.240048 [debug] [MainThread]: SQL status: SELECT 2 in 0.009 seconds
[0m16:48:55.243954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f7f1df40>]}
[0m16:48:55.245019 [debug] [MainThread]: On master: ROLLBACK
[0m16:48:55.245979 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:55.246468 [debug] [MainThread]: On master: BEGIN
[0m16:48:55.247334 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:48:55.247822 [debug] [MainThread]: On master: COMMIT
[0m16:48:55.248282 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:55.248801 [debug] [MainThread]: On master: COMMIT
[0m16:48:55.249418 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:48:55.249878 [debug] [MainThread]: On master: Close
[0m16:48:55.257032 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m16:48:55.257879 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m16:48:55.258853 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_works
[0m16:48:55.259562 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_1c_journal .............................. [RUN]
[0m16:48:55.260562 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_1c_tech ................................. [RUN]
[0m16:48:55.261483 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_1c_works ................................ [RUN]
[0m16:48:55.262547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m16:48:55.263236 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_tech'
[0m16:48:55.264021 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_works'
[0m16:48:55.264631 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m16:48:55.265176 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m16:48:55.266128 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m16:48:55.279696 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m16:48:55.281138 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m16:48:55.283901 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m16:48:55.285208 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m16:48:55.301671 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m16:48:55.302442 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m16:48:55.362935 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m16:48:55.363757 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m16:48:55.365744 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m16:48:55.366956 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:48:55.367654 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m16:48:55.368591 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:48:55.369062 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:48:55.369715 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:48:55.370760 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m16:48:55.371786 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m16:48:55.372777 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:48:55.373489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:55.384205 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m16:48:55.384943 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m16:48:55.385658 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:48:55.386403 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:48:55.387341 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m16:48:55.388163 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m16:48:55.388820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:48:55.389699 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:48:55.390787 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "value_Ссылка" does not exist
LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                         ^

[0m16:48:55.391952 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m16:48:55.393411 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: ROLLBACK
[0m16:48:55.394893 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: Close
[0m16:48:55.396968 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m16:48:55.404744 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m16:48:55.408885 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:48:55.409449 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:48:55.410088 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m16:48:55.410871 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech__dbt_tmp" rename to "stg_1c_tech"
[0m16:48:55.412762 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:48:55.413531 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:48:55.430111 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:48:55.430865 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m16:48:55.437161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m16:48:55.436795 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m16:48:55.441951 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:48:55.442713 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:48:55.443691 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:48:55.444689 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m16:48:55.445468 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:48:55.453037 [debug] [Thread-3 (]: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:48:55.455110 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f6f8daf0>]}
[0m16:48:55.456003 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_1c_works ....................... [[31mERROR[0m in 0.19s]
[0m16:48:55.456884 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m16:48:55.457667 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.stg_1c_works' to be skipped because of status 'error'.  Reason: Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql.
[0m16:48:55.459007 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m16:48:55.459646 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.dv_hub_fact_work ................................... [[33mSKIP[0m]
[0m16:48:55.460458 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m16:48:55.482437 [debug] [Thread-2 (]: SQL status: COMMIT in 0.036 seconds
[0m16:48:55.492225 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_tech__dbt_backup"
[0m16:48:55.499339 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:48:55.500049 [debug] [Thread-1 (]: SQL status: COMMIT in 0.054 seconds
[0m16:48:55.500643 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
drop view if exists "postgres"."public"."stg_1c_tech__dbt_backup" cascade
[0m16:48:55.503766 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m16:48:55.505364 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:48:55.506080 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:48:55.506748 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m16:48:55.509588 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m16:48:55.510675 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18fad1f890>]}
[0m16:48:55.511559 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_1c_tech ............................ [[32mCREATE VIEW[0m in 0.25s]
[0m16:48:55.512947 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m16:48:55.514250 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m16:48:55.515104 [info ] [Thread-3 (]: 5 of 6 START sql incremental model public.dv_hub_tech .......................... [RUN]
[0m16:48:55.516003 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_works, now model.tsm_dwh.dv_hub_tech)
[0m16:48:55.516527 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m16:48:55.527629 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.017 seconds
[0m16:48:55.528717 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m16:48:55.530513 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m16:48:55.531636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f573d400>]}
[0m16:48:55.533510 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_1c_journal ......................... [[32mCREATE VIEW[0m in 0.27s]
[0m16:48:55.535494 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m16:48:55.536265 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m16:48:55.537488 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m16:48:55.553707 [info ] [Thread-2 (]: 6 of 6 START sql incremental model public.dv_hub_fact_journal .................. [RUN]
[0m16:48:55.559939 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_hub_fact_journal)
[0m16:48:55.566103 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m16:48:55.587627 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:48:55.610365 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m16:48:55.611358 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_tech"
[0m16:48:55.620629 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:48:55.621788 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

    
  
    

  create temporary table "dv_hub_fact_journal__dbt_tmp164855615710"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal"


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_journal" target
    where 
        target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_journal 
)

  );
  
  
[0m16:48:55.622742 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:55.623654 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:48:55.624603 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: BEGIN
[0m16:48:55.625663 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:55.635458 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m16:48:55.636110 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:48:55.636764 [debug] [Thread-2 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "stg"
LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                 ^

[0m16:48:55.637323 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      
  
    

  create  table "postgres"."public"."dv_hub_tech"
  
  
    as
  
  (
    

SELECT distinct on (bk_ресурс_uuid)
        hk_dv_hub_tech,
        hkcode,
        recsource,
        loadts,
        bk_ресурс_uuid
FROM "postgres"."public"."stg_1c_tech"


  );
  
  
[0m16:48:55.638401 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m16:48:55.644118 [debug] [Thread-2 (]: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                   ^
[0m16:48:55.645276 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f46573e0>]}
[0m16:48:55.646264 [error] [Thread-2 (]: 6 of 6 ERROR creating sql incremental model public.dv_hub_fact_journal ......... [[31mERROR[0m in 0.09s]
[0m16:48:55.647438 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m16:48:55.648257 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_hub_fact_journal' to be skipped because of status 'error'.  Reason: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                   ^.
[0m16:48:55.674254 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.035 seconds
[0m16:48:55.681822 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m16:48:55.682486 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:48:55.683063 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m16:48:55.692880 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m16:48:55.693918 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_tech: Close
[0m16:48:55.694755 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b7bd44-f439-4f98-bc4b-e3791c0c1d94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f464b590>]}
[0m16:48:55.696311 [info ] [Thread-3 (]: 5 of 6 OK created sql incremental model public.dv_hub_tech ..................... [[32mSELECT 0[0m in 0.18s]
[0m16:48:55.697627 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m16:48:55.699636 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:55.700121 [debug] [MainThread]: On master: BEGIN
[0m16:48:55.700711 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:48:55.711856 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:48:55.712433 [debug] [MainThread]: On master: COMMIT
[0m16:48:55.713146 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:55.713790 [debug] [MainThread]: On master: COMMIT
[0m16:48:55.714419 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:48:55.714889 [debug] [MainThread]: On master: Close
[0m16:48:55.715590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:55.716485 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_journal' was properly closed.
[0m16:48:55.717410 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_journal' was properly closed.
[0m16:48:55.718124 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_tech' was properly closed.
[0m16:48:55.719010 [info ] [MainThread]: 
[0m16:48:55.720024 [info ] [MainThread]: Finished running 3 incremental models, 3 view models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m16:48:55.722731 [debug] [MainThread]: Command end result
[0m16:48:55.760903 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:48:55.762695 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:48:55.771523 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m16:48:55.772199 [info ] [MainThread]: 
[0m16:48:55.772876 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:48:55.773523 [info ] [MainThread]: 
[0m16:48:55.774421 [error] [MainThread]:   Database Error in model stg_1c_works (tsm_dwh/models/stage/stg_1c_works.sql)
  column "value_Ссылка" does not exist
  LINE 36:  digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка...
                                                           ^
  compiled code at target/run/tsm_dwh/tsm_dwh/models/stage/stg_1c_works.sql
[0m16:48:55.775171 [info ] [MainThread]: 
[0m16:48:55.776025 [error] [MainThread]:   Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                   ^
[0m16:48:55.776633 [info ] [MainThread]: 
[0m16:48:55.777229 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=1 TOTAL=6
[0m16:48:55.778933 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3889942, "process_in_blocks": "21432", "process_kernel_time": 0.297379, "process_mem_max_rss": "119288", "process_out_blocks": "2592", "process_user_time": 2.627715}
[0m16:48:55.779652 [debug] [MainThread]: Command `dbt run` failed at 16:48:55.779490 after 1.39 seconds
[0m16:48:55.780176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f8d31160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18fad8cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f7bb50a0>]}
[0m16:48:55.780743 [debug] [MainThread]: Flushing usage events
[0m16:48:57.027659 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:53:39.980237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9f229160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da171e3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da0809ac0>]}


============================== 16:53:39.985918 | 33cc656c-2a91-46f3-8bec-e4d63832318f ==============================
[0m16:53:39.985918 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:53:39.986997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'debug': 'False', 'profiles_dir': '/home/egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s +tag:hub', 'send_anonymous_usage_stats': 'True'}
[0m16:53:40.209054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9fc10500>]}
[0m16:53:40.275003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9fa018e0>]}
[0m16:53:40.276023 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:53:40.408266 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:53:40.526094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:53:40.526658 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:53:40.557151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9e52e840>]}
[0m16:53:40.630148 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:53:40.632823 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:53:40.661045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9d522300>]}
[0m16:53:40.661742 [info ] [MainThread]: Found 17 models, 433 macros
[0m16:53:40.662290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9e16eab0>]}
[0m16:53:40.664947 [info ] [MainThread]: 
[0m16:53:40.665675 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:53:40.666248 [info ] [MainThread]: 
[0m16:53:40.667216 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:53:40.674043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:53:40.734930 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:53:40.735487 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:53:40.735954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:40.759640 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.024 seconds
[0m16:53:40.761305 [debug] [ThreadPool]: On list_postgres: Close
[0m16:53:40.765334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:53:40.772100 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:53:40.772672 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:53:40.773146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:53:40.782042 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:53:40.782666 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:53:40.783173 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:53:40.786928 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m16:53:40.788757 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:53:40.789397 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:53:40.797285 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:40.797851 [debug] [MainThread]: On master: BEGIN
[0m16:53:40.798294 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:53:40.808832 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m16:53:40.809370 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:40.810156 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:53:40.819616 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m16:53:40.822877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9e1c2b10>]}
[0m16:53:40.824030 [debug] [MainThread]: On master: ROLLBACK
[0m16:53:40.825362 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:40.826439 [debug] [MainThread]: On master: BEGIN
[0m16:53:40.827668 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:53:40.828633 [debug] [MainThread]: On master: COMMIT
[0m16:53:40.829525 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:40.830272 [debug] [MainThread]: On master: COMMIT
[0m16:53:40.831329 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:53:40.832286 [debug] [MainThread]: On master: Close
[0m16:53:40.854805 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m16:53:40.856112 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_1c_journal .............................. [RUN]
[0m16:53:40.861574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m16:53:40.862829 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m16:53:40.869836 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m16:53:40.871092 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_1c_tech ................................. [RUN]
[0m16:53:40.872326 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_tech'
[0m16:53:40.883166 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m16:53:40.873542 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_works
[0m16:53:40.890188 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_1c_works ................................ [RUN]
[0m16:53:40.891529 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_works'
[0m16:53:40.888792 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m16:53:40.893003 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m16:53:40.897053 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m16:53:40.904496 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m16:53:40.905925 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m16:53:40.902556 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m16:53:40.924710 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m16:53:41.046407 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m16:53:41.048552 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m16:53:41.049861 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m16:53:41.051143 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:53:41.052196 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m16:53:41.053033 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:53:41.054294 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:53:41.055785 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:53:41.056941 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m16:53:41.057767 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m16:53:41.058350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:41.059195 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:53:41.064739 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m16:53:41.065771 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:53:41.066771 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m16:53:41.072883 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:53:41.073619 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m16:53:41.074471 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:53:41.075190 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:53:41.076225 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m16:53:41.077170 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m16:53:41.077924 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m16:53:41.086229 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:53:41.086877 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m16:53:41.087558 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech__dbt_tmp" rename to "stg_1c_tech"
[0m16:53:41.092721 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:53:41.093557 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m16:53:41.094564 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m16:53:41.095420 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:53:41.099663 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:53:41.100168 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m16:53:41.111262 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works__dbt_tmp" rename to "stg_1c_works"
[0m16:53:41.118802 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:53:41.120830 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m16:53:41.121575 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:53:41.122232 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:53:41.122817 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:53:41.123331 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:53:41.124062 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m16:53:41.126447 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m16:53:41.127362 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:53:41.127992 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m16:53:41.134983 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m16:53:41.148840 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m16:53:41.149962 [debug] [Thread-2 (]: SQL status: COMMIT in 0.023 seconds
[0m16:53:41.150498 [debug] [Thread-3 (]: SQL status: COMMIT in 0.022 seconds
[0m16:53:41.159492 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:53:41.162576 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_tech__dbt_backup"
[0m16:53:41.165367 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_works__dbt_backup"
[0m16:53:41.166036 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m16:53:41.167104 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:53:41.168282 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:53:41.169109 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
drop view if exists "postgres"."public"."stg_1c_tech__dbt_backup" cascade
[0m16:53:41.169925 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:53:41.170477 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
drop view if exists "postgres"."public"."stg_1c_works__dbt_backup" cascade
[0m16:53:41.173498 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m16:53:41.174136 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:53:41.178933 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m16:53:41.179584 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m16:53:41.181820 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: Close
[0m16:53:41.182745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da140b590>]}
[0m16:53:41.183332 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9c062d80>]}
[0m16:53:41.184691 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_1c_journal ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m16:53:41.185499 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9c16fbf0>]}
[0m16:53:41.186440 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_1c_tech ............................ [[32mCREATE VIEW[0m in 0.31s]
[0m16:53:41.187667 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m16:53:41.188538 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_1c_works ........................... [[32mCREATE VIEW[0m in 0.29s]
[0m16:53:41.189593 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m16:53:41.190895 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m16:53:41.191951 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m16:53:41.193277 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m16:53:41.194360 [info ] [Thread-4 (]: 4 of 6 START sql incremental model public.dv_hub_fact_journal .................. [RUN]
[0m16:53:41.195448 [debug] [Thread-3 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m16:53:41.196602 [info ] [Thread-1 (]: 5 of 6 START sql incremental model public.dv_hub_tech .......................... [RUN]
[0m16:53:41.197958 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_hub_fact_journal'
[0m16:53:41.199424 [info ] [Thread-3 (]: 6 of 6 START sql incremental model public.dv_hub_fact_work ..................... [RUN]
[0m16:53:41.201144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_journal, now model.tsm_dwh.dv_hub_tech)
[0m16:53:41.202474 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m16:53:41.203557 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_works, now model.tsm_dwh.dv_hub_fact_work)
[0m16:53:41.204416 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m16:53:41.210441 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m16:53:41.219820 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:53:41.227864 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m16:53:41.234105 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m16:53:41.235498 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m16:53:41.236239 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m16:53:41.253771 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m16:53:41.342179 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_work"
[0m16:53:41.347636 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:53:41.351451 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:53:41.352224 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

    
  
    

  create temporary table "dv_hub_fact_journal__dbt_tmp165341322362"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal"


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_journal" target
    where 
        target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_journal 
)

  );
  
  
[0m16:53:41.353023 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

    
  
    

  create temporary table "dv_hub_tech__dbt_tmp165341349188"
  
  
    as
  
  (
    

SELECT distinct on (bk_ресурс_uuid)
        hk_dv_hub_tech,
        hkcode,
        recsource,
        loadts,
        bk_ресурс_uuid
FROM "postgres"."public"."stg_1c_tech"


where not exists (
    select 1
    from "postgres"."public"."dv_hub_tech" target
    where 
        target.hk_dv_hub_tech = stg.hk_dv_hub_tech 
)

  );
  
  
[0m16:53:41.353687 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:53:41.354456 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:53:41.355011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:41.355936 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: BEGIN
[0m16:53:41.357236 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:53:41.367951 [debug] [Thread-1 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "stg"
LINE 28:         target.hk_dv_hub_tech = stg.hk_dv_hub_tech 
                                         ^

[0m16:53:41.369588 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_tech: Close
[0m16:53:41.370257 [debug] [Thread-4 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "stg"
LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                 ^

[0m16:53:41.374054 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m16:53:41.374845 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m16:53:41.375485 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:53:41.376316 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      
  
    

  create  table "postgres"."public"."dv_hub_fact_work"
  
  
    as
  
  (
    

SELECT distinct on (bk_работа_uuid)
        hk_dv_hub_fact_work,
        hkcode,
        recsource,
        loadts,
        bk_работа_uuid
FROM "postgres"."public"."stg_1c_works"


  );
  
  
[0m16:53:41.409898 [debug] [Thread-1 (]: Database Error in model dv_hub_tech (tsm_dwh/models/dv/dv_hub_tech.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_tech = stg.hk_dv_hub_tech 
                                           ^
[0m16:53:41.419341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9c0de150>]}
[0m16:53:41.416205 [debug] [Thread-4 (]: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                   ^
[0m16:53:41.426685 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9c0ccf80>]}
[0m16:53:41.422670 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model public.dv_hub_tech ................. [[31mERROR[0m in 0.22s]
[0m16:53:41.430825 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m16:53:41.425556 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.046 seconds
[0m16:53:41.442026 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_hub_tech' to be skipped because of status 'error'.  Reason: Database Error in model dv_hub_tech (tsm_dwh/models/dv/dv_hub_tech.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_tech = stg.hk_dv_hub_tech 
                                           ^.
[0m16:53:41.428092 [error] [Thread-4 (]: 4 of 6 ERROR creating sql incremental model public.dv_hub_fact_journal ......... [[31mERROR[0m in 0.23s]
[0m16:53:41.453059 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m16:53:41.455908 [debug] [Thread-7 (]: Marking all children of 'model.tsm_dwh.dv_hub_fact_journal' to be skipped because of status 'error'.  Reason: Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                   ^.
[0m16:53:41.457746 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m16:53:41.458952 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:53:41.460105 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m16:53:41.473578 [debug] [Thread-3 (]: SQL status: COMMIT in 0.012 seconds
[0m16:53:41.475536 [debug] [Thread-3 (]: On model.tsm_dwh.dv_hub_fact_work: Close
[0m16:53:41.477801 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33cc656c-2a91-46f3-8bec-e4d63832318f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9c0bc350>]}
[0m16:53:41.481030 [info ] [Thread-3 (]: 6 of 6 OK created sql incremental model public.dv_hub_fact_work ................ [[32mSELECT 0[0m in 0.27s]
[0m16:53:41.483012 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m16:53:41.486971 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:41.488913 [debug] [MainThread]: On master: BEGIN
[0m16:53:41.489816 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:53:41.505066 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m16:53:41.506707 [debug] [MainThread]: On master: COMMIT
[0m16:53:41.508064 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:41.509302 [debug] [MainThread]: On master: COMMIT
[0m16:53:41.510809 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:53:41.512083 [debug] [MainThread]: On master: Close
[0m16:53:41.517073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:41.518404 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_tech' was properly closed.
[0m16:53:41.519579 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_tech' was properly closed.
[0m16:53:41.521488 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_work' was properly closed.
[0m16:53:41.522608 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_journal' was properly closed.
[0m16:53:41.523802 [info ] [MainThread]: 
[0m16:53:41.525113 [info ] [MainThread]: Finished running 3 incremental models, 3 view models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m16:53:41.527659 [debug] [MainThread]: Command end result
[0m16:53:41.579833 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:53:41.588763 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:53:41.602956 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m16:53:41.604767 [info ] [MainThread]: 
[0m16:53:41.606045 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:53:41.607043 [info ] [MainThread]: 
[0m16:53:41.608445 [error] [MainThread]:   Database Error in model dv_hub_tech (tsm_dwh/models/dv/dv_hub_tech.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_tech = stg.hk_dv_hub_tech 
                                           ^
[0m16:53:41.609530 [info ] [MainThread]: 
[0m16:53:41.610629 [error] [MainThread]:   Database Error in model dv_hub_fact_journal (tsm_dwh/models/dv/dv_hub_fact_journal.sql)
  missing FROM-clause entry for table "stg"
  LINE 28:         target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_j...
                                                   ^
[0m16:53:41.613894 [info ] [MainThread]: 
[0m16:53:41.616798 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m16:53:41.620365 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7039288, "process_in_blocks": "46368", "process_kernel_time": 0.333718, "process_mem_max_rss": "121636", "process_out_blocks": "2600", "process_user_time": 2.873743}
[0m16:53:41.623913 [debug] [MainThread]: Command `dbt run` failed at 16:53:41.621308 after 1.71 seconds
[0m16:53:41.625024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9fb5b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da0f75820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d9e1c1070>]}
[0m16:53:41.626334 [debug] [MainThread]: Flushing usage events
[0m16:53:43.136216 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:02.336093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff63239c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6323b740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff64d90680>]}


============================== 16:55:02.339831 | fe3dd13d-7488-4e82-9a69-e808cc4cd2a5 ==============================
[0m16:55:02.339831 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:55:02.340832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/egor/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/egor/projects/TSM_DWH/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s +tag:hub', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:55:02.520976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff632f45c0>]}
[0m16:55:02.588157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff62f58380>]}
[0m16:55:02.589157 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:55:02.732176 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:55:02.822647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:02.823131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:02.853466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff619619a0>]}
[0m16:55:02.923805 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:55:02.926191 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:55:02.939875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6114be60>]}
[0m16:55:02.940560 [info ] [MainThread]: Found 17 models, 433 macros
[0m16:55:02.941174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff62658290>]}
[0m16:55:02.943888 [info ] [MainThread]: 
[0m16:55:02.944584 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:55:02.945193 [info ] [MainThread]: 
[0m16:55:02.946274 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:55:02.955186 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:55:03.005611 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:55:03.006160 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:55:03.006751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:03.017948 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m16:55:03.019579 [debug] [ThreadPool]: On list_postgres: Close
[0m16:55:03.022307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public)
[0m16:55:03.029209 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:55:03.029779 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m16:55:03.030225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:03.038290 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m16:55:03.038883 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m16:55:03.039352 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:55:03.042651 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.003 seconds
[0m16:55:03.044603 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m16:55:03.045197 [debug] [ThreadPool]: On list_postgres_public: Close
[0m16:55:03.053793 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:03.054305 [debug] [MainThread]: On master: BEGIN
[0m16:55:03.054816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:03.063510 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m16:55:03.064035 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:03.064643 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:55:03.070556 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m16:55:03.072954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5f974e90>]}
[0m16:55:03.073526 [debug] [MainThread]: On master: ROLLBACK
[0m16:55:03.074203 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:03.074717 [debug] [MainThread]: On master: BEGIN
[0m16:55:03.075453 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:55:03.075922 [debug] [MainThread]: On master: COMMIT
[0m16:55:03.076408 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:03.076847 [debug] [MainThread]: On master: COMMIT
[0m16:55:03.077417 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:55:03.077874 [debug] [MainThread]: On master: Close
[0m16:55:03.081385 [debug] [Thread-1 (]: Began running node model.tsm_dwh.stg_1c_journal
[0m16:55:03.082573 [debug] [Thread-2 (]: Began running node model.tsm_dwh.stg_1c_tech
[0m16:55:03.083736 [debug] [Thread-3 (]: Began running node model.tsm_dwh.stg_1c_works
[0m16:55:03.084513 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_1c_journal .............................. [RUN]
[0m16:55:03.085488 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_1c_tech ................................. [RUN]
[0m16:55:03.086573 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_1c_works ................................ [RUN]
[0m16:55:03.087390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_public, now model.tsm_dwh.stg_1c_journal)
[0m16:55:03.088406 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_tech'
[0m16:55:03.089509 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.tsm_dwh.stg_1c_works'
[0m16:55:03.090321 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.stg_1c_journal
[0m16:55:03.091433 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.stg_1c_tech
[0m16:55:03.092503 [debug] [Thread-3 (]: Began compiling node model.tsm_dwh.stg_1c_works
[0m16:55:03.105258 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_journal"
[0m16:55:03.107834 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_tech"
[0m16:55:03.110872 [debug] [Thread-3 (]: Writing injected SQL for node "model.tsm_dwh.stg_1c_works"
[0m16:55:03.112593 [debug] [Thread-3 (]: Began executing node model.tsm_dwh.stg_1c_works
[0m16:55:03.113772 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.stg_1c_journal
[0m16:55:03.114782 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.stg_1c_tech
[0m16:55:03.205200 [debug] [Thread-3 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_works"
[0m16:55:03.206628 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_tech"
[0m16:55:03.207208 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.stg_1c_journal"
[0m16:55:03.208597 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:55:03.209121 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: BEGIN
[0m16:55:03.209713 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:55:03.210696 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:55:03.211788 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: BEGIN
[0m16:55:03.212712 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:55:03.213289 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:55:03.214063 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: BEGIN
[0m16:55:03.215054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:03.219896 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m16:55:03.220563 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:55:03.221239 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */

  create view "postgres"."public"."stg_1c_tech__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_tech,
	LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(Аналитика_value::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_work_tech,
	digest(TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(ГосНомерТехникаНеНайдена::varchar, 'N\A')) || '|' || TRIM(COALESCE(Количество::varchar, 'N\A')) || '|' || TRIM(COALESCE(Часы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Ресурс_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Аналитика_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(Контрагент_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_tech,
	Примечание::varchar,
	ГосНомерТехникаНеНайдена::varchar,
	Количество::int,
	Часы::numeric,
	Ресурс_value::uuid,
	Ресурс_codе::varchar,
	Ресурс_name::varchar,
	Аналитика_codе::varchar,
	Аналитика_name::varchar,
	Контрагент_value::varchar,
	Контрагент_codе::varchar,
	Контрагент_name::varchar
    FROM 
        src_tech
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_hub_tech,
	bk_ресурс_uuid,
	hk_dv_lnk_fact_work_tech,
	hdiff_dv_sat_fact_tech,
	примечание,
	госномер_техника_не_найдена,
	количество,
	часы,
	ресурс_value,
	ресурс_codе,
	ресурс_name,
	аналитика_codе,
	аналитика_name,
	контрагент_value,
	контрагент_codе,
	контрагент_name)
  );
[0m16:55:03.225012 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:55:03.234234 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:55:03.234869 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m16:55:03.235449 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech" rename to "stg_1c_tech__dbt_backup"
[0m16:55:03.236102 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:55:03.236793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m16:55:03.237846 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */

  create view "postgres"."public"."stg_1c_works__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_work,
	LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)) || '|' || LOWER(TRIM(COALESCE(КлючСвязи::varchar, '-1')::varchar)), 'sha1') as hk_dv_lnk_fact_journal_fact_work,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	digest(TRIM(COALESCE(СтруктураРаботИдентификатор::varchar, 'N\A')) || '|' || TRIM(COALESCE(ОбъемРаботы::varchar, 'N\A')) || '|' || TRIM(COALESCE(Примечание::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботНомерПоКонтрактнойВедомости::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРаботПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРаботУровеньОперации::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(СтруктураРабот_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(ВидРабот_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_work,
	СтруктураРаботИдентификатор::varchar,
	ОбъемРаботы::numeric,
	Примечание::varchar,
	СтруктураРаботНомерПоКонтрактнойВедомости::varchar,
	СтруктураРаботПометкаУдаления::bool,
	ВидРаботУровеньОперации::varchar,
	СтруктураРабот_value::uuid,
	СтруктураРабот_codе::varchar,
	СтруктураРабот_name::varchar,
	ВидРабот_value::uuid,
	ВидРабот_codе::varchar,
	ВидРабот_name::varchar
    FROM 
        src_works
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_work,
	bk_работа_uuid,
	hk_dv_lnk_fact_journal_fact_work,
	bk_жуфвр_uuid,
	hk_dv_hub_fact_journal,
	hdiff_dv_sat_fact_work,
	идентификатор,
	объем_работы,
	примечание,
	кв,
	пометка_удаления,
	тип_spider,
	структура_работ_value,
	структура_работ_codе,
	структура_работ_name,
	видработ_value,
	видработ_codе,
	видработ_name)
  );
[0m16:55:03.238663 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:55:03.239187 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:55:03.243186 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:55:03.244110 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */

  create view "postgres"."public"."stg_1c_journal__dbt_tmp"
    
    
  as (
    SELECT
    recsource,
    loadts,
    hkcode,
    hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name
FROM (
    SELECT
        recsource,
        loadts,
        'default',
        digest('default' || '|' || LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)), 'sha1') as hk_dv_hub_fact_journal,
	LOWER(TRIM(COALESCE(value_Ссылка::varchar, '-1')::varchar)),
	digest(TRIM(COALESCE(uuid::varchar, 'N\A')) || '|' || TRIM(COALESCE(date::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Проведен::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ссылка::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_ПометкаУдаления::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Дата::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Номер::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Территория_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Подразделение_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Смена_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Прораб_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Комментарий::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_Ответственный_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_АктуальнаяВерсияЖУФВР_name::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_value::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_codе::varchar, 'N\A')) || '|' || TRIM(COALESCE(value_НаправлениеДеятельности_name::varchar, 'N\A')), 'sha1') as hdiff_dv_sat_fact_journal,
	uuid::uuid,
	date::timestamptz,
	value_Проведен::boolean,
	value_Ссылка::uuid,
	value_ПометкаУдаления::boolean,
	value_Дата::timestamptz,
	value_Номер::varchar,
	value_Территория_value::uuid,
	value_Территория_codе::varchar,
	value_Территория_name::varchar,
	value_Подразделение_value::uuid,
	value_Подразделение_codе::varchar,
	value_Подразделение_name::varchar,
	value_Смена_value::uuid,
	value_Смена_codе::varchar,
	value_Смена_name::varchar,
	value_Прораб_value::uuid,
	value_Прораб_codе::varchar,
	value_Прораб_name::varchar,
	value_Комментарий::varchar,
	value_Ответственный_value::uuid,
	value_Ответственный_codе::varchar,
	value_Ответственный_name::varchar,
	value_АктуальнаяВерсияЖУФВР_value::uuid,
	value_АктуальнаяВерсияЖУФВР_codе::varchar,
	value_АктуальнаяВерсияЖУФВР_name::varchar,
	value_НаправлениеДеятельности_value::uuid,
	value_НаправлениеДеятельности_codе::varchar,
	value_НаправлениеДеятельности_name::varchar
    FROM 
        src_journal
) AS tmp (recsource, loadts, hkcode, hk_dv_hub_fact_journal,
	bk_жуфвр_uuid,
	hdiff_dv_sat_fact_journal,
	rabbit_uuid,
	rabbit_дата,
	проведен,
	uuid_жуфвр,
	пометка_удаления,
	дата,
	номер,
	территория_value,
	территория_codе,
	территория_name,
	подразделение_value,
	подразделение_codе,
	подразделение_name,
	смена_value,
	смена_codе,
	смена_name,
	прораб_value,
	прораб_codе,
	прораб_name,
	комментарий,
	ответственный_value,
	ответственный_codе,
	ответственный_name,
	версия_жуфвр_value,
	версия_жуфвр_codе,
	версия_жуфвр_name,
	направление_деятельности_value,
	направление_деятельности_codе,
	направление_деятельности_name)
  );
[0m16:55:03.244955 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m16:55:03.245543 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
alter table "postgres"."public"."stg_1c_tech__dbt_tmp" rename to "stg_1c_tech"
[0m16:55:03.249749 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:55:03.250481 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:55:03.251130 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works" rename to "stg_1c_works__dbt_backup"
[0m16:55:03.251992 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:55:03.257046 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:55:03.268489 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal" rename to "stg_1c_journal__dbt_backup"
[0m16:55:03.275970 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m16:55:03.279430 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:55:03.280051 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m16:55:03.285947 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m16:55:03.286491 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
alter table "postgres"."public"."stg_1c_works__dbt_tmp" rename to "stg_1c_works"
[0m16:55:03.290199 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:55:03.290859 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:55:03.291510 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
alter table "postgres"."public"."stg_1c_journal__dbt_tmp" rename to "stg_1c_journal"
[0m16:55:03.292135 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:55:03.292676 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: COMMIT
[0m16:55:03.295339 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m16:55:03.296264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:55:03.297416 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:55:03.299825 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:55:03.300432 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: COMMIT
[0m16:55:03.301058 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:55:03.301714 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: COMMIT
[0m16:55:03.306630 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m16:55:03.313988 [debug] [Thread-2 (]: Applying DROP to: "postgres"."public"."stg_1c_tech__dbt_backup"
[0m16:55:03.320247 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.stg_1c_tech"
[0m16:55:03.320927 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m16:55:03.321505 [debug] [Thread-3 (]: SQL status: COMMIT in 0.020 seconds
[0m16:55:03.321988 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_tech"} */
drop view if exists "postgres"."public"."stg_1c_tech__dbt_backup" cascade
[0m16:55:03.325007 [debug] [Thread-1 (]: Applying DROP to: "postgres"."public"."stg_1c_journal__dbt_backup"
[0m16:55:03.327850 [debug] [Thread-3 (]: Applying DROP to: "postgres"."public"."stg_1c_works__dbt_backup"
[0m16:55:03.329833 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.stg_1c_journal"
[0m16:55:03.331283 [debug] [Thread-3 (]: Using postgres connection "model.tsm_dwh.stg_1c_works"
[0m16:55:03.332028 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_journal"} */
drop view if exists "postgres"."public"."stg_1c_journal__dbt_backup" cascade
[0m16:55:03.332796 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.stg_1c_works"} */
drop view if exists "postgres"."public"."stg_1c_works__dbt_backup" cascade
[0m16:55:03.340452 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.012 seconds
[0m16:55:03.343472 [debug] [Thread-2 (]: On model.tsm_dwh.stg_1c_tech: Close
[0m16:55:03.345837 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff64d47980>]}
[0m16:55:03.346888 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_1c_tech ............................ [[32mCREATE VIEW[0m in 0.26s]
[0m16:55:03.347863 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.stg_1c_tech
[0m16:55:03.348810 [debug] [Thread-4 (]: Began running node model.tsm_dwh.dv_hub_tech
[0m16:55:03.349665 [info ] [Thread-4 (]: 4 of 6 START sql incremental model public.dv_hub_tech .......................... [RUN]
[0m16:55:03.350563 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.tsm_dwh.dv_hub_tech'
[0m16:55:03.351073 [debug] [Thread-4 (]: Began compiling node model.tsm_dwh.dv_hub_tech
[0m16:55:03.360301 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.027 seconds
[0m16:55:03.366178 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.033 seconds
[0m16:55:03.368898 [debug] [Thread-4 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_tech"
[0m16:55:03.372163 [debug] [Thread-1 (]: On model.tsm_dwh.stg_1c_journal: Close
[0m16:55:03.375042 [debug] [Thread-3 (]: On model.tsm_dwh.stg_1c_works: Close
[0m16:55:03.376351 [debug] [Thread-4 (]: Began executing node model.tsm_dwh.dv_hub_tech
[0m16:55:03.378268 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5f8ce9f0>]}
[0m16:55:03.379282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5f8ce7b0>]}
[0m16:55:03.390679 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_1c_works ........................... [[32mCREATE VIEW[0m in 0.29s]
[0m16:55:03.401788 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_1c_journal ......................... [[32mCREATE VIEW[0m in 0.29s]
[0m16:55:03.403101 [debug] [Thread-3 (]: Finished running node model.tsm_dwh.stg_1c_works
[0m16:55:03.418478 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.stg_1c_journal
[0m16:55:03.440361 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:55:03.441475 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

    
  
    

  create temporary table "dv_hub_tech__dbt_tmp165503416815"
  
  
    as
  
  (
    

SELECT distinct on (bk_ресурс_uuid)
        hk_dv_hub_tech,
        hkcode,
        recsource,
        loadts,
        bk_ресурс_uuid
FROM "postgres"."public"."stg_1c_tech" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_tech" target
    where 
        target.hk_dv_hub_tech = stg.hk_dv_hub_tech 
)

  );
  
  
[0m16:55:03.442146 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:55:03.442750 [debug] [Thread-2 (]: Began running node model.tsm_dwh.dv_hub_fact_work
[0m16:55:03.443897 [info ] [Thread-2 (]: 5 of 6 START sql incremental model public.dv_hub_fact_work ..................... [RUN]
[0m16:55:03.445109 [debug] [Thread-1 (]: Began running node model.tsm_dwh.dv_hub_fact_journal
[0m16:55:03.446011 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_tech, now model.tsm_dwh.dv_hub_fact_work)
[0m16:55:03.446907 [info ] [Thread-1 (]: 6 of 6 START sql incremental model public.dv_hub_fact_journal .................. [RUN]
[0m16:55:03.447666 [debug] [Thread-2 (]: Began compiling node model.tsm_dwh.dv_hub_fact_work
[0m16:55:03.448465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.tsm_dwh.stg_1c_journal, now model.tsm_dwh.dv_hub_fact_journal)
[0m16:55:03.456141 [debug] [Thread-2 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_work"
[0m16:55:03.456934 [debug] [Thread-1 (]: Began compiling node model.tsm_dwh.dv_hub_fact_journal
[0m16:55:03.463299 [debug] [Thread-1 (]: Writing injected SQL for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:55:03.464472 [debug] [Thread-2 (]: Began executing node model.tsm_dwh.dv_hub_fact_work
[0m16:55:03.473836 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:55:03.474520 [debug] [Thread-1 (]: Began executing node model.tsm_dwh.dv_hub_fact_journal
[0m16:55:03.475092 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.033 seconds
[0m16:55:03.475759 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

    
  
    

  create temporary table "dv_hub_fact_work__dbt_tmp165503469306"
  
  
    as
  
  (
    

SELECT distinct on (bk_работа_uuid)
        hk_dv_hub_fact_work,
        hkcode,
        recsource,
        loadts,
        bk_работа_uuid
FROM "postgres"."public"."stg_1c_works" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_work" target
    where 
        target.hk_dv_hub_fact_work = stg.hk_dv_hub_fact_work 
)

  );
  
  
[0m16:55:03.481096 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:55:03.497301 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:55:03.497923 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:55:03.498723 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

    
  
    

  create temporary table "dv_hub_fact_journal__dbt_tmp165503478730"
  
  
    as
  
  (
    

SELECT distinct on (bk_жуфвр_uuid)
        hk_dv_hub_fact_journal,
        hkcode,
        recsource,
        loadts,
        bk_жуфвр_uuid
FROM "postgres"."public"."stg_1c_journal" stg


where not exists (
    select 1
    from "postgres"."public"."dv_hub_fact_journal" target
    where 
        target.hk_dv_hub_fact_journal = stg.hk_dv_hub_fact_journal 
)

  );
  
  
[0m16:55:03.499457 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: BEGIN
[0m16:55:03.500249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:03.501131 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m16:55:03.501892 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:55:03.503127 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech__dbt_tmp165503416815'
        
      order by ordinal_position

  
[0m16:55:03.518587 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.020 seconds
[0m16:55:03.519583 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.016 seconds
[0m16:55:03.523172 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:55:03.523755 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.024 seconds
[0m16:55:03.529456 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:55:03.530250 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: BEGIN
[0m16:55:03.533799 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:55:03.534506 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m16:55:03.535302 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: BEGIN
[0m16:55:03.536020 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m16:55:03.536732 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:55:03.537347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m16:55:03.538194 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work__dbt_tmp165503469306'
        
      order by ordinal_position

  
[0m16:55:03.538875 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:55:03.539909 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal__dbt_tmp165503478730'
        
      order by ordinal_position

  
[0m16:55:03.540761 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.004 seconds
[0m16:55:03.552985 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.013 seconds
[0m16:55:03.553640 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.012 seconds
[0m16:55:03.557543 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:55:03.559844 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:55:03.563456 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:55:03.564203 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m16:55:03.564899 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_tech'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m16:55:03.565608 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m16:55:03.568813 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.002 seconds
[0m16:55:03.576066 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.010 seconds
[0m16:55:03.576713 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.010 seconds
[0m16:55:03.579828 [debug] [Thread-4 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_tech"
[0m16:55:03.585539 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:55:03.591488 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:55:03.592610 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_work'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m16:55:03.593273 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'dv_hub_fact_journal'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m16:55:03.594116 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:55:03.597202 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_tech"} */

      insert into "postgres"."public"."dv_hub_tech" ("hk_dv_hub_tech", "hkcode", "recsource", "loadts", "bk_ресурс_uuid")
    (
        select "hk_dv_hub_tech", "hkcode", "recsource", "loadts", "bk_ресурс_uuid"
        from "dv_hub_tech__dbt_tmp165503416815"
    )


  
[0m16:55:03.598480 [debug] [Thread-2 (]: SQL status: SELECT 5 in 0.004 seconds
[0m16:55:03.599113 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m16:55:03.601728 [debug] [Thread-2 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_work"
[0m16:55:03.602432 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m16:55:03.604788 [debug] [Thread-1 (]: Writing runtime sql for node "model.tsm_dwh.dv_hub_fact_journal"
[0m16:55:03.606882 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m16:55:03.607752 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:55:03.608465 [debug] [Thread-4 (]: Using postgres connection "model.tsm_dwh.dv_hub_tech"
[0m16:55:03.609489 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_work"} */

      insert into "postgres"."public"."dv_hub_fact_work" ("hk_dv_hub_fact_work", "hkcode", "recsource", "loadts", "bk_работа_uuid")
    (
        select "hk_dv_hub_fact_work", "hkcode", "recsource", "loadts", "bk_работа_uuid"
        from "dv_hub_fact_work__dbt_tmp165503469306"
    )


  
[0m16:55:03.610166 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:55:03.611030 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: COMMIT
[0m16:55:03.612009 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "tsm_dwh", "target_name": "dev", "node_id": "model.tsm_dwh.dv_hub_fact_journal"} */

      insert into "postgres"."public"."dv_hub_fact_journal" ("hk_dv_hub_fact_journal", "hkcode", "recsource", "loadts", "bk_жуфвр_uuid")
    (
        select "hk_dv_hub_fact_journal", "hkcode", "recsource", "loadts", "bk_жуфвр_uuid"
        from "dv_hub_fact_journal__dbt_tmp165503478730"
    )


  
[0m16:55:03.612798 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m16:55:03.617434 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m16:55:03.618266 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m16:55:03.619366 [debug] [Thread-2 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_work"
[0m16:55:03.621798 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m16:55:03.622619 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: COMMIT
[0m16:55:03.623455 [debug] [Thread-1 (]: Using postgres connection "model.tsm_dwh.dv_hub_fact_journal"
[0m16:55:03.624586 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: COMMIT
[0m16:55:03.627911 [debug] [Thread-4 (]: SQL status: COMMIT in 0.014 seconds
[0m16:55:03.629000 [debug] [Thread-4 (]: On model.tsm_dwh.dv_hub_tech: Close
[0m16:55:03.629816 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5f822a50>]}
[0m16:55:03.630940 [info ] [Thread-4 (]: 4 of 6 OK created sql incremental model public.dv_hub_tech ..................... [[32mINSERT 0 0[0m in 0.28s]
[0m16:55:03.631902 [debug] [Thread-4 (]: Finished running node model.tsm_dwh.dv_hub_tech
[0m16:55:03.640064 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m16:55:03.641332 [debug] [Thread-2 (]: SQL status: COMMIT in 0.017 seconds
[0m16:55:03.643361 [debug] [Thread-1 (]: On model.tsm_dwh.dv_hub_fact_journal: Close
[0m16:55:03.645089 [debug] [Thread-2 (]: On model.tsm_dwh.dv_hub_fact_work: Close
[0m16:55:03.646383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5f99bfe0>]}
[0m16:55:03.647246 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe3dd13d-7488-4e82-9a69-e808cc4cd2a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5f99ae40>]}
[0m16:55:03.648204 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model public.dv_hub_fact_journal ............. [[32mINSERT 0 0[0m in 0.20s]
[0m16:55:03.649532 [info ] [Thread-2 (]: 5 of 6 OK created sql incremental model public.dv_hub_fact_work ................ [[32mINSERT 0 0[0m in 0.20s]
[0m16:55:03.651047 [debug] [Thread-1 (]: Finished running node model.tsm_dwh.dv_hub_fact_journal
[0m16:55:03.652606 [debug] [Thread-2 (]: Finished running node model.tsm_dwh.dv_hub_fact_work
[0m16:55:03.655154 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:03.656222 [debug] [MainThread]: On master: BEGIN
[0m16:55:03.656972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:55:03.667560 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m16:55:03.668501 [debug] [MainThread]: On master: COMMIT
[0m16:55:03.669482 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:03.670284 [debug] [MainThread]: On master: COMMIT
[0m16:55:03.671330 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:55:03.672546 [debug] [MainThread]: On master: Close
[0m16:55:03.673902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:03.674580 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_journal' was properly closed.
[0m16:55:03.674996 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_fact_work' was properly closed.
[0m16:55:03.675562 [debug] [MainThread]: Connection 'model.tsm_dwh.stg_1c_works' was properly closed.
[0m16:55:03.675999 [debug] [MainThread]: Connection 'model.tsm_dwh.dv_hub_tech' was properly closed.
[0m16:55:03.676703 [info ] [MainThread]: 
[0m16:55:03.677575 [info ] [MainThread]: Finished running 3 incremental models, 3 view models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m16:55:03.679449 [debug] [MainThread]: Command end result
[0m16:55:03.721262 [debug] [MainThread]: Wrote artifact WritableManifest to /home/egor/projects/TSM_DWH/target/manifest.json
[0m16:55:03.724954 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/egor/projects/TSM_DWH/target/semantic_manifest.json
[0m16:55:03.732506 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/egor/projects/TSM_DWH/target/run_results.json
[0m16:55:03.733417 [info ] [MainThread]: 
[0m16:55:03.734039 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:55:03.734771 [info ] [MainThread]: 
[0m16:55:03.735417 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:55:03.736811 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4593469, "process_in_blocks": "0", "process_kernel_time": 0.245078, "process_mem_max_rss": "120420", "process_out_blocks": "2800", "process_user_time": 2.715666}
[0m16:55:03.737400 [debug] [MainThread]: Command `dbt run` succeeded at 16:55:03.737265 after 1.46 seconds
[0m16:55:03.738021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff667b7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5f974e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5f9674a0>]}
[0m16:55:03.738739 [debug] [MainThread]: Flushing usage events
[0m16:55:04.852517 [debug] [MainThread]: An error was encountered while trying to flush usage events
